{"version":3,"sources":["../src/confirm-lock-aware.js"],"names":["define","$","Str","Notification","strings","key","component","init","selector","stringsPromise","get_strings","catch","exception","on","e","_confirmed","preventDefault","form","target","then","title","question","yesLabel","noLabel","confirm","submit"],"mappings":"+qCAuBAA,OAAM,mCAAC,CAAC,QAAD,CAAW,UAAX,CAAuB,mBAAvB,CAAD,CAA8C,SAASC,CAAT,CAAYC,CAAZ,CAAiBC,CAAjB,CAA+B,CAE/E,GAAMC,CAAAA,CAAO,CAAG,CACZ,CAACC,GAAG,CAAE,YAAN,CAAoBC,SAAS,CAAE,MAA/B,CADY,CAEZ,CAACD,GAAG,CAAE,yBAAN,CAAiCC,SAAS,CAAE,cAA5C,CAFY,CAGZ,CAACD,GAAG,CAAE,KAAN,CAAaC,SAAS,CAAE,MAAxB,CAHY,CAIZ,CAACD,GAAG,CAAE,IAAN,CAAYC,SAAS,CAAE,MAAvB,CAJY,CAAhB,CAoCA,MAAO,CACHC,IAAI,CAzBR,SAAcC,CAAd,CAAwB,YAGdC,CAAc,CAAGP,CAAG,CAACQ,WAAJ,CAAgBN,CAAhB,EAAyBO,KAAzB,CAA+BR,CAAY,CAACS,SAA5C,CAHH,CAMpBX,CAAC,CAACO,CAAD,CAAD,CAAYK,EAAZ,CAAe,QAAf,CAAyB,SAACC,CAAD,CAAO,CAC5B,GAAI,CAAI,CAACC,UAAT,CAAqB,CACjB,MACH,CAEDD,CAAC,CAACE,cAAF,GACA,GAAMC,CAAAA,CAAI,CAAGhB,CAAC,CAACa,CAAC,CAACI,MAAH,CAAd,CAEAT,CAAc,CAACU,IAAf,CAAoB,WAA0C,2BAAxCC,CAAwC,MAAjCC,CAAiC,MAAvBC,CAAuB,MAAbC,CAAa,MAC1D,MAAOpB,CAAAA,CAAY,CAACqB,OAAb,CAAqBJ,CAArB,CAA4BC,CAA5B,CAAsCC,CAAtC,CAAgDC,CAAhD,CAAyD,UAAM,CAClE,CAAI,CAACR,UAAL,IACAE,CAAI,CAACQ,MAAL,EACH,CAHM,CAIV,CALD,EAKGd,KALH,CAKSR,CAAY,CAACS,SALtB,CAOH,CAfD,CAgBH,CAEM,CAIV,CA1CK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Ask student to confirm that they are aware that editing will be locked.\n *\n * @copyright  2020 Xi'an Jiaotong-Liverpool University\n * @author     Frédéric Massart <fred@branchup.tech>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/str', 'core/notification'], function($, Str, Notification) {\n\n    const strings = [\n        {key: 'areyousure', component: 'core'},\n        {key: 'confirmlockeditingaware', component: 'mod_peerwork'},\n        {key: 'yes', component: 'core'},\n        {key: 'no', component: 'core'},\n    ];\n\n    /**\n     * Init function.\n     *\n     * @param {String} selector The form selector.\n     */\n    function init(selector) {\n\n        // Preload strings.\n        const stringsPromise = Str.get_strings(strings).catch(Notification.exception);\n\n        // Listen to form submissions.\n        $(selector).on('submit', (e) => {\n            if (this._confirmed) {\n                return;\n            }\n\n            e.preventDefault();\n            const form = $(e.target);\n\n            stringsPromise.then(([title, question, yesLabel, noLabel]) => {\n                return Notification.confirm(title, question, yesLabel, noLabel, () => {\n                    this._confirmed = true;\n                    form.submit();\n                });\n            }).catch(Notification.exception);\n\n        });\n    }\n\n    return {\n        init: init\n    };\n\n});\n"],"file":"confirm-lock-aware.min.js"}