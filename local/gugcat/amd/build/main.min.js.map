{"version":3,"sources":["../src/main.js"],"names":["define","$","Str","ModalFactory","ModalGcat","Storage","Ajax","checkCurrentUrl","path","url","window","location","pathname","match","calculatePercentagePoints","target","is_percentage","grade_max","document","getElementsByName","value","input_point","getElementById","id","slice","isNaN","rounder","input_percentage","number","multiplier","parseInt","repeat","Math","round","clearConversionTable","input_percentage_points","querySelectorAll","forEach","element","input","lastElementChild","firstElementChild","is_input_H","update_reason_inputs","val","list","check_blind_marking","btn_identities","classes","length","textContent","classList","add","is_blindmarking","get","get_strings","key","component","then","langStrings","remove","toggle_child_activities","btns","btn","addEventListener","e","selected","getAttribute","icon","querySelector","toggle","contains","colgroups","toggle_display_assessments","btn_switch_display","urlParams","URLSearchParams","search","courseid","requests","call","methodname","args","done","data","switchOn","result","fail","style","display","sortTable","n","table","rows","switching","i","x","y","shouldSwitch","dir","switchcount","getElementsByTagName","innerHTML","toLowerCase","parentNode","insertBefore","showModal","dataAction","messageId","confirmId","cancelId","templateContext","bodycontent","strcancel","strconfirm","dataaction","create","type","TYPE","modal","show","toggleScaleTable","schedA","schedB","onChangeListeners","event","categories","activities","childactivities","grade_reason","select_scale","select_template","select_alt_grade","mform_grade_reason","delete","set","replace","selectedOption","mformReason","focus","required","templateid","template","JSON","parse","scaletype","nameidprc","nameidpt","maxgrade","conversions","conversion","conv","nameprc","grade","namept","inputprc","inputpt","lowerboundary","parseFloat","all","merit","gpa","lbl","showImportLoading","body","scrollTop","documentElement","overflow","onClickListeners","btn_multiadd","btn_multisave","btn_cancelmultisave","btn_release","btn_import","btn_coursegradeform","btn_download","btn_finalrelease","btn_bulk_import","radio_ptprc","btn_altsave","btn_upload_submit","click","text","includes","inputarr","total","div","invalid","notes","errorNotes","alttype","selectReason","otherReason","init","GCAT","input_reason","input_search","keyCode","which","field","input_gradept","grademax","test","Number","isInteger","input_percentarr","totalweight","input_templatename","columns","column","preventDefault","entries","searchIcons","currentTarget","blur","nextSibling","grdDiscExist","meritCheckboxes","cb","checked","input_percent","nodeArr","Array","from","find","node","btnnewgrade","hideshowgrade","btn_upload","disabled","cursor","cssText"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module for local_gugcat.\n *\n * @package    local_gugcat\n * @copyright  2020\n * @author     Accenture\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/str', 'core/modal_factory', 'local_gugcat/modal_gcat', 'core/sessionstorage', 'core/ajax'],\nfunction($, Str, ModalFactory, ModalGcat, Storage, Ajax) {\n\n    const BLIND_MARKING_KEY = 'blind-marking';\n    //Returns boolean on check of the current url and match it to the path params\n    const checkCurrentUrl = (path) => {\n        var url = window.location.pathname;\n        return url.match(path);\n    };\n\n    const calculatePercentagePoints = (target, is_percentage = true) => {\n        var grade_max = document.getElementsByName('grademax')[0].value;\n        if (is_percentage){\n            var input_point = document.getElementById(target.id.slice(0,10) + \"pt_\" + target.id.slice(10));\n            input_point.value = target.value && !isNaN(target.value) ? rounder((target.value / 100) * grade_max) : '';\n        } else {\n            var input_percentage = document.getElementById(target.id.slice(0,10) + target.id.slice(13));\n            input_percentage.value = target.value && !isNaN(target.value) ? rounder((target.value / grade_max) * 100) : '';\n        }\n    };\n\n    const rounder = (number) => {\n        var multiplier = parseInt(\"1\" + \"0\".repeat(2));\n        number = number * multiplier;\n        return Math.round(number) / multiplier;\n    };\n\n    const clearConversionTable = () => {\n        var input_percentage_points = document.querySelectorAll('.input-prc,.input-pt');\n        input_percentage_points.forEach(element => {\n            var input = element.lastElementChild.firstElementChild;\n            var is_input_H = input.id == 'id_schedA_pt_1' || input.id == 'id_schedA_1'\n                || input.id == 'id_schedB_1' || input.id == 'id_schedB_pt_1';\n            if (!is_input_H){\n                input.value = \"\";\n            }\n        });\n    };\n\n    const update_reason_inputs = (val) => {\n        var list = document.querySelectorAll('.input-reason');\n        list.forEach(input => {input.value = val;});\n    };\n\n    const check_blind_marking = () =>{\n        var btn_identities = document.getElementById('btn-identities');\n        var classes = document.querySelectorAll('.blind-marking');\n        if(btn_identities && classes.length > 0){\n            btn_identities.textContent = '...';\n            classes.forEach(element => element.classList.add('hide-names'));\n            var is_blindmarking = (Storage.get(BLIND_MARKING_KEY) == 'true');\n            var strings = [\n                {\n                    key: 'showidentities',\n                    component: 'local_gugcat'\n                },\n                {\n                    key: 'hideidentities',\n                    component: 'local_gugcat'\n                }\n            ];\n            Str.get_strings(strings).then(function(langStrings){\n                btn_identities.textContent = is_blindmarking\n                    ?langStrings[0]//show\n                    :langStrings[1];//hide\n                classes.forEach(element => {\n                    if(is_blindmarking){\n                        element.classList.add('hide-names');\n                    }else{\n                        element.classList.remove('hide-names');\n                    }\n                });\n            });\n\n        }\n    };\n\n    const toggle_child_activities = () =>{\n        var btns = document.querySelectorAll('.btn-colexp');\n        if(btns.length > 0){\n            btns.forEach(btn => {\n                btn.addEventListener('click', (e) => {\n                    var selected = e.target.getAttribute('data-categoryid');\n                    var classes = document.querySelectorAll(`[data-category=\"${selected}\"]`);\n                    var icon = btn.querySelector('.i-colexp');\n                    classes.forEach(element => {\n                       element.classList.toggle('hidden');\n                       if(element.classList.contains('hidden')){\n                           icon.classList.add('fa-plus');\n                           icon.classList.remove('fa-minus');\n                       }else{\n                           icon.classList.remove('fa-plus');\n                           icon.classList.add('fa-minus');\n                       }\n                   });\n                    var colgroups = document.querySelectorAll(`.catid-${selected}`);\n                    colgroups.forEach(element => element.classList.toggle('hidden'));\n                });\n            });\n        }\n    };\n\n    const toggle_display_assessments = () =>{\n        var btn_switch_display = document.getElementById('btn-switch-display');\n        var urlParams = new URLSearchParams(window.location.search);\n        var courseid = urlParams.get('id');\n        if(btn_switch_display){\n            btn_switch_display.textContent = '...';\n            var requests = Ajax.call([{\n                methodname: 'local_gugcat_display_assessments',\n                args: { courseid: courseid},\n            }]);\n            requests[0].done(function(data) {\n                var switchOn = data.result;\n                var strings = [\n                    {\n                        key: 'switchoffdisplay',\n                        component: 'local_gugcat'\n                    },\n                    {\n                        key: 'switchondisplay',\n                        component: 'local_gugcat'\n                    }\n                ];\n                Str.get_strings(strings).then(function(langStrings){\n                    btn_switch_display.textContent = switchOn\n                        ?langStrings[0]//off\n                        :langStrings[1];//on\n                });\n                }).fail(function(){\n                    btn_switch_display.style.display = 'none';\n                });\n        }\n    };\n\n    const sortTable = (n) => {\n        var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;\n        table = document.getElementById(\"gcat-table\");\n        switching = true;\n        // Set the sorting direction to ascending:\n        dir = \"asc\";\n        /* Make a loop that will continue until\n        no switching has been done: */\n        while (switching) {\n          // Start by saying: no switching is done:\n          switching = false;\n          rows = table.rows;\n          /* Loop through all table rows (except the\n          first, which contains table headers): */\n          for (i = 1; i < (rows.length - 1); i++) {\n            // Start by saying there should be no switching:\n            shouldSwitch = false;\n            /* Get the two elements you want to compare,\n            one from current row and one from the next: */\n            x = rows[i].getElementsByTagName(\"TD\")[n];\n            y = rows[i + 1].getElementsByTagName(\"TD\")[n];\n            /* Check if the two rows should switch place,\n            based on the direction, asc or desc: */\n            if (dir == \"asc\") {\n              if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {\n                // If so, mark as a switch and break the loop:\n                shouldSwitch = true;\n                break;\n              }\n            } else if (dir == \"desc\") {\n              if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {\n                // If so, mark as a switch and break the loop:\n                shouldSwitch = true;\n                break;\n              }\n            }\n          }\n          if (shouldSwitch) {\n            /* If a switch has been marked, make the switch\n            and mark that a switch has been done: */\n            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);\n            switching = true;\n            // Each time a switch is done, increase this count by 1:\n            switchcount ++;\n          } else {\n            /* If no switching has been done AND the direction is \"asc\",\n            set the direction to \"desc\" and run the while loop again. */\n            if (switchcount == 0 && dir == \"asc\") {\n              dir = \"desc\";\n              switching = true;\n            }\n          }\n        }\n    };\n\n    const showModal = (dataAction, messageId, confirmId, cancelId = 'cancelmodal') => {\n        var strings = [\n            {\n                key: messageId,\n                component: 'local_gugcat'\n            },\n            {\n                key: cancelId,\n                component: 'local_gugcat'\n            },\n            {\n                key: confirmId,\n                component: 'local_gugcat'\n            }\n        ];\n        Str.get_strings(strings).then(function(langStrings){\n            var templateContext = {\n                bodycontent: langStrings[0],\n                strcancel: langStrings[1],\n                strconfirm: langStrings[2],\n                dataaction: dataAction\n            };\n            ModalFactory.create({\n                type:ModalGcat.TYPE,\n                templateContext: templateContext\n            }).done(modal => modal.show());\n        });\n    };\n\n    const toggleScaleTable = () => {\n        var schedA = document.getElementById('table-schedulea');\n        var schedB = document.getElementById('table-scheduleb');\n        schedA.classList.toggle('hidden');\n        schedB.classList.toggle('hidden');\n    };\n\n    const onChangeListeners = (event) =>{\n        var urlParams = new URLSearchParams(window.location.search);\n        var categories = document.getElementById('select-category');\n        var activities = document.getElementById('select-activity');\n        var childactivities = document.getElementById('select-child-act');\n        var grade_reason = document.querySelector('.multi-select-reason > select');\n        var select_scale = document.getElementById('select-scale');\n        var select_template = document.getElementById('select-template');\n        var select_alt_grade = document.getElementById('select-alt-grade');\n        var mform_grade_reason = document.getElementById('id_reasons');\n        switch (event.target) {\n            case categories:\n                urlParams.delete(\"activityid\");\n                urlParams.delete(\"childactivityid\");\n                urlParams.delete(\"page\");\n                if(categories.value === 'null'){\n                    urlParams.delete(\"categoryid\");\n                }else{\n                    urlParams.set(\"categoryid\", categories.value);\n                }\n                if(checkCurrentUrl(\"gugcat/add\")){\n                    urlParams.delete(\"studentid\");\n                    var url = window.location.pathname;\n                    url = url.replace(\"gugcat/add\", \"gugcat\")+\"?\"+urlParams;\n                    window.location.replace(url);\n                    return;\n                }\n                window.location.search = urlParams;\n                break;\n            case activities:\n                urlParams.set(\"activityid\", activities.value);\n                urlParams.delete(\"childactivityid\");\n                urlParams.delete(\"page\");\n                window.location.search = urlParams;\n                break;\n            case childactivities:\n                urlParams.set(\"childactivityid\", childactivities.value);\n                urlParams.delete(\"page\");\n                window.location.search = urlParams;\n                break;\n            case grade_reason:\n                var selected = event.target.value;\n                var input = document.querySelector('.togglemultigrd > input');\n                update_reason_inputs(selected);\n                if(selected === 'Other'){\n                    update_reason_inputs('');\n                    input.style.display = 'block';\n                }else{\n                    input.style.display = 'none';\n                }\n                break;\n            case mform_grade_reason:\n                var selectedOption = event.target.value;\n                var mformReason = document.getElementById('id_otherreason');\n                if (selectedOption == '9') {\n                    mformReason.value = '';\n                    mformReason.focus();\n                    mformReason.required = true;\n                } else {\n                    mformReason.required = false;\n                }\n                break;\n            case select_scale:\n                toggleScaleTable();\n                break;\n            case select_template:\n                if(select_template.value != 0){\n                    var templateid = select_template.value;\n                    var requests = Ajax.call([{\n                        methodname: 'local_gugcat_get_converter_template',\n                        args: { templateid: templateid},\n                    }]);\n                    requests[0].done(function(data) {\n                        var template = data.result;\n                        if(template){\n                            template = JSON.parse(template);\n                            // Empty all input fields first\n                            clearConversionTable();\n\n                            // Toggle table scale based on the template scale\n                            if(select_scale.value != template.scaletype){\n                                toggleScaleTable();\n                            }\n\n                            // Assign template scale on the select scale field\n                            select_scale.value = template.scaletype;\n\n                            // Name identifier for the input percentages and input points\n\n                            var nameidprc = template.scaletype != 2 ? \"schedA[*]\" : \"schedB[*]\";\n                            var nameidpt = template.scaletype != 2 ? \"schedA_pt[*]\" : \"schedB_pt[*]\";\n\n                            // Get maximum grade\n                            var maxgrade = document.getElementsByName('grademax')[0].value;\n\n                            // Start assigning lowerboundary from template on the input pt fields\n                            var conversions = template.conversion;\n                            for (let key in conversions) {\n                                let conv = conversions[key];\n                                let nameprc = nameidprc.replace(\"*\", conv.grade);\n                                let namept = nameidpt.replace(\"*\", conv.grade);\n                                var inputprc = document.querySelector(`.input-prc > div > input[name=\"${nameprc}\"]`);\n                                var inputpt = document.querySelector(`.input-pt > div > input[name=\"${namept}\"]`);\n                                let lowerboundary = parseFloat(conv.lowerboundary);\n                                inputprc.value =  lowerboundary;\n                                inputpt.value = rounder((lowerboundary / 100) * maxgrade); //convert percentage to points\n                            }\n                        }\n                    }).fail(function(){\n                        // console.log(e);\n                    });\n                }\n                break;\n            case select_alt_grade:\n                var all = document.querySelectorAll('.merit-lbl, .gpa-lbl');\n                if(select_alt_grade.value != 0){\n                    var merit = document.querySelectorAll('.merit-lbl');\n                    var gpa = document.querySelectorAll('.gpa-lbl');\n                    if(select_alt_grade.value == 1){\n                        if(merit.length > 0 ){\n                            merit.forEach(lbl => lbl.classList.remove('hidden'));\n                        }\n                        if(gpa.length > 0 ){\n                            gpa.forEach(lbl => lbl.classList.add('hidden'));\n                        }\n                    }else if(select_alt_grade.value == 2){\n                        if(merit.length > 0 ){\n                            merit.forEach(lbl => lbl.classList.add('hidden'));\n                        }\n                        if(gpa.length > 0 ){\n                            gpa.forEach(lbl => lbl.classList.remove('hidden'));\n                        }\n                    }\n                }else{\n                    if(all.length > 0 ){\n                        all.forEach(lbl => lbl.classList.add('hidden'));\n                    }\n                }\n                break;\n            default:\n                break;\n        }\n    };\n\n    const showImportLoading = () => {\n        document.body.scrollTop = 0; // For Safari\n        document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera\n        document.getElementById('import-loading').style.display = 'block';\n        document.querySelector('body').style.overflow = 'hidden';\n    };\n\n    const onClickListeners = (event) =>{\n        var btn_multiadd = document.getElementById('btn-saveadd');\n        var btn_multisave = document.getElementById('btn-multisave');\n        var btn_cancelmultisave = document.getElementById('btn-cancelmulti');\n        var btn_release = document.getElementById('btn-release');\n        var btn_import = document.getElementById('btn-import');\n        var btn_identities = document.getElementById('btn-identities');\n        var btn_coursegradeform = document.getElementById('btn-coursegradeform');\n        var btn_download = document.getElementById('btn-download');\n        var btn_finalrelease = document.getElementById('btn-finalrelease');\n        var btn_switch_display = document.getElementById('btn-switch-display');\n        var btn_bulk_import = document.getElementById('btn-blkimport');\n        var radio_ptprc = document.getElementsByName('percentpoints');\n        var btn_altsave = document.querySelector('[name=\"savealtbutton\"]');\n        var btn_upload_submit = document.getElementsByName('submitupload');\n        switch (event.target) {\n            case btn_cancelmultisave:\n            case btn_multiadd:\n                $(\".togglemultigrd\").toggle();\n                btn_multisave.classList.toggle('hidden');\n                btn_cancelmultisave.classList.toggle('hidden');\n                break;\n            case btn_multisave:\n                if(document.querySelectorAll('input.is-invalid').length == 0){\n                    document.getElementById('multiadd-submit').click();\n                }\n                break;\n            case btn_release:\n                showModal('release', 'modalreleaseprovisionalgrade', 'confirmreleaseprovisionalgrade');\n                break;\n            case btn_import:\n                if(!$(\".gradeitems\").text().includes(\"Moodle Grade[Date]\")){\n                    showModal('importgrades', 'modalimportgrades', 'confirmimport');\n                }else{\n                    showImportLoading();\n                    document.getElementById('importgrades-submit').click();\n                }\n                break;\n            case btn_coursegradeform:\n                var inputarr = document.querySelectorAll('.input-percent');\n                var total = 0;\n                if(inputarr.length > 0){\n                    inputarr.forEach(div => {\n                        var input = div.querySelector('input');\n                        total += parseInt(input.value);\n                        var invalid = div.querySelector('input.is-invalid');\n                        if(invalid !== null){\n                            div.querySelector('[data-fieldtype=\"text\"]').classList.add('no-after');\n                        }else{\n                            div.querySelector('[data-fieldtype=\"text\"]').classList.remove('no-after');\n                        }\n                    });\n                }\n                var notes = document.querySelector('textarea#id_notes');\n                var errorNotes = document.getElementById('id_error_notes');\n                if(notes.value == ''){\n                    errorNotes.innerHTML = '- You must supply a value here.';\n                    errorNotes.style.display = 'block';\n                }else{\n                    errorNotes.innerHTML = '';\n                    errorNotes.style.display = 'none';\n                    if(total != 100){\n                        showModal('adjustweight', 'modaladjustweights', 'confirmchanges');\n                    }else{\n                        document.getElementById('coursegradeform-submit').click();\n                    }\n                }\n                break;\n            case btn_finalrelease:\n                showModal('finalrelease', 'modalreleasefinalgrades', 'confirmfinalrelease');\n                break;\n            case btn_download:\n                document.getElementById('downloadcsv-submit').click();\n                break;\n            case btn_identities:\n                var is_blindmarking = (Storage.get(BLIND_MARKING_KEY) == 'true');\n                Storage.set(BLIND_MARKING_KEY, !is_blindmarking);\n                check_blind_marking();\n                break;\n            case btn_switch_display:\n                toggle_display_assessments();\n                break;\n            case btn_bulk_import:\n                if(!$(\".gradeitems\").text().includes(\"Moodle Grade[Date]\")){\n                    showModal('bulkimportgrades', 'modalimportgrades', 'confirmimport');\n                }else{\n                    showImportLoading();\n                    document.getElementById('bulk-submit').click();\n                }\n                break;\n            case radio_ptprc[0]:\n            case radio_ptprc[1]:\n                clearConversionTable();\n                break;\n\n            case btn_altsave:\n                var alttype = document.getElementById('select-alt-grade');\n                if(alttype.value == 1){\n                    var inputarr = document.querySelectorAll('.input-percent');\n                    var total = 0;\n                    if(inputarr.length > 0){\n                        inputarr.forEach(div => {\n                            var input = div.querySelector('input');\n                            total += parseInt(input.value);\n                            let invalid = div.querySelector('input.is-invalid');\n                            if(invalid !== null){\n                                div.querySelector('input').classList.add('is-invalid');\n                                div.querySelector('[data-fieldtype=\"text\"]').classList.add('no-after');\n                            }else{\n                                div.querySelector('input').classList.remove('is-invalid');\n                                div.querySelector('[data-fieldtype=\"text\"]').classList.remove('no-after');\n                            }\n                        });\n                    }\n                    var invalid = document.querySelectorAll('input.is-invalid');\n                    if(invalid.length == 0){\n                        if(total != 100){\n                            showModal('hiddensubmit', 'modalmeritweights', 'confirmchanges');\n                        }else{\n\n                            document.querySelector('[name=\"hiddensubmitform\"]').click();\n                        }\n                    }\n                }else{\n                    document.querySelector('[name=\"hiddensubmitform\"]').click();\n                }\n                break;\n            case btn_upload_submit[0]:\n                var selectReason = document.querySelector('select#id_reasons');\n                var otherReason = document.querySelector('input#id_otherreason');\n                if(selectReason.value != '0' && selectReason.value != '9'){\n                    showImportLoading();\n                }else if(selectReason.value == '9' && otherReason.value){\n                    showImportLoading();\n                }\n                break;\n            default:\n                break;\n        }\n    };\n\n    return {\n        init: function() {\n            const GCAT = document.querySelector('.gcat-container');\n            if(GCAT){\n                GCAT.addEventListener('change', onChangeListeners);\n                GCAT.addEventListener('click', onClickListeners);\n\n                //if hide identities button is visible, add key in storage\n                if(document.getElementById('btn-identities') && !Storage.get(BLIND_MARKING_KEY)){\n                    Storage.set(BLIND_MARKING_KEY, false);\n                }\n                check_blind_marking();\n                toggle_child_activities();\n\n                var input_reason = document.querySelector('.togglemultigrd > input');\n                if(input_reason){\n                    input_reason.addEventListener('input', (e) => {\n                        update_reason_inputs(e.target.value);\n                    });\n                }\n\n                var select_scale = document.getElementById('select-scale');\n                if(select_scale){\n                    if(select_scale.value != 1){\n                        toggleScaleTable();\n                    }\n                }\n\n                var input_search = document.querySelectorAll('.input-search');\n                if(input_search.length > 0){\n                    input_search.forEach(input => {\n                        input.addEventListener('keydown', (e) => {\n                            var key = e.keyCode ? e.keyCode : e.which;\n                            if(key === 13){\n                                document.getElementById('search-submit').click();\n                            }\n                        });\n                    });\n                }\n\n                var input_percentage_points = document.querySelectorAll('.input-prc,.input-pt');\n                if(input_percentage_points.length > 0){\n                    input_percentage_points.forEach(input => {\n                        var field = input.querySelector('input');\n                        if(field.value){\n                            calculatePercentagePoints(field, input.classList.contains('input-prc'));\n                        }\n                        input.addEventListener('change', (e) =>{\n                            calculatePercentagePoints(e.target, input.classList.contains('input-prc'));\n                        });\n                    });\n                }\n\n                var input_gradept = document.querySelectorAll('.input-gradept');\n                if(input_gradept.length > 0){\n                    input_gradept.forEach(input => {\n                        input.addEventListener('input', (e) => {\n                            var val = e.target.value;\n                            var grademax = e.target.getAttribute('data-grademax');\n                            if(val && !(/^([mM][vV]|[0-9]|[nN][sS])+$/).test(val)){\n                                input.classList.add('is-invalid');\n                            }else{\n                                if(Number.isInteger(parseInt(val)) && parseInt(val) > parseInt(grademax)){\n                                    input.classList.add('is-invalid');\n                                }else{\n                                    input.classList.remove('is-invalid');\n                                }\n                            }\n                        });\n                    });\n                }\n\n                var input_percentarr = document.querySelectorAll('.input-percent');\n                var totalweight = document.querySelector('.total-weight')\n                    ? document.querySelector('.total-weight')\n                    : document.querySelector('#fitem_id_totalweight .form-inline');\n                if(input_percentarr.length > 0 && totalweight){\n                    var total = 0;\n                    input_percentarr.forEach(div => {\n                        var input = div.querySelector('input');\n                        total += parseInt(input.value);\n                        input.addEventListener('input', () => {\n                            let total = 0;\n                            input_percentarr.forEach(div => {total += parseInt(div.querySelector('input').value);});\n                            totalweight.innerHTML = `${total}%`;\n                        });\n                        input.addEventListener('focus', (e) => {\n                            var val = e.target.value;\n                            if(val !== \"\" && val.match(/^[0-9]+$/) === null){\n                                div.querySelector('[data-fieldtype=\"text\"]').classList.add('no-after');\n                                div.querySelector('input').classList.add('is-invalid');\n                            }else{\n                                div.querySelector('[data-fieldtype=\"text\"]').classList.remove('no-after');\n                                div.querySelector('input').classList.remove('is-invalid');\n                            }\n                        });\n                        input.addEventListener('blur', (e) => {\n                            var val = e.target.value;\n                            if(val !== \"\" && val.match(/^[0-9]+$/) === null){\n                                div.querySelector('[data-fieldtype=\"text\"]').classList.add('no-after');\n                                div.querySelector('input').classList.add('is-invalid');\n                            }else{\n                                div.querySelector('[data-fieldtype=\"text\"]').classList.remove('no-after');\n                                div.querySelector('input').classList.remove('is-invalid');\n                            }\n                        });\n                    });\n                    totalweight.innerHTML = `${total}%`;\n                }\n\n                var input_templatename = document.querySelector('.template-name input');\n                if(input_templatename){\n                    input_templatename.addEventListener('input', (e) => {\n                        update_reason_inputs(e.target.value);\n                    });\n                }\n\n                var columns = document.querySelectorAll('.sortable');\n                if(columns.length > 0){\n                    for (const [id, column] of columns.entries()) {\n                        column.addEventListener('keyup', (e) => {\n                            if (e.keyCode === 13) {\n                                e.preventDefault();\n                                column.click();\n                            }\n                        });\n                        column.addEventListener('click', () => sortTable(id));\n                    }\n                }\n\n                var searchIcons = document.querySelectorAll('.fa-search');\n                if(searchIcons.length > 0){\n                    searchIcons.forEach(icon => {\n                        icon.addEventListener('keyup', (e) => {\n                            if (e.keyCode === 13) {\n                                e.preventDefault();\n                                icon.click();\n                            }\n                        });\n                        icon.addEventListener('click', (e) => {\n                            e.currentTarget.blur();\n                            var input = e.target.nextSibling;\n                            input.classList.toggle('visible');\n                            if(input.classList.contains('visible')){\n                                input.style.display = 'block';\n                            } else {\n                                input.style.display = 'none';\n                            }\n                        });\n                    });\n                }\n\n                //Show 'grade discrepancy' when grade discrepancy exist\n                var grdDiscExist = document.querySelectorAll('td .grade-discrepancy');\n                if (grdDiscExist.length > 0) {\n                    document.getElementById('btn-grddisc').style.display = 'inline-block';\n                }\n\n                //Reset to 0 if merit checkbox is unchecked\n                var meritCheckboxes = document.querySelectorAll('input.checkbox-field');\n                if (meritCheckboxes.length > 0) {\n                meritCheckboxes.forEach(cb => {\n                    cb.addEventListener('change', (e) => {\n                        if(!e.currentTarget.checked){\n                            var id =  e.target.getAttribute('data-itemid');\n                            var input_percent = document.querySelector(`.input-percent input[name=\"weights[${id}]\"]`);\n                            input_percent.value = 0;\n                        }\n                    });\n                });\n                }\n\n                // Hide elements different pages\n                if(checkCurrentUrl(\"gugcat/overview\")){\n                    document.querySelector('#btn-overviewtab').classList.add('active');\n                    document.querySelector('#btn-assessmenttab').classList.remove('active');\n                }else if(checkCurrentUrl(\"gugcat/index\")){\n                    document.getElementById('btn-release').style.display =\n                    !$(\".gradeitems\").text().includes(\"Moodle Grade[Date]\") ? 'inline-block' : 'none';\n                    var nodeArr = Array.from(document.querySelectorAll('.gradeitems'));\n                    if(nodeArr.find(node => node.innerHTML !== 'Moodle Grade<br>[Date]')){\n                        document.getElementById('btn-saveadd').style.display = 'inline-block';\n                        var btnnewgrade = document.querySelectorAll('.addnewgrade');\n                        btnnewgrade.forEach(e => {\n                            e.style.display = 'block';\n                        });\n\n                        var hideshowgrade = document.querySelectorAll('.hide-show-grade');\n                        hideshowgrade.forEach(element => {\n                            element.style.display = 'block';\n                        });\n                    }\n                }else if(checkCurrentUrl(\"gugcat/import\")){\n                    var btn_upload = document.getElementsByName('submitupload');\n                    if(btn_upload[0]){\n                        var disabledStyle = \"opacity: 0.8; cursor: default; pointer-events: none;\";\n                        document.getElementById('select-category').disabled = true;\n                        document.getElementById('select-category').style.cursor = 'default';\n                        document.getElementById('btn-overviewtab').style.cssText = disabledStyle;\n                        document.getElementById('btn-assessmenttab').style.cssText = disabledStyle;\n                        document.getElementById('gcat-cog').style.cssText = disabledStyle;\n                    }\n                }\n            }\n        }\n    };\n});\n"],"file":"main.min.js"}