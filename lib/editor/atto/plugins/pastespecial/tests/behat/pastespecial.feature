@wip @editor @editor_atto @atto @atto_pastespecial
Feature: Atto Pastespecial
  To paste formatted text in Atto, I need to utilize Pastespecial

  Background:
    Given the following config values are set as admin:
     | config | value | plugin |
     | toolbar | style = pastespecial,html | editor_atto |
     | straight | 1 | atto_pastespecial |
    And I log in as "admin"
    And I follow "Profile" in the user menu
    And I follow "Blog entries"
    And I follow "Add a new entry"
    And I set the field "Entry title" to "How to paste"
    And I click on "Paste special" "button"

  @javascript
  Scenario: Paste from Microsoft Word on Windows
    When I set the innerhtml of "atto_pastespecial_iframe" to "<p class=\"MsoDate\"><span lang=\"DE\">18.11.2015<o:p></o:p></span></p><p class=\"Recipient\"><span lang=\"DE\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>Geschäftsführerin<o:p></o:p></span></p><p class=\"Recipient\"><span lang=\"DE\">Firma ABC<br>Musterstraße 5<br>11111 Musterstadt<o:p></o:p></span></p><p class=\"MsoSalutation\"><span lang=\"DE\">Sehr geehrte Frau Mast,<o:p></o:p></span></p><w:sdt docpart=\"2BDAB6B996EDA24AB5792F9FBD410C55\" id=\"23717172\"> <p class=\"MsoNormal\" id=\"yui_3_17_2_1_1448308578641_1106\"><span lang=\"DE\" style=\"mso-bidi-font-size:11.0pt;line-height: 115%\">lorem ipsum bla bla bla.</span><span lang=\"DE\"><o:p></o:p></span><span lang=\"DE\" style=\"mso-bidi-font-size:11.0pt;line-height:115%\"><w:sdtpr></w:sdtpr></span></p></w:sdt><p class=\"MsoSignature\"><span lang=\"DE\">Mit freundlichen Grüßen<o:p></o:p></span></p><p class=\"MsoSignature\"><!--[if supportFields]><span lang=DE><spanstyle=\"mso-element:field-begin\"></span>PLACEHOLDER<span style=\"mso-element:field-begin\"></span>IF<span style=\"mso-element:field-begin\"></span>USERNAME<spanstyle=\"mso-element:field-separator\"></span><span style=\"mso-no-proof:yes\">KathrinOsswald<span style=\"mso-element:field-end\"></span></span>=&quot;&quot;&quot;[Ihr Name]&quot;<span style=\"mso-element:field-begin\"></span>USERNAME<spanstyle=\"mso-element:field-separator\"></span><span style=\"mso-no-proof:yes\">KathrinOsswald<span style=\"mso-element:field-end\"></span></span><spanstyle=\"mso-element:field-separator\"></span><span style=\"mso-no-proof:yes\">KathrinOsswald</span><span style=\"mso-element:field-end\"></span>\* MERGEFORMAT<spanstyle=\"mso-element:field-separator\"></span></span><![endif]--><span lang=\"DE\">KathrinOsswald</span><!--[if supportFields]><span lang=DE><span style=\"mso-element:field-end\"></span></span><![endif]--><span lang=\"DE\"><br>Geschäftsführerin<o:p></o:p></span></p><p class=\"MsoNormal\"><span lang=\"DE\">&nbsp;</span></p>"
    And I click on "Paste from Microsoft Word" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "Firma ABC"

  @javascript
  Scenario: Paste from Google Doc on Windows
    When I set the innerhtml of "atto_pastespecial_iframe" to "<span id=\"docs-internal-guid-9c6f5d75-311a-fc1c-0df8-a2683a3c87d6\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Or</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"> only </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: rgb(0, 255, 255);\">when </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: rgb(0, 255, 255);\">redcolor</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"> I do this?</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Fire</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">fox</span></p><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Sample text with </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">bold </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">text</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">All bold text</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-style: italic; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">And some italics</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">And underlined</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">ALL THREE</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">STRIKE ME</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">And some </span><span style=\"font-size: 8.8px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: sub; white-space: pre-wrap; background-color: transparent;\">subs </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">and </span><span style=\"font-size: 8.8px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: super; white-space: pre-wrap; background-color: transparent;\">supers</span></p><br><ol style=\"margin-top:0pt;margin-bottom:0pt;\"><li dir=\"ltr\" style=\"list-style-type: decimal; font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); font-weight: 700; vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">First item</span></p></li><li dir=\"ltr\" style=\"list-style-type: decimal; font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); font-style: italic; vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Second item</span></p></li><li dir=\"ltr\" style=\"list-style-type: decimal; font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Third</span></p></li></ol><ul style=\"margin-top:0pt;margin-bottom:0pt;\"><li dir=\"ltr\" style=\"list-style-type: disc; font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); text-decoration: line-through; vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Some bullets</span></p></li><li dir=\"ltr\" style=\"list-style-type: disc; font-size: 24px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Another bullet</span></p></li></ul></span>"
    And I click on "Paste from Google Document" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "Or only when redcolor I do this?"

  @javascript
  Scenario: Paste from LibreOffice
    When I set the innerhtml of "atto_pastespecial_iframe" to "<p style=\"margin-bottom: 0.14in; line-height: 115%\">There is texthere</p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><font face=\"Andalus, serif\">Iplay with family</font></p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><font style=\"font-size: 24pt\">Andsize</font></p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><font face=\"Arial Unicode MS, serif\"><font style=\"font-size: 22pt\">Andboth</font></font></p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><b>And bold</b></p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><i>Italics</i></p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><u>Underlined</u></p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><strike><i><u><b>Allof the above?</b></u></i></strike></p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><font color=\"#ff0000\"><strike><i><u><b>We</b></u></i></strike></font><font color=\"#ff0000\"><strike><sup><i><u><b>ge</b></u></i></sup></strike></font><font color=\"#ff0000\"><strike><i><u><b>tc</b></u></i></strike></font><font color=\"#ff0000\"><strike><sub><i><u><b>razy</b></u></i></sub></strike></font></p><p style=\"margin-bottom: 0.14in; line-height: 115%\">I <font color=\"#ff0000\">hatethis f</font><font color=\"#ff0000\"><font face=\"Arial Rounded MT Bold, serif\">or</font></font><font color=\"#ff0000\"><font face=\"Arial Rounded MT Bold, serif\">m</font></font><font face=\"Arial Rounded MT Bold, serif\">a</font>t<font style=\"font-size: 12pt\">ti</font><font style=\"font-size: 12pt\">n</font>g</p><p style=\"margin-bottom: 0.14in; line-height: 115%\"><br><br></p><ol id=\"yui_3_17_2_1_1452631724877_1099\"> <li><p style=\"margin-bottom: 0.14in; line-height: 115%\"><b>First  item</b></p>    </li><li id=\"yui_3_17_2_1_1452631724877_1098\"><p style=\"margin-bottom: 0.14in; line-height: 115%\" id=\"yui_3_17_2_1_1452631724877_1097\"><i>Second  item</i></p>    </li><li><p style=\"margin-bottom: 0.14in; line-height: 115%\"><a name=\"_GoBack\"></a> <u>Third</u></p></li></ol><ul>  <li><p style=\"margin-bottom: 0.14in; line-height: 115%\"><strike>Some  bullets</strike></p>    </li><li><p style=\"margin-bottom: 0.14in; line-height: 115%\"><font style=\"font-size: 16pt\">Another  bullet</font></p></li></ul>"
    And I click on "Paste from Google Document" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "There is texthere"

  @javascript
  Scenario: Paste from Microsoft Word on Mac
    When I set the innerhtml of "atto_pastespecial_iframe" to "<!--[if !mso]><style>v\:* {behavior:url(#default#VML);}o\:* {behavior:url(#default#VML);}w\:* {behavior:url(#default#VML);}.shape {behavior:url(#default#VML);}</style><![endif]--><!--[if gte mso 9]><xml> <o:OfficeDocumentSettings>  <o:AllowPNG/> </o:OfficeDocumentSettings></xml><![endif]--><!--[if gte mso 9]><xml> <w:WordDocument>  <w:View>Normal</w:View>  <w:Zoom>0</w:Zoom>  <w:TrackMoves>false</w:TrackMoves>  <w:TrackFormatting/>  <w:PunctuationKerning/>  <w:ValidateAgainstSchemas/>  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>  <w:DoNotPromoteQF/>  <w:LidThemeOther>EN-US</w:LidThemeOther>  <w:LidThemeAsian>JA</w:LidThemeAsian>  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>  <w:Compatibility>   <w:BreakWrappedTables/>   <w:SnapToGridInCell/>   <w:WrapTextWithPunct/>   <w:UseAsianBreakRules/>   <w:DontGrowAutofit/>   <w:SplitPgBreakAndParaMark/>   <w:EnableOpenTypeKerning/>   <w:DontFlipMirrorIndents/>   <w:OverrideTableStyleHps/>   <w:UseFELayout/>  </w:Compatibility>   </w:LatentStyles></xml><![endif]--><!--[if gte mso 10]><style> /* Style Definitions */table.MsoNormalTable    {mso-style-name:\"Table Normal\";   mso-tstyle-rowband-size:0;  mso-tstyle-colband-size:0;  mso-style-noshow:yes;   mso-style-priority:99;  mso-style-parent:\"\";  mso-padding-alt:0in 5.4pt 0in 5.4pt;    mso-para-margin-top:0in;    mso-para-margin-right:0in;  mso-para-margin-bottom:10.0pt;  mso-para-margin-left:0in;   line-height:115%;   mso-pagination:widow-orphan;    font-size:10.0pt;   font-family:Calibri;    mso-ascii-font-family:Calibri;  mso-ascii-theme-font:minor-latin;   mso-hansi-font-family:Calibri;  mso-hansi-theme-font:minor-latin;   mso-ansi-language:DE;   mso-fareast-language:DE;}</style><![endif]--><!--StartFragment--><p class=\"MsoDate\"><span lang=\"DE\">18.11.2015<o:p></o:p></span></p><p class=\"Recipient\"><span lang=\"DE\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>Geschäftsführerin<o:p></o:p></span></p><p class=\"Recipient\"><span lang=\"DE\">Firma ABC<br>Musterstraße 5<br>11111 Musterstadt<o:p></o:p></span></p><p class=\"MsoSalutation\"><span lang=\"DE\">Sehr geehrte Frau Mast,<o:p></o:p></span></p><w:sdt docpart=\"2BDAB6B996EDA24AB5792F9FBD410C55\" id=\"23717172\"> <p class=\"MsoNormal\" id=\"yui_3_17_2_1_1448308578641_1106\"><span lang=\"DE\" style=\"mso-bidi-font-size:11.0pt;line-height: 115%\">lorem ipsum bla bla bla.</span><span lang=\"DE\"><o:p></o:p></span><span lang=\"DE\" style=\"mso-bidi-font-size:11.0pt;line-height:115%\"><w:sdtpr></w:sdtpr></span></p></w:sdt><p class=\"MsoSignature\"><span lang=\"DE\">Mit freundlichen Grüßen<o:p></o:p></span></p><p class=\"MsoSignature\"><!--[if supportFields]><span lang=DE><spanstyle=\"mso-element:field-begin\"></span>PLACEHOLDER<span style=\"mso-element:field-begin\"></span>IF<span style=\"mso-element:field-begin\"></span>USERNAME<spanstyle=\"mso-element:field-separator\"></span><span style=\"mso-no-proof:yes\">KathrinOsswald<span style=\"mso-element:field-end\"></span></span>=&quot;&quot;&quot;[Ihr Name]&quot;<span style=\"mso-element:field-begin\"></span>USERNAME<spanstyle=\"mso-element:field-separator\"></span><span style=\"mso-no-proof:yes\">KathrinOsswald<span style=\"mso-element:field-end\"></span></span><spanstyle=\"mso-element:field-separator\"></span><span style=\"mso-no-proof:yes\">KathrinOsswald</span><span style=\"mso-element:field-end\"></span>\* MERGEFORMAT<spanstyle=\"mso-element:field-separator\"></span></span><![endif]--><span lang=\"DE\">KathrinOsswald</span><!--[if supportFields]><span lang=DE><span style=\"mso-element:field-end\"></span></span><![endif]--><span lang=\"DE\"><br>Geschäftsführerin<o:p></o:p></span></p><p class=\"MsoNormal\"><span lang=\"DE\">&nbsp;</span></p><!--EndFragment-->"
    And I click on "Paste from Microsoft Word" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "Firma ABC"

  @javascript
  Scenario: Paste from Google Doc on Mac
    When I set the innerhtml of "atto_pastespecial_iframe" to "<!--[if !mso]><style>v\:* {behavior:url(#default#VML);}o\:* {behavior:url(#default#VML);}w\:* {behavior:url(#default#VML);}.shape {behavior:url(#default#VML);}</style><![endif]--><!--[if gte mso 9]><xml> <o:OfficeDocumentSettings>  <o:AllowPNG/> </o:OfficeDocumentSettings></xml><![endif]--><!--[if gte mso 9]><xml> <w:WordDocument>  <w:View>Normal</w:View>  <w:Zoom>0</w:Zoom>  <w:TrackMoves>false</w:TrackMoves>  <w:TrackFormatting/>  <w:PunctuationKerning/>  <w:ValidateAgainstSchemas/>  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>  <w:DoNotPromoteQF/>  <w:LidThemeOther>EN-US</w:LidThemeOther>  <w:LidThemeAsian>JA</w:LidThemeAsian>  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>  <w:Compatibility>   <w:BreakWrappedTables/>   <w:SnapToGridInCell/>   <w:WrapTextWithPunct/>   <w:UseAsianBreakRules/>   <w:DontGrowAutofit/>   <w:SplitPgBreakAndParaMark/>   <w:EnableOpenTypeKerning/>   <w:DontFlipMirrorIndents/>   <w:OverrideTableStyleHps/>   <w:UseFELayout/>  </w:Compatibility>   </w:LatentStyles></xml><![endif]--><!--[if gte mso 10]><style> /* Style Definitions */table.MsoNormalTable    {mso-style-name:\"Table Normal\";   mso-tstyle-rowband-size:0;  mso-tstyle-colband-size:0;  mso-style-noshow:yes;   mso-style-priority:99;  mso-style-parent:\"\";  mso-padding-alt:0in 5.4pt 0in 5.4pt;    mso-para-margin-top:0in;    mso-para-margin-right:0in;  mso-para-margin-bottom:10.0pt;  mso-para-margin-left:0in;   line-height:115%;   mso-pagination:widow-orphan;    font-size:10.0pt;   font-family:Calibri;    mso-ascii-font-family:Calibri;  mso-ascii-theme-font:minor-latin;   mso-hansi-font-family:Calibri;  mso-hansi-theme-font:minor-latin;   mso-ansi-language:DE;   mso-fareast-language:DE;}</style><![endif]--><!--StartFragment--><span id=\"docs-internal-guid-a763265d-3784-99f6-df01-4360bb709af4\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Or</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"> only </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: rgb(0, 255, 255);\">when </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: rgb(0, 255, 255);\">redcolor</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"> I do this?</span></p></span><!--EndFragment-->"
    And I click on "Paste from Google Document" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "Or only when redcolor I do this?"

  @javascript
  Scenario: Paste as unformatted text on Windows
    When I set the innerhtml of "atto_pastespecial_iframe" to "<span id=\"docs-internal-guid-9c6f5d75-311a-fc1c-0df8-a2683a3c87d6\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Or</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"> only </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: rgb(0, 255, 255);\">when </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: rgb(0, 255, 255);\">redcolor</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"> I do this?</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Fire</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">fox</span></p><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Sample text with </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">bold </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">text</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">All bold text</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-style: italic; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">And some italics</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">And underlined</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">ALL THREE</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">STRIKE ME</span></p><br><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">And some </span><span style=\"font-size: 8.8px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: sub; white-space: pre-wrap; background-color: transparent;\">subs </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">and </span><span style=\"font-size: 8.8px; font-family: Arial; color: rgb(255, 0, 0); font-weight: 700; font-style: italic; text-decoration: underline line-through; vertical-align: super; white-space: pre-wrap; background-color: transparent;\">supers</span></p><br><ol style=\"margin-top:0pt;margin-bottom:0pt;\"><li dir=\"ltr\" style=\"list-style-type: decimal; font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); font-weight: 700; vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">First item</span></p></li><li dir=\"ltr\" style=\"list-style-type: decimal; font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); font-style: italic; vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Second item</span></p></li><li dir=\"ltr\" style=\"list-style-type: decimal; font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Third</span></p></li></ol><ul style=\"margin-top:0pt;margin-bottom:0pt;\"><li dir=\"ltr\" style=\"list-style-type: disc; font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); text-decoration: line-through; vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Some bullets</span></p></li><li dir=\"ltr\" style=\"list-style-type: disc; font-size: 24px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; background-color: transparent;\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Another bullet</span></p></li></ul></span>"
    And I click on "Paste as unformatted text" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "Or only when redcolor I do this?"

  @javascript
  Scenario: Paste as unformatted text on Mac
    When I set the innerhtml of "atto_pastespecial_iframe" to "<!--[if !mso]><style>v\:* {behavior:url(#default#VML);}o\:* {behavior:url(#default#VML);}w\:* {behavior:url(#default#VML);}.shape {behavior:url(#default#VML);}</style><![endif]--><!--[if gte mso 9]><xml> <o:OfficeDocumentSettings>  <o:AllowPNG/> </o:OfficeDocumentSettings></xml><![endif]--><!--[if gte mso 9]><xml> <w:WordDocument>  <w:View>Normal</w:View>  <w:Zoom>0</w:Zoom>  <w:TrackMoves>false</w:TrackMoves>  <w:TrackFormatting/>  <w:PunctuationKerning/>  <w:ValidateAgainstSchemas/>  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>  <w:DoNotPromoteQF/>  <w:LidThemeOther>EN-US</w:LidThemeOther>  <w:LidThemeAsian>JA</w:LidThemeAsian>  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>  <w:Compatibility>   <w:BreakWrappedTables/>   <w:SnapToGridInCell/>   <w:WrapTextWithPunct/>   <w:UseAsianBreakRules/>   <w:DontGrowAutofit/>   <w:SplitPgBreakAndParaMark/>   <w:EnableOpenTypeKerning/>   <w:DontFlipMirrorIndents/>   <w:OverrideTableStyleHps/>   <w:UseFELayout/>  </w:Compatibility>   </w:LatentStyles></xml><![endif]--><!--[if gte mso 10]><style> /* Style Definitions */table.MsoNormalTable    {mso-style-name:\"Table Normal\";   mso-tstyle-rowband-size:0;  mso-tstyle-colband-size:0;  mso-style-noshow:yes;   mso-style-priority:99;  mso-style-parent:\"\";  mso-padding-alt:0in 5.4pt 0in 5.4pt;    mso-para-margin-top:0in;    mso-para-margin-right:0in;  mso-para-margin-bottom:10.0pt;  mso-para-margin-left:0in;   line-height:115%;   mso-pagination:widow-orphan;    font-size:10.0pt;   font-family:Calibri;    mso-ascii-font-family:Calibri;  mso-ascii-theme-font:minor-latin;   mso-hansi-font-family:Calibri;  mso-hansi-theme-font:minor-latin;   mso-ansi-language:DE;   mso-fareast-language:DE;}</style><![endif]--><!--StartFragment--><span id=\"docs-internal-guid-a763265d-3784-99f6-df01-4360bb709af4\"><p dir=\"ltr\" style=\"line-height:1.38;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\">Or</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"> only </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: rgb(0, 255, 255);\">when </span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(255, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: rgb(0, 255, 255);\">redcolor</span><span style=\"font-size: 14.6667px; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"> I do this?</span></p></span><!--EndFragment-->"
    And I click on "Paste as unformatted text" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "Or only when redcolor I do this?"

   @javascript
   Scenario: Paste table and content into formatting
    When I set the innerhtml of "atto_pastespecial_iframe" to "<p>Look at me</p><table id=\"table\"><tr><td>Cell</td></tr></table><p>Also here</p>"
    And I click on "Paste as unformatted text" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "Look at me"
    And I should see "Also here"
    And "table" "css_element" should exist

   @javascript
   Scenario: Paste without formatting text
    When I set the innerhtml of "atto_pastespecial_iframe" to "<p id='skynet'>There is no need for concern</p>"
    And I click on "Paste from Moodle" "radio"
    And I click on "form.atto_form .submit" "css_element"
    And I press "Save changes"
    Then I should see "There is no need for concern"
    And "#skynet" "css_element" should exist
