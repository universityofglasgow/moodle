/**
 * Main Javascript module for format_tiles for when user *IS* editing.
 * See course.js for if they are not editing.
 * Handles the UI changes when tiles are selected and anything else not
 * covered by the specific modules
 *
 * @module format_tiles/edit_course
 * @copyright 2019 David Watson {@link http://evolutioncode.uk}
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @since Moodle 3.3
 */
define("format_tiles/edit_course",["jquery","core/config","core/str","core/ajax","format_tiles/edit_browser_storage"],(function($,config,str,ajax,browserStorageEdit){var courseId,Selector_ACTIVITY="li.activity",Selector_SECTION_ID="#section-",Selector_TILE_BAR_TEXT=".tile_bar_text",Selector_SECTION="ul.section",Selector_SECTION_MAIN="li.section.main",Selector_SECTIONACTIONMENU=".section_action_menu",Selector_MENU_ACTION=".menu-action",Keyboard_RETURN=13,Event_KEYDOWN="keydown",DataAttributes_SECTION="data-section";return{init:function(courseIdInit,useJavascriptNav,isMobile,sectionNum,useFilterButtons,assumeDataStoreConsent,reopenLastSection,userId,fitTilesToWidth,enablecompletion,pageType,allowPhotoTiles,useSubTiles,documentationurl){courseId=courseIdInit,assumeDataStoreConsent="1"===assumeDataStoreConsent,require(["format_tiles/edit_icon_picker"],(function(iconPicker){iconPicker.init(courseId,pageType,allowPhotoTiles,documentationurl)})),useSubTiles&&require(["format_tiles/edit_course_mod"],(function(editCourseMod){editCourseMod.init(courseId)})),$(document).ready((function(){if($(Selector_TILE_BAR_TEXT).on(Event_KEYDOWN,(function(e){e.keyCode!==Keyboard_RETURN||$(e.target).hasClass("form-control")||(window.location=config.wwwroot+"/course/view.php?id="+courseId+"&section="+$(e.currentTarget).parent().attr(DataAttributes_SECTION))})),useJavascriptNav&&!isMobile){var collapsingAllSectionFromURL=-1!==window.location.search.indexOf("expanded=-1"),finalSectionInCourse=$(Selector_SECTION_MAIN).last().attr("data-section");browserStorageEdit.init(userId,courseId,assumeDataStoreConsent,finalSectionInCourse,collapsingAllSectionFromURL)}if(!isMobile){var toolTips=$("[data-toggle=tooltip]");if(0!==toolTips.length&&"function"==typeof toolTips.tooltip)try{toolTips.tooltip()}catch(err){require(["core/log"],(function(log){log.debug(err)}))}}$("body").on("click keypress",Selector_SECTION_MAIN+" "+Selector_SECTIONACTIONMENU+"[data-true-sectionid] a[data-action]",(function(e){var target=$(e.target).closest(Selector_MENU_ACTION),sectionMain=target.closest(Selector_SECTION_MAIN);"hide"!==target.attr("data-action")&&"show"!==target.attr("data-action")||(!function(secNum){var section=$(Selector_SECTION_ID+secNum);$(Selector_SECTION_ID+secNum+"-content").animate({opacity:0},300),section.find(Selector_ACTIVITY).slideUp(500),section.find(".section-modchooser").slideUp(500),section.addClass("collapsed").removeClass("expanded"),section.find(".mod-chooser-outer").fadeOut(500),browserStorageEdit.setSectionStatus(secNum,!1)}(sectionMain.attr("data-section")),sectionMain.find(Selector_SECTION).find(Selector_ACTIVITY).slideUp(300).remove())}));var anchor=window.location.hash;if(anchor){var section=anchor.replace("#section-","",anchor),courseContent=$("#coursecontentcollapse"+section);courseContent&&!courseContent.hasClass("show")&&(courseContent.addClass("show"),$("#collapssesection"+section).removeClass("collapsed").attr("aria-expanded",!0))}}))}}}));

//# sourceMappingURL=edit_course.min.js.map