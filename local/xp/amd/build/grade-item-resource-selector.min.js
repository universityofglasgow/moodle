define ("local_xp/grade-item-resource-selector",["jquery","core/ajax","core/str","core/notification","block_xp/throttler","block_xp/resource-selector"],function(a,b,c,d,e,f){var i=null,j=[];function g(a,b){i=a;j=b}function h(a,b){f.prototype.constructor.apply(this,[a,this.filterFunction.bind(this),b]);this.resources=j;this.courseId=i;this.throttler=new e(200);this.setMinChars(0)}h.prototype=Object.create(f.prototype);h.prototype.constructor=h;h.prototype.initForCourse=function(a){if(this.courseId==a){this.displayResults(this.resources);return}this.displaySearching();this.courseId=a;this.fetchAllForCourse(a).then(function(b){if(this.courseId!=a){return}this.resources=b;this.displayResults(this.resources);g(this.courseId,this.resources)}.bind(this)).fail(function(){i=null;j=[];this.resources=[];this.displayEmptyResults()}.bind(this))};h.prototype.fetchAllForCourse=function(a){return b.call([{methodname:"local_xp_search_grade_items",args:{courseid:a,query:"*"}}])[0].then(function(a){return c.get_strings([{component:"local_xp",key:"categoryn",param:""},{component:"local_xp",key:"maxn",param:""}]).then(function(){return a.map(function(a){var b=a.categories.map(function(a){return a.name}).join(" > ");return{_isgradeitem:!0,subname:"".concat(M.util.get_string("maxn","local_xp",a.max))+"".concat(a.categories.length?" - ".concat(b):""),name:a.name,gradeitem:a}})})}).fail(function(a){d.exception(a);return[]})};h.prototype.filterFunction=function(a){a=(a||"").toLowerCase();if(!a){return this.resources}return this.resources.filter(function(b){return-1<b.name.toLowerCase().indexOf(a)})};return h});
//# sourceMappingURL=grade-item-resource-selector.min.js.map
