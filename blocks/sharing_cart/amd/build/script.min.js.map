{"version":3,"file":"script.min.js","sources":["../src/script.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  Sharing Cart\n *\n *  @package    block_sharing_cart\n *  @copyright  2017 (C) VERSION2, INC.\n *  @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\n\n/**\n * @param {string} addMethod\n */\nexport const init = function(addMethod) {\n    $(document).ready(function() {\n        let isDragging = false;\n\n        /**\n         *  Returns a localized string\n         *\n         *  @param {String} identifier\n         *  @return {String}\n         */\n        function str(identifier) {\n            return M.str.block_sharing_cart[identifier] || M.str.moodle[identifier];\n        }\n\n        /**\n         *  Get an action URL\n         *\n         *  @param {String} name   The action name\n         *  @param {Object} [args] The action parameters\n         *  @return {String}\n         */\n        function get_action_url(name, args) {\n            let url = M.cfg.wwwroot + '/blocks/sharing_cart/' + name + '.php';\n            if (args) {\n                const q = [];\n                for (let k in args) {\n                    q.push(k + '=' + encodeURIComponent(args[k]));\n                }\n                url += '?' + q.join('&');\n            }\n            return url;\n        }\n\n        /**\n         *  Shake the basket to indicate cancel/submit\n         */\n        function shake_basket() {\n            if (addMethod === 'drag_and_drop') {\n                const sharingCartBasket = document.querySelector('button.sharing_cart_basket');\n                sharingCartBasket?.classList.add('shake_basket');\n            }\n        }\n\n        /**\n         *  Remove the shake effect and basket icon\n         */\n        function remove_basket() {\n            if (addMethod === 'drag_and_drop' && !isDragging) {\n                const footer = document.getElementById('page-footer');\n                const footerIconContainer = footer.querySelector('div[data-region=\"footer-container-popover\"]');\n                const sharingCartBasket = document.querySelector('button.sharing_cart_basket');\n\n                if (sharingCartBasket) {\n                    footerIconContainer?.removeChild(sharingCartBasket);\n                    sharingCartBasket.classList.remove('shake_basket');\n                }\n            }\n        }\n\n        /**\n         * Modal called when confirming an action.\n         *\n         * @param obj\n         */\n        function confirm_modal(obj) {\n\n            // Checkbox for copying userdata confirmation.\n            if (obj.checkbox) {\n                obj.body +=\n                    '<div class=\"modal-checbox-wrapper modal-sharing_cart\">' +\n                    '<input type=\"checkbox\" id=\"modal-checkbox\" class=\"modal-checkbox\">' +\n                    '<label for=\"modal-checkbox\">' + str('modal_checkbox') + '</label>' +\n                    '</div>';\n            }\n\n\n            ModalFactory.create({\n                type: ModalFactory.types.SAVE_CANCEL,\n                title: obj.title,\n                body: obj.body,\n            }).done(function(modal) {\n                let is_submitted = false;\n                modal.setSaveButtonText(obj.save_button);\n\n                // On save save check - if checkbox is checked.\n                modal.getRoot().on(ModalEvents.save, function(e) {\n\n                    const response = {\n                        'checkbox': $(e.target).find('.modal-checkbox').is(':checked'),\n                    };\n\n                    obj.next(response);\n                    is_submitted = true;\n                });\n\n                modal.getRoot().on(ModalEvents.cancel, function() {\n                    remove_basket();\n                });\n\n                // Remove modal from html.\n                modal.getRoot().on(ModalEvents.hidden, function() {\n                    $('body').removeClass('modal-open');\n\n                    if (!is_submitted) {\n                        remove_basket();\n                    }\n                });\n\n                modal.show();\n            });\n        }\n\n        /**\n         * Get the section name from the section when\n         * it's changed with the in place editor\n         *\n         * @param $section\n         * @returns {*}\n         */\n        function in_place_edit_section_name($section) {\n            let sectionName = '';\n            const $inPlaceEditable = $section.find('h3.sectionname .inplaceeditable');\n            if ($inPlaceEditable.length) {\n                sectionName = $inPlaceEditable.data('value');\n            }\n            return sectionName;\n        }\n\n        /**\n         * @param post_data\n         * @param title_str\n         * @param body_str\n         * @param isSection\n         */\n        function on_backup_modal(post_data, title_str, body_str, isSection) {\n            (function(on_success) {\n                $.post(get_action_url('rest'), post_data,\n                    function(response) {\n                        on_success(response);\n                    }, \"text\")\n                    .fail(function(response) {\n                        show_error(response);\n                    });\n            })(function(response) {\n                const copyable = response === '1';\n                let checkbox = false;\n\n                if (copyable) {\n                    checkbox = true;\n                }\n\n                confirm_modal({\n                    'title': title_str,\n                    'body': body_str,\n                    'save_button': str('modal_confirm_backup'),\n                    'checkbox': checkbox,\n                    'next': function(data) {\n                        if (isSection === true) {\n                            backup_section(post_data.sectionid, post_data.sectionnumber, post_data.courseid, data.checkbox);\n                        } else {\n                            backup(post_data.cmid, data.checkbox);\n                        }\n\n                        shake_basket();\n                    }\n                });\n            });\n        }\n\n        /** @var {Object}  The icon configurations */\n        const icon = {\n            // Actions\n            'backup': {\n                css: 'editing_backup',\n                iconClass: 'fa fa-frown-o',\n            },\n            'movedir': {\n                css: 'editing_right',\n                iconClass: 'fa fa-arrow-right',\n            },\n            'move': {\n                css: 'editing_move_',\n                iconClass: 'fa fa-arrows-v',\n            },\n            'edit': {\n                css: 'editing_update',\n                iconClass: 'fa fa-pencil',\n            },\n            'cancel': {\n                css: 'editing_cancel',\n                iconClass: 'fa fa-ban',\n            },\n            'delete': {\n                css: 'editing_update',\n                iconClass: 'fa fa-trash',\n            },\n            'restore': {\n                css: 'editing_restore',\n                iconClass: 'fa fa-clone',\n            },\n            // Directories\n            'dir-open': {\n                iconClass: 'fa fa-folder-open-o'\n            },\n            'dir-closed': {\n                iconClass: 'fa fa-folder-o'\n            },\n        };\n\n        /** @var {Node}  The Sharing Cart block container node */\n        const $block = $('.block_sharing_cart');\n\n        /** @var {Object}  The current course */\n        const course = new function () {\n            const body = $('body');\n            this.id = body.attr('class').match(/course-(\\d+)/)[1];\n            this.is_frontpage = body.hasClass('pagelayout-frontpage');\n        }();\n\n        /**\n         *  Shows an error message with given Ajax error\n         *\n         *  @param {Object} response  The Ajax response\n         */\n        function show_error(response) {\n            try {\n                const ex = JSON.parse(response.responseText);\n                new M.core.exception({\n                    name: str('pluginname') + ' - ' + str('error'),\n                    message: ex.message\n                });\n            } catch (e) {\n                new M.core.exception({\n                    name: str('pluginname') + ' - ' + str('error'),\n                    message: response.responseText\n                });\n            }\n        }\n\n        /**\n         *  Check special layout (theme boost)\n         *\n         *  @return {Boolean}\n         */\n        function verify_layout() {\n            const menuelement = $block.find('.menubar .dropdown .dropdown-menu');\n            return (menuelement.length);\n        }\n\n        /**\n         * Set Cookie\n         * @param name\n         * @param value\n         * @param expireTimeInMillisecond\n         */\n        function setCookie(name, value, expireTimeInMillisecond) {\n            const d = new Date();\n            d.setTime(d.getTime() + expireTimeInMillisecond);\n            const expires = 'expires=' + d.toUTCString();\n            document.cookie = name + '=' + value + ';' + expires + '';\n        }\n\n        /**\n         * Get Cookie Value\n         * @param param\n         * @returns {*}\n         */\n        function getCookieValue(param) {\n            const readCookie = document.cookie.match('(^|;)\\\\s*' + param + '\\\\s*=\\\\s*([^;]+)');\n            return readCookie ? readCookie.pop() : '';\n        }\n\n        /**\n         * Create a command icon\n         *\n         *  @param {String} name  The command name, predefined in icon\n         *  @param {String} [pix] The icon pix name to override\n         */\n        function create_command(name) {\n            const iconElement = $('<i/>')\n                .attr('alt', str(name))\n                .attr('class', icon[name].iconClass);\n            // If (verify_layout()) {\n            //     iconElement.addClass('iconcustom');\n            // }\n\n            return $('<a href=\"javascript:void(0)\"/>')\n                .addClass(icon[name].css)\n                .attr('title', str(name))\n                .append(iconElement);\n        }\n\n        /**\n         * Create a spinner\n         * @param $node\n         * @returns {*|jQuery}\n         */\n        function add_spinner() {\n            const $spinner = ($('<div class=\"block_spinner\"><i class=\"fa fa-shopping-basket sharing_cart_basket shake_basket fa-2x\"></i></div>'));\n            $('section.block_sharing_cart').append($spinner);\n            return $spinner;\n        }\n\n        /**\n         *\n         * @param $node\n         * @returns {jQuery.fn.init}\n         */\n        function add_node_spinner($node) {\n            const $node_spinner = $('<i class=\"fa fa-circle-o-notch fa-spin node_spinner node_spinner-sharing_cart\"></i>');\n            $node.append($node_spinner);\n            return $node_spinner;\n        }\n\n        $(document).on('click', 'a.restore', function() {\n            add_spinner();\n        });\n\n        /**\n         *\n         *  Reload the Sharing Cart item tree\n         */\n        function reload_tree() {\n            $.post(get_action_url(\"rest\"),\n                {\n                    \"action\": \"render_tree\",\n                    \"courseid\": course.id\n                },\n                function(response) {\n                    $block.find(\".tree\").replaceWith($(response));\n                    $.init_item_tree();\n                }, \"html\")\n                .fail(function(response) {\n                    show_error(response);\n                });\n        }\n\n        /**\n         *  Backup an activity\n         *\n         *  @param {int} cmid\n         *  @param {Boolean} userdata\n         */\n        function backup(cmid, userdata) {\n            let $commands = $('#module-' + cmid + ' .actions');\n            if (!$commands.length) {\n                $commands = $('[data-owner=\"#module-' + cmid + '\"]');\n            }\n\n            const $spinner = add_spinner();\n            const $node_spinner = add_node_spinner($commands);\n\n            $.post(get_action_url(\"rest\"),\n                {\n                    \"action\": \"backup\",\n                    \"cmid\": cmid,\n                    \"userdata\": userdata,\n                    \"sesskey\": M.cfg.sesskey,\n                    \"courseid\": course.id\n                },\n                function() {\n                    reload_tree();\n                })\n                .fail(function(response) {\n                    show_error(response);\n                })\n                .always(function() {\n                    $node_spinner.hide();\n                    $spinner.hide();\n                    remove_basket();\n                });\n        }\n\n        /**\n         *  Backup an activities in a section\n         *\n         *  @param {int} sectionId\n         *  @param {int} sectionNumber\n         *  @param {int} courseId\n         *  @param {Boolean} userdata\n         */\n        function backup_section(sectionId, sectionNumber, courseId, userdata) {\n            const $commands = $('span.inplaceeditable[data-itemtype=sectionname][data-itemid=' + sectionId + ']');\n            const $section = $commands.closest(\"li.section.main\");\n            let sectionName = $section.attr('aria-label') || $section.find('.sectionname').text().trim();\n\n            if (sectionName === null) {\n                sectionName = String($('#region-main .section_action_menu[data-sectionid=\\'' + sectionId + '\\']')\n                    .parent().parent().find('h3.sectionname').text());\n            }\n\n            const inPlaceEditSectionName = in_place_edit_section_name($section);\n            sectionName = (inPlaceEditSectionName !== '') ? inPlaceEditSectionName : sectionName;\n\n            const $spinner = add_spinner();\n            const $node_spinner = add_node_spinner($commands);\n\n            $.post(get_action_url(\"rest\"),\n                {\n                    \"action\": \"backup_section\",\n                    \"sectionid\": sectionId,\n                    \"sectionnumber\": sectionNumber,\n                    \"courseid\": courseId,\n                    \"sectionname\": sectionName,\n                    \"userdata\": userdata,\n                    \"sesskey\": M.cfg.sesskey\n                },\n                function() {\n                    reload_tree();\n                })\n                .fail(function(response) {\n                    show_error(response);\n                })\n                .always(function() {\n                    $spinner.hide();\n                    $node_spinner.hide();\n                    remove_basket();\n                });\n        }\n\n\n        // /////// CLASSES /////////\n\n        /**\n         *  @class Directory states manager\n         */\n        const directories = new function () {\n            const KEY = 'block_sharing_cart-dirs';\n\n            let opens = getCookieValue(KEY).split(',').map(function (v) {\n                return parseInt(v);\n            });\n\n            function save() {\n                const expires = new Date();\n                expires.setDate(expires.getDate() + 30);\n                setCookie(KEY, opens.join(','), expires);\n            }\n\n            function open($dir, visible) {\n                const iconIndex = visible ? 'dir-open' : 'dir-closed';\n                const iconElement = icon[iconIndex].iconClass;\n                $dir.find('> div i.icon').attr('class', 'icon ' + iconElement);\n                $dir.find('> ul.list')[visible ? 'show' : 'hide']();\n            }\n\n            function toggle(e) {\n                const $dir = $(e.target).closest('li.directory');\n                const i = $dir.attr('id').match(/(\\d+)$/)[1];\n                const v = $dir.find('> ul.list').css('display') === 'none';\n\n                open($dir, v);\n                opens[i] = v ? 1 : 0;\n                save();\n            }\n\n            /**\n             *  Initialize directory states\n             */\n            this.init = function () {\n                let i = 0;\n                $block.find('li.directory').each(function (index, dir) {\n                    const $dir = $(dir);\n                    $dir.attr('id', 'block_sharing_cart-dir-' + i);\n                    if (i >= opens.length) {\n                        opens.push(0);\n                    } else if (opens[i]) {\n                        open($dir, true);\n                    }\n                    $dir.find('> div div.toggle-wrapper').css('cursor', 'pointer').on('click', function (e) {\n                        toggle(e);\n                    });\n                    i++;\n                });\n            };\n\n            /**\n             *  Reset directory states\n             */\n            this.reset = function () {\n                opens = [];\n                this.init();\n                save();\n            };\n        }();\n\n        /**\n         *  @class Targets for moving an item directory\n         */\n        const move_targets = new function () {\n            let $cancel = null,\n                targets = [];\n\n            /**\n             *  Hide move targets\n             */\n            this.hide = function () {\n                if ($cancel !== null) {\n                    const $commands = $cancel.closest('.commands');\n                    $cancel.remove();\n                    $cancel = null;\n                    $commands.closest('li.activity').css('opacity', 1.0);\n                    $commands.find('a').each(function () {\n                        $(this).show();\n                    });\n                    $.each(targets, function (index, $target) {\n                        $target.remove();\n                    });\n                    targets = [];\n                }\n            };\n\n            /**\n             *  Show move targets for a given item\n             *\n             *  @param {int} id  The item ID\n             */\n            this.show = function (item_id) {\n                this.hide();\n\n                function move(e) {\n\n                    const m = $(e.target).closest('a').attr('class').match(/move-(\\d+)-to-(\\d+)/);\n                    const item_id = m[1],\n                        area_to = m[2];\n\n                    const $spinner = add_spinner();\n                    $.post(get_action_url(\"rest\"),\n                        {\n                            \"action\": \"move\",\n                            \"item_id\": item_id,\n                            \"area_to\": area_to,\n                            \"sesskey\": M.cfg.sesskey\n                        },\n                        function () {\n                            reload_tree();\n                        })\n                        .fail(function (response) {\n                            show_error(response);\n                        })\n                        .always(function () {\n                            $spinner.hide();\n                        });\n                }\n\n                const $current = $block.find('#block_sharing_cart-item-' + item_id);\n                const $next = $current.next();\n                const $list = $current.closest('ul');\n\n                let next_id = 0;\n                if ($next.length) {\n                    next_id = $next.attr('id').match(/item-(\\d+)$/)[1];\n                }\n\n                /**\n                 *\n                 * @param item_id\n                 * @param area_to\n                 * @returns {jQuery}\n                 */\n                function create_target(item_id, area_to) {\n                    const $anchor = $('<a href=\"javascript:void(0)\"/>')\n                        .addClass('move-' + item_id + '-to-' + area_to)\n                        .attr('title', str('movehere'))\n                        .append(\n                            $('<p>' + str('clicktomove') + '</p>')\n                                .attr('alt', str('movehere'))\n                        );\n\n                    const $target = $('<li class=\"activity move-to\"/>')\n                        .append($anchor);\n                    $anchor.on('click', function (e) {\n                        move(e);\n                    });\n\n                    return $target;\n                }\n\n                $list.find('> li.activity').each(function (index, item) {\n                    const $item = $(item);\n                    const to = $item.attr('id').match(/item-(\\d+)$/)[1];\n                    if (to === item_id) {\n                        $cancel = create_command('cancel', 't/left');\n                        $cancel.on('click', function () {\n                            move_targets.hide();\n                        });\n                        const $commands = $item.find('.commands');\n                        $commands.find('a').each(function () {\n                            $(this).hide();\n                        });\n                        $commands.append($cancel);\n                        $item.css('opacity', 0.5);\n                    } else if (to !== next_id) {\n                        const $target = create_target(item_id, to);\n                        $item.before($target);\n                        targets.push($target);\n                    }\n                }, this);\n\n                if ($next) {\n                    var $target = create_target(item_id, 0);\n                    $list.append($target);\n                    targets.push($target);\n                }\n            };\n        }();\n\n        /**\n         *  @class Targets for restoring an item\n         */\n        const restore_targets = new function () {\n            this.is_directory = null;\n            let $clipboard = null,\n                targets = [];\n\n            /**\n             *\n             * @param id\n             * @param section\n             * @returns {jQuery}\n             */\n\n            function create_target(id, section) {\n                const href = get_action_url('restore', {\n                    'directory': (restore_targets.is_directory === true),\n                    'target': id,\n                    'course': course.id,\n                    'section': section,\n                    'in_section': $('#copy-section-form').data('in-section'),\n                    'sesskey': M.cfg.sesskey,\n                    'returnurl': document.URL,\n                });\n\n                let $target = $('<a/>').attr('href', href).attr('title', str('copyhere')).append(\n                    $('<img class=\"move_target\"/>').attr('alt', str('copyhere')).attr('src', M.util.image_url('dropzone_arrow', 'block_sharing_cart'))\n                );\n\n                targets.push($target);\n\n                return $target;\n            }\n\n            /**\n             *  Hide restore targets\n             */\n            this.hide = function () {\n                if ($clipboard !== null) {\n                    $clipboard.remove();\n                    $clipboard = null;\n                    $.each(targets, function (index, $target) {\n                        $target.remove();\n                    });\n                    targets = [];\n                }\n            };\n\n            /**\n             *\n             *\n             *  @param {int} id  The item ID\n             */\n            this.show = function (id) {\n                this.hide();\n\n                let $view = $(\"<span/>\");\n\n                if (this.is_directory) {\n                    $view.html(id).css('display', 'inline');\n                    $view.prepend(\n                        $(\"<i/>\").addClass(\"icon\")\n                            .attr(\"alt\", id)\n                        // .attr(\"src\", M.util.image_url(icon['dir-closed'].pix, null))\n                    );\n                } else {\n                    const $item = $block.find('#block_sharing_cart-item-' + id);\n                    $view = $($item.find('div')[0].cloneNode(true)).css('display', 'inline');\n                    $view.attr('class', $view.attr('class').replace(/mod-indent-\\d+/, ''));\n                    $view.find('.commands').remove();\n                }\n\n                const $cancel = create_command('cancel');\n\n                $cancel.on('click', this.hide);\n\n                $clipboard = $('<div class=\"clipboard\"/>');\n                $clipboard.append(str('clipboard') + \": \").append($view).append($cancel);\n\n                if (course.is_frontpage) {\n                    const $sitetopic = $('.sitetopic');\n                    const $mainmenu = $('.block_site_main_menu');\n                    if ($sitetopic) {\n                        $sitetopic.find('*').before($clipboard);\n                    } else if ($mainmenu) {\n                        $mainmenu.find('.content').before($clipboard);\n                    }\n\n                    // Mainmenu = section #0, sitetopic = section #1\n                    if ($mainmenu) {\n                        $mainmenu.find('.footer').before(create_target(id, 0));\n                    }\n                    if ($sitetopic) {\n                        $sitetopic.find('ul.section').append(create_target(id, 1));\n                    }\n                } else {\n                    const $container = $('.course-content');\n                    $container.prepend($clipboard);\n                    $container.find('li.section').each(function (index, sectionDOM) {\n                        const $section = $(sectionDOM);\n                        const section = $section.attr('id').match(/(\\d+)$/)[1];\n                        $section.find('ul.section').first().append(create_target(id, section));\n                    }, this);\n                }\n            };\n        }();\n\n        // /////// INITIALIZATION /////////\n\n        /**\n         *\n         * @returns {string|*}\n         */\n        $.get_plugin_name = function() {\n            let $blockheader = $block.find(\"h2\");\n\n            if (!$blockheader.length) {\n                $blockheader = $block.find(\"h3\");\n\n                if ($blockheader.length) {\n                    return $blockheader.html();\n                }\n            } else {\n                return $blockheader.html();\n            }\n\n            return \"\";\n        };\n\n        /**\n         *\n         * @param e\n         * @param activityName\n         * @param {int} cmId\n         */\n        $.on_backup = function(e, activityName, cmId = 0) {\n            if (cmId === 0) {\n                cmId = (function ($backup) {\n                    const $activity = $backup.closest('li.activity');\n                    if ($activity.length) {\n                        return $activity.attr('id').match(/(\\d+)$/)[1];\n                    }\n                    const $commands = $backup.closest('.commands');\n                    const dataowner = $commands.attr('data-owner');\n                    if (dataowner.length) {\n                        return dataowner.match(/(\\d+)$/)[1];\n                    }\n                    return $commands.find('a.editing_delete').attr('href').match(/delete=(\\d+)/)[1];\n                })($(e.target));\n            }\n\n            const data =\n                {\n                    \"action\": \"is_userdata_copyable\",\n                    \"cmid\": cmId\n                };\n\n            on_backup_modal(data, activityName, str('confirm_backup'), false);\n        };\n\n        /**\n         *  On movedir command clicked\n         *\n         *  @param {DOMEventFacade} e\n         */\n        $.on_movedir = function(e) {\n            const $commands = $(e.target).closest('.commands');\n\n            const $current_dir = $commands.closest('li.directory');\n            const current_path = $current_dir.length ? $current_dir.attr('directory-path') : '/';\n\n            const item_id = $(e.target).closest('li.activity').attr('id').match(/(\\d+)$/)[1];\n\n            const dirs = [];\n            $block.find('li.directory').each(function() {\n                dirs.push($(this).attr('directory-path'));\n            });\n\n            const $form = $('<form/>');\n            // eslint-disable-next-line no-script-url\n            $form.attr('action', 'javascript:void(0)');\n\n            function submit() {\n                const folder_to = $form.find('[name=\"to\"]').val();\n                const $spinner = add_spinner();\n                $.post(get_action_url('rest'),\n                    {\n                        \"action\": \"movedir\",\n                        \"item_id\": item_id,\n                        \"folder_to\": folder_to,\n                        \"sesskey\": M.cfg.sesskey\n                    },\n                    function() {\n                        reload_tree();\n                        directories.reset();\n                    })\n                    .fail(function(response) {\n                        show_error(response);\n                    })\n                    .always(function() {\n                        $spinner.hide();\n                    });\n            }\n\n            $form.submit(submit);\n\n            if (dirs.length === 0) {\n                var $input = $('<input class=\"form-control\" type=\"text\" name=\"to\"/>').val(current_path);\n                setTimeout(function() {\n                    $input.focus();\n                }, 1);\n                $form.append($input);\n            } else {\n                dirs.unshift('/');\n\n                const $select = $('<select class=\"custom-select\" name=\"to\"/>');\n                for (let i = 0; i < dirs.length; i++) {\n                    $select.append($('<option/>').val(dirs[i]).append(dirs[i]));\n                }\n                $select.val(current_path);\n                $select.change(submit);\n                $form.append($select);\n\n                const $edit = create_command('edit');\n\n                $edit.on('click', function() {\n                    const $input = $('<input type=\"text\" name=\"to\"/>').val(current_path);\n                    $select.remove();\n                    $edit.replaceWith($input);\n                    $input.focus();\n                });\n\n                $form.append($edit);\n            }\n\n            const $cancel = create_command('cancel');\n            $cancel.on('click', function() {\n                $form.remove();\n                $commands.find('a').show();\n            });\n            $form.append($cancel);\n\n            $commands.find('a').each(function() {\n                $(this).hide();\n            });\n            $commands.append($form);\n        };\n\n        /**\n         *  On move command clicked\n         *\n         *  @param {DOMEventFacade} e\n         */\n        $.on_move = function(e) {\n            const $item = $(e.target).closest('li.activity');\n            const id = $item.attr('id').match(/(\\d+)$/)[1];\n\n            move_targets.show(id);\n        };\n\n        /**\n         *  On delete command clicked\n         *\n         *  @param {DOMEventFacade} e\n         */\n        $.on_delete = function(e) {\n            const $item = $(e.target).closest('li');\n            const liText = $item[0].innerText;\n\n            let isDirectory = false;\n            let modalBody;\n            let item;\n            let description_text = '';\n\n            if ($item.hasClass(\"directory\")) {\n                isDirectory = true;\n                item = str('folder_string');\n                description_text = str('delete_folder');\n            } else {\n                item = str('activity_string');\n            }\n\n            modalBody = '<p class=\"delete-item\">' + item + ' ' + liText + description_text + '</p>';\n\n            confirm_modal({\n                'title': str('confirm_delete'),\n                'body': modalBody,\n                'save_button': str('modal_confirm_delete'),\n                'checkbox': false,\n                'next': function() {\n\n                    let data = {};\n\n                    if (isDirectory === true) {\n                        data = {\n                            \"action\": \"delete_directory\",\n                            \"path\": $item.attr(\"directory-path\"),\n                            \"sesskey\": M.cfg.sesskey\n                        };\n                    } else if ($item.hasClass(\"activity\")) {\n                        data = {\n                            \"action\": \"delete\",\n                            \"id\": $item.attr('id').match(/(\\d+)$/)[1],\n                            \"sesskey\": M.cfg.sesskey\n                        };\n                    }\n\n                    const $spinner = add_spinner();\n\n                    $.post(get_action_url(\"rest\"), data,\n                        function() {\n                            reload_tree();\n                        })\n                        .fail(function(response) {\n                            show_error(response);\n                        })\n                        .always(function() {\n                            $spinner.hide();\n                        });\n\n                    e.stopPropagation();\n                }\n            });\n        };\n\n        /**\n         *  On restore command clicked\n         *\n         *  @param {DOMEventFacade} e\n         */\n        $.on_restore = function(e) {\n            const $item = $(e.target).closest('li');\n            let id = null;\n\n            if ($item.hasClass(\"directory\")) {\n                id = $item.attr(\"directory-path\");\n                restore_targets.is_directory = true;\n            } else if ($item.hasClass(\"activity\")) {\n                id = $item.attr('id').match(/(\\d+)$/)[1];\n                restore_targets.is_directory = false;\n            }\n\n            restore_targets.show(id);\n        };\n\n        /**\n         * On backup the whole section as a folder\n         *\n         * @param {int} sectionId\n         * @param {int} sectionNumber\n         * @param {int} courseId\n         * @param {string} sectionName\n         */\n        $.on_section_backup = function(sectionId, sectionNumber, courseId, sectionName) {\n            const data =\n                {\n                    \"action\": \"is_userdata_copyable_section\",\n                    \"sectionid\": sectionId,\n                    \"sectionnumber\": sectionNumber,\n                    \"courseid\": courseId,\n                };\n\n            const body_html = '<p class=\"alert alert-danger mt-3\">' + str('backup_heavy_load_warning_message') +\n                '</p>' + str('confirm_backup_section');\n\n            on_backup_modal(data, sectionName, body_html, true);\n        };\n\n        /**\n         *  Initialize the delete bulk\n         */\n        $.init_bulk_delete = function(isspeciallayout) {\n            const bulkdelete = $block.find('.editing_bulkdelete');\n            if (bulkdelete.length) {\n                if (isspeciallayout) {\n                    bulkdelete.attr('role', 'menuitem').addClass('dropdown-item menu-action');\n                    bulkdelete.append($(\"<span class='menu-action-text'/>\").append(bulkdelete.attr('title')));\n\n                    $block.find('.menubar .dropdown .dropdown-menu').append(bulkdelete);\n                } else {\n                    $block.find('.header .commands').append(bulkdelete);\n                }\n            }\n        };\n\n        /**\n         *  Initialize the help icon\n         */\n        $.init_help_icon = function(isspeciallayout) {\n            const helpicon = $block.find('.header-commands > .help-icon');\n\n            if (isspeciallayout) {\n                $block.find('.header-commands').parent().css('display', 'block');\n            } else {\n                $block.find('.header .commands').append(helpicon);\n            }\n        };\n\n        /**\n         *  Initialize the Sharing Cart block header\n         */\n        $.init_block_header = function() {\n            const isspeciallayout = verify_layout();\n            $.init_bulk_delete(isspeciallayout);\n            $.init_help_icon(isspeciallayout);\n        };\n\n        /**\n         *  Initialize the Sharing Cart item tree\n         */\n        $.init_item_tree = function() {\n            function add_actions(item, actions) {\n                const $item = $(item);\n                const isCopying = $item.attr('data-is-copying') === '1';\n                const $commands = $item.find('.commands').first();\n\n                $.each(actions, function(index, action) {\n                    if (action === 'restore' && isCopying) {\n                        return;\n                    }\n                    const $command = create_command(action);\n                    $command.on('click', function(e) {\n                        $['on_' + action](e);\n                    });\n                    $commands.append($command);\n                }, this);\n            }\n\n            const activity_actions = ['movedir', 'move', 'delete'];\n            if (course) {\n                activity_actions.push('restore');\n            }\n\n            const directory_actions = ['delete', 'restore'];\n\n            // Initialize items\n            $block.find('li.activity').each(function(index, item) {\n                if($(item).attr('data-disable-copy') == 1) {\n                    add_actions(item, ['movedir', 'move', 'delete']);\n                    return;\n                }\n                add_actions(item, activity_actions);\n            });\n\n            // Initialize directory items\n            $block.find('li.directory').each(function(index, item) {\n                add_actions(item, directory_actions);\n            });\n\n            // Initialize directories\n            directories.init();\n        };\n\n        /**\n         * Extract html object from area where moodle ajax was called.\n         *\n         * Call add_activity_backup_control to re append sharing cart icon.\n         */\n        $.init_activity_commands = function() {\n            $(document).ajaxComplete(function(event, xhr, settings) {\n\n                const url = settings.url;\n                const lastslashindex = url.lastIndexOf('=');\n                const result = url.substring(lastslashindex + 1);\n\n                if (result === 'core_course_edit_module' || result === 'core_course_get_module') {\n\n                    const data = JSON.parse(settings.data);\n                    const action = data[0].args.action;\n\n                    // Don't try to add icon if activity has been deleted.\n                    if (action === 'delete') {\n                        return;\n                    }\n\n                    setTimeout(function() {\n                        const activity_id = data[0].args.id;\n                        const activity = $('#module-' + activity_id);\n                        add_activity_backup_control(activity);\n\n                        if (action === 'duplicate') {\n                            const duplicated = activity.next();\n                            add_activity_backup_control(duplicated);\n                        }\n                    }, 1);\n                }\n            });\n\n            /**\n             * Create the backup icon\n             *\n             * @returns $backupIcon\n             */\n            function create_backup_icon() {\n\n                const $backupIcon = $('<a href=\"javascript:void(0)\" class=\"add-to-sharing-cart\" />')\n                    .append($('<i class=\"fa fa-shopping-basket icon\"></i>'))\n                    .attr('title', str('backup'));\n\n                if (addMethod !== 'click_to_add') {\n                    $backupIcon.addClass('d-none');\n                }\n\n                return $backupIcon;\n            }\n\n            /**\n             * Add backup control with a click event to an activity\n             * Added fix for copying an activity without backup routine\n             *\n             * @param $activity\n             */\n            function add_activity_backup_control($activity) {\n\n                const activityClass = $activity[0].className;\n\n                // Selecting modtype without prefix.\n                const modtype = activityClass.substr(activityClass.indexOf('modtype_') + 8);\n\n                // Default activity name.\n                let activityName = str('activity_string');\n\n                // Label is using a different html / css layout, so it's needed to get the name by using another $find.\n                if (modtype !== 'label') {\n                    activityName = $('.activity#' + $activity[0].id)\n                        .find('.mod-indent-outer .activityinstance span.instancename')\n                        .html();\n                }\n\n                const $backupIcon = create_backup_icon();\n\n                $backupIcon.on('click', function(e) {\n                    $.on_backup(e, activityName);\n                });\n\n                const $actionMenuItem = $activity.find('.action-menu.section-cm-edit-actions').parent('.actions');\n\n                if (!$actionMenuItem.find('.add-to-sharing-cart').length) {\n                    $actionMenuItem.append($backupIcon);\n                }\n            }\n\n            /**\n             * Add backup control with a click event to a section\n             *\n             * @param $section\n             */\n            function add_section_backup_control($section) {\n\n                let sectionId = $section.find('.section_action_menu').data('sectionid');\n                const sectionNumber = parseInt(String($section.attr('id')).match(/\\d+/)[0]);\n                let sectionName = $section.attr('aria-label') || $section.find('.sectionname').text().trim();\n\n                const isFlexibleCourseFormat = $('body[id$=flexsections]').length;\n\n                // Extract the section ID from the section if this is a Flexible\n                // course format (since this format doesn't have an action menu)\n                if (isFlexibleCourseFormat && (typeof sectionId === 'undefined' || sectionId === null)) {\n                    sectionId = $section.data('section-id');\n                }\n\n                // A bit unsafe to extract the course ID from the body but it's the best option we got at the moment\n                const courseId = parseInt(String($('body').attr('class')).match(/course-([0-9]*)( |$)/)[1]);\n\n                const $backupIcon = create_backup_icon();\n\n                $backupIcon.on('click', function() {\n                    const inPlaceEditSectionName = in_place_edit_section_name($section);\n                    sectionName = (inPlaceEditSectionName !== '') ? inPlaceEditSectionName : sectionName;\n                    $.on_section_backup(sectionId, sectionNumber, courseId, sectionName);\n                });\n\n                let $sectionTitle = $section.find('h3.sectionname').first().find('a').last();\n\n                const $inPlaceEditable = $section.find('h3.sectionname .inplaceeditable').first();\n                if ($inPlaceEditable.length) {\n                    $sectionTitle = $inPlaceEditable;\n                }\n\n                // Add the backup icon after the cog wheel if this is a Flexible course format\n                if (isFlexibleCourseFormat && sectionNumber === 0) {\n                    $sectionTitle = $section.find('> .controls');\n                    $sectionTitle.prepend($backupIcon);\n                } else {\n                    $backupIcon.insertAfter($sectionTitle);\n                }\n\n                const activitySelector = 'li.activity';\n\n                const $activities = $section.find(activitySelector);\n\n                $($activities).each(function() {\n                    add_activity_backup_control($(this));\n                });\n            }\n\n            $(\"body.editing .course-content li.section\").each(function() {\n                add_section_backup_control($(this));\n            });\n        };\n\n        /**\n         *  Initialize the Sharing Cart footer basket for 4.0+.\n         */\n        function init_footer_basket() {\n            let currentDragging;\n            const activities = document.querySelectorAll(\".activity.activity-wrapper\");\n            const sections = document.querySelectorAll(\".course-section-header\");\n            const sharingCartBlock = document.querySelector('section[data-block=\"sharing_cart\"]');\n\n            add_draggable_to_first_section();\n\n            const footer = document.getElementById('page-footer');\n            const footerIconContainer = footer.querySelector('div[data-region=\"footer-container-popover\"]');\n\n            const basket = document.createElement('i');\n            basket.setAttribute('class', 'fa fa-shopping-basket');\n\n            const basketButton = document.createElement('button');\n            basketButton.setAttribute('class', 'btn btn-icon bg-secondary icon-no-margin btn-footer-popover sharing_cart_basket');\n            basketButton.setAttribute('style', 'z-index: 1001;');\n            basketButton.append(basket);\n\n            const dropAreaText = document.createElement('p');\n            dropAreaText.setAttribute('class', 'font-weight-bold text-white');\n            dropAreaText.innerText = str('drop_here');\n\n            const dropArea = document.createElement('div');\n            dropArea.setAttribute('class',\n                'h-100 w-100 position-absolute d-flex justify-content-center align-items-center');\n            dropArea.append(dropAreaText);\n\n            sections.forEach(section => {\n                drag_event_listeners(section);\n            });\n\n            activities.forEach(activity => {\n                drag_event_listeners(activity);\n            });\n\n            /**\n             *  Initialize events for dragging\n             * @param {object} draggable\n             */\n            function drag_event_listeners(draggable) {\n                draggable.addEventListener('dragstart', (e) => {\n                    basketButton.classList.remove('shake_basket');\n\n                    footerIconContainer?.prepend(basketButton);\n                    sharingCartBlock.children[0].classList.add('dragging_item');\n                    sharingCartBlock.append(dropArea);\n                    currentDragging = e.target;\n                    isDragging = true;\n                });\n\n                draggable.addEventListener('dragend', () => {\n                    if (currentDragging instanceof HTMLElement) {\n                        footerIconContainer?.removeChild(basketButton);\n                    }\n\n                    sharingCartBlock.children[0].classList.remove('dragging_item');\n                    sharingCartBlock.removeChild(dropArea);\n                    isDragging = false;\n                });\n            }\n\n            [basketButton, sharingCartBlock].forEach((dropzone) => {\n                dropzone.addEventListener(\"dragover\", (e) => {\n                    e.preventDefault();\n                    dropzone.classList.add('drag_over');\n                });\n\n                dropzone.addEventListener(\"dragenter\", (e) => {\n                    e.preventDefault();\n                    dropzone.classList.add('drag_over');\n                });\n\n                dropzone.addEventListener(\"dragleave\", () => {\n                    dropzone.classList.remove('drag_over');\n                });\n\n                dropzone.addEventListener(\"drop\", () => {\n                    if (currentDragging instanceof HTMLElement) {\n                        currentDragging.querySelector('.add-to-sharing-cart').click();\n                    }\n\n                    dropzone.classList.remove('drag_over');\n                    currentDragging = undefined;\n                    isDragging = false;\n                });\n            });\n        }\n\n        /**\n         *  Make the first section (General) draggable\n         */\n        function add_draggable_to_first_section() {\n            const courseSectionHeader = document.getElementsByClassName(\"course-section-header\")[0] ?? null;\n\n            if (courseSectionHeader instanceof HTMLElement) {\n                courseSectionHeader.classList.add('draggable');\n                courseSectionHeader.setAttribute('draggable', true);\n            }\n        }\n\n        /**\n         * Initialize the Sharing Cart block\n         */\n        $.init = function() {\n            M.str.block_sharing_cart.pluginname = this.get_plugin_name();\n\n            // Arrange header icons (bulkdelete, help)\n            $.init_block_header();\n            $.init_item_tree();\n            $.init_activity_commands();\n\n            if (addMethod === 'drag_and_drop') {\n                init_footer_basket();\n            }\n        };\n        var $spinner = $('<i/>').addClass('spinner fa fa-3x fa-circle-o-notch fa-spin');\n        $('div#sharing-cart-spinner-modal div.spinner-container').prepend($spinner);\n\n        $.init();\n    });\n\n    $('.copy_section').on('click', function() {\n\n        const $section_selected = ($('.section-dropdown option:selected'));\n        const sectionId = $section_selected.data('section-id');\n        const sectionNumber = $section_selected.data('section-number');\n        const courseId = $section_selected.data('course-id');\n        const sectionName = $section_selected.data('section-name');\n\n        $.on_section_backup(sectionId, sectionNumber, courseId, sectionName);\n    });\n\n    $('.copy_activity').on('click', function(e) {\n        const activitySelected = ($('.activity-dropdown option:selected'));\n        const activityId = activitySelected.data('activity-id');\n        const activityName = activitySelected.data('activity-name');\n\n        $.on_backup(e, activityName, activityId);\n    });\n};\n"],"names":["addMethod","document","ready","isDragging","str","identifier","M","block_sharing_cart","moodle","get_action_url","name","args","url","cfg","wwwroot","q","k","push","encodeURIComponent","join","remove_basket","footerIconContainer","getElementById","querySelector","sharingCartBasket","removeChild","classList","remove","confirm_modal","obj","checkbox","body","create","type","ModalFactory","types","SAVE_CANCEL","title","done","modal","is_submitted","setSaveButtonText","save_button","getRoot","on","ModalEvents","save","e","response","target","find","is","next","cancel","hidden","removeClass","show","in_place_edit_section_name","$section","sectionName","$inPlaceEditable","length","data","on_backup_modal","post_data","title_str","body_str","isSection","post","sectionId","sectionNumber","courseId","userdata","$commands","closest","attr","text","trim","String","parent","inPlaceEditSectionName","$spinner","add_spinner","$node_spinner","add_node_spinner","sesskey","reload_tree","fail","show_error","always","hide","backup_section","sectionid","sectionnumber","courseid","cmid","course","id","backup","add","shake_basket","on_success","icon","css","iconClass","$block","match","is_frontpage","hasClass","ex","JSON","parse","responseText","core","exception","message","create_command","iconElement","addClass","append","$node","replaceWith","init_item_tree","directories","KEY","opens","param","readCookie","cookie","pop","getCookieValue","split","map","v","parseInt","expires","Date","setDate","getDate","value","expireTimeInMillisecond","d","setTime","getTime","toUTCString","setCookie","open","$dir","visible","init","i","each","index","dir","toggle","reset","move_targets","$cancel","targets","this","$target","item_id","$current","$next","$list","next_id","create_target","area_to","$anchor","m","move","item","$item","to","before","restore_targets","is_directory","$clipboard","section","href","URL","util","image_url","$view","html","prepend","cloneNode","replace","$sitetopic","$mainmenu","$container","sectionDOM","first","init_footer_basket","currentDragging","activities","querySelectorAll","sections","sharingCartBlock","courseSectionHeader","getElementsByClassName","HTMLElement","setAttribute","add_draggable_to_first_section","basket","createElement","basketButton","dropAreaText","innerText","dropArea","drag_event_listeners","draggable","addEventListener","children","forEach","activity","dropzone","preventDefault","click","undefined","get_plugin_name","$blockheader","on_backup","activityName","cmId","$backup","$activity","dataowner","on_movedir","$current_dir","current_path","dirs","$form","submit","folder_to","val","$input","setTimeout","focus","unshift","$select","change","$edit","on_move","on_delete","liText","modalBody","isDirectory","description_text","stopPropagation","on_restore","on_section_backup","init_bulk_delete","isspeciallayout","bulkdelete","init_help_icon","helpicon","init_block_header","add_actions","actions","isCopying","action","$command","activity_actions","directory_actions","init_activity_commands","create_backup_icon","$backupIcon","add_activity_backup_control","activityClass","className","modtype","substr","indexOf","$actionMenuItem","ajaxComplete","event","xhr","settings","lastslashindex","lastIndexOf","result","substring","activity_id","isFlexibleCourseFormat","$sectionTitle","last","insertAfter","$activities","add_section_backup_control","pluginname","$section_selected","activitySelected","activityId"],"mappings":";;;;;;;kPA8BoB,SAASA,+BACvBC,UAAUC,OAAM,eACVC,YAAa,WAQRC,IAAIC,mBACFC,EAAEF,IAAIG,mBAAmBF,aAAeC,EAAEF,IAAII,OAAOH,qBAUvDI,eAAeC,KAAMC,UACtBC,IAAMN,EAAEO,IAAIC,QAAU,wBAA0BJ,KAAO,UACvDC,KAAM,OACAI,EAAI,OACL,IAAIC,KAAKL,KACVI,EAAEE,KAAKD,EAAI,IAAME,mBAAmBP,KAAKK,KAE7CJ,KAAO,IAAMG,EAAEI,KAAK,YAEjBP,aAgBFQ,mBACa,kBAAdpB,YAAkCG,WAAY,OAExCkB,oBADSpB,SAASqB,eAAe,eACJC,cAAc,+CAC3CC,kBAAoBvB,SAASsB,cAAc,8BAE7CC,oBACAH,MAAAA,qBAAAA,oBAAqBI,YAAYD,mBACjCA,kBAAkBE,UAAUC,OAAO,2BAUtCC,cAAcC,KAGfA,IAAIC,WACJD,IAAIE,MACA,uJAEiC3B,IAAI,kBAFrC,yCAOK4B,OAAO,CAChBC,KAAMC,uBAAaC,MAAMC,YACzBC,MAAOR,IAAIQ,MACXN,KAAMF,IAAIE,OACXO,MAAK,SAASC,WACTC,cAAe,EACnBD,MAAME,kBAAkBZ,IAAIa,aAG5BH,MAAMI,UAAUC,GAAGC,sBAAYC,MAAM,SAASC,SAEpCC,SAAW,WACD,mBAAED,EAAEE,QAAQC,KAAK,mBAAmBC,GAAG,aAGvDtB,IAAIuB,KAAKJ,UACTR,cAAe,KAGnBD,MAAMI,UAAUC,GAAGC,sBAAYQ,QAAQ,WACnCjC,mBAIJmB,MAAMI,UAAUC,GAAGC,sBAAYS,QAAQ,+BACjC,QAAQC,YAAY,cAEjBf,cACDpB,mBAIRmB,MAAMiB,mBAWLC,2BAA2BC,cAC5BC,YAAc,SACZC,iBAAmBF,SAASR,KAAK,0CACnCU,iBAAiBC,SACjBF,YAAcC,iBAAiBE,KAAK,UAEjCH,qBASFI,gBAAgBC,UAAWC,UAAWC,SAAUC,2BAE/CC,KAAK3D,eAAe,QAASuD,WAC3B,SAAShB,WAMd,SAASA,cAEJlB,UAAW,EADe,MAAbkB,WAIblB,UAAW,GAGfF,cAAc,OACDqC,eACDC,qBACO9D,IAAI,iCACP0B,cACJ,SAASgC,OACK,IAAdK,mBAgOIE,UAAWC,cAAeC,SAAUC,gBAClDC,WAAY,mBAAE,+DAAiEJ,UAAY,KAC3FX,SAAWe,UAAUC,QAAQ,uBAC/Bf,YAAcD,SAASiB,KAAK,eAAiBjB,SAASR,KAAK,gBAAgB0B,OAAOC,OAElE,OAAhBlB,cACAA,YAAcmB,QAAO,mBAAE,qDAAwDT,UAAY,MACtFU,SAASA,SAAS7B,KAAK,kBAAkB0B,eAG5CI,uBAAyBvB,2BAA2BC,UAC1DC,YAA0C,KAA3BqB,uBAAiCA,uBAAyBrB,kBAEnEsB,SAAWC,cACXC,cAAgBC,iBAAiBX,2BAErCL,KAAK3D,eAAe,QAClB,QACc,2BACG4D,wBACIC,uBACLC,qBACGZ,qBACHa,iBACDlE,EAAEO,IAAIwE,UAErB,WACIC,iBAEHC,MAAK,SAASvC,UACXwC,WAAWxC,aAEdyC,QAAO,WACJR,SAASS,OACTP,cAAcO,OACdtE,mBAlQQuE,CAAe3B,UAAU4B,UAAW5B,UAAU6B,cAAe7B,UAAU8B,SAAUhC,KAAKhC,mBAyL1FiE,KAAMvB,cACdC,WAAY,mBAAE,WAAasB,KAAO,aACjCtB,UAAUZ,SACXY,WAAY,mBAAE,wBAA0BsB,KAAO,aAG7Cd,SAAWC,cACXC,cAAgBC,iBAAiBX,2BAErCL,KAAK3D,eAAe,QAClB,QACc,cACFsF,cACIvB,iBACDlE,EAAEO,IAAIwE,iBACLW,OAAOC,KAEvB,WACIX,iBAEHC,MAAK,SAASvC,UACXwC,WAAWxC,aAEdyC,QAAO,WACJN,cAAcO,OACdT,SAASS,OACTtE,mBAjNQ8E,CAAOlC,UAAU+B,KAAMjC,KAAKhC,wBA3H1B,kBAAd9B,UAA+B,OACzBwB,kBAAoBvB,SAASsB,cAAc,8BACjDC,MAAAA,mBAAAA,kBAAmBE,UAAUyE,IAAI,iBA4HzBC,MAzBAC,CAAWrD,YACZ,QACFuC,MAAK,SAASvC,UACXwC,WAAWxC,mBA6BrBsD,KAAO,QAEC,CACNC,IAAK,iBACLC,UAAW,yBAEJ,CACPD,IAAK,gBACLC,UAAW,0BAEP,CACJD,IAAK,gBACLC,UAAW,uBAEP,CACJD,IAAK,iBACLC,UAAW,uBAEL,CACND,IAAK,iBACLC,UAAW,oBAEL,CACND,IAAK,iBACLC,UAAW,uBAEJ,CACPD,IAAK,kBACLC,UAAW,0BAGH,CACRA,UAAW,oCAED,CACVA,UAAW,mBAKbC,QAAS,mBAAE,uBAGXT,OAAS,IAAI,iBACTjE,MAAO,mBAAE,aACVkE,GAAKlE,KAAK4C,KAAK,SAAS+B,MAAM,gBAAgB,QAC9CC,aAAe5E,KAAK6E,SAAS,kCAQ7BpB,WAAWxC,oBAEN6D,GAAKC,KAAKC,MAAM/D,SAASgE,kBAC3B1G,EAAE2G,KAAKC,UAAU,CACjBxG,KAAMN,IAAI,cAAgB,MAAQA,IAAI,SACtC+G,QAASN,GAAGM,UAElB,MAAOpE,OACDzC,EAAE2G,KAAKC,UAAU,CACjBxG,KAAMN,IAAI,cAAgB,MAAQA,IAAI,SACtC+G,QAASnE,SAASgE,yBA4CrBI,eAAe1G,YACd2G,aAAc,mBAAE,QACjB1C,KAAK,MAAOvE,IAAIM,OAChBiE,KAAK,QAAS2B,KAAK5F,MAAM8F,kBAKvB,mBAAE,kCACJc,SAAShB,KAAK5F,MAAM6F,KACpB5B,KAAK,QAASvE,IAAIM,OAClB6G,OAAOF,sBAQPnC,oBACCD,UAAY,mBAAE,2IAClB,8BAA8BsC,OAAOtC,UAChCA,kBAQFG,iBAAiBoC,aAChBrC,eAAgB,mBAAE,8FACxBqC,MAAMD,OAAOpC,eACNA,uBAWFG,8BACHlB,KAAK3D,eAAe,QAClB,QACc,uBACEuF,OAAOC,KAEvB,SAASjD,UACLyD,OAAOvD,KAAK,SAASuE,aAAY,mBAAEzE,2BACjC0E,mBACH,QACFnC,MAAK,SAASvC,UACXwC,WAAWxC,iCAnBrB/C,UAAU2C,GAAG,QAAS,aAAa,WACjCsC,uBA+GEyC,YAAc,IAAI,iBACdC,IAAM,8BAERC,eAlKgBC,aACdC,WAAa9H,SAAS+H,OAAOtB,MAAM,YAAcoB,MAAQ,2BACxDC,WAAaA,WAAWE,MAAQ,GAgK3BC,CAAeN,KAAKO,MAAM,KAAKC,KAAI,SAAUC,UAC9CC,SAASD,eAGXvF,aACCyF,QAAU,IAAIC,KACpBD,QAAQE,QAAQF,QAAQG,UAAY,aApLzBhI,KAAMiI,MAAOC,+BACtBC,EAAI,IAAIL,KACdK,EAAEC,QAAQD,EAAEE,UAAYH,+BAClBL,QAAU,WAAaM,EAAEG,cAC/B/I,SAAS+H,OAAStH,KAAO,IAAMiI,MAAQ,IAAMJ,QAiLzCU,CAAUrB,IAAKC,MAAM1G,KAAK,KAAMoH,kBAG3BW,KAAKC,KAAMC,eAEV/B,YAAcf,KADF8C,QAAU,WAAa,cACL5C,UACpC2C,KAAKjG,KAAK,gBAAgByB,KAAK,QAAS,QAAU0C,aAClD8B,KAAKjG,KAAK,aAAakG,QAAU,OAAS,eAgBzCC,KAAO,eACJC,EAAI,EACR7C,OAAOvD,KAAK,gBAAgBqG,MAAK,SAAUC,MAAOC,WACxCN,MAAO,mBAAEM,KACfN,KAAKxE,KAAK,KAAM,0BAA4B2E,GACxCA,GAAKzB,MAAMhE,OACXgE,MAAM5G,KAAK,GACJ4G,MAAMyB,IACbJ,KAAKC,MAAM,GAEfA,KAAKjG,KAAK,4BAA4BqD,IAAI,SAAU,WAAW3D,GAAG,SAAS,SAAUG,aAvB7EA,SACNoG,MAAO,mBAAEpG,EAAEE,QAAQyB,QAAQ,gBAC3B4E,EAAIH,KAAKxE,KAAK,MAAM+B,MAAM,UAAU,GACpC2B,EAA8C,SAA1Cc,KAAKjG,KAAK,aAAaqD,IAAI,WAErC2C,KAAKC,KAAMd,GACXR,MAAMyB,GAAKjB,EAAI,EAAI,EACnBvF,OAiBQ4G,CAAO3G,MAEXuG,aAOHK,MAAQ,WACT9B,MAAQ,QACHwB,OACLvG,SAOF8G,aAAe,IAAI,eACjBC,QAAU,KACVC,QAAU,QAKTpE,KAAO,cACQ,OAAZmE,QAAkB,OACZpF,UAAYoF,QAAQnF,QAAQ,aAClCmF,QAAQlI,SACRkI,QAAU,KACVpF,UAAUC,QAAQ,eAAe6B,IAAI,UAAW,GAChD9B,UAAUvB,KAAK,KAAKqG,MAAK,+BACnBQ,MAAMvG,0BAEV+F,KAAKO,SAAS,SAAUN,MAAOQ,SAC7BA,QAAQrI,YAEZmI,QAAU,UASbtG,KAAO,SAAUyG,cACbvE,aA2BCwE,SAAWzD,OAAOvD,KAAK,4BAA8B+G,SACrDE,MAAQD,SAAS9G,OACjBgH,MAAQF,SAASxF,QAAQ,UAE3B2F,QAAU,WAWLC,cAAcL,QAASM,eACtBC,SAAU,mBAAE,kCACblD,SAAS,QAAU2C,QAAU,OAASM,SACtC5F,KAAK,QAASvE,IAAI,aAClBmH,QACG,mBAAE,MAAQnH,IAAI,eAAiB,QAC1BuE,KAAK,MAAOvE,IAAI,cAGvB4J,SAAU,mBAAE,kCACbzC,OAAOiD,gBACZA,QAAQ5H,GAAG,SAAS,SAAUG,aAnDpBA,SAEJ0H,GAAI,mBAAE1H,EAAEE,QAAQyB,QAAQ,KAAKC,KAAK,SAAS+B,MAAM,uBACjDuD,QAAUQ,EAAE,GACdF,QAAUE,EAAE,GAEVxF,SAAWC,8BACfd,KAAK3D,eAAe,QAClB,QACc,eACCwJ,gBACAM,gBACAjK,EAAEO,IAAIwE,UAErB,WACIC,iBAEHC,MAAK,SAAUvC,UACZwC,WAAWxC,aAEdyC,QAAO,WACJR,SAASS,UA+BbgF,CAAK3H,MAGFiH,WAzBPG,MAAMtG,SACNwG,QAAUF,MAAMxF,KAAK,MAAM+B,MAAM,eAAe,IA2BpD0D,MAAMlH,KAAK,iBAAiBqG,MAAK,SAAUC,MAAOmB,YACxCC,OAAQ,mBAAED,MACVE,GAAKD,MAAMjG,KAAK,MAAM+B,MAAM,eAAe,MAC7CmE,KAAOZ,QAAS,CAChBJ,QAAUzC,eAAe,UACzByC,QAAQjH,GAAG,SAAS,WAChBgH,aAAalE,gBAEXjB,UAAYmG,MAAM1H,KAAK,aAC7BuB,UAAUvB,KAAK,KAAKqG,MAAK,+BACnBQ,MAAMrE,UAEZjB,UAAU8C,OAAOsC,SACjBe,MAAMrE,IAAI,UAAW,SAClB,GAAIsE,KAAOR,QAAS,OACjBL,QAAUM,cAAcL,QAASY,IACvCD,MAAME,OAAOd,SACbF,QAAQ7I,KAAK+I,YAElBD,MAECI,MAAO,KACHH,QAAUM,cAAcL,QAAS,GACrCG,MAAM7C,OAAOyC,SACbF,QAAQ7I,KAAK+I,YAQnBe,gBAAkB,IAAI,gBACnBC,aAAe,SAChBC,WAAa,KACbnB,QAAU,YASLQ,cAAcrE,GAAIiF,eACjBC,KAAO1K,eAAe,UAAW,YACY,IAAjCsK,gBAAgBC,oBACpB/E,UACAD,OAAOC,WACNiF,oBACG,mBAAE,sBAAsBpH,KAAK,sBAChCxD,EAAEO,IAAIwE,kBACJpF,SAASmL,UAGtBpB,SAAU,mBAAE,QAAQrF,KAAK,OAAQwG,MAAMxG,KAAK,QAASvE,IAAI,aAAamH,QACtE,mBAAE,8BAA8B5C,KAAK,MAAOvE,IAAI,aAAauE,KAAK,MAAOrE,EAAE+K,KAAKC,UAAU,iBAAkB,+BAGhHxB,QAAQ7I,KAAK+I,SAENA,aAMNtE,KAAO,WACW,OAAfuF,aACAA,WAAWtJ,SACXsJ,WAAa,qBACX1B,KAAKO,SAAS,SAAUN,MAAOQ,SAC7BA,QAAQrI,YAEZmI,QAAU,UASbtG,KAAO,SAAUyC,SACbP,WAED6F,OAAQ,mBAAE,cAEVxB,KAAKiB,aACLO,MAAMC,KAAKvF,IAAIM,IAAI,UAAW,UAC9BgF,MAAME,SACF,mBAAE,QAAQnE,SAAS,QACd3C,KAAK,MAAOsB,SAGlB,OACG2E,MAAQnE,OAAOvD,KAAK,4BAA8B+C,IACxDsF,OAAQ,mBAAEX,MAAM1H,KAAK,OAAO,GAAGwI,WAAU,IAAOnF,IAAI,UAAW,UAC/DgF,MAAM5G,KAAK,QAAS4G,MAAM5G,KAAK,SAASgH,QAAQ,iBAAkB,KAClEJ,MAAMrI,KAAK,aAAavB,eAGtBkI,QAAUzC,eAAe,aAE/ByC,QAAQjH,GAAG,QAASmH,KAAKrE,MAEzBuF,YAAa,mBAAE,4BACfA,WAAW1D,OAAOnH,IAAI,aAAe,MAAMmH,OAAOgE,OAAOhE,OAAOsC,SAE5D7D,OAAOW,aAAc,OACfiF,YAAa,mBAAE,cACfC,WAAY,mBAAE,yBAChBD,WACAA,WAAW1I,KAAK,KAAK4H,OAAOG,YACrBY,WACPA,UAAU3I,KAAK,YAAY4H,OAAOG,YAIlCY,WACAA,UAAU3I,KAAK,WAAW4H,OAAOR,cAAcrE,GAAI,IAEnD2F,YACAA,WAAW1I,KAAK,cAAcqE,OAAO+C,cAAcrE,GAAI,QAExD,OACG6F,YAAa,mBAAE,mBACrBA,WAAWL,QAAQR,YACnBa,WAAW5I,KAAK,cAAcqG,MAAK,SAAUC,MAAOuC,kBAC1CrI,UAAW,mBAAEqI,YACbb,QAAUxH,SAASiB,KAAK,MAAM+B,MAAM,UAAU,GACpDhD,SAASR,KAAK,cAAc8I,QAAQzE,OAAO+C,cAAcrE,GAAIiF,YAC9DnB,kBAsfNkC,yBACDC,sBACEC,WAAalM,SAASmM,iBAAiB,8BACvCC,SAAWpM,SAASmM,iBAAiB,0BACrCE,iBAAmBrM,SAASsB,cAAc,kFAyF1CgL,kDAAsBtM,SAASuM,uBAAuB,yBAAyB,0DAAM,KAEvFD,+BAA+BE,cAC/BF,oBAAoB7K,UAAUyE,IAAI,aAClCoG,oBAAoBG,aAAa,aAAa,IA3FlDC,SAGMtL,oBADSpB,SAASqB,eAAe,eACJC,cAAc,+CAE3CqL,OAAS3M,SAAS4M,cAAc,KACtCD,OAAOF,aAAa,QAAS,+BAEvBI,aAAe7M,SAAS4M,cAAc,UAC5CC,aAAaJ,aAAa,QAAS,mFACnCI,aAAaJ,aAAa,QAAS,kBACnCI,aAAavF,OAAOqF,cAEdG,aAAe9M,SAAS4M,cAAc,KAC5CE,aAAaL,aAAa,QAAS,+BACnCK,aAAaC,UAAY5M,IAAI,mBAEvB6M,SAAWhN,SAAS4M,cAAc,gBAiB/BK,qBAAqBC,WAC1BA,UAAUC,iBAAiB,aAAcrK,IACrC+J,aAAapL,UAAUC,OAAO,gBAE9BN,MAAAA,qBAAAA,oBAAqBoK,QAAQqB,cAC7BR,iBAAiBe,SAAS,GAAG3L,UAAUyE,IAAI,iBAC3CmG,iBAAiB/E,OAAO0F,UACxBf,gBAAkBnJ,EAAEE,OACpB9C,YAAa,KAGjBgN,UAAUC,iBAAiB,WAAW,KAC9BlB,2BAA2BO,cAC3BpL,MAAAA,qBAAAA,oBAAqBI,YAAYqL,eAGrCR,iBAAiBe,SAAS,GAAG3L,UAAUC,OAAO,iBAC9C2K,iBAAiB7K,YAAYwL,UAC7B9M,YAAa,KAlCrB8M,SAASP,aAAa,QAClB,kFACJO,SAAS1F,OAAOwF,cAEhBV,SAASiB,SAAQpC,UACbgC,qBAAqBhC,YAGzBiB,WAAWmB,SAAQC,WACfL,qBAAqBK,cA6BxBT,aAAcR,kBAAkBgB,SAASE,WACtCA,SAASJ,iBAAiB,YAAarK,IACnCA,EAAE0K,iBACFD,SAAS9L,UAAUyE,IAAI,gBAG3BqH,SAASJ,iBAAiB,aAAcrK,IACpCA,EAAE0K,iBACFD,SAAS9L,UAAUyE,IAAI,gBAG3BqH,SAASJ,iBAAiB,aAAa,KACnCI,SAAS9L,UAAUC,OAAO,gBAG9B6L,SAASJ,iBAAiB,QAAQ,KAC1BlB,2BAA2BO,aAC3BP,gBAAgB3K,cAAc,wBAAwBmM,QAG1DF,SAAS9L,UAAUC,OAAO,aAC1BuK,qBAAkByB,EAClBxN,YAAa,wBA/jBvByN,gBAAkB,eACZC,aAAepH,OAAOvD,KAAK,aAE1B2K,aAAahK,OAOPgK,aAAarC,QANpBqC,aAAepH,OAAOvD,KAAK,MAEvB2K,aAAahK,OACNgK,aAAarC,OAMrB,qBASTsC,UAAY,SAAS/K,EAAGgL,kBAAcC,4DAAO,EAC9B,IAATA,OACAA,KAAQ,SAAUC,eACRC,UAAYD,QAAQvJ,QAAQ,kBAC9BwJ,UAAUrK,cACHqK,UAAUvJ,KAAK,MAAM+B,MAAM,UAAU,SAE1CjC,UAAYwJ,QAAQvJ,QAAQ,aAC5ByJ,UAAY1J,UAAUE,KAAK,qBAC7BwJ,UAAUtK,OACHsK,UAAUzH,MAAM,UAAU,GAE9BjC,UAAUvB,KAAK,oBAAoByB,KAAK,QAAQ+B,MAAM,gBAAgB,GAVzE,EAWL,mBAAE3D,EAAEE,gBAGLa,KACF,QACc,4BACFkK,MAGhBjK,gBAAgBD,KAAMiK,aAAc3N,IAAI,mBAAmB,oBAQ7DgO,WAAa,SAASrL,SACd0B,WAAY,mBAAE1B,EAAEE,QAAQyB,QAAQ,aAEhC2J,aAAe5J,UAAUC,QAAQ,gBACjC4J,aAAeD,aAAaxK,OAASwK,aAAa1J,KAAK,kBAAoB,IAE3EsF,SAAU,mBAAElH,EAAEE,QAAQyB,QAAQ,eAAeC,KAAK,MAAM+B,MAAM,UAAU,GAExE6H,KAAO,GACb9H,OAAOvD,KAAK,gBAAgBqG,MAAK,WAC7BgF,KAAKtN,MAAK,mBAAE8I,MAAMpF,KAAK,4BAGrB6J,OAAQ,mBAAE,oBAIPC,eACCC,UAAYF,MAAMtL,KAAK,eAAeyL,MACtC1J,SAAWC,8BACfd,KAAK3D,eAAe,QAClB,QACc,kBACCwJ,kBACEyE,kBACFpO,EAAEO,IAAIwE,UAErB,WACIC,cACAqC,YAAYgC,WAEfpE,MAAK,SAASvC,UACXwC,WAAWxC,aAEdyC,QAAO,WACJR,SAASS,aApBrB8I,MAAM7J,KAAK,SAAU,sBAwBrB6J,MAAMC,OAAOA,QAEO,IAAhBF,KAAK1K,OAAc,KACf+K,QAAS,mBAAE,uDAAuDD,IAAIL,cAC1EO,YAAW,WACPD,OAAOE,UACR,GACHN,MAAMjH,OAAOqH,YACV,CACHL,KAAKQ,QAAQ,WAEPC,SAAU,mBAAE,iDACb,IAAI1F,EAAI,EAAGA,EAAIiF,KAAK1K,OAAQyF,IAC7B0F,QAAQzH,QAAO,mBAAE,aAAaoH,IAAIJ,KAAKjF,IAAI/B,OAAOgH,KAAKjF,KAE3D0F,QAAQL,IAAIL,cACZU,QAAQC,OAAOR,QACfD,MAAMjH,OAAOyH,eAEPE,MAAQ9H,eAAe,QAE7B8H,MAAMtM,GAAG,SAAS,iBACRgM,QAAS,mBAAE,kCAAkCD,IAAIL,cACvDU,QAAQrN,SACRuN,MAAMzH,YAAYmH,QAClBA,OAAOE,WAGXN,MAAMjH,OAAO2H,aAGXrF,QAAUzC,eAAe,UAC/ByC,QAAQjH,GAAG,SAAS,WAChB4L,MAAM7M,SACN8C,UAAUvB,KAAK,KAAKM,UAExBgL,MAAMjH,OAAOsC,SAEbpF,UAAUvB,KAAK,KAAKqG,MAAK,+BACnBQ,MAAMrE,UAEZjB,UAAU8C,OAAOiH,wBAQnBW,QAAU,SAASpM,SAEXkD,IADQ,mBAAElD,EAAEE,QAAQyB,QAAQ,eACjBC,KAAK,MAAM+B,MAAM,UAAU,GAE5CkD,aAAapG,KAAKyC,qBAQpBmJ,UAAY,SAASrM,SACb6H,OAAQ,mBAAE7H,EAAEE,QAAQyB,QAAQ,MAC5B2K,OAASzE,MAAM,GAAGoC,cAGpBsC,UACA3E,KAFA4E,aAAc,EAGdC,iBAAmB,GAEnB5E,MAAMhE,SAAS,cACf2I,aAAc,EACd5E,KAAOvK,IAAI,iBACXoP,iBAAmBpP,IAAI,kBAEvBuK,KAAOvK,IAAI,mBAGfkP,UAAY,0BAA4B3E,KAAO,IAAM0E,OAASG,iBAAmB,OAEjF5N,cAAc,OACDxB,IAAI,uBACLkP,sBACOlP,IAAI,kCACP,OACJ,eAEA0D,KAAO,IAES,IAAhByL,YACAzL,KAAO,QACO,wBACF8G,MAAMjG,KAAK,0BACRrE,EAAEO,IAAIwE,SAEduF,MAAMhE,SAAS,cACtB9C,KAAO,QACO,YACJ8G,MAAMjG,KAAK,MAAM+B,MAAM,UAAU,WAC5BpG,EAAEO,IAAIwE,gBAInBJ,SAAWC,8BAEfd,KAAK3D,eAAe,QAASqD,MAC3B,WACIwB,iBAEHC,MAAK,SAASvC,UACXwC,WAAWxC,aAEdyC,QAAO,WACJR,SAASS,UAGjB3C,EAAE0M,sCAUZC,WAAa,SAAS3M,SACd6H,OAAQ,mBAAE7H,EAAEE,QAAQyB,QAAQ,UAC9BuB,GAAK,KAEL2E,MAAMhE,SAAS,cACfX,GAAK2E,MAAMjG,KAAK,kBAChBoG,gBAAgBC,cAAe,GACxBJ,MAAMhE,SAAS,cACtBX,GAAK2E,MAAMjG,KAAK,MAAM+B,MAAM,UAAU,GACtCqE,gBAAgBC,cAAe,GAGnCD,gBAAgBvH,KAAKyC,qBAWvB0J,kBAAoB,SAAStL,UAAWC,cAAeC,SAAUZ,aAY/DI,gBAVI,QACc,yCACGM,wBACIC,uBACLC,UAMEZ,YAHJ,sCAAwCvD,IAAI,qCAC1D,OAASA,IAAI,2BAE6B,oBAMhDwP,iBAAmB,SAASC,uBACpBC,WAAarJ,OAAOvD,KAAK,uBAC3B4M,WAAWjM,SACPgM,iBACAC,WAAWnL,KAAK,OAAQ,YAAY2C,SAAS,6BAC7CwI,WAAWvI,QAAO,mBAAE,oCAAoCA,OAAOuI,WAAWnL,KAAK,WAE/E8B,OAAOvD,KAAK,qCAAqCqE,OAAOuI,aAExDrJ,OAAOvD,KAAK,qBAAqBqE,OAAOuI,8BAQlDC,eAAiB,SAASF,uBAClBG,SAAWvJ,OAAOvD,KAAK,iCAEzB2M,gBACApJ,OAAOvD,KAAK,oBAAoB6B,SAASwB,IAAI,UAAW,SAExDE,OAAOvD,KAAK,qBAAqBqE,OAAOyI,2BAO9CC,kBAAoB,iBACZJ,gBA7vBcpJ,OAAOvD,KAAK,qCACZW,uBA6vBlB+L,iBAAiBC,iCACjBE,eAAeF,kCAMnBnI,eAAiB,oBACNwI,YAAYvF,KAAMwF,eACjBvF,OAAQ,mBAAED,MACVyF,UAA8C,MAAlCxF,MAAMjG,KAAK,mBACvBF,UAAYmG,MAAM1H,KAAK,aAAa8I,wBAExCzC,KAAK4G,SAAS,SAAS3G,MAAO6G,WACb,YAAXA,QAAwBD,uBAGtBE,SAAWlJ,eAAeiJ,QAChCC,SAAS1N,GAAG,SAAS,SAASG,mBACxB,MAAQsN,QAAQtN,MAEtB0B,UAAU8C,OAAO+I,YAClBvG,YAGDwG,iBAAmB,CAAC,UAAW,OAAQ,UACzCvK,QACAuK,iBAAiBtP,KAAK,iBAGpBuP,kBAAoB,CAAC,SAAU,WAGrC/J,OAAOvD,KAAK,eAAeqG,MAAK,SAASC,MAAOmB,MACJ,IAArC,mBAAEA,MAAMhG,KAAK,qBAIhBuL,YAAYvF,KAAM4F,kBAHdL,YAAYvF,KAAM,CAAC,UAAW,OAAQ,cAO9ClE,OAAOvD,KAAK,gBAAgBqG,MAAK,SAASC,MAAOmB,MAC7CuF,YAAYvF,KAAM6F,sBAItB7I,YAAY0B,wBAQdoH,uBAAyB,oBAmCdC,2BAECC,aAAc,mBAAE,+DACjBpJ,QAAO,mBAAE,+CACT5C,KAAK,QAASvE,IAAI,iBAEL,iBAAdJ,WACA2Q,YAAYrJ,SAAS,UAGlBqJ,qBASFC,4BAA4B1C,iBAE3B2C,cAAgB3C,UAAU,GAAG4C,UAG7BC,QAAUF,cAAcG,OAAOH,cAAcI,QAAQ,YAAc,OAGrElD,aAAe3N,IAAI,mBAGP,UAAZ2Q,UACAhD,cAAe,mBAAE,aAAeG,UAAU,GAAGjI,IACxC/C,KAAK,yDACLsI,cAGHmF,YAAcD,qBAEpBC,YAAY/N,GAAG,SAAS,SAASG,mBAC3B+K,UAAU/K,EAAGgL,uBAGbmD,gBAAkBhD,UAAUhL,KAAK,wCAAwC6B,OAAO,YAEjFmM,gBAAgBhO,KAAK,wBAAwBW,QAC9CqN,gBAAgB3J,OAAOoJ,iCA/E7B1Q,UAAUkR,cAAa,SAASC,MAAOC,IAAKC,gBAEpC1Q,IAAM0Q,SAAS1Q,IACf2Q,eAAiB3Q,IAAI4Q,YAAY,KACjCC,OAAS7Q,IAAI8Q,UAAUH,eAAiB,MAE/B,4BAAXE,QAAmD,2BAAXA,OAAqC,OAEvE3N,KAAOgD,KAAKC,MAAMuK,SAASxN,MAC3BuM,OAASvM,KAAK,GAAGnD,KAAK0P,UAGb,WAAXA,cAIJxB,YAAW,iBACD8C,YAAc7N,KAAK,GAAGnD,KAAKsF,GAC3BsH,UAAW,mBAAE,WAAaoE,gBAChCf,4BAA4BrD,UAEb,cAAX8C,OAAwB,CAExBO,4BADmBrD,SAASnK,WAGjC,2BAgHT,2CAA2CmG,MAAK,qBAjDd7F,cAE5BW,UAAYX,SAASR,KAAK,wBAAwBY,KAAK,mBACrDQ,cAAgBgE,SAASxD,OAAOpB,SAASiB,KAAK,OAAO+B,MAAM,OAAO,QACpE/C,YAAcD,SAASiB,KAAK,eAAiBjB,SAASR,KAAK,gBAAgB0B,OAAOC,aAEhF+M,wBAAyB,mBAAE,0BAA0B/N,OAIvD+N,8BAAkCvN,YAClCA,UAAYX,SAASI,KAAK,qBAIxBS,SAAW+D,SAASxD,QAAO,mBAAE,QAAQH,KAAK,UAAU+B,MAAM,wBAAwB,IAElFiK,YAAcD,qBAEpBC,YAAY/N,GAAG,SAAS,iBACdoC,uBAAyBvB,2BAA2BC,UAC1DC,YAA0C,KAA3BqB,uBAAiCA,uBAAyBrB,4BACvEgM,kBAAkBtL,UAAWC,cAAeC,SAAUZ,oBAGxDkO,cAAgBnO,SAASR,KAAK,kBAAkB8I,QAAQ9I,KAAK,KAAK4O,aAEhElO,iBAAmBF,SAASR,KAAK,mCAAmC8I,QACtEpI,iBAAiBC,SACjBgO,cAAgBjO,kBAIhBgO,wBAA4C,IAAlBtN,eAC1BuN,cAAgBnO,SAASR,KAAK,eAC9B2O,cAAcpG,QAAQkF,cAEtBA,YAAYoB,YAAYF,qBAKtBG,YAActO,SAASR,KAFJ,mCAIvB8O,aAAazI,MAAK,WAChBqH,6BAA4B,mBAAE7G,UAKlCkI,EAA2B,mBAAElI,2BA+GnCV,KAAO,WACL/I,EAAEF,IAAIG,mBAAmB2R,WAAanI,KAAK6D,kCAGzCqC,oCACAvI,iCACA+I,yBAEgB,kBAAdzQ,WACAiM,0BAGJhH,UAAW,mBAAE,QAAQqC,SAAS,kEAChC,wDAAwDmE,QAAQxG,0BAEhEoE,8BAGJ,iBAAiBzG,GAAG,SAAS,iBAErBuP,mBAAqB,mBAAE,qCACvB9N,UAAY8N,kBAAkBrO,KAAK,cACnCQ,cAAgB6N,kBAAkBrO,KAAK,kBACvCS,SAAW4N,kBAAkBrO,KAAK,aAClCH,YAAcwO,kBAAkBrO,KAAK,gCAEzC6L,kBAAkBtL,UAAWC,cAAeC,SAAUZ,oCAG1D,kBAAkBf,GAAG,SAAS,SAASG,SAC/BqP,kBAAoB,mBAAE,sCACtBC,WAAaD,iBAAiBtO,KAAK,eACnCiK,aAAeqE,iBAAiBtO,KAAK,iCAEzCgK,UAAU/K,EAAGgL,aAAcsE"}