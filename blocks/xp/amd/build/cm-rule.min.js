define ("block_xp/cm-rule",["jquery","core/templates","core/str","block_xp/dialogue-base"],function(a,b,c,d){function f(a){this.initWithCourse=a||null;d.prototype.constructor.apply(this,[])}f.prototype=Object.create(d.prototype);f.prototype.constructor=f;f.prototype._render=function(){var a=JSON.stringify(this.initWithCourse);return c.get_string("cmselector","block_xp").then(function(c){return b.render("block_xp/cm-selector",{initwithcoursejson:a}).then(function(a,d){this.setTitle(c);this._setDialogueContent(a);b.runTemplateJS(d);this.center();this.find(".block_xp-cm-selector-widget").on("cm-selected",function(a,b){this.trigger("cm-selected",b);this.close()}.bind(this))}.bind(this))}.bind(this))};return{init:function(b){a(".block-xp-filters").on("click",".block_xp-cm-rule-widget button",function(c){c.preventDefault();var g=a(c.target).closest(".block_xp-cm-rule-widget");if(!g){return}var h=new f(b);h.on("cm-selected",function(a,b){var c=b.cm,d=b.course;g.find(".cm-rule-contextid").val(c.contextid);g.find(".cm-selected").text(M.util.get_string("rulecmdescwithcourse","block_xp",{contextname:c.name,coursename:d.shortname}));g.addClass("has-cm")});h.show()})}}});
//# sourceMappingURL=cm-rule.min.js.map
