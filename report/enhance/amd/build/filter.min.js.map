{"version":3,"file":"filter.min.js","sources":["../src/filter.js"],"sourcesContent":["define(['jquery', 'core/templates', 'core/ajax', 'core/notification'], function($, templates, ajax, notification) {\n\n    return {\n        init: function() {\n\n            // Set up filter for list of requests\n            $(\".filter-list .nav-link\").click(function() {\n                $(\".filter-list .nav-link\").removeClass(\"active\");\n                $(this).addClass(\"active\");\n                $(\".filter-all\").hide();\n                $($(this).attr(\"data-filter\")).show();\n                if($($(this).attr(\"data-filter\")).length == 0) {\n                    $(\".bottom-button\").hide();\n                } else {\n                    $(\".bottom-button\").show();\n                }\n                try {\n                    localStorage.setItem('selected-filter', $(this).attr(\"data-filter\"));\n                } catch (error) {\n                    return false;\n                }\n            });\n\n            try {\n                var filter = localStorage.getItem('selected-filter');\n                if (filter === null) {\n                    filter = \".filter-status-1, .filter-status-2, .filter-status-3,\" +\n                        \" .filter-status-4, .filter-status-5, .filter-status-6, .filter-status-9\";\n                }\n                $(\".filter-all\").hide();\n                $(filter).show();\n                if ($(filter).length == 0) {\n                    $(\".bottom-button\").hide();\n                } else {\n                    $(\".bottom-button\").show();\n                }\n                // $('.active') removed *all* active classes on the page, breaking \"user menu\" along the way\n                $('.filter-list .nav-link.active').removeClass(\"active\");\n                $(\"[data-filter='\" + filter + \"']\").addClass(\"active\");\n            } catch (error) {\n                return false;\n            }\n\n            // Display updated voting buttons\n            function render_voting(container, requestid, votes) {\n                var context = {\n                    votecount: votes.count,\n                    id: requestid,\n                    ownrequest: votes.ownrequest,\n                    voted: votes.voted\n                };\n                templates.render(\"report_enhance/votes\", context)\n                   .done(function(html) {\n                        $(container).html(html);\n                    })\n                    .fail(notification.exception);\n            }\n\n            // set up voting stuffs\n            $(\".enhance_votes\").on(\"click\", \".votebutton\", function() {\n                var requestid = $(this).data(\"requestid\");\n                var vote = $(this).data(\"vote\");\n                var container = $(this).parent();\n\n                // ajax call to get voting details\n                ajax.call([{\n                    methodname: 'report_enhance_set_vote',\n                    args: { requestid: requestid, vote: vote },\n                    done: function(votes) { render_voting(container, requestid, votes);  },\n                    fail: notification.exception,\n                }]);\n\n                return false;\n            });\n\n            // remember scroll position\n            $(\".save-link\").on(\"click\", function() {\n                var scroll = $(document).scrollTop();\n                try {\n                    localStorage.setItem('scroll-position', scroll);\n                } catch(e) {\n                    return;\n                }\n            });\n\n            // Restore scroll position\n            try {\n                var scroll = localStorage.getItem('scroll-position');\n            } catch(e) {\n                return;\n            }\n            if (scroll) {\n                $(document).scrollTop(scroll);\n            }\n        }\n    };\n});\n"],"names":["define","$","templates","ajax","notification","init","click","removeClass","this","addClass","hide","attr","show","length","localStorage","setItem","error","filter","getItem","on","requestid","data","vote","container","parent","call","methodname","args","done","votes","context","votecount","count","id","ownrequest","voted","render","html","fail","exception","render_voting","scroll","document","scrollTop","e"],"mappings":"AAAAA,+BAAO,CAAC,SAAU,iBAAkB,YAAa,sBAAsB,SAASC,EAAGC,UAAWC,KAAMC,oBAEzF,CACHC,KAAM,WAGFJ,EAAE,0BAA0BK,OAAM,WAC9BL,EAAE,0BAA0BM,YAAY,UACxCN,EAAEO,MAAMC,SAAS,UACjBR,EAAE,eAAeS,OACjBT,EAAEA,EAAEO,MAAMG,KAAK,gBAAgBC,OACa,GAAzCX,EAAEA,EAAEO,MAAMG,KAAK,gBAAgBE,OAC9BZ,EAAE,kBAAkBS,OAEpBT,EAAE,kBAAkBW,WAGpBE,aAAaC,QAAQ,kBAAmBd,EAAEO,MAAMG,KAAK,gBACvD,MAAOK,cACE,cAKPC,OAASH,aAAaI,QAAQ,mBACnB,OAAXD,SACAA,OAAS,gIAGbhB,EAAE,eAAeS,OACjBT,EAAEgB,QAAQL,OACc,GAApBX,EAAEgB,QAAQJ,OACVZ,EAAE,kBAAkBS,OAEpBT,EAAE,kBAAkBW,OAGxBX,EAAE,iCAAiCM,YAAY,UAC/CN,EAAE,iBAAmBgB,OAAS,MAAMR,SAAS,UAC/C,MAAOO,cACE,EAmBXf,EAAE,kBAAkBkB,GAAG,QAAS,eAAe,eACvCC,UAAYnB,EAAEO,MAAMa,KAAK,aACzBC,KAAOrB,EAAEO,MAAMa,KAAK,QACpBE,UAAYtB,EAAEO,MAAMgB,gBAGxBrB,KAAKsB,KAAK,CAAC,CACPC,WAAY,0BACZC,KAAM,CAAEP,UAAWA,UAAWE,KAAMA,MACpCM,KAAM,SAASC,iBAxBAN,UAAWH,UAAWS,WACrCC,QAAU,CACVC,UAAWF,MAAMG,MACjBC,GAAIb,UACJc,WAAYL,MAAMK,WAClBC,MAAON,MAAMM,OAEjBjC,UAAUkC,OAAO,uBAAwBN,SACrCF,MAAK,SAASS,MACVpC,EAAEsB,WAAWc,KAAKA,SAErBC,KAAKlC,aAAamC,WAaKC,CAAcjB,UAAWH,UAAWS,QAC5DS,KAAMlC,aAAamC,cAGhB,KAIXtC,EAAE,cAAckB,GAAG,SAAS,eACpBsB,OAASxC,EAAEyC,UAAUC,gBAErB7B,aAAaC,QAAQ,kBAAmB0B,QAC1C,MAAMG,sBAOJH,OAAS3B,aAAaI,QAAQ,mBACpC,MAAM0B,UAGJH,QACAxC,EAAEyC,UAAUC,UAAUF"}