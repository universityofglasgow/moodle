{"version":3,"sources":["../src/jquery.editable.amd.js"],"names":["$","window","$win","$textArea","$currentlyEdited","SUPPORTS_TOUCH","TINYMCE_INSTALLED","tinyMCE","init","oldjQueryIs","fn","is","lastTap","tapper","now","Date","getTime","trigger","keyHandler","e","keyCode","data","closeOnEnter","editable","val","attr","toggleFontSize","metaKey","fontSize","parseInt","css","adjustTextAreaHeight","scrollHeight","resetElement","$el","newText","emptyMessage","removeAttr","length","html","remove","elementEditor","opts","defaultText","trim","defaultFontSize","elementHeight","height","textareaStyle","lineBreaks","replace","text","id","appendTo","mode","elements","width","innerWidth","theme_advanced_resize_vertical","setup","ed","onInit","add","editor","editorWindow","getWin","hasPressedKey","editorBlur","getDoc","find","get","nodeName","unbind","callback","content","setTimeout","bind","onkeydown","focus","blur","newFontSize","margin","padding","overflow","editorStyle","select","editEvent","event","children","clickedElement","extend","touch","statement","indexOf","apply","arguments","document","mousedown","target","jQuery"],"mappings":"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","sourcesContent":["/*\n* jQuery plugin that makes elements editable\n*\n* @author Victor Jonsson (http://victorjonsson.se/)\n* @website https://github.com/victorjonsson/jquery-editable/\n* @license GPLv2 http://www.gnu.org/licenses/gpl-2.0.html\n* @version 1.3.6.dev\n* @donations http://victorjonsson.se/donations/\n*/\nexport default (function($, window) {\n\n    'use strict';\n\n    var $win = $(window), // Reference to window\n\n    // Reference to textarea\n    $textArea = false,\n\n    // Reference to currently edit element\n    $currentlyEdited = false,\n\n    // Some constants\n    EVENT_ATTR = 'data-edit-event',\n    IS_EDITING_ATTR = 'data-is-editing',\n    EMPTY_ATTR = 'data-is-empty',\n    DBL_TAP_EVENT = 'dbltap',\n    SUPPORTS_TOUCH = 'ontouchend' in window,\n    TINYMCE_INSTALLED = 'tinyMCE' in window && typeof window.tinyMCE.init == 'function',\n\n    // reference to old is function\n    oldjQueryIs = $.fn.is,\n\n    /*\n     * Function responsible of triggering double tap event\n     */\n    lastTap = 0,\n    tapper = function() {\n        var now = new Date().getTime();\n        if( (now-lastTap) < 250 ) {\n            $(this).trigger(DBL_TAP_EVENT);\n        }\n        lastTap = now;\n    },\n\n    /**\n     * Event listener that largens font size\n     */\n    keyHandler = function(e) {\n        if( e.keyCode == 13 && e.data.closeOnEnter ) {\n            $currentlyEdited.editable('close');\n        }\n    else if( e.keyCode == 27 ) {\n            $textArea.val($currentlyEdited.attr('orig-text'));\n            $currentlyEdited.editable('close');\n        }\n        else if( e.data.toggleFontSize && (e.metaKey && (e.keyCode == 38 || e.keyCode == 40)) ) {\n            var fontSize = parseInt($textArea.css('font-size'), 10);\n            fontSize += e.keyCode == 40 ? -1 : 1;\n            $textArea.css('font-size', fontSize+'px');\n            return false;\n        }\n    },\n\n    /**\n     * Adjusts the height of the textarea to remove scroll\n     * @todo This way of doing it does not make the textarea smaller when the number of text lines gets smaller\n     */\n    adjustTextAreaHeight = function() {\n        if( $textArea[0].scrollHeight !== parseInt($textArea.attr('data-scroll'), 10) ) {\n            $textArea.css('height', $textArea[0].scrollHeight +'px');\n            $textArea.attr('data-scroll', $textArea[0].scrollHeight);\n        }\n    },\n\n    /**\n     * @param {jQuery} $el\n     * @param {String} newText\n     */\n    resetElement = function($el, newText, emptyMessage) {\n        $el.removeAttr(IS_EDITING_ATTR);\n\n        if (newText.length == 0 && emptyMessage) {\n            $el.html(emptyMessage);\n            $el.attr(EMPTY_ATTR, 'empty');\n        } else {\n            $el.html( newText );\n            $el.removeAttr(EMPTY_ATTR);\n        }\n        $textArea.remove();\n    },\n\n\n    /**\n     * Function creating editor\n     */\n    elementEditor = function($el, opts) {\n\n        if( $el.is(':editing') ) {\n            return;\n        }\n\n        $currentlyEdited = $el;\n        $el.attr(IS_EDITING_ATTR, '1');\n\n        if ($el.is(':empty')) {\n            $el.removeAttr(EMPTY_ATTR);\n            $el.html('');\n        }\n\n        var defaultText = $.trim( $el.html() ),\n            defaultFontSize = $el.css('font-size'),\n            elementHeight = $el.height(),\n            textareaStyle = 'width: 96%; padding:0; margin:0; border:0; background:none;'+\n                            'font-family: '+$el.css('font-family')+'; font-size: '+$el.css('font-size')+';'+\n                            'font-weight: '+$el.css('font-weight')+';';\n\n        $el.attr('orig-text', defaultText);\n        if( opts.lineBreaks ) {\n            defaultText = defaultText.replace(/<br( |)(|\\/)>/g, '\\n');\n        }\n\n        $textArea = $('<textarea></textarea>');\n        $el.text('');\n\n        // The editor should always be static\n        textareaStyle += 'position: static';\n\n        /*\n          TINYMCE EDITOR\n         */\n        if( opts.tinyMCE !== false ) {\n            var id = 'editable-area-'+(new Date().getTime());\n            $textArea\n                .val(defaultText)\n                .appendTo($el)\n                .attr('id', id);\n\n            if( typeof opts.tinyMCE != 'object' ) {\n                opts.tinyMCE = {};\n            }\n\n            opts.tinyMCE.mode = 'exact';\n            opts.tinyMCE.elements = id;\n            opts.tinyMCE.width = $el.innerWidth();\n            opts.tinyMCE.height = $el.height() + 200;\n            opts.tinyMCE.theme_advanced_resize_vertical = true;\n\n            opts.tinyMCE.setup = function (ed) {\n                ed.onInit.add(function(editor) {\n                    var editorWindow = editor.getWin();\n                    var hasPressedKey = false;\n                    var editorBlur = function() {\n\n                        var newText = $(editor.getDoc()).find('body').html();\n                        if( $(newText).get(0).nodeName == $el.get(0).nodeName ) {\n                            newText = $(newText).html();\n                        }\n\n                        // Update element and remove editor\n                        resetElement($el, newText, opts.emptyMessage);\n                        editor.remove();\n                        $textArea = false;\n                        $win.unbind('click', editorBlur);\n                        $currentlyEdited = false;\n\n                        // Run callback\n                        if( typeof opts.callback == 'function' ) {\n                            opts.callback({\n                                content : newText == defaultText || !hasPressedKey ? false : newText,\n                                fontSize : false,\n                                $el : $el\n                            });\n                        }\n                    };\n\n                    // Blur editor when user clicks outside the editor\n                    setTimeout(function() {\n                        $win.bind('click', editorBlur);\n                    }, 500);\n\n                    // Create a dummy textarea that will called upon when\n                    // programmatically interacting with the editor\n                    $textArea = $('<textarea></textarea>');\n                    $textArea.bind('blur', editorBlur);\n\n                    editorWindow.onkeydown = function() {\n                        hasPressedKey = true;\n                    };\n\n                    editorWindow.focus();\n                });\n            };\n\n            window.tinyMCE.init(opts.tinyMCE);\n        }\n\n        /*\n         TEXTAREA EDITOR\n         */\n        else {\n\n            if( opts.toggleFontSize || opts.closeOnEnter ) {\n                $win.bind('keydown', opts, keyHandler);\n            }\n            $win.bind('keyup', adjustTextAreaHeight);\n\n            $textArea\n                .html(defaultText)\n                .blur(function() {\n\n                    $currentlyEdited = false;\n\n                    // Get new text and font size\n                    var newText = $.trim( $textArea.val() ),\n                        newFontSize = $textArea.css('font-size');\n\n                    newText = $('<div />').text(newText).html();\n\n                    if( opts.lineBreaks ) {\n                        newText = newText.replace(new RegExp('\\\\n','g'), '<br />');\n                    }\n\n                    // Update element\n                    resetElement($el, newText, opts.emptyMessage);\n                    if( newFontSize != defaultFontSize ) {\n                        $el.css('font-size', newFontSize);\n                    }\n\n                    // remove textarea and size toggles\n                    $win.unbind('keydown', keyHandler);\n                    $win.unbind('keyup', adjustTextAreaHeight);\n\n                    // Run callback\n                    if( typeof opts.callback == 'function' ) {\n                        opts.callback({\n                            content : newText == defaultText ? false : newText,\n                            fontSize : newFontSize == defaultFontSize ? false : newFontSize,\n                            $el : $el\n                        });\n                    }\n                })\n                .attr('style', textareaStyle)\n                .appendTo($el)\n                .css({\n                    margin: 0,\n                    padding: 0,\n                    height : elementHeight +'px',\n                    overflow : 'hidden'\n                })\n                .css(opts.editorStyle)\n                .focus()\n                .get(0).select();\n\n            adjustTextAreaHeight();\n\n        }\n\n        $el.trigger('edit', [$textArea]);\n    },\n\n    /**\n     * Event listener\n     */\n    editEvent = function(event) {\n\n        if( $currentlyEdited !== false && !$currentlyEdited.children(\"textarea\").is(clickedElement)) {\n            // Not closing the currently open editor before opening a new\n            // editor makes things go crazy\n            $currentlyEdited.editable('close');\n            elementEditor($(this), event.data);\n        }\n        else {\n            elementEditor($(this), event.data);\n        }\n        return false;\n    };\n\n    /**\n     * Jquery plugin that makes elments editable\n     * @param {Object|String} [opts] Either callback function or the string 'destroy' if wanting to remove the editor event\n     * @return {jQuery|Boolean}\n     */\n    $.fn.editable = function(opts) {\n\n        if(typeof opts == 'string') {\n\n            if( this.is(':editable') ) {\n\n                switch (opts) {\n                    case 'open':\n                        if( !this.is(':editing') ) {\n                            this.trigger(this.attr(EVENT_ATTR));\n                        }\n                        break;\n                    case 'close':\n                        if( this.is(':editing') ) {\n                            $textArea.trigger('blur');\n                        }\n                        break;\n                    case 'destroy':\n                        if( this.is(':editing') ) {\n                            $textArea.trigger('blur');\n                        }\n                        this.unbind(this.attr(EVENT_ATTR));\n                        this.removeAttr(EVENT_ATTR);\n                        break;\n                    default:\n//                        console.warn('Unknown command \"'+opts+'\" for jquery.editable');\n                }\n\n            } else {\n//                console.error('Calling .editable() on an element that is not editable, call .editable() first');\n            }\n        }\n        else {\n\n            if( this.is(':editable') ) {\n//                console.warn('Making an already editable element editable, call .editable(\"destroy\") first');\n                this.editable('destroy');\n            }\n\n            opts = $.extend({\n                event : 'dblclick',\n                touch : true,\n                lineBreaks : true,\n                toggleFontSize : true,\n                closeOnEnter : false,\n                emptyMessage : false,\n                tinyMCE : false,\n                editorStyle : {}\n            }, opts);\n\n            if( opts.tinyMCE !== false && !TINYMCE_INSTALLED ) {\n//                console.warn('Trying to use tinyMCE as editor but id does not seem to be installed');\n                opts.tinyMCE = false;\n            }\n\n            if( SUPPORTS_TOUCH && opts.touch ) {\n                opts.event = DBL_TAP_EVENT;\n                this.unbind('touchend', tapper);\n                this.bind('touchend', tapper);\n            }\n            else {\n                opts.event += '.textEditor';\n            }\n\n            this.bind(opts.event, opts, editEvent);\n            this.attr(EVENT_ATTR, opts.event);\n\n            // If it is empty to start with, apply the empty message\n            if (this.html().length == 0 && opts.emptyMessage) {\n                this.html(opts.emptyMessage);\n                this.attr(EMPTY_ATTR, 'empty');\n            } else {\n                this.removeAttr(EMPTY_ATTR);\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Add :editable :editing to $.is()\n     * @param {Object} statement\n     * @return {*}\n     */\n    $.fn.is = function(statement) {\n        if( typeof statement == 'string' && statement.indexOf(':') === 0) {\n            if( statement == ':editable' ) {\n                return this.attr(EVENT_ATTR) !== undefined;\n            } else if( statement == ':editing' ) {\n                return this.attr(IS_EDITING_ATTR) !== undefined;\n            } else if( statement == ':empty' ) {\n                return this.attr(EMPTY_ATTR) !== undefined;\n            }\n        }\n        return oldjQueryIs.apply(this, arguments);\n    };\n\n    // The latest element clicked\n    var clickedElement;\n    $(document).mousedown(function(e) {\n        clickedElement = $(e.target);\n    });\n\n})(window.jQuery, window);\n"],"file":"jquery.editable.amd.min.js"}