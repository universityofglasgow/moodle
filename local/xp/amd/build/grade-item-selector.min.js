/**
 * Grade item selector.
 *
 * @copyright  2019 Frédéric Massart
 * @author     Frédéric Massart <fred@branchup.tech>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["jquery","block_xp/course-resource-selector","local_xp/grade-item-resource-selector"],(function($,CourseResourceSelector,GradeItemResourceSelector){var lastUsedCourse=null;return{init:function(selector,initWithCourse){initWithCourse=initWithCourse||lastUsedCourse;var container=$(selector),currentCourse=null,searchResultsContents=container.find(".search-result-contents"),courseSearchField=container.find(".search-term-course"),giSearchField=container.find(".search-term-grade-item"),cs=new CourseResourceSelector(searchResultsContents,courseSearchField);cs.onResourceSelected((function(e,resource){resource._iscourse&&selectCourse(resource.course)}));var gis=new GradeItemResourceSelector(searchResultsContents,giSearchField);function reset(){courseSearchField.val(""),giSearchField.val(""),cs.clear(),container.find(".cm-search").hide(),container.find(".course-search .course-not-selected").show(),container.find(".course-search .course-selected").hide(),currentCourse=null,courseSearchField.focus()}function selectCourse(course){currentCourse=course,lastUsedCourse=course,container.find(".course-search .course-selected span").text(course.fullname),container.find(".course-search .course-selected").show(),container.find(".course-search .course-not-selected").hide(),container.find(".cm-search").show(),cs.clear(),gis.initForCourse(course.id),giSearchField.val(""),giSearchField.focus()}gis.onResourceSelected((function(e,resource){resource._isgradeitem&&container.trigger("grade-item-selected",{gradeitem:resource.gradeitem,course:currentCourse})})),container.find(".course-selection-change").on("click",(function(){reset()})),initWithCourse?selectCourse(initWithCourse):reset()}}}));

//# sourceMappingURL=grade-item-selector.min.js.map