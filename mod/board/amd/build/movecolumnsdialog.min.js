function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}define("mod_board/movecolumnsdialog",["exports","core/modal_factory","core/modal_events","core/notification","core/str"],(function(_exports,_modal_factory,_modal_events,_notification,Str){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_notification=_interopRequireDefault(_notification),Str=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Str);var getDestinationsList=function(moveColumnControl){var columns=document.querySelectorAll(".mod_board .board_column"),currentColumn=moveColumnControl.closest(".board_column"),columnsArray=Array.from(columns),sortorder=columnsArray.indexOf(currentColumn),wrapper=document.createElement("div"),list=document.createElement("ul");return list.classList.add("move-column-dialog-destinations","list-unstyled"),Str.get_string("move_column_to_firstplace","mod_board").then((function(moveToFirstString){if(0!==sortorder){var li=document.createElement("li"),link=moveLink(currentColumn.dataset.ident,0,moveToFirstString);li.appendChild(link),list.appendChild(li)}return columns.forEach((function(column){var sortOrder=columnsArray.indexOf(column);if(currentColumn!=column){var columnName=column.querySelector(".mod_board_column_name").innerText;Str.get_string("move_column_to_aftercolumn","mod_board",columnName).then((function(moveToColumnString){var li=document.createElement("li"),link=moveLink(currentColumn.dataset.ident,sortOrder,moveToColumnString);return li.appendChild(link),list.appendChild(li),""})).catch(_notification.default.exception)}})),wrapper.appendChild(list),""})).catch(_notification.default.exception),wrapper.appendChild(list),wrapper},moveLink=function(movingColumnId,sortOrder,linkString){var link=document.createElement("a");return link.setAttribute("href","#"),link.dataset.movingcolumnid=movingColumnId,link.dataset.sortorder=sortOrder,link.innerText=linkString,link},displayMoveModal=function(moveColumnControl){var modalTitle=moveColumnControl.getAttribute("aria-label");_modal_factory.default.create({type:_modal_factory.default.types.CANCEL,title:modalTitle,body:getDestinationsList(moveColumnControl)}).then((function(modal){return modal.getRoot().on(_modal_events.default.hidden,(function(){modal.destroy()})),document.addEventListener("closemovedialog",(function(){modal.destroy()})),modal.show(),modal})).catch(_notification.default.exception)},_default={init:function(moveColumn){var body=document.querySelector("body");body.classList.contains("move-column-dialog-initialized")||(document.addEventListener("click",(function(e){var moveColumnControl=e.target.closest(".mod_column_move");moveColumnControl&&displayMoveModal(moveColumnControl);var moveDestination=e.target.closest(".move-column-dialog-destinations a");if(moveDestination){e.preventDefault();var payload={id:parseInt(moveDestination.dataset.movingcolumnid),sortorder:parseInt(moveDestination.dataset.sortorder)};moveColumn(payload),document.dispatchEvent(new Event("closemovedialog"))}})),document.addEventListener("keypress",(function(e){var moveColumnControl=e.target.closest(".mod_column_move");moveColumnControl&&displayMoveModal(moveColumnControl)})),body.classList.add("move-column-dialog-initialized"))}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=movecolumnsdialog.min.js.map