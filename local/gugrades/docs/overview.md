# Overview

This document describes the local_gugrades plugin aka the second generation of the GCAT project. This is the staff-facing application.

## General description

The code is organised as a conventional Moodle 'local' plugin. The facilities in lib.php are used to tie the plugin into the Moodle navigation. It appears in the 'More..' tab/menu of each Moodle course. This link maps to the index.php file which is located in the ui/dist folder (more about this later) with a single parameter - the course id. 

The user interface is coded in ['Vue.js'](https://vuejs.org/), in particular it utlises the [Vue CLI](https://cli.vuejs.org/) 'Vue standard tooling'.  See the [vue.md](vue.md) file for more details. 

The index.php file is quite simple. It contains the usual Moodle boilerplate - header, footer, login and capability checks, and so on. It loads a number of javascript libraries - these consist of both a Moodle AMD module defined in the plugin and the javascript generated by the Vue tooling. The actual page content contains only a div which will be controlled by Vue. 

As Vue runs entirely client-side, its interaction with Moodle is via web services. Normal Moodle web service calls are used. Each custom web service is given its own class in 'classes/external'. Most of the non-UI processing originates with these web services. 

The classes/ directory also contains a number of classes that contain static shared functions. These functions should be comprehensively commented. 

## Activity support classes

The classes/activities directory contains classes that support different activity types. When the user selects an activity (or as a result of a group of activities being processed) a factory method loads the correct class for the activity to be processed. The logic is that if the selection is a manual grade in the Gradebook the 'manual' class is chosen. If a specific class for the activity type exists (e.g. 'assign_activity') then that is chosen. Failing both, 'default_activity' will be used. The latter gives basic functionality for all graded activities. 

The methods that these classes need to implement are outlines in the Interface 'activity_interface'. Again, this should be comprehensively commented. 

The functionality of these classes surrounds requirements such as dealing with anonymous marking, extracting grades from the appropriate tables and so on. 

## AMD 'glue' logic

A small AMD module has been created to 'glue' Moodle javascript modules into the Vue code. See [amd.md](amd.md)