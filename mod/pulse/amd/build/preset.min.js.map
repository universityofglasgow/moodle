{"version":3,"sources":["../src/preset.js"],"names":["define","$","Modal","ModalPreset","PresetEvents","Str","Fragment","AJAX","Templates","Loadingicon","Notification","ModalEvents","SELECTOR","presetAvailability","Preset","contextId","courseid","section","loadPresetsList","prototype","listElement","pageparams","loadIconElement","actionbuttons","setupmodal","THIS","triggerelement","document","querySelectorAll","attachmentPoint","createElement","classList","add","forEach","element","addEventListener","presetid","getAttribute","presettitle","params","body","prepend","create","type","TYPE","title","get_string","loadFragment","large","then","modal","show","getRoot","on","bodyRendered","reinitAvailability","fieldChangedEvent","hidden","destroy","bind","customize","modform","querySelector","modformdata","FormData","get","form","formdata","URLSearchParams","toString","addIconToContainer","disableButtons","applyCustomize","save","e","preventDefault","restorePreset","catch","exception","confParam","getElementById","methods","fieldName","changeinput","id","changeName","split","field","event","target","value","reminder","schedule","method","opt","hasOwnProperty","selector","M","core_availability","resetRestrictPlugins","parentNode","removeChild","init","restrictByGroup","availabilityPlugins","plugins","plugin","i","addedEvents","contextID","done","html","js","handleFormSubmissionResponse","buttons","$i","disabled","data","newform","innerHTML","replaceNode","contextid","formdatastr","promises","call","methodname","args","response","JSON","parse","url","window","location","href","listParent","loaded","replaceNodeContents","setAttribute"],"mappings":"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","sourcesContent":["define(['jquery', 'core/modal_factory', 'mod_pulse/modal_preset', 'mod_pulse/events', 'core/str',\n'core/fragment', 'core/ajax', 'core/templates', 'core/loadingicon', 'core/notification', 'core/modal_events'],\n    function($, Modal, ModalPreset, PresetEvents, Str, Fragment, AJAX, Templates, Loadingicon, Notification, ModalEvents) {\n\n    var SELECTOR = {\n        presetAvailability: '.preset-config-params .availability-field'\n    };\n\n    /**\n     * Preset module declaration. Setup the global values.\n     * @param  {int} contextId\n     * @param  {int} courseid\n     * @param  {int} section\n     */\n    var Preset = function(contextId, courseid, section) {\n        this.contextId = contextId;\n        this.courseid = courseid;\n        this.section = section;\n        this.loadPresetsList();\n    };\n\n    Preset.prototype.listElement = {'selector': 'pulse-presets-data', \"loaded\": \"data-listloaded\"};\n\n    Preset.prototype.contextId = 0;\n\n    Preset.prototype.courseid = 0;\n\n    Preset.prototype.section = 0;\n\n    Preset.prototype.pageparams = [];\n\n    Preset.prototype.loadIconElement = '.modal-footer #loader-icon';\n\n    Preset.prototype.actionbuttons = '.modal-footer button';\n\n    /**\n     * Setup the presets modal event listeners.\n     */\n    Preset.prototype.setupmodal = function() {\n\n        var THIS = this;\n\n        var triggerelement = document.querySelectorAll('.pulse-usepreset');\n        // Modal attachment point.\n        var attachmentPoint = document.createElement('div');\n        attachmentPoint.classList.add('modal-preset');\n        triggerelement.forEach((element) => element.addEventListener('click', () => {\n            var presetid = element.getAttribute('data-presetid');\n            var presettitle = element.getAttribute('data-presettitle');\n            var params = {'presetid': presetid, 'courseid': THIS.courseid, 'section': THIS.section};\n\n            document.body.prepend(attachmentPoint);\n            Modal.create({\n                type: ModalPreset.TYPE,\n                title: Str.get_string('presetmodaltitle', 'pulse', {'title': presettitle}),\n                body: Fragment.loadFragment('mod_pulse', 'get_preset_preview', THIS.contextId, params),\n                large: true,\n            }).then(modal => {\n                // Make the modal attachment point to overcome the restriction access condition.\n                modal.attachmentPoint = attachmentPoint;\n                modal.show();\n                modal.getRoot().on(ModalEvents.bodyRendered, function() {\n                    THIS.reinitAvailability(SELECTOR.presetAvailability);\n                    THIS.fieldChangedEvent();\n                });\n                // Destroy the modal on hidden to reload the editors.\n                modal.getRoot().on(ModalEvents.hidden, function() {\n                    modal.destroy.bind(modal);\n                    THIS.reinitAvailability();\n                });\n\n                // Apply and customize method.\n                modal.getRoot().on(PresetEvents.customize, () => {\n                    var modform = document.querySelector('#mod-pulse-form');\n                    var modformdata = new FormData(modform);\n                    modal.getRoot().get(0).querySelectorAll('form').forEach(form => {\n                        var formdata = new FormData(form);\n                        formdata = new URLSearchParams(formdata).toString();\n                        var pageparams = new URLSearchParams(modformdata).toString();\n                        params = {formdata: formdata, pageparams: pageparams};\n\n                        Loadingicon.addIconToContainer(this.loadIconElement);\n                        THIS.disableButtons();\n                        THIS.applyCustomize(params, THIS.contextId, modal);\n                    });\n                });\n                // Apply and save method.\n                modal.getRoot().on(PresetEvents.save, (e) => {\n                    e.preventDefault();\n                    Loadingicon.addIconToContainer(this.loadIconElement);\n                    THIS.disableButtons();\n                    var formdata = {};\n                    modal.getRoot().get(0).querySelectorAll('form').forEach(form => {\n                        formdata = new FormData(form);\n                        this.restorePreset(formdata, THIS.contextId);\n                    });\n                });\n                return true;\n            }).catch(Notification.exception);\n        }));\n    };\n\n\n    Preset.prototype.fieldChangedEvent = () => {\n        var confParam = document.getElementById(\"preset-configurable-params\");\n        var reminders = ['first', 'second', 'recurring'];\n        var methods = ['fixed', 'relative'];\n        var fieldName, changeinput, id, changeName, split;\n        confParam.querySelectorAll('input, select, textarea').forEach(field => {\n            field.addEventListener('change', (event) => {\n                fieldName = event.target.getAttribute('name');\n                if (confParam.querySelector('input[name=\"' + fieldName + '_changed\"]') !== null) {\n                    confParam.querySelector('input[name=\"' + fieldName + '_changed\"]').value = true;\n                }\n            });\n        });\n\n        reminders.forEach(reminder => {\n            confParam.querySelectorAll('[name=\"' + reminder + '_schedule\"').forEach(schedule => {\n                schedule.addEventListener('change', (e) => {\n                    changeName = e.target.getAttribute('name');\n                    changeinput = 'input[name=\"' + changeName + '_arr_changed\"]';\n                    confParam.querySelector(changeinput).value = true;\n                });\n            });\n            methods.forEach(method => {\n                id = reminder + \"_\" + method + \"date\";\n                confParam.querySelectorAll('[name*=\"' + id + '\"]').forEach(opt => {\n                    opt.addEventListener('change', (e) => {\n                        split = e.target.getAttribute('name').split('[');\n                        changeName = (split.hasOwnProperty(1)) ? split[0] : split;\n                        changeinput = 'input[name=\"' + changeName + '_changed\"]';\n                        confParam.querySelector(changeinput).value = true;\n                    });\n                });\n            });\n        });\n    };\n\n    /**\n     * Reinitialize the availability javascript.\n     * @param {string} selector\n     */\n    Preset.prototype.reinitAvailability = function(selector = '.availability-field') {\n        if (typeof M.core_availability.form !== \"undefined\") {\n            this.resetRestrictPlugins();\n            document.querySelectorAll(selector).forEach((field) => field.parentNode.removeChild(field));\n            M.core_availability.form.init();\n        }\n    };\n\n    Preset.prototype.resetRestrictPlugins = function() {\n        if (typeof M.core_availability.form !== \"undefined\" && document.getElementById('id_availabilityconditionsjson') !== null) {\n            M.core_availability.form.restrictByGroup = null;\n            var availabilityPlugins = (typeof M.core_availability.form.plugins !== 'undefined')\n                ? M.core_availability.form.plugins : {};\n            var plugin = '';\n            for (var i in availabilityPlugins) {\n                plugin = \"availability_\" + i;\n                if (M.hasOwnProperty(plugin)) {\n                    M[plugin].form.addedEvents = false;\n                }\n            }\n        }\n    };\n\n    /**\n     * Apply and customize triggered using fragment. Response will replaced with current mod form.\n     * @param  {string} params\n     * @param  {int} contextID\n     * @param  {object} modal\n     */\n    Preset.prototype.applyCustomize = function(params, contextID, modal) {\n        Fragment.loadFragment('mod_pulse', 'apply_preset', contextID, params).done((html, js) => {\n            modal.destroy();\n            // Reset the availability to work for upcoming response html.\n            this.resetRestrictPlugins();\n            this.handleFormSubmissionResponse(html, js);\n        });\n    };\n\n    /**\n     * Disable the modal save and customize buttons to prevent reinit.\n     */\n    Preset.prototype.disableButtons = function() {\n        var buttons = document.querySelectorAll(this.actionbuttons);\n        for (let $i in buttons) {\n            buttons[$i].disabled = true;\n        }\n    };\n\n    /**\n     * Handle the loaded fragment output of customize method pulse mod.\n     * @param  {html} data\n     * @param  {string} js\n     */\n    Preset.prototype.handleFormSubmissionResponse = (data, js) => {\n        var newform = document.createElement('div');\n        newform.innerHTML = data;\n        Templates.replaceNode('[action=\"modedit.php\"]', data, js);\n\n    };\n\n    /**\n     * Initiate the apply and save method to create the pulse module with custom daa.\n     * @param  {FormData} formdata\n     * @param  {int} contextid\n     */\n    Preset.prototype.restorePreset = (formdata, contextid) => {\n        var formdatastr = new URLSearchParams(formdata).toString();\n        var promises = AJAX.call([{\n            methodname: 'mod_pulse_apply_presets',\n            args: {contextid: contextid, formdata: formdatastr}\n        }]);\n\n        promises[0].done((response) => {\n            response = JSON.parse(response);\n            if (typeof response.url != 'undefined') {\n                window.location.href = response.url;\n            }\n        });\n    };\n\n    /**\n     * Load list of available presets.\n     */\n    Preset.prototype.loadPresetsList = function() {\n        var listParent = document.getElementById(this.listElement.selector);\n\n        if (listParent !== null) {\n            if (listParent.getAttribute(this.listElement.loaded) == 'false') {\n                Fragment.loadFragment('mod_pulse', 'get_presetslist', this.contextId, {'courseid': this.courseid})\n                .done((html, js) => {\n                    Templates.replaceNodeContents(listParent, html, js);\n                    listParent.setAttribute(this.listElement.loaded, 'true');\n                    this.setupmodal();\n                });\n            }\n        }\n    };\n\n    return {\n        init: (contextId, courseid, section) => {\n            new Preset(contextId, courseid, section);\n        }\n    };\n});\n"],"file":"preset.min.js"}