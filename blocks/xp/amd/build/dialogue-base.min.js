define(["jquery","core/yui","core/str"],function(a,b,c){function d(){this._eventNode=a("<div>");var c=a.Deferred();this._ready=c.promise(),b.use("moodle-core-notification",function(){this._init().then(function(){c.resolve()})}.bind(this))}return d.prototype._dialogue=null,d.prototype._eventNode=null,d.prototype._ready=null,d.prototype._title="&hellip;",d.prototype.center=function(){this._dialogue.centerDialogue()},d.prototype._init=function(){var d,e=a.Deferred(),f=b.Node.create('<p style="text-align: center;"><img src="'+M.util.image_url("y/loading")+'" alt=""></p>');d=new M.core.dialogue({draggable:!0,modal:!0,width:"600px"}),this._dialogue=d;var g=d.hide;return d.hide=function(){g.apply(d,arguments),this.destroy()}.bind(d),d.getStdModNode(b.WidgetStdMod.HEADER).prepend(b.Node.create("<h1>")),this._updateDialogueTitle(),this._setDialogueContent(f),e.resolve(),this._render().fail(function(){c.get_string("error","core").then(function(a){return a}).fail(function(){return""}).always(function(a){this._setDialogueContent(a)}.bind(this))}.bind(this)),e.promise()},d.prototype.close=function(){this.trigger("dialogue-closed"),this._dialogue.destroy(),this._eventNode=null},d.prototype.find=function(c){return a(this._dialogue.getStdModNode(b.WidgetStdMod.BODY).getDOMNode()).find(c)},d.prototype.on=function(a,b){this._eventNode.on(a,b)},d.prototype._render=function(){},d.prototype.show=function(a){this._ready.then(function(){this._dialogue.show(a)}.bind(this))},d.prototype._setDialogueContent=function(a){this._dialogue.setStdModContent(b.WidgetStdMod.BODY,a,b.WidgetStdMod.REPLACE)},d.prototype.setTitle=function(a){this._title=a,this._updateDialogueTitle()},d.prototype.trigger=function(a,b){this._eventNode.trigger(a,b)},d.prototype._updateDialogueTitle=function(){this._dialogue&&this._dialogue.getStdModNode(b.WidgetStdMod.HEADER).one("h1").setHTML(this._title)},d});