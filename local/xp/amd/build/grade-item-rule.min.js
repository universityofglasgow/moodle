define ("local_xp/grade-item-rule",["jquery","core/templates","core/str","block_xp/dialogue-base"],function(a,b,c,d){function f(a,b){this.initWithCourse=a||null;this.canChangeCourse=b;d.prototype.constructor.apply(this,[])}f.prototype=Object.create(d.prototype);f.prototype.constructor=f;f.prototype._render=function(){var a=JSON.stringify(this.initWithCourse);return c.get_string("gradeitemselector","local_xp").then(function(c){return b.render("local_xp/grade-item-selector",{canchangecourse:this.canChangeCourse,initwithcoursejson:a}).then(function(a,d){this.setTitle(c);this._setDialogueContent(a);b.runTemplateJS(d);this.center();this.find(".local_xp-grade-item-selector-widget").on("grade-item-selected",function(a,b){this.trigger("grade-item-selected",b);this.close()}.bind(this))}.bind(this))}.bind(this))};return{init:function(b,c){a(".block-xp-filters").on("click",".local_xp-grade-item-rule-widget button",function(g){g.preventDefault();var h=a(g.target).closest(".local_xp-grade-item-rule-widget");if(!h){return}var i=new f(b,c);i.on("grade-item-selected",function(a,b){var d=b.gradeitem,e=b.course,f=c?"rulegradeitemdescwithcourse":"rulegradeitemdesc";h.find(".grade-item-rule-itemid").val(d.id);h.find(".grade-item-selected").text(M.util.get_string(f,"local_xp",{gradeitemname:d.name,coursename:e.shortname}));h.addClass("has-grade-item")});i.show()})}}});
//# sourceMappingURL=grade-item-rule.min.js.map
