define ("tool_pluginskel/addmore",["jquery"],function(a){var b={deleteElements:function deleteElements(c,d,e){var f,g;if(e){var h=d[0];f=d[1];g=h+"_"+f}else{f=d[0];g=f}var l=g+"count",m=parseInt(a("[name=\""+l+"\"]").val()),n;for(var o in c){if(c[o].name==f){n=c[o];break}}if(1==m){var p="id_"+g+"_0";b.removeInputFromNode(n,p);return}var q=m-1;a("#id_"+g+" br").last().remove();for(o in n.values){var r=n.values[o],s="fitem_id_"+g+"_"+q+"_"+r.name;a("#"+s).remove();if("numeric-array"===r.type){var t=g+"_"+q+"_"+r.name+"count",u=parseInt(a("[name='"+t+"']").val());if(2<=u){a("#id_"+g+" br").slice(-(u-1)).remove()}for(var v in r.values){for(var j=r.values[v],w=0,x;w<u;w++){x=s+"_"+w+"_"+j.name;a("#"+x).remove()}}var y="fitem_id_addmore_"+g+"_"+q+"_"+r.name;a("#"+y).remove();a("[name='"+t+"']").remove()}}a("[name=\""+l+"\"]").val(m-1)},addMoreRootElements:function addMoreRootElements(c,d,e){var f,g,h;if(e){var k=d[0];f=d[1];g=k+"["+f+"]";h=k+"_"+f}else{f=d[0];g=f;h=f}var l=h+"count",m=parseInt(a("[name=\""+l+"\"]").val()),n;for(var o in c){if(c[o].name==f){n=c[o];break}}var p=m-1,q,r="<br/>";for(o in n.values){var s=n.values[o],t=g+"["+m+"]["+s.name+"]",u="id_"+h+"_"+m+"_"+s.name,v=g+"["+p+"]["+s.name+"]",w="id_"+h+"_"+p+"_"+s.name;if("numeric-array"==s.type){var x=a("#fitem_"+w).attr("class");r+="<div id=\"fitem_"+u+"\" class=\""+x+"\">";r+=a("#fitem_"+w).html();r+="</div>";for(var y in s.values){var j=s.values[y],z=t+"[0]["+j.name+"]",A=u+"_0_"+j.name,B=v+"[0]["+j.name+"]",C=w+"_0_"+j.name;r+=b.copyElement(B,C,z,A,p+".0",m+".0")}var D="id_addmore_"+h+"_"+m+"_"+s.name,E="addmore_"+g+"["+m+"]["+s.name+"]",F="id_addmore_"+h+"_"+p+"_"+s.name,G="addmore_"+g+"["+p+"]["+s.name+"]";r+=b.copyElement(G,F,E,D,null,null);var H=h+"_"+p+"_"+s.name+"count",I=h+"_"+m+"_"+s.name+"count";a("[name=\""+H+"\"]").after("<input name=\""+I+"\" value=\"1\" type=\"hidden\"></input>")}else{r+=b.copyElement(v,w,t,u,p,m)}}a("#fgroup_id_buttons_"+h).before(r);q="id_"+h+"_"+m;b.removeInputFromNode(n,q);a("[name=\""+l+"\"]").val(m+1)},addMoreNestedElements:function addMoreNestedElements(c,d,e,f){var g,h,k,l,m;if(f){if(e){g=d[0]+"["+d[1]+"]["+d[2]+"]";h=d[0]+"_"+d[1]+"_"+d[2];k=d[1];l=d[2]}else{g=d[0]+"["+d[1]+"]";h=d[0]+"_"+d[1];k=d[0];l=d[1]}m=null}else{if(e){g=d[0]+"["+d[1]+"]["+d[2]+"]";g=g+"["+d[3]+"]";h=d[0]+"_"+d[1]+"_"+d[2]+"_"+d[3];k=d[1];l=d[3];m=d[2]}else{g=d[0]+"["+d[1]+"]["+d[2]+"]";h=d[0]+"_"+d[1]+"_"+d[2];k=d[0];l=d[2];m=d[1]}}var n=h+"count",o=parseInt(a("[name=\""+n+"\"]").val()),p;for(var q in c){if(c[q].name==k){for(var r in c[q].values){if(c[q].values[r].name==l){p=c[q].values[r];break}}}}var j=o-1,s="<br/>";for(q in p.values){var t=p.values[q],u=g+"["+o+"]["+t.name+"]",v="id_"+h+"_"+o+"_"+t.name,w=g+"["+j+"]["+t.name+"]",x="id_"+h+"_"+j+"_"+t.name,y,z;if(null===m){y=j;z=o}else{y=m+"."+j;z=m+"."+o}s+=b.copyElement(w,x,u,v,y,z)}a("#fitem_id_addmore_"+h).before(s);var A="id_"+h+"_"+o;b.removeInputFromNode(p,A);a("[name=\""+n+"\"]").val(o+1)},removeInputFromNode:function removeInputFromNode(c,d){for(var e in c.values){var f=c.values[e],g=d+"_"+f.name;if("text"==f.type||"int"==f.type){a("#"+g).val("")}if("multiple-options"==f.type||"boolean"==f.type){var h="required"in f&&!0===f.required;if(!h){a("#"+g+" option[value=\"undefined\"]").prop("selected",!0).change()}}if("numeric-array"==f.type){for(var i=g.replace("id_","")+"count",k=parseInt(a("[name=\""+i+"\"]").val()),l=0,m;l<k;l++){m=g+"_"+l;b.removeInputFromNode(f,m)}}}},copyElement:function copyElement(b,c,d,e,f,g){var h=a("#fitem_"+c).attr("class"),i=a("#fitem_"+c).html();while(-1!=i.indexOf(c)){i=i.replace(c,e)}while(-1!=i.indexOf(b)){i=i.replace(b,d)}if(null!==f){f=f+". ";g=g+". ";i=i.replace("label for=\""+e+"\">"+f,"label for=\""+e+"\">"+g)}var j="<div id=\"fitem_"+e+"\" class=\""+h+"\">";j+=i;j+="</div>";return j},addMore:function addMore(){a(document).ready(function(){a(".mform").on("click",":button",function(c){var d=c.target.name;if(-1!==d.indexOf("addmore_")||-1!==d.indexOf("delete_")){var e=a.parseJSON(a("[name=\"templatevars\"]").val()),f=a("[name=\"componenttype1\"]").val(),g,h;if(-1!==d.indexOf("addmore_")){g=!0;h=d.replace("addmore_","")}else{h=d.replace("delete_","");g=!1}var j=h.split(/\]\[|\[|\]/gi);if(0===j[j.length-1].length){j.pop()}var k;if(j[0]===f+"_features"){k=!0}else{k=!1}var l=!1;for(var m in j){if(a.isNumeric(j[m])){l=!0;break}}var i=!1;if(!l){if(k&&3===j.length){l=!0;i=!0}if(!k&&2===j.length){l=!0;i=!0}}if(g){if(l){b.addMoreNestedElements(e,j,k,i)}else{b.addMoreRootElements(e,j,k)}}else{b.deleteElements(e,j,k)}}})})}};return b});
//# sourceMappingURL=addmore.min.js.map
