{"version":3,"file":"edit_course.min.js","sources":["../src/edit_course.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Main Javascript module for format_tiles for when user *IS* editing.\n * See course.js for if they are not editing.\n * Handles the UI changes when tiles are selected and anything else not\n * covered by the specific modules\n *\n * @module format_tiles/edit_course\n * @copyright 2019 David Watson {@link http://evolutioncode.uk}\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since Moodle 3.3\n */\n\n/* eslint space-before-function-paren: 0 */\n\ndefine(\n    [\"jquery\", \"core/config\", \"core/str\", \"core/ajax\", \"format_tiles/edit_browser_storage\"],\n    function($, config, str, ajax, browserStorageEdit) {\n        \"use strict\";\n\n        var courseId;\n\n        return {\n            // All args down to \"filttilestowidth\" are copied from course.js.\n            init: function(\n                courseIdInit,\n                useJavascriptNav, // Set by site admin see settings.php.\n                isMobile,\n                sectionNum,\n                useFilterButtons,\n                assumeDataStoreConsent, // Set by site admin see settings.php.\n                reopenLastSection, // Set by site admin see settings.php.\n                userId,\n                fitTilesToWidth,\n                enablecompletion,\n                useSubTiles,\n                pageType,\n                allowPhotoTiles,\n                documentationurl\n            ) {\n                courseId = courseIdInit;\n                // Some args are strings or ints but we prefer bool.  Change to bool now as they are passed on elsewhere.\n                assumeDataStoreConsent = assumeDataStoreConsent === \"1\";\n                // This is also called from lib.php, via edit_form_helper, if user is on course/edit.php or editsection.php.\n                require(['format_tiles/edit_icon_picker'], function(iconPicker) {\n                    iconPicker.init(courseId, pageType, allowPhotoTiles, documentationurl);\n                });\n\n                $(document).ready(function() {\n\n                    // If the user preference is for JS off, or site admin has disabled, or user is mobile, no JS nav.\n                    if (useJavascriptNav && !isMobile) {\n                        var collapsingAllSectionFromURL = (window.location.search).indexOf(\"expanded=-1\") !== -1;\n                        var finalSectionInCourse = $(\"li.section.main\").last().data(\"section\");\n                        browserStorageEdit.init(\n                            userId,\n                            courseId,\n                            assumeDataStoreConsent,\n                            finalSectionInCourse,\n                            collapsingAllSectionFromURL\n                        );\n                    }\n\n                    if (!isMobile) {\n                        // Initialise tooltips shown for example when hover over tile icon \"Click to change icon\".\n                        // But not on mobile as they make clicks harder.\n                        var toolTips = $(\"[data-toggle=tooltip]\");\n                        if (toolTips.length !== 0 && typeof toolTips.tooltip == 'function') {\n                            try {\n                                toolTips.tooltip();\n                            } catch (err) {\n                                require([\"core/log\"], function(log) {\n                                    log.debug(err);\n                                });\n                            }\n                        }\n                    }\n\n                    const anchor = window.location.hash;\n                    if (anchor) {\n                        const section = anchor.replace('#section-', '', anchor);\n                        const courseContent = $('#coursecontentcollapse' + section);\n                        if (courseContent && !courseContent.hasClass('show')) {\n                            courseContent.addClass('show');\n                            $('#collapssesection' + section).removeClass('collapsed').attr('aria-expanded', true);\n                        }\n                    }\n                });\n            }\n        };\n    }\n);"],"names":["define","$","config","str","ajax","browserStorageEdit","courseId","init","courseIdInit","useJavascriptNav","isMobile","sectionNum","useFilterButtons","assumeDataStoreConsent","reopenLastSection","userId","fitTilesToWidth","enablecompletion","useSubTiles","pageType","allowPhotoTiles","documentationurl","require","iconPicker","document","ready","collapsingAllSectionFromURL","window","location","search","indexOf","finalSectionInCourse","last","data","toolTips","length","tooltip","err","log","debug","anchor","hash","section","replace","courseContent","hasClass","addClass","removeClass","attr"],"mappings":";;;;;;;;;;;AA6BAA,kCACI,CAAC,SAAU,cAAe,WAAY,YAAa,sCACnD,SAASC,EAAGC,OAAQC,IAAKC,KAAMC,wBAGvBC,eAEG,CAEHC,KAAM,SACFC,aACAC,iBACAC,SACAC,WACAC,iBACAC,uBACAC,kBACAC,OACAC,gBACAC,iBACAC,YACAC,SACAC,gBACAC,kBAEAf,SAAWE,aAEXK,uBAAoD,MAA3BA,uBAEzBS,QAAQ,CAAC,kCAAkC,SAASC,YAChDA,WAAWhB,KAAKD,SAAUa,SAAUC,gBAAiBC,qBAGzDpB,EAAEuB,UAAUC,OAAM,cAGVhB,mBAAqBC,SAAU,KAC3BgB,6BAAmF,IAApDC,OAAOC,SAASC,OAAQC,QAAQ,eAC/DC,qBAAuB9B,EAAE,mBAAmB+B,OAAOC,KAAK,WAC5D5B,mBAAmBE,KACfQ,OACAT,SACAO,uBACAkB,qBACAL,iCAIHhB,SAAU,KAGPwB,SAAWjC,EAAE,4BACO,IAApBiC,SAASC,QAA2C,mBAApBD,SAASE,YAErCF,SAASE,UACX,MAAOC,KACLf,QAAQ,CAAC,aAAa,SAASgB,KAC3BA,IAAIC,MAAMF,eAMpBG,OAASb,OAAOC,SAASa,QAC3BD,OAAQ,OACFE,QAAUF,OAAOG,QAAQ,YAAa,GAAIH,QAC1CI,cAAgB3C,EAAE,yBAA2ByC,SAC/CE,gBAAkBA,cAAcC,SAAS,UACzCD,cAAcE,SAAS,QACvB7C,EAAE,oBAAsByC,SAASK,YAAY,aAAaC,KAAK,iBAAiB"}