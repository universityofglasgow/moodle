{"version":3,"file":"launcher.min.js","sources":["../src/launcher.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Launch an app.\n *\n * @copyright  2021 Frédéric Massart\n * @author     Frédéric Massart <fred@branchup.tech>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/notification'], function($, Notification) {\n\n    /**\n     * App launcher.\n     *\n     * @param {String} mod The module name.\n     * @param {String} rootId The root ID.\n     * @param {String} propsId The props ID.\n     */\n    function launcher(mod, rootId, propsId) {\n\n        // Load the app module. By convension a module app needs to return\n        // an object with two properties: `dependencies`, and `startApp`.\n        require([mod], function(mod) {\n            var dependencies = [];\n            var dependenciesLoadedCallback = function() {\n                return;\n            };\n\n            // If the module defines dependencies, set them up..\n            if (mod.dependencies) {\n                dependencies = mod.dependencies.list;\n                dependenciesLoadedCallback = mod.dependencies.loader;\n            }\n\n            // Load the dependencies.\n            var loader = $.Deferred();\n            require(dependencies, function() {\n                loader.resolve(arguments);\n            });\n\n            // Once the deps are loaded, pass them to the the app, and start the app.\n            loader.then(function(depsArg) {\n                var deps = [].slice.call(depsArg);\n                dependenciesLoadedCallback(deps);\n                var props = JSON.parse(document.getElementById(propsId).textContent);\n                mod.startApp(document.getElementById(rootId), props);\n                return;\n            }).catch(Notification.exception);\n\n        });\n    }\n\n    return launcher;\n});\n"],"names":["define","$","Notification","mod","rootId","propsId","require","dependencies","dependenciesLoadedCallback","list","loader","Deferred","resolve","arguments","then","depsArg","deps","slice","call","props","JSON","parse","document","getElementById","textContent","startApp","catch","exception"],"mappings":";;;;;;;AAuBAA,2BAAO,CAAC,SAAU,sBAAsB,SAASC,EAAGC,8BAS9BC,IAAKC,OAAQC,SAI3BC,QAAQ,CAACH,MAAM,SAASA,SAChBI,aAAe,GACfC,2BAA6B,aAK7BL,IAAII,eACJA,aAAeJ,IAAII,aAAaE,KAChCD,2BAA6BL,IAAII,aAAaG,YAI9CA,OAAST,EAAEU,WACfL,QAAQC,cAAc,WAClBG,OAAOE,QAAQC,cAInBH,OAAOI,MAAK,SAASC,aACbC,KAAO,GAAGC,MAAMC,KAAKH,SACzBP,2BAA2BQ,UACvBG,MAAQC,KAAKC,MAAMC,SAASC,eAAelB,SAASmB,aACxDrB,IAAIsB,SAASH,SAASC,eAAenB,QAASe,UAE/CO,MAAMxB,aAAayB"}