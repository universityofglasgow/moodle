function _typeof(e){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}define ("qtype_stack/jsxgraphcore-lazy",function(){var requirejs,require,define;(function(e){var c,p,u,h,m={},g={},b={},C={},y=Object.prototype.hasOwnProperty,v=[].slice,f=/\.js$/;function t(e,t){return y.call(e,t)}function r(e,t){var r,o,s,n,a,d,l,c,p,u,h,m,g=t&&t.split("/"),C=b.map,y=C&&C["*"]||{};if(e){e=e.split("/");a=e.length-1;if(b.nodeIdCompat&&f.test(e[a])){e[a]=e[a].replace(f,"")}if("."===e[0].charAt(0)&&g){m=g.slice(0,g.length-1);e=m.concat(e)}for(p=0;p<e.length;p++){h=e[p];if("."===h){e.splice(p,1);p-=1}else if(".."===h){if(0===p||1===p&&".."===e[2]||".."===e[p-1]){continue}else if(0<p){e.splice(p-1,2);p-=2}}}e=e.join("/")}if((g||y)&&C){r=e.split("/");for(p=r.length;0<p;p-=1){o=r.slice(0,p).join("/");if(g){for(u=g.length;0<u;u-=1){s=C[g.slice(0,u).join("/")];if(s){s=s[o];if(s){n=s;d=p;break}}}}if(n){break}if(!l&&y&&y[o]){l=y[o];c=p}}if(!n&&l){n=l;d=c}if(n){r.splice(0,d,n);e=r.join("/")}}return e}function o(t,r){return function(){var o=v.call(arguments,0);if("string"!=typeof o[0]&&1===o.length){o.push(null)}return p.apply(e,o.concat([t,r]))}}function i(e){return function(t){return r(t,e)}}function s(e){return function(t){m[e]=t}}function n(r){if(t(g,r)){var o=g[r];delete g[r];C[r]=!0;c.apply(e,o)}if(!t(m,r)&&!t(C,r)){throw new Error("No "+r)}return m[r]}function a(e){var t,r=e?e.indexOf("!"):-1;if(-1<r){t=e.substring(0,r);e=e.substring(r+1,e.length)}return[t,e]}function d(e){return e?a(e):[]}u=function(e,t){var o,s=a(e),d=s[0],l=t[1];e=s[1];if(d){d=r(d,l);o=n(d)}if(d){if(o&&o.normalize){e=o.normalize(e,i(l))}else{e=r(e,l)}}else{e=r(e,l);s=a(e);d=s[0];e=s[1];if(d){o=n(d)}}return{f:d?d+"!"+e:e,n:e,pr:d,p:o}};function l(e){return function(){return b&&b.config&&b.config[e]||{}}}h={require:function(e){return o(e)},exports:function exports(t){var r=m[t];if("undefined"!=typeof r){return r}else{return m[t]={}}},module:function module(e){return{id:e,uri:"",exports:m[e],config:l(e)}}};c=function(r,a,l,c){var p,b,y,v,f,P,_=[],S=_typeof(l),E;c=c||r;P=d(c);if("undefined"===S||"function"===S){a=!a.length&&l.length?["require","exports","module"]:a;for(f=0;f<a.length;f+=1){v=u(a[f],P);b=v.f;if("require"===b){_[f]=h.require(r)}else if("exports"===b){_[f]=h.exports(r);E=!0}else if("module"===b){p=_[f]=h.module(r)}else if(t(m,b)||t(g,b)||t(C,b)){_[f]=n(b)}else if(v.p){v.p.load(v.n,o(c,!0),s(b),{});_[f]=m[b]}else{throw new Error(r+" missing "+b)}}y=l?l.apply(m[r],_):void 0;if(r){if(p&&p.exports!==e&&p.exports!==m[r]){m[r]=p.exports}else if(y!==e||!E){m[r]=y}}}else if(r){m[r]=l}};requirejs=require=p=function req(t,r,o,i,s){if("string"==typeof t){if(h[t]){return h[t](r)}return n(u(t,d(r)).f)}else if(!t.splice){b=t;if(b.deps){p(b.deps,b.callback)}if(!r){return}if(r.splice){t=r;r=o;o=null}else{t=e}}r=r||function(){};if("function"==typeof o){o=i;i=s}if(i){c(e,t,r,o)}else{setTimeout(function(){c(e,t,r,o)},4)}return p};p.config=function(e){return p(e)};requirejs._defined=m;define=function(e,r,o){if("string"!=typeof e){throw new Error("See almond README: incorrect module build, no module name")}if(!r.splice){o=r;r=[]}if(!t(m,e)&&!t(g,e)){g[e]=[e,r,o]}};define.amd={jQuery:!0}})();define("../node_modules/almond/almond",function(){});define("jxg",[],function(){"use strict";var t={};if("object"===("undefined"==typeof JXG?"undefined":_typeof(JXG))&&!JXG.extend){t=JXG}t.extend=function(t,r,o,i){var s,n;o=o||!1;i=i||!1;for(s in r){if(!o||o&&r.hasOwnProperty(s)){if(i){n=s.toLowerCase()}else{n=s}t[n]=r[s]}}};t.extend(t,{boards:{},readers:{},elements:{},registerElement:function registerElement(e,t){e=e.toLowerCase();this.elements[e]=t},registerReader:function registerReader(t,r){var o,s;for(o=0;o<r.length;o++){s=r[o].toLowerCase();if("function"!=typeof this.readers[s]){this.readers[s]=t}}},shortcut:function shortcut(e,t){return function(){return e[t].apply(this,arguments)}},getRef:function getRef(e,r){t.deprecated("JXG.getRef()","Board.select()");return e.select(r)},getReference:function getReference(e,r){t.deprecated("JXG.getReference()","Board.select()");return e.select(r)},getBoardByContainerId:function getBoardByContainerId(e){for(var t in JXG.boards){if(JXG.boards.hasOwnProperty(t)&&JXG.boards[t].container===e){return JXG.boards[t]}}return null},deprecated:function deprecated(e,r){var o=e+" is deprecated.";if(r){o+=" Please use "+r+" instead."}t.warn(o)},warn:function warn(e){if("object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.console&&console.warn){console.warn("WARNING:",e)}else if("object"===("undefined"==typeof document?"undefined":_typeof(document))&&document.getElementById("warning")){document.getElementById("debug").innerHTML+="WARNING: "+e+"<br />"}},debugInt:function debugInt(){var e,t;for(e=0;e<arguments.length;e++){t=arguments[e];if("object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.console&&console.log){console.log(t)}else if("object"===("undefined"==typeof document?"undefined":_typeof(document))&&document.getElementById("debug")){document.getElementById("debug").innerHTML+=t+"<br/>"}}},debugWST:function debugWST(){var r=new Error;t.debugInt.apply(this,arguments);if(r&&r.stack){t.debugInt("stacktrace");t.debugInt(r.stack.split("\n").slice(1).join("\n"))}},debugLine:function debugLine(){var r=new Error;t.debugInt.apply(this,arguments);if(r&&r.stack){t.debugInt("Called from",r.stack.split("\n").slice(2,3).join("\n"))}},debug:function debug(){t.debugInt.apply(this,arguments)}});return t});define("base/constants",["jxg"],function(e){"use strict";var t="0.99.7"+"",r;r={version:"0.99.7",licenseText:"JSXGraph v0.99.7 Copyright (C) see http://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82};e.extend(e,r);return r});define("utils/type",["jxg","base/constants"],function(e,t){"use strict";e.extend(e,{isId:function isId(e,t){return"string"==typeof t&&!!e.objects[t]},isName:function isName(e,t){return"string"==typeof t&&!!e.elementsByName[t]},isGroup:function isGroup(e,t){return"string"==typeof t&&!!e.groups[t]},isString:function isString(e){return"string"==typeof e},isNumber:function isNumber(e){return"number"==typeof e||"[Object Number]"===Object.prototype.toString.call(e)},isFunction:function isFunction(e){return"function"==typeof e},isArray:function isArray(e){var t;if(Array.isArray){t=Array.isArray(e)}else{t=null!==e&&"object"===_typeof(e)&&"function"==typeof e.splice&&"function"==typeof e.join}return t},isObject:function isObject(e){return"object"===_typeof(e)&&!this.isArray(e)},isPoint:function isPoint(e){if(null!==e&&"object"===_typeof(e)){return e.elementClass===t.OBJECT_CLASS_POINT}return!1},isPointType:function isPointType(e,t){var r,o;if(this.isArray(t)){return!0}if(this.isFunction(t)){r=t();if(this.isArray(r)&&1<r.length){return!0}}o=e.select(t);return this.isPoint(o)},isTransformationOrArray:function isTransformationOrArray(e){if(null!==e){if(this.isArray(e)&&0<e.length){return this.isTransformationOrArray(e[0])}else if("object"===_typeof(e)){return e.type===t.OBJECT_TYPE_TRANSFORMATION}}return!1},exists:function(e){return function(t){return!(t===e||null===t)}}(),def:function def(e,t){if(this.exists(e)){return e}return t},str2Bool:function str2Bool(e){if(!this.exists(e)){return!0}if("boolean"==typeof e){return e}if(this.isString(e)){return"true"===e.toLowerCase()}return!1},createEvalFunction:function createEvalFunction(t,r,o){var s=[],n;for(n=0;n<o;n++){s[n]=e.createFunction(r[n],t,"",!0)}return function(e){return s[e]()}},createFunction:function createFunction(e,t,r,o){var i=null;if((!this.exists(o)||o)&&this.isString(e)){i=t.jc.snippet(e,!0,r,!0)}else if(this.isFunction(e)){i=e}else if(this.isNumber(e)){i=function(){return e}}else if(this.isString(e)){i=function(){return e}}if(null!==i){i.origin=e}return i},providePoints:function providePoints(e,t,r,o,s){var n,a,d,l=0,c=[],p,u;if(!this.isArray(t)){t=[t]}d=t.length;if(this.exists(s)){l=s.length}if(0===l){p=this.copyAttributes(r,e.options,o)}for(n=0;n<d;++n){if(0<l){a=Math.min(n,l-1);p=this.copyAttributes(r,e.options,o,s[a])}if(this.isArray(t[n])&&1<t[n].length){c.push(e.create("point",t[n],p))}else if(this.isFunction(t[n])){u=t[n]();if(this.isArray(u)&&1<u.length){c.push(e.create("point",[t[n]],p))}}else{c.push(e.select(t[n]))}if(!this.isPoint(c[n])){return!1}}return c},bind:function bind(e,t){return function(){return e.apply(t,arguments)}},evaluate:function evaluate(e){if(this.isFunction(e)){return e()}return e},indexOf:function indexOf(e,t,r){var o,n=this.exists(r);if(Array.indexOf&&!n){return e.indexOf(t)}for(o=0;o<e.length;o++){if(n&&e[o][r]===t||!n&&e[o]===t){return o}}return-1},eliminateDuplicates:function eliminateDuplicates(e){var t,r=e.length,o=[],s={};for(t=0;t<r;t++){s[e[t]]=0}for(t in s){if(s.hasOwnProperty(t)){o.push(t)}}return o},swap:function swap(e,t,r){var o=e[t];e[t]=e[r];e[r]=o;return e},uniqueArray:function uniqueArray(t){var r,o,s,n=[];if(0===t.length){return[]}for(r=0;r<t.length;r++){s=this.isArray(t[r]);if(!this.exists(t[r])){t[r]="";continue}for(o=r+1;o<t.length;o++){if(s&&e.cmpArrays(t[r],t[o])){t[r]=[]}else if(!s&&t[r]===t[o]){t[r]=""}}}o=0;for(r=0;r<t.length;r++){s=this.isArray(t[r]);if(!s&&""!==t[r]){n[o]=t[r];o++}else if(s&&0!==t[r].length){n[o]=t[r].slice(0);o++}}t=n;return n},isInArray:function isInArray(t,r){return-1<e.indexOf(t,r)},coordsArrayToMatrix:function coordsArrayToMatrix(e,t){var r,o=[],s=[];for(r=0;r<e.length;r++){if(t){o.push(e[r].usrCoords[1]);s.push(e[r].usrCoords[2])}else{s.push([e[r].usrCoords[1],e[r].usrCoords[2]])}}if(t){s=[o,s]}return s},cmpArrays:function cmpArrays(e,t){var r;if(e===t){return!0}if(e.length!==t.length){return!1}for(r=0;r<e.length;r++){if(this.isArray(e[r])&&this.isArray(t[r])){if(!this.cmpArrays(e[r],t[r])){return!1}}else if(e[r]!==t[r]){return!1}}return!0},removeElementFromArray:function removeElementFromArray(e,t){var r;for(r=0;r<e.length;r++){if(e[r]===t){e.splice(r,1);return e}}return e},trunc:function trunc(t,r){r=e.def(r,0);return this.toFixed(t,r)},_decimalAdjust:function _decimalAdjust(e,t,r){if(r===void 0||0==+r){return Math[e](t)}t=+t;r=+r;if(isNaN(t)||!("number"==typeof r&&0==r%1)){return NaN}t=t.toString().split("e");t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-r:-r)));t=t.toString().split("e");return+(t[0]+"e"+(t[1]?+t[1]+r:r))},_round10:function _round10(e,t){return this._decimalAdjust("round",e,t)},_floor10:function _floor10(e,t){return this._decimalAdjust("floor",e,t)},_ceil10:function _ceil10(e,t){return this._decimalAdjust("ceil",e,t)},toFixed:function toFixed(e,t){return this._round10(e,-t).toFixed(t)},autoDigits:function autoDigits(e){var t=Math.abs(e),r;if(.1<t){r=this.toFixed(e,2)}else if(.01<=t){r=this.toFixed(e,4)}else if(1e-4<=t){r=this.toFixed(e,6)}else{r=e}return r},keys:function(e,t){var r=[],o;for(o in e){if(t){if(e.hasOwnProperty(o)){r.push(o)}}else{r.push(o)}}return r},clone:function clone(e){return{prototype:e}},cloneAndCopy:function cloneAndCopy(e,t){var o,i=function(){};i.prototype=e;for(o in t){i[o]=t[o]}return i},merge:function merge(e,t){var r,o;for(r in t){if(t.hasOwnProperty(r)){if(this.isArray(t[r])){if(!e[r]){e[r]=[]}for(o=0;o<t[r].length;o++){if("object"===_typeof(t[r][o])){e[r][o]=this.merge(e[r][o],t[r][o])}else{e[r][o]=t[r][o]}}}else if("object"===_typeof(t[r])){if(!e[r]){e[r]={}}e[r]=this.merge(e[r],t[r])}else{e[r]=t[r]}}}return e},deepCopy:function deepCopy(e,t,r){var o,s,n,a;r=r||!1;if("object"!==_typeof(e)||null===e){return e}if(this.isArray(e)){o=[];for(s=0;s<e.length;s++){n=e[s];if("object"===_typeof(n)){if(this.exists(n.board)){o[s]=n.id}else{o[s]=this.deepCopy(n)}}else{o[s]=n}}}else{o={};for(s in e){if(e.hasOwnProperty(s)){a=r?s.toLowerCase():s;n=e[s];if(null!==n&&"object"===_typeof(n)){if(this.exists(n.board)){o[a]=n.id}else{o[a]=this.deepCopy(n)}}else{o[a]=n}}}for(s in t){if(t.hasOwnProperty(s)){a=r?s.toLowerCase():s;n=t[s];if("object"===_typeof(n)){if(this.isArray(n)||!this.exists(o[a])){o[a]=this.deepCopy(n)}else{o[a]=this.deepCopy(o[a],n,r)}}else{o[a]=n}}}}return o},copyAttributes:function copyAttributes(t,r,n){var s,d,l,c,p;l=arguments.length;if(3>l||{circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1}[n]){s=e.deepCopy(r.elements,null,!0)}else{s={}}if(4>l&&this.exists(n)&&this.exists(r.layer[n])){s.layer=r.layer[n]}c=r;p=!0;for(d=2;d<l;d++){if(this.exists(c[arguments[d]])){c=c[arguments[d]]}else{p=!1;break}}if(p){s=e.deepCopy(s,c,!0)}c=t;p=!0;for(d=3;d<l;d++){if(this.exists(c[arguments[d]])){c=c[arguments[d]]}else{p=!1;break}}if(p){this.extend(s,c,null,!0)}c=r;p=!0;for(d=2;d<l;d++){if(this.exists(c[arguments[d]])){c=c[arguments[d]]}else{p=!1;break}}if(p&&this.exists(c.label)){s.label=e.deepCopy(c.label,s.label)}s.label=e.deepCopy(r.label,s.label);return s},copyPrototypeMethods:function copyPrototypeMethods(e,t,r){e.prototype[r]=t.prototype.constructor;for(var o in t.prototype){if(t.prototype.hasOwnProperty(o)){e.prototype[o]=t.prototype[o]}}},toJSON:function toJSON(t,r){var o,n,a,d,l;r=e.def(r,!1);if(("undefined"==typeof JSON?"undefined":_typeof(JSON))&&JSON.stringify&&!r){try{d=JSON.stringify(t);return d}catch(t){}}switch(_typeof(t)){case"object":if(t){o=[];if(this.isArray(t)){for(a=0;a<t.length;a++){o.push(e.toJSON(t[a],r))}return"["+o.join(",")+"]"}for(n in t){if(t.hasOwnProperty(n)){try{l=e.toJSON(t[n],r)}catch(e){l=""}if(r){o.push(n+":"+l)}else{o.push("\""+n+"\":"+l)}}}return"{"+o.join(",")+"} "}return"null";case"string":return"'"+t.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return t.toString();}return"0"},clearVisPropOld:function clearVisPropOld(e){e.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",transitionduration:0,top:-1e5,visible:null};return e},isInObject:function isInObject(e,t){for(var r in e){if(e.hasOwnProperty(r)){if(e[r]===t){return!0}}}return!1},escapeHTML:function escapeHTML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function unescapeHTML(e){return e.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function capitalize(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},trimNumber:function trimNumber(e){e=e.replace(/^0+/,"");e=e.replace(/0+$/,"");if("."===e[e.length-1]||","===e[e.length-1]){e=e.slice(0,-1)}if("."===e[0]||","===e[0]){e="0"+e}return e},filterElements:function filterElements(e,t){var r,o,s,n,a,d,c,p=e.length,l=[];if("function"!=typeof t&&"object"!==_typeof(t)){return l}for(r=0;r<p;r++){c=!0;s=e[r];if("object"===_typeof(t)){for(o in t){if(t.hasOwnProperty(o)){n=o.toLowerCase();if("function"==typeof s[o]){a=s[o]()}else{a=s[o]}if(s.visProp&&"function"==typeof s.visProp[n]){d=s.visProp[n]()}else{d=s.visProp&&s.visProp[n]}if("function"==typeof t[o]){c=t[o](a)||t[o](d)}else{c=a===t[o]||d===t[o]}if(!c){break}}}}else if("function"==typeof t){c=t(s)}if(c){l.push(s)}}return l},trim:function trim(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function sanitizeHTML(e,t){if("function"==typeof html_sanitize&&t){return html_sanitize(e,function(){},function(e){return e})}if(e){e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}return e},evalSlider:function evalSlider(e){if(e&&e.type===t.OBJECT_TYPE_GLIDER&&"function"==typeof e.Value){return e.Value()}return e}});return e});define("utils/env",["jxg","utils/type"],function(t,r){"use strict";t.extend(t,{touchProperty:"touches",isBrowser:"object"===("undefined"==typeof window?"undefined":_typeof(window))&&"object"===("undefined"==typeof document?"undefined":_typeof(document)),supportsVML:function supportsVML(){return this.isBrowser&&!!document.namespaces},supportsSVG:function supportsSVG(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function supportsCanvas(){var e,t=!1;if(this.isNode()){try{e="object"===("undefined"==typeof module?"undefined":_typeof(module))?module.require("canvas"):require("canvas");t=!!e}catch(e){}}return t||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function isNode(){return!this.isBrowser&&("object"===("undefined"==typeof module?"undefined":_typeof(module))&&!!module.exports||"object"===("undefined"==typeof global?"undefined":_typeof(global))&&global.requirejsVars&&!global.requirejsVars.isBrowser)},isWebWorker:function isWebWorker(){return!this.isBrowser&&"object"===("undefined"==typeof self?"undefined":_typeof(self))&&"function"==typeof self.postMessage},supportsPointerEvents:function supportsPointerEvents(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function isTouchDevice(){return this.isBrowser&&window.ontouchstart!==void 0},isAndroid:function isAndroid(){return r.exists(navigator)&&-1<navigator.userAgent.toLowerCase().indexOf("android")},isWebkitAndroid:function isWebkitAndroid(){return this.isAndroid()&&-1<navigator.userAgent.indexOf(" AppleWebKit/")},isApple:function isApple(){return r.exists(navigator)&&(-1<navigator.userAgent.indexOf("iPad")||-1<navigator.userAgent.indexOf("iPhone"))},isWebkitApple:function isWebkitApple(){return this.isApple()&&-1<navigator.userAgent.search(/Mobile\/[0-9A-Za-z\.]*Safari/)},isMetroApp:function isMetroApp(){return"object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.clientInformation&&window.clientInformation.appVersion&&-1<window.clientInformation.appVersion.indexOf("MSAppHost")},isMozilla:function isMozilla(){return r.exists(navigator)&&-1<navigator.userAgent.toLowerCase().indexOf("mozilla")&&-1===navigator.userAgent.toLowerCase().indexOf("apple")},isFirefoxOS:function isFirefoxOS(){return r.exists(navigator)&&-1===navigator.userAgent.toLowerCase().indexOf("android")&&-1===navigator.userAgent.toLowerCase().indexOf("apple")&&-1<navigator.userAgent.toLowerCase().indexOf("mobile")&&-1<navigator.userAgent.toLowerCase().indexOf("mozilla")},ieVersion:function(){var e,t,r=3;if("object"!==("undefined"==typeof document?"undefined":_typeof(document))){return 0}e=document.createElement("div");t=e.getElementsByTagName("i");do{e.innerHTML="<!--[if gt IE "+ ++r+"]><i></i><![endif]-->"}while(t[0]);return 4<r?r:void 0}(),getDimensions:function getDimensions(e,t){var o,i,s,n,a,d,l,c,p,u=/\d+(\.\d*)?px/;if(!this.isBrowser||null===e){return{width:500,height:500}}t=t||document;o=t.getElementById(e);if(!r.exists(o)){throw new Error("\nJSXGraph: HTML container element '"+e+"' not found.")}i=o.style.display;if("none"!==i&&null!==i){if(0<o.clientWidth&&0<o.clientHeight){return{width:o.clientWidth,height:o.clientHeight}}p=window.getComputedStyle?window.getComputedStyle(o):o.style;return{width:u.test(p.width)?parseFloat(p.width):0,height:u.test(p.height)?parseFloat(p.height):0}}s=o.style;n=s.visibility;a=s.position;d=s.display;s.visibility="hidden";s.position="absolute";s.display="block";l=o.clientWidth;c=o.clientHeight;s.display=d;s.position=a;s.visibility=n;return{width:l,height:c}},addEvent:function addEvent(e,t,o,i){var s=function(){return o.apply(i,arguments)};s.origin=o;i["x_internal"+t]=i["x_internal"+t]||[];i["x_internal"+t].push(s);if(r.exists(e)&&r.exists(e.addEventListener)){e.addEventListener(t,s,!1)}if(r.exists(e)&&r.exists(e.attachEvent)){e.attachEvent("on"+t,s)}},removeEvent:function removeEvent(e,o,s,n){var a;if(!r.exists(n)){t.debug("no such owner");return}if(!r.exists(n["x_internal"+o])){t.debug("no such type: "+o);return}if(!r.isArray(n["x_internal"+o])){t.debug("owner[x_internal + "+o+"] is not an array");return}a=r.indexOf(n["x_internal"+o],s,"origin");if(-1===a){t.debug("no such event function in internal list: "+s);return}try{if(r.exists(e)&&r.exists(e.removeEventListener)){e.removeEventListener(o,n["x_internal"+o][a],!1)}if(r.exists(e)&&r.exists(e.detachEvent)){e.detachEvent("on"+o,n["x_internal"+o][a])}}catch(r){t.debug("event not registered in browser: ("+o+" -- "+s+")")}n["x_internal"+o].splice(a,1)},removeAllEvents:function removeAllEvents(e,r,o){var s,n;if(o["x_internal"+r]){n=o["x_internal"+r].length;for(s=n-1;0<=s;s--){t.removeEvent(e,r,o["x_internal"+r][s].origin,o)}if(0<o["x_internal"+r].length){t.debug("removeAllEvents: Not all events could be removed.")}}},getPosition:function getPosition(o,s,n){var a,d,l,c=0,p=0;if(!o){o=window.event}n=n||document;l=o[t.touchProperty];if(r.exists(l)&&0===l.length){l=o.changedTouches}if(r.exists(s)&&r.exists(l)){if(-1===s){d=l.length;for(a=0;a<d;a++){if(l[a]){o=l[a];break}}}else{o=l[s]}}if(o.clientX){c=o.clientX;p=o.clientY}return[c,p]},getOffset:function getOffset(e){var r,i=e,s=e,n=i.offsetLeft-i.scrollLeft,a=i.offsetTop-i.scrollTop;r=this.getCSSTransform([n,a],i);n=r[0];a=r[1];i=i.offsetParent;while(i){n+=i.offsetLeft;a+=i.offsetTop;if(i.offsetParent){n+=i.clientLeft-i.scrollLeft;a+=i.clientTop-i.scrollTop}r=this.getCSSTransform([n,a],i);n=r[0];a=r[1];s=s.parentNode;while(s!==i){n+=s.clientLeft-s.scrollLeft;a+=s.clientTop-s.scrollTop;r=this.getCSSTransform([n,a],s);n=r[0];a=r[1];s=s.parentNode}i=i.offsetParent}return[n,a]},getStyle:function getStyle(e,o){var i,s=e.ownerDocument;if(s.defaultView&&s.defaultView.getComputedStyle){i=s.defaultView.getComputedStyle(e,null).getPropertyValue(o)}else if(e.currentStyle&&9<=t.ieVersion){i=e.currentStyle[o]}else{if(e.style){o=o.replace(/-([a-z]|[0-9])/ig,function(e,t){return t.toUpperCase()});i=e.style[o]}}return i},getProp:function getProp(e,t){var r=parseInt(this.getStyle(e,t),10);return isNaN(r)?0:r},getCSSTransform:function getCSSTransform(e,o){var s,n,a,d,l,c,p,u,h=["transform","webkitTransform","MozTransform","msTransform","oTransform"];c=h.length;for(s=0,a="";s<c;s++){if(r.exists(o.style[h[s]])){a=o.style[h[s]];break}}if(""!==a){l=a.indexOf("(");if(0<l){c=a.length;d=a.substring(l+1,c-1);u=d.split(",");for(n=0,p=u.length;n<p;n++){u[n]=parseFloat(u[n])}if(0===a.indexOf("matrix")){e[0]+=u[4];e[1]+=u[5]}else if(0===a.indexOf("translateX")){e[0]+=u[0]}else if(0===a.indexOf("translateY")){e[1]+=u[0]}else if(0===a.indexOf("translate")){e[0]+=u[0];e[1]+=u[1]}}}if(r.exists(o.style.zoom)){a=o.style.zoom;if(""!==a){e[0]*=parseFloat(a);e[1]*=parseFloat(a)}}return e},getCSSTransformMatrix:function getCSSTransformMatrix(e){var o,s,n,a,d,l,c,p,u,h=e.ownerDocument,m=["transform","webkitTransform","MozTransform","msTransform","oTransform"],t=[[1,0,0],[0,1,0],[0,0,1]];if(h.defaultView&&h.defaultView.getComputedStyle){u=h.defaultView.getComputedStyle(e,null);n=u.getPropertyValue("-webkit-transform")||u.getPropertyValue("-moz-transform")||u.getPropertyValue("-ms-transform")||u.getPropertyValue("-o-transform")||u.getPropertyValue("transform")}else{l=m.length;for(o=0,n="";o<l;o++){if(r.exists(e.style[m[o]])){n=e.style[m[o]];break}}}if(""!==n){d=n.indexOf("(");if(0<d){l=n.length;a=n.substring(d+1,l-1);p=a.split(",");for(s=0,c=p.length;s<c;s++){p[s]=parseFloat(p[s])}if(0===n.indexOf("matrix")){t=[[1,0,0],[0,p[0],p[1]],[0,p[2],p[3]]]}else if(0===n.indexOf("scaleX")){t[1][1]=p[0]}else if(0===n.indexOf("scaleY")){t[2][2]=p[0]}else if(0===n.indexOf("scale")){t[1][1]=p[0];t[2][2]=p[1]}}}if(r.exists(e.style.zoom)){n=e.style.zoom;if(""!==n){t[1][1]*=parseFloat(n);t[2][2]*=parseFloat(n)}}return t},timedChunk:function timedChunk(e,t,r,o){var i=e.concat(),s=function(){var n=+new Date;do{t.call(r,i.shift())}while(0<i.length&&300>+new Date-n);if(0<i.length){window.setTimeout(s,1)}else{o(e)}};window.setTimeout(s,1)}});return t});define("utils/xml",["jxg","utils/type"],function(e,t){"use strict";e.XML={cleanWhitespace:function cleanWhitespace(e){var r=e.firstChild;while(t.exists(r)){if(3===r.nodeType&&!/\S/.test(r.nodeValue)){e.removeChild(r)}else if(1===r.nodeType){this.cleanWhitespace(r)}r=r.nextSibling}},parse:function parse(e){var t,r,o;if("function"==typeof DOMParser||"object"===("undefined"==typeof DOMParser?"undefined":_typeof(DOMParser))){o=DOMParser}else{o=function(){this.parseFromString=function(e){var t;if("function"==typeof ActiveXObject){t=new ActiveXObject("MSXML.DomDocument");t.loadXML(e)}return t}}}t=new o;r=t.parseFromString(e,"text/xml");this.cleanWhitespace(r);return r}};return e.XML});define("utils/event",["jxg","utils/type"],function(e,t){"use strict";e.EventEmitter={eventHandlers:{},suspended:{},trigger:function trigger(e,t){var r,o,s,n,a,d;a=e.length;for(o=0;o<a;o++){n=this.eventHandlers[e[o]];if(!this.suspended[e[o]]){this.suspended[e[o]]=!0;if(n){d=n.length;for(r=0;r<d;r++){s=n[r];s.handler.apply(s.context,t)}}this.suspended[e[o]]=!1}}return this},on:function on(e,r,o){if(!t.isArray(this.eventHandlers[e])){this.eventHandlers[e]=[]}o=t.def(o,this);this.eventHandlers[e].push({handler:r,context:o});return this},off:function off(e,r){var o;if(!e||!t.isArray(this.eventHandlers[e])){return this}if(r){o=t.indexOf(this.eventHandlers[e],r,"handler");if(-1<o){this.eventHandlers[e].splice(o,1)}if(0===this.eventHandlers[e].length){delete this.eventHandlers[e]}}else{delete this.eventHandlers[e]}return this},eventify:function eventify(e){e.eventHandlers={};e.on=this.on;e.off=this.off;e.triggerEventHandlers=this.trigger;e.trigger=this.trigger;e.suspended={}}};return e.EventEmitter});define("math/math",["jxg","utils/type"],function(e,t){"use strict";var o,i=function(e){var t,r;if(e.memo){return e.memo}t={};r=Array.prototype.join;e.memo=function(){var i=r.call(arguments);return t[i]!==o?t[i]:t[i]=e.apply(this,arguments)};return e.memo};e.Math={eps:1e-6,relDif:function relDif(e,t){var r=Math.abs(e),o=Math.abs(t);o=Math.max(r,o);return 0===o?0:Math.abs(e-t)/o},mod:function mod(e,t){return e-Math.floor(e/t)*t},vector:function vector(e,t){var o,s;t=t||0;o=[];for(s=0;s<e;s++){o[s]=t}return o},matrix:function matrix(e,t,o){var s,n,a;o=o||0;t=t||e;s=[];for(n=0;n<e;n++){s[n]=[];for(a=0;a<t;a++){s[n][a]=o}}return s},identity:function identity(e,t){var s,n;if(t===o&&"number"!=typeof t){t=e}s=this.matrix(e,t);for(n=0;n<Math.min(e,t);n++){s[n][n]=1}return s},frustum:function frustum(e,o,r,i,t,s){var n=this.matrix(4,4);n[0][0]=2*t/(o-e);n[0][1]=0;n[0][2]=(o+e)/(o-e);n[0][3]=0;n[1][0]=0;n[1][1]=2*t/(i-r);n[1][2]=(i+r)/(i-r);n[1][3]=0;n[2][0]=0;n[2][1]=0;n[2][2]=-(s+t)/(s-t);n[2][3]=-(2*(s*t))/(s-t);n[3][0]=0;n[3][1]=0;n[3][2]=-1;n[3][3]=0;return n},projection:function projection(e,o,i,s){var n=i*Math.tan(e/2),t=n*o;return this.frustum(-t,t,-n,n,i,s)},matVecMult:function matVecMult(e,t){var r,o,a,d=e.length,l=t.length,n=[];if(3===l){for(r=0;r<d;r++){n[r]=e[r][0]*t[0]+e[r][1]*t[1]+e[r][2]*t[2]}}else{for(r=0;r<d;r++){o=0;for(a=0;a<l;a++){o+=e[r][a]*t[a]}n[r]=o}}return n},matMatMult:function matMatMult(e,t){var r,o,a,d,l=e.length,c=0<l?t[0].length:0,n=t.length,p=this.matrix(l,c);for(r=0;r<l;r++){for(o=0;o<c;o++){a=0;for(d=0;d<n;d++){a+=e[r][d]*t[d][o]}p[r][o]=a}}return p},transpose:function transpose(e){var t,r,o,s,a;s=e.length;a=0<e.length?e[0].length:0;t=this.matrix(a,s);for(r=0;r<a;r++){for(o=0;o<s;o++){t[r][o]=e[o][r]}}return t},inverse:function inverse(e){var t,o,a,d,l,c,u,h=e.length,n=[],m=[],p=[];for(t=0;t<h;t++){n[t]=[];for(o=0;o<h;o++){n[t][o]=e[t][o]}m[t]=t}for(o=0;o<h;o++){l=Math.abs(n[o][o]);c=o;for(t=o+1;t<h;t++){if(Math.abs(n[t][o])>l){l=Math.abs(n[t][o]);c=t}}if(l<=this.eps){return[]}if(c>o){for(a=0;a<h;a++){u=n[o][a];n[o][a]=n[c][a];n[c][a]=u}u=m[o];m[o]=m[c];m[c]=u}d=1/n[o][o];for(t=0;t<h;t++){n[t][o]*=d}n[o][o]=d;for(a=0;a<h;a++){if(a!==o){for(t=0;t<h;t++){if(t!==o){n[t][a]-=n[t][o]*n[o][a]}}n[o][a]=-d*n[o][a]}}}for(t=0;t<h;t++){for(a=0;a<h;a++){p[m[a]]=n[t][a]}for(a=0;a<h;a++){n[t][a]=p[a]}}return n},innerProduct:function innerProduct(e,r,a){var d,l=0;if(a===o||!t.isNumber(a)){a=e.length}for(d=0;d<a;d++){l+=e[d]*r[d]}return l},crossProduct:function crossProduct(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},factorial:i(function(e){if(0>e){return NaN}e=Math.floor(e);if(0===e||1===e){return 1}return e*this.factorial(e-1)}),binomial:i(function(e,t){var r,o;if(t>e||0>t){return NaN}t=Math.round(t);e=Math.round(e);if(0===t||t===e){return 1}r=1;for(o=0;o<t;o++){r*=e-o;r/=o+1}return r}),cosh:function cosh(e){return .5*(Math.exp(e)+Math.exp(-e))},sinh:function sinh(e){return .5*(Math.exp(e)-Math.exp(-e))},pow:function pow(e,t){if(0===e){if(0===t){return 1}return 0}if(Math.floor(t)===t){return Math.pow(e,t)}if(0<e){return Math.exp(t*Math.log(Math.abs(e)))}return NaN},log10:function log10(e){return Math.log(e)/Math.log(10)},log2:function log2(e){return Math.log(e)/Math.log(2)},log:function log(e,r){if(r!==void 0&&t.isNumber(r)){return Math.log(e)/Math.log(r)}return Math.log(e)},sign:Math.sign||function(e){e=+e;if(0===e||isNaN(e)){return e}return 0<e?1:-1},squampow:function squampow(e,t){var r;if(Math.floor(t)===t){r=1;if(0>t){e=1/e;t*=-1}while(0!==t){if(1&t){r*=e}t>>=1;e*=e}return r}return this.pow(e,t)},gcd:function gcd(e,r){e=Math.abs(e);r=Math.abs(r);if(!(t.isNumber(e)&&t.isNumber(r))){return NaN}if(r>e){var o=e;e=r;r=o}while(!0){e%=r;if(0===e){return r}r%=e;if(0===r){return e}}},lcm:function lcm(e,r){var o;if(!(t.isNumber(e)&&t.isNumber(r))){return NaN}o=e*r;if(0!==o){return o/this.gcd(e,r)}return 0},normalize:function normalize(e){var t,o,i=2*e[3],s=e[4]/i;e[5]=s;e[6]=-e[1]/i;e[7]=-e[2]/i;if(!isFinite(s)){t=Math.sqrt(e[1]*e[1]+e[2]*e[2]);e[0]/=t;e[1]/=t;e[2]/=t;e[3]=0;e[4]=1}else if(1<=Math.abs(s)){e[0]=(e[6]*e[6]+e[7]*e[7]-s*s)/(2*s);e[1]=-e[6]/s;e[2]=-e[7]/s;e[3]=1/(2*s);e[4]=1}else{o=0>=s?-1:1;e[0]=.5*(o*(e[6]*e[6]+e[7]*e[7]-s*s));e[1]=-o*e[6];e[2]=-o*e[7];e[3]=o/2;e[4]=o*s}return e},toGL:function toGL(e){var t,r,o;if("function"==typeof Float32Array){t=new Float32Array(16)}else{t=Array(16)}if(4!==e.length&&4!==e[0].length){return t}for(r=0;4>r;r++){for(o=0;4>o;o++){t[r+4*o]=e[r][o]}}return t}};return e.Math});define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],function(e,t,r,o,i){"use strict";e.Coords=function(e,t,i,s){this.board=i;this.usrCoords=[];this.scrCoords=[];this.emitter=!o.exists(s)||s;if(this.emitter){r.eventify(this)}this.setCoordinates(e,t,!0,!0)};e.extend(e.Coords.prototype,{normalizeUsrCoords:function normalizeUsrCoords(){if(Math.abs(this.usrCoords[0])>i.eps){this.usrCoords[1]/=this.usrCoords[0];this.usrCoords[2]/=this.usrCoords[0];this.usrCoords[0]=1}},usr2screen:function usr2screen(e){var t=Math.round,r=this.board,o=this.usrCoords,i=r.origin.scrCoords;if(!0===e){this.scrCoords[0]=t(o[0]);this.scrCoords[1]=t(o[0]*i[1]+o[1]*r.unitX);this.scrCoords[2]=t(o[0]*i[2]-o[2]*r.unitY)}else{this.scrCoords[0]=o[0];this.scrCoords[1]=o[0]*i[1]+o[1]*r.unitX;this.scrCoords[2]=o[0]*i[2]-o[2]*r.unitY}},screen2usr:function screen2usr(){var e=this.board.origin.scrCoords,t=this.scrCoords,r=this.board;this.usrCoords[0]=1;this.usrCoords[1]=(t[1]-e[1])/r.unitX;this.usrCoords[2]=(e[2]-t[2])/r.unitY},distance:function distance(e,r){var o=0,s,n=this.usrCoords,a=this.scrCoords,d;if(e===t.COORDS_BY_USER){s=r.usrCoords;d=n[0]-s[0];o=d*d;if(o>i.eps*i.eps){return Number.POSITIVE_INFINITY}d=n[1]-s[1];o+=d*d;d=n[2]-s[2];o+=d*d}else{s=r.scrCoords;d=a[1]-s[1];o+=d*d;d=a[2]-s[2];o+=d*d}return Math.sqrt(o)},setCoordinates:function setCoordinates(e,r,o,i){var s=this.usrCoords,n=this.scrCoords,a=[s[0],s[1],s[2]],d=[n[0],n[1],n[2]];if(e===t.COORDS_BY_USER){if(2===r.length){s[0]=1;s[1]=r[0];s[2]=r[1]}else{s[0]=r[0];s[1]=r[1];s[2]=r[2];this.normalizeUsrCoords()}this.usr2screen(o)}else{if(2===r.length){n[1]=r[0];n[2]=r[1]}else{n[1]=r[1];n[2]=r[2]}this.screen2usr()}if(this.emitter&&!i&&(d[1]!==n[1]||d[2]!==n[2])){this.triggerEventHandlers(["update"],[a,d])}return this},copy:function copy(e,t){if(t===void 0){t=0}return this[e].slice(t)},__evt__update:function __evt__update(){},__evt:function __evt(){}});return e.Coords});define("utils/expect",["jxg","utils/type","base/constants","base/coords"],function(e,t,r,o){"use strict";var i={each:function each(e,o,s){var n,a,d=[];if(t.exists(e.length)){a=e.length;for(n=0;n<a;n++){d.push(o.call(this,e[n],s))}}return d},coords:function coords(e,t){var i=e;if(e&&e.elementClass===r.OBJECT_CLASS_POINT){i=e.coords}else if(e.usrCoords&&e.scrCoords&&e.usr2screen){i=e}if(t){i=new o(r.COORDS_BY_USER,i.usrCoords,i.board)}return i},coordsArray:function coordsArray(e,r){var o;if(!t.isArray(e)){o=this.coords(e).usrCoords}else{o=e}if(3>o.length){o.unshift(1)}if(r){o=[o[0],o[1],o[2]]}return o}};e.Expect=i;return i});define("math/qdt",["math/math","utils/type"],function(e,t){"use strict";var r=function(e){this.capacity=10;this.points=[];this.xlb=e[0];this.xub=e[2];this.ylb=e[3];this.yub=e[1];this.northWest=null;this.northEast=null;this.southEast=null;this.southWest=null};t.extend(r.prototype,{contains:function contains(e,t){return this.xlb<e&&e<=this.xub&&this.ylb<t&&t<=this.yub},insert:function insert(e){if(!this.contains(e.usrCoords[1],e.usrCoords[2])){return!1}if(this.points.length<this.capacity){this.points.push(e);return!0}if(null===this.northWest){this.subdivide()}if(this.northWest.insert(e)){return!0}if(this.northEast.insert(e)){return!0}if(this.southEast.insert(e)){return!0}return!!this.southWest.insert(e)},subdivide:function subdivide(){var e,t=this.points.length,o=this.xlb+(this.xub-this.xlb)/2,s=this.ylb+(this.yub-this.ylb)/2;this.northWest=new r([this.xlb,this.yub,o,s]);this.northEast=new r([o,this.yub,this.xub,s]);this.southEast=new r([this.xlb,s,o,this.ylb]);this.southWest=new r([o,s,this.xub,this.ylb]);for(e=0;e<t;e+=1){this.northWest.insert(this.points[e]);this.northEast.insert(this.points[e]);this.southEast.insert(this.points[e]);this.southWest.insert(this.points[e])}},_query:function _query(e,t){var o;if(this.contains(e,t)){if(null===this.northWest){return this}o=this.northWest._query(e,t);if(o){return o}o=this.northEast._query(e,t);if(o){return o}o=this.southEast._query(e,t);if(o){return o}o=this.southWest._query(e,t);if(o){return o}}return!1},query:function query(e,r){var o,i;if(t.exists(r)){o=e;i=r}else{o=e.usrCoords[1];i=e.usrCoords[2]}return this._query(o,i)}});e.Quadtree=r;return r});define("math/numerics",["jxg","utils/type","math/math"],function(e,o,l){"use strict";var c={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};l.Numerics={Gauss:function Gauss(e,t){var r,s,a,d,c,p=l.eps,u=0<e.length?e[0].length:0;if(u!==t.length||u!==e.length){throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.")}d=[];c=t.slice(0,u);for(r=0;r<u;r++){d[r]=e[r].slice(0,u)}for(s=0;s<u;s++){for(r=u-1;r>s;r--){if(Math.abs(d[r][s])>p){if(Math.abs(d[s][s])<p){o.swap(d,r,s);o.swap(c,r,s)}else{d[r][s]/=d[s][s];c[r]-=d[r][s]*c[s];for(a=s+1;a<u;a++){d[r][a]-=d[r][s]*d[s][a]}}}}if(Math.abs(d[s][s])<p){throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}}this.backwardSolve(d,c,!0);return c},backwardSolve:function backwardSolve(e,t,r){var o,s,a,d,l;if(r){o=t}else{o=t.slice(0,t.length)}s=e.length;a=0<e.length?e[0].length:0;for(d=s-1;0<=d;d--){for(l=a-1;l>d;l--){o[d]-=e[d][l]*o[l]}o[d]/=e[d][d]}return o},gaussBareiss:function gaussBareiss(e){var r,o,a,d,u,h,m,g,b,C=l.eps;m=e.length;if(0>=m){return 0}if(e[0].length<m){m=e[0].length}g=[];for(d=0;d<m;d++){g[d]=e[d].slice(0,m)}o=1;a=1;for(r=0;r<m-1;r++){h=g[r][r];if(Math.abs(h)<C){for(d=r+1;d<m;d++){if(Math.abs(g[d][r])>=C){break}}if(d===m){return 0}for(u=r;u<m;u++){b=g[d][u];g[d][u]=g[r][u];g[r][u]=b}a=-a;h=g[r][r]}for(d=r+1;d<m;d++){for(u=r+1;u<m;u++){b=h*g[d][u]-g[d][r]*g[r][u];g[d][u]=b/o}}o=h}return a*g[m-1][m-1]},det:function det(e){var t=e.length;if(2===t&&2===e[0].length){return e[0][0]*e[1][1]-e[1][0]*e[0][1]}return this.gaussBareiss(e)},Jacobi:function Jacobi(e){var t,r,o,s,a,d,c,p,u,h=l.eps,m=0,g=e.length,n=[[0,0,0],[0,0,0],[0,0,0]],b=[[0,0,0],[0,0,0],[0,0,0]],C=0;for(t=0;t<g;t++){for(r=0;r<g;r++){n[t][r]=0;b[t][r]=e[t][r];m+=Math.abs(b[t][r])}n[t][t]=1}if(1===g){return[b,n]}if(0>=m){return[b,n]}m/=g*g;do{p=0;u=0;for(r=1;r<g;r++){for(t=0;t<r;t++){s=Math.abs(b[t][r]);if(s>u){u=s}p+=s;if(s>=h){s=.5*Math.atan2(2*b[t][r],b[t][t]-b[r][r]);a=Math.sin(s);d=Math.cos(s);for(o=0;o<g;o++){c=b[o][t];b[o][t]=d*c+a*b[o][r];b[o][r]=-a*c+d*b[o][r];c=n[o][t];n[o][t]=d*c+a*n[o][r];n[o][r]=-a*c+d*n[o][r]}b[t][t]=d*b[t][t]+a*b[r][t];b[r][r]=-a*b[t][r]+d*b[r][r];b[t][r]=0;for(o=0;o<g;o++){b[t][o]=b[o][t];b[r][o]=b[o][r]}}}}C+=1}while(Math.abs(p)/m>h&&2e3>C);return[b,n]},NewtonCotes:function NewtonCotes(e,t,r){var s,n,a,d=0,l=r&&o.isNumber(r.number_of_nodes)?r.number_of_nodes:28,c={trapez:!0,simpson:!0,milne:!0},p=r&&r.integration_type&&c.hasOwnProperty(r.integration_type)&&c[r.integration_type]?r.integration_type:"milne",u=(e[1]-e[0])/l;switch(p){case"trapez":d=.5*(t(e[0])+t(e[1]));s=e[0];for(n=0;n<l-1;n++){s+=u;d+=t(s)}d*=u;break;case"simpson":if(0<l%2){throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.")}a=l/2;d=t(e[0])+t(e[1]);s=e[0];for(n=0;n<a-1;n++){s+=2*u;d+=2*t(s)}s=e[0]-u;for(n=0;n<a;n++){s+=2*u;d+=4*t(s)}d*=u/3;break;default:if(0<l%4){throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4")}a=.25*l;d=7*(t(e[0])+t(e[1]));s=e[0];for(n=0;n<a-1;n++){s+=4*u;d+=14*t(s)}s=e[0]-3*u;for(n=0;n<a;n++){s+=4*u;d+=32*(t(s)+t(s+2*u))}s=e[0]-2*u;for(n=0;n<a;n++){s+=4*u;d+=12*t(s)}d*=2*u/45;}return d},Romberg:function Romberg(e,t,r){var d,l,c,u,g,C,y,v,f=[],p=0,P=1/0,_=r&&o.isNumber(r.max_iterations)?r.max_iterations:20,m=r&&o.isNumber(r.eps)?r.eps:r.eps||1e-7;d=e[0];l=e[1];c=l-d;g=1;f[0]=.5*c*(t(d)+t(l));for(C=0;C<_;++C){u=0;c*=.5;g*=2;v=1;for(y=1;y<g;y+=2){u+=t(d+y*c)}f[C+1]=.5*f[C]+u*c;p=f[C+1];for(y=C-1;0<=y;--y){v*=4;f[y]=f[y+1]+(f[y+1]-f[y])/(v-1);p=f[y]}if(Math.abs(p-P)<m*Math.abs(p)){break}P=p}return p},GaussLegendre:function GaussLegendre(e,t,r){var s,d,l,c,p,u,h=0,g=[],C=[],y,v,f=r&&o.isNumber(r.n)?r.n:12;if(18<f){f=18}g[2]=[.5773502691896257];C[2]=[1];g[4]=[.33998104358485626,.8611363115940526];C[4]=[.6521451548625461,.34785484513745385];g[6]=[.2386191860831969,.6612093864662645,.932469514203152];C[6]=[.46791393457269104,.3607615730481386,.17132449237917036];g[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363];C[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626];g[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717];C[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814];g[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192];C[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183];g[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123];C[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186];g[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499];C[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096];g[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309];C[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331];g[3]=[0,.7745966692414834];C[3]=[.8888888888888888,.5555555555555556];g[5]=[0,.5384693101056831,.906179845938664];C[5]=[.5688888888888889,.47862867049936647,.23692688505618908];g[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585];C[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697];g[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261];C[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441];g[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057];C[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366];g[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881];C[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588];g[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854];C[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727];g[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174];C[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793];s=e[0];d=e[1];c=f+1>>1;y=g[f];v=C[f];u=.5*(d-s);p=.5*(d+s);if(f&!0){h=v[0]*t(p);for(l=1;l<c;++l){h+=v[l]*(t(p+u*y[l])+t(p-u*y[l]))}}else{h=0;for(l=0;l<c;++l){h+=v[l]*(t(p+u*y[l])+t(p-u*y[l]))}}return u*h},_rescale_error:function _rescale_error(e,t,r){var o,i,s=2220446049250313e-31;e=Math.abs(e);if(0!==r&&0!==e){o=Math.pow(200*e/r,1.5);if(1>o){e=r*o}else{e=r}}if(t>22250738585072014e-324/(50*s)){i=50*s*t;if(i>e){e=i}}return e},_gaussKronrod:function _gaussKronrod(e,t,r,o,i,s,n){var d=e[0],a=e[1],l,c,p=.5*(d+a),u=.5*(a-d),h=Math.abs(u),m=t(p),g=0,b=m*s[r-1],C=Math.abs(b),y=0,v=0,f=0,P,_,S,E,x,O,T,A=[],w=[];if(0==r%2){g=m*i[r/2-1]}l=Math.floor((r-1)/2);for(P=0;P<l;P++){_=2*P+1;S=u*o[_];E=t(p-S);x=t(p+S);O=E+x;A[_]=E;w[_]=x;g+=i[P]*O;b+=s[_]*O;C+=s[_]*(Math.abs(E)+Math.abs(x))}l=Math.floor(r/2);for(P=0;P<l;P++){T=2*P;S=u*o[T];E=t(p-S);x=t(p+S);A[T]=E;w[T]=x;b+=s[T]*(E+x);C+=s[T]*(Math.abs(E)+Math.abs(x))}v=.5*b;y=s[r-1]*Math.abs(m-v);for(P=0;P<r-1;P++){y+=s[P]*(Math.abs(A[P]-v)+Math.abs(w[P]-v))}f=(b-g)*u;b*=u;C*=h;y*=h;c=b;n.abserr=this._rescale_error(f,C,y);n.resabs=C;n.resasc=y;return c},GaussKronrod15:function GaussKronrod15(e,t,r){return this._gaussKronrod(e,t,8,[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782],r)},GaussKronrod21:function GaussKronrod21(e,t,r){return this._gaussKronrod(e,t,11,[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169],r)},GaussKronrod31:function GaussKronrod31(e,t,r){return this._gaussKronrod(e,t,16,[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154],r)},_workspace:function _workspace(e,t){return{limit:t,size:0,nrmax:0,i:0,alist:[e[0]],blist:[e[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function qpsrt(){var e=this.size-1,t=this.limit,r,o,s,n,a,d=this.nrmax,l=this.order[d];if(2>e){this.order[0]=0;this.order[1]=1;this.i=l;return}r=this.elist[l];while(0<d&&r>this.elist[this.order[d-1]]){this.order[d]=this.order[d-1];d--}if(e<t/2+2){a=e}else{a=t-e+1}s=d+1;while(s<a&&r<this.elist[this.order[s]]){this.order[s-1]=this.order[s];s++}this.order[s-1]=l;o=this.elist[e];n=a-1;while(n>s-2&&o>=this.elist[this.order[n]]){this.order[n+1]=this.order[n];n--}this.order[n+1]=e;l=this.order[d];this.i=l;this.nrmax=d},set_initial_result:function set_initial_result(e,t){this.size=1;this.rlist[0]=e;this.elist[0]=t},update:function update(e,t,r,o,i,s,n,a){var d=this.i,l=this.size,c=this.level[this.i]+1;if(a>o){this.alist[d]=i;this.rlist[d]=n;this.elist[d]=a;this.level[d]=c;this.alist[l]=e;this.blist[l]=t;this.rlist[l]=r;this.elist[l]=o;this.level[l]=c}else{this.blist[d]=t;this.rlist[d]=r;this.elist[d]=o;this.level[d]=c;this.alist[l]=i;this.blist[l]=s;this.rlist[l]=n;this.elist[l]=a;this.level[l]=c}this.size++;if(c>this.maximum_level){this.maximum_level=c}this.qpsrt()},retrieve:function retrieve(){var e=this.i;return{a:this.alist[e],b:this.blist[e],r:this.rlist[e],e:this.elist[e]}},sum_results:function sum_results(){var e=this.size,t,r=0;for(t=0;t<e;t++){r+=this.rlist[t]}return r},subinterval_too_small:function subinterval_too_small(e,t,r){var o=(1+100*2220446049250313e-31)*(Math.abs(t)+1e3*22250738585072014e-324);return Math.abs(e)<=o&&Math.abs(r)<=o}}},Qag:function Qag(t,r,i){var s=this._workspace(t,1e3),n=i&&o.isNumber(i.limit)?i.limit:15,a=i&&o.isNumber(i.epsrel)?i.epsrel:1e-7,d=i&&o.isNumber(i.epsabs)?i.epsabs:1e-7,c=i&&o.isFunction(i.q)?i.q:this.GaussKronrod15,p={},u,h,m,g,b,C,y,v,f=0,P=0,_=0,S=0,E,x,O,T,A,w,j,N,R,L=0,B=0,k=0,Y=0,D=0,I=0,X,M,U,G;if(n>s.limit){e.warn("iteration limit exceeds available workspace")}if(0>=d&&(a<50*l.eps||5e-29>a)){e.warn("tolerance cannot be acheived with given epsabs and epsrel")}m=c.apply(this,[t,r,p]);g=p.abserr;b=p.resabs;C=p.resasc;s.set_initial_result(m,g);v=Math.max(d,a*Math.abs(m));E=50*2220446049250313e-31*b;if(g<=E&&g>v){y=m;e.warn("cannot reach tolerance because of roundoff error on first attempt");return-Infinity}if(g<=v&&g!==C||0===g){y=m;return y}if(1===n){y=m;e.warn("a maximum of one iteration was insufficient");return-Infinity}u=m;h=g;f=1;do{L=0;B=0;k=0;Y=0;D=0;I=0;U=s.retrieve();w=U.a;j=U.b;N=U.r;R=U.e;x=w;O=.5*(w+j);T=O;A=j;L=c.apply(this,[[x,O],r,p]);Y=p.abserr;p.resabs;X=p.resasc;B=c.apply(this,[[T,A],r,p]);D=p.abserr;p.resabs;M=p.resasc;k=L+B;I=Y+D;h+=I-R;u+=k-N;if(X!==Y&&M!==D){G=N-k;if(Math.abs(G)<=1e-5*Math.abs(k)&&I>=.99*R){P++}if(10<=f&&I>R){_++}}v=Math.max(d,a*Math.abs(u));if(h>v){if(6<=P||20<=_){S=2}if(s.subinterval_too_small(x,T,A)){S=3}}s.update(x,O,L,Y,T,A,B,D);U=s.retrieve();w=U.a_i;j=U.b_i;N=U.r_i;R=U.e_i;f++}while(f<n&&!S&&h>v);y=s.sum_results();return y},I:function I(e,t){return this.Qag(e,t,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function Newton(e,t,r){var s,n=0,a=l.eps,d=e.apply(r,[t]);if(o.isArray(t)){t=t[0]}while(50>n&&Math.abs(d)>a){s=this.D(e,r)(t);if(Math.abs(s)>a){t-=d/s}else{t+=.2*Math.random()-1}d=e.apply(r,[t]);n+=1}return t},root:function root(e,t,r){return this.fzero(e,t,r)},generalizedNewton:function generalizedNewton(t,r,o,i){var s,n,p,u,h,m,g,C,y,v,P,_,S,E,x=0;if(this.generalizedNewton.t1memo){s=this.generalizedNewton.t1memo;n=this.generalizedNewton.t2memo}else{s=o;n=i}C=t.X(s)-r.X(n);y=t.Y(s)-r.Y(n);v=C*C+y*y;P=this.D(t.X,t);_=this.D(r.X,r);S=this.D(t.Y,t);E=this.D(r.Y,r);while(v>l.eps&&10>x){p=P(s);u=-_(n);h=S(s);m=-E(n);g=p*m-u*h;s-=(m*C-u*y)/g;n-=(p*y-h*C)/g;C=t.X(s)-r.X(n);y=t.Y(s)-r.Y(n);v=C*C+y*y;x+=1}this.generalizedNewton.t1memo=s;this.generalizedNewton.t2memo=n;if(Math.abs(s)<Math.abs(n)){return[t.X(s),t.Y(s)]}return[r.X(n),r.Y(n)]},Neville:function Neville(e){var t=[],r=function(r){return function(o,n){var a,c,p,u=l.binomial,h=e.length,m=0,g=0;if(!n){p=1;for(a=0;a<h;a++){t[a]=u(h-1,a)*p;p*=-1}}c=o;for(a=0;a<h;a++){if(0===c){return e[a][r]()}p=t[a]/c;c-=1;m+=e[a][r]()*p;g+=p}return m/g}},o=r("X"),i=r("Y");return[o,i,0,function(){return e.length-1}]},splineDef:function splineDef(e,t){var r,o,s,a=Math.min(e.length,t.length),n=[],d=[],c=[],p=[],u=[],h=[];if(2===a){return[0,0]}for(o=0;o<a;o++){r={X:e[o],Y:t[o]};c.push(r)}c.sort(function(e,t){return e.X-t.X});for(o=0;o<a;o++){e[o]=c[o].X;t[o]=c[o].Y}for(o=0;o<a-1;o++){p.push(e[o+1]-e[o])}for(o=0;o<a-2;o++){u.push(6*(t[o+2]-t[o+1])/p[o+1]-6*(t[o+1]-t[o])/p[o])}n.push(2*(p[0]+p[1]));d.push(u[0]);for(o=0;o<a-3;o++){s=p[o+1]/n[o];n.push(2*(p[o+1]+p[o+2])-s*p[o+1]);d.push(u[o+1]-s*d[o])}h[a-3]=d[a-3]/n[a-3];for(o=a-4;0<=o;o--){h[o]=(d[o]-p[o+1]*h[o+1])/n[o]}for(o=a-3;0<=o;o--){h[o+1]=h[o]}h[0]=0;h[a-1]=0;return h},splineEval:function splineEval(e,t,r,s){var p,u,h,m,g,C,y,v=Math.min(t.length,r.length),n=1,f=!1,P=[];if(o.isArray(e)){n=e.length;f=!0}else{e=[e]}for(p=0;p<n;p++){if(e[p]<t[0]||t[p]>t[v-1]){return NaN}for(u=1;u<v;u++){if(e[p]<=t[u]){break}}u-=1;h=r[u];m=(r[u+1]-r[u])/(t[u+1]-t[u])-(t[u+1]-t[u])/6*(s[u+1]+2*s[u]);g=s[u]/2;C=(s[u+1]-s[u])/(6*(t[u+1]-t[u]));y=e[p]-t[u];P.push(h+(m+(g+C*y)*y)*y)}if(f){return P}return P[0]},generatePolynomialTerm:function generatePolynomialTerm(e,r,o,s){var n,a=[];for(n=r;0<=n;n--){a=a.concat(["(",e[n].toPrecision(s),")"]);if(1<n){a=a.concat(["*",o,"<sup>",n,"<","/sup> + "])}else if(1===n){a=a.concat(["*",o," + "])}}return a.join("")},lagrangePolynomial:function lagrangePolynomial(e){var t=[],r=function(r,o){var n,a,d,l,c=e.length,p=0,u=0;if(!o){for(n=0;n<c;n++){t[n]=1;d=e[n].X();for(a=0;a<c;a++){if(a!==n){t[n]*=d-e[a].X()}}t[n]=1/t[n]}}for(n=0;n<c;n++){d=e[n].X();if(r===d){return e[n].Y()}l=t[n]/(r-d);u+=l;p+=l*e[n].Y()}return p/u};r.getTerm=function(){return""};return r},_initCubicPoly:function _initCubicPoly(e,t,r,o){return[e,r,-3*e+3*t-2*r-o,2*e-2*t+r+o]},CardinalSpline:function CardinalSpline(e,t,r){var i,n=[],a,d,c,u=this;if(o.isFunction(t)){c=t}else{c=function(){return t}}if(r===void 0){r="uniform"}a=function(o){return function(a,p){var h,m,g,b,C,y,v,f,P,_;if(2>e.length){return NaN}if(!p){d=c();g={X:function X(){return 2*e[0].X()-e[1].X()},Y:function Y(){return 2*e[0].Y()-e[1].Y()},Dist:function Dist(e){var t=this.X()-e.X(),r=this.Y()-e.Y();return Math.sqrt(t*t+r*r)}};b={X:function X(){return 2*e[e.length-1].X()-e[e.length-2].X()},Y:function Y(){return 2*e[e.length-1].Y()-e[e.length-2].Y()},Dist:function Dist(e){var t=this.X()-e.X(),r=this.Y()-e.Y();return Math.sqrt(t*t+r*r)}};i=[g].concat(e,[b]);_=i.length;n[o]=[];for(h=0;h<_-3;h++){if("centripetal"===r){v=i[h].Dist(i[h+1]);f=i[h+2].Dist(i[h+1]);P=i[h+3].Dist(i[h+2]);v=Math.sqrt(v);f=Math.sqrt(f);P=Math.sqrt(P);if(f<l.eps){f=1}if(v<l.eps){v=f}if(P<l.eps){P=f}C=(i[h+1][o]()-i[h][o]())/v-(i[h+2][o]()-i[h][o]())/(f+v)+(i[h+2][o]()-i[h+1][o]())/f;y=(i[h+2][o]()-i[h+1][o]())/f-(i[h+3][o]()-i[h+1][o]())/(P+f)+(i[h+3][o]()-i[h+2][o]())/P;C*=f;y*=f;n[o][h]=u._initCubicPoly(i[h+1][o](),i[h+2][o](),d*C,d*y)}else{n[o][h]=u._initCubicPoly(i[h+1][o](),i[h+2][o](),d*(i[h+2][o]()-i[h][o]()),d*(i[h+3][o]()-i[h+1][o]()))}}}if(isNaN(a)){return NaN}_=e.length;if(0>=a){return e[0][o]()}if(a>=_){return e[_-1][o]()}h=Math.floor(a);if(h===a){return e[h][o]()}a-=h;m=n[o][h];if(m===void 0){return NaN}return((m[3]*a+m[2])*a+m[1])*a+m[0]}};return[a("X"),a("Y"),0,function(){return e.length-1}]},CatmullRomSpline:function CatmullRomSpline(e,t){return this.CardinalSpline(e,.5,t)},regressionPolynomial:function regressionPolynomial(e,t,r){var n,a,d,s,p,u,h="";if(o.isPoint(e)&&o.isFunction(e.Value)){a=function(){return e.Value()}}else if(o.isFunction(e)){a=e}else if(o.isNumber(e)){a=function(){return e}}else{throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+_typeof(e)+"'.")}if(3===arguments.length&&o.isArray(t)&&o.isArray(r)){p=0}else if(2===arguments.length&&o.isArray(t)&&0<t.length&&o.isPoint(t[0])){p=1}else if(2===arguments.length&&o.isArray(t)&&0<t.length&&t[0].usrCoords&&t[0].scrCoords){p=2}else{throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.")}u=function(e,u){var m,g,b,C,v,f,P,_,S,E=t.length;S=Math.floor(a());if(!u){if(1===p){d=[];s=[];for(m=0;m<E;m++){d[m]=t[m].X();s[m]=t[m].Y()}}if(2===p){d=[];s=[];for(m=0;m<E;m++){d[m]=t[m].usrCoords[1];s[m]=t[m].usrCoords[2]}}if(0===p){d=[];s=[];for(m=0;m<E;m++){if(o.isFunction(t[m])){d.push(t[m]())}else{d.push(t[m])}if(o.isFunction(r[m])){s.push(r[m]())}else{s.push(r[m])}}}b=[];for(g=0;g<E;g++){b.push([1])}for(m=1;m<=S;m++){for(g=0;g<E;g++){b[g][m]=b[g][m-1]*d[g]}}v=s;C=l.transpose(b);f=l.matMatMult(C,b);P=l.matVecMult(C,v);n=l.Numerics.Gauss(f,P);h=l.Numerics.generatePolynomialTerm(n,S,"x",3)}_=n[S];for(m=S-1;0<=m;m--){_=_*e+n[m]}return _};u.getTerm=function(){return h};return u},bezier:function bezier(e){var r,o,i=function(i){return function(s,t){var n=3*Math.floor(s),a=s%1,d=1-a;if(!t){o=3*Math.floor((e.length-1)/3);r=Math.floor(o/3)}if(0>s){return e[0][i]()}if(s>=r){return e[o][i]()}if(isNaN(s)){return NaN}return d*d*(d*e[n][i]()+3*a*e[n+1][i]())+(3*d*e[n+2][i]()+a*e[n+3][i]())*a*a}};return[i("X"),i("Y"),0,function(){return Math.floor(e.length/3)}]},bspline:function bspline(e,r){var o,i=[],a=function(e,t){var r,o=[];for(r=0;r<e+t+1;r++){if(r<t){o[r]=0}else if(r<=e){o[r]=r-t+1}else{o[r]=e-t+2}}return o},d=function(e,t,r,o,n){var s,d,l,c,p,u=[];if(t[n]<=e&&e<t[n+1]){u[n]=1}else{u[n]=0}for(s=2;s<=o;s++){for(d=n-s+1;d<=n;d++){if(d<=n-s+1||0>d){l=0}else{l=u[d]}if(d>=n){c=0}else{c=u[d+1]}p=t[d+s-1]-t[d];if(0===p){u[d]=0}else{u[d]=(e-t[d])/p*l}p=t[d+s]-t[d+1];if(0!==p){u[d]+=(t[d+s]-e)/p*c}}}return u},l=function(t){return function(l){var c,p,u,h=e.length,m=h-1,n=r;if(0>=m){return NaN}if(m+2<=n){n=m+1}if(0>=l){return e[0][t]()}if(l>=m-n+2){return e[m][t]()}u=Math.floor(l)+n-1;o=a(m,n);i=d(l,o,m,n,u);c=0;for(p=u-n+1;p<=u;p++){if(p<h&&0<=p){c+=e[p][t]()*i[p]}}return c}};return[l("X"),l("Y"),0,function(){return e.length-1}]},D:function D(e,t){if(!o.exists(t)){return function(t,r){var o=1e-5;return(e(t+o,r)-e(t-o,r))/(2*o)}}return function(r,o){var i=1e-5;return(e.apply(t,[r+i,o])-e.apply(t,[r-i,o]))/(2*i)}},_riemannValue:function _riemannValue(e,t,r,o){var i,s,n,a;if(0>o){if("trapezoidal"!==r){e=e+o}o*=-1;if("lower"===r){r="upper"}else if("upper"===r){r="lower"}}a=.01*o;if("right"===r){i=t(e+o)}else if("middle"===r){i=t(e+.5*o)}else if("left"===r||"trapezoidal"===r){i=t(e)}else if("lower"===r){i=t(e);for(n=e+a;n<=e+o;n+=a){s=t(n);if(s<i){i=s}}s=t(e+o);if(s<i){i=s}}else if("upper"===r){i=t(e);for(n=e+a;n<=e+o;n+=a){s=t(n);if(s>i){i=s}}s=t(e+o);if(s>i){i=s}}else if("random"===r){i=t(e+o*Math.random())}else if("simpson"===r){i=(t(e)+4*t(e+.5*o)+t(e+o))/6}else{i=t(e)}return i},riemann:function riemann(e,t,r,s,a){var d,l,c=[],p=[],u=0,h=s,m,b=0,C,v,P,_;if(o.isArray(e)){v=e[0];C=e[1]}else{C=e}t=Math.floor(t);if(0>=t){return[c,p,b]}l=(a-s)/t;for(d=0;d<t;d++){m=this._riemannValue(h,C,r,l);c[u]=h;p[u]=m;u+=1;h+=l;if("trapezoidal"===r){m=C(h)}c[u]=h;p[u]=m;u+=1}for(d=0;d<t;d++){if(v){m=this._riemannValue(h,v,r,-l)}else{m=0}c[u]=h;p[u]=m;u+=1;h-=l;if("trapezoidal"===r&&v){m=v(h)}c[u]=h;p[u]=m;if("trapezoidal"!==r){P=m;_=p[2*(t-1)-2*d]}else{_=.5*(C(h+l)+C(h));if(v){P=.5*(v(h+l)+v(h))}else{P=0}}b+=(_-P)*l;u+=1;c[u]=h;p[u]=p[2*(t-1)-2*d];u+=1}return[c,p,b]},riemannsum:function riemannsum(t,r,o,i,s){e.deprecated("Numerics.riemannsum()","Numerics.riemann()");return this.riemann(t,r,o,i,s)[2]},rungeKutta:function rungeKutta(n,a,d,p,u){var m,g,b,C,v,f,P=[],_=[],y=(d[1]-d[0])/p,h=d[0],S=a.length,E=[],x=0;if(o.isString(n)){n=c[n]||c.euler}f=n.s;for(m=0;m<S;m++){P[m]=a[m]}for(g=0;g<p;g++){E[x]=[];for(m=0;m<S;m++){E[x][m]=P[m]}x+=1;C=[];for(b=0;b<f;b++){for(m=0;m<S;m++){_[m]=0}for(v=0;v<b;v++){for(m=0;m<S;m++){_[m]+=n.A[b][v]*y*C[v][m]}}for(m=0;m<S;m++){_[m]+=P[m]}C.push(u(h+n.c[b]*y,_))}for(m=0;m<S;m++){_[m]=0}for(v=0;v<f;v++){for(m=0;m<S;m++){_[m]+=n.b[v]*C[v][m]}}for(m=0;m<S;m++){P[m]=P[m]+y*_[m]}h+=y}return E},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function fzero(e,t,r){var s,n,d,h,m,g,C,y,v,f,P,_,S,E,x,O,T,A,w,j,N=l.eps,R=this.maxIterationsRoot,L=0;if(o.isArray(t)){if(2>t.length){throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.")}s=t[0];h=e.call(r,s);n=t[1];m=e.call(r,n)}else{s=t;h=e.call(r,s);if(0===s){C=1}else{C=s}y=[.9*C,1.1*C,C-1,C+1,.5*C,1.5*C,-C,2*C,-10*C,10*C];f=y.length;for(v=0;v<f;v++){n=y[v];m=e.call(r,n);if(0>=h*m){break}}if(n<s){P=s;s=n;n=P;_=h;h=m;m=_}}if(0<h*m){if(o.isArray(t)){return this.fminbr(e,[s,n],r)}return this.Newton(e,s,r)}d=s;g=h;while(L<R){S=n-s;if(Math.abs(g)<Math.abs(m)){s=n;n=d;d=s;h=m;m=g;g=h}T=2*N*Math.abs(n)+.5*N;j=.5*(d-n);if(Math.abs(j)<=T&&Math.abs(m)<=N){return n}if(Math.abs(S)>=T&&Math.abs(h)>Math.abs(m)){x=d-n;if(s===d){E=m/h;A=x*E;w=1-E}else{w=h/g;E=m/g;O=m/h;A=O*(x*w*(w-E)-(n-s)*(E-1));w=(w-1)*(E-1)*(O-1)}if(0<A){w=-w}else{A=-A}if(A<.75*x*w-.5*Math.abs(T*w)&&A<Math.abs(.5*(S*w))){j=A/w}}if(Math.abs(j)<T){if(0<j){j=T}else{j=-T}}s=n;h=m;n+=j;m=e.call(r,n);if(0<m&&0<g||0>m&&0>g){d=s;g=h}L++}return n},fminbr:function fminbr(e,i,s){var n,d,c,u,h,m,g,C,y,f,P,_,S,E,O,T,A=.5*(3-Math.sqrt(5)),r=l.eps,j=l.eps,N=this.maxIterationsMinimize,R=0;if(!o.isArray(i)||2>i.length){throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.")}n=i[0];d=i[1];u=n+A*(d-n);g=e.call(s,u);c=u;h=u;m=g;C=g;while(R<N){y=d-n;f=.5*(n+d);P=j*Math.abs(c)+r/3;if(Math.abs(c-f)+.5*y<=2*P){return c}_=A*(c<f?d-c:n-c);if(Math.abs(c-h)>=P){O=(c-h)*(m-g);E=(c-u)*(m-C);S=(c-u)*E-(c-h)*O;E=2*(E-O);if(0<E){S=-S}else{E=-E}if(Math.abs(S)<Math.abs(_*E)&&S>E*(n-c+2*P)&&S<E*(d-c-2*P)){_=S/E}}if(Math.abs(_)<P){if(0<_){_=P}else{_=-P}}O=c+_;T=e.call(s,O);if(T<=m){if(O<c){d=c}else{n=c}u=h;h=c;c=O;g=C;C=m;m=T}else{if(O<c){n=O}else{d=O}if(T<=C||h===c){u=h;h=O;g=C;C=T}else if(T<=g||u===c||u===h){u=O;g=T}}R+=1}return c},RamerDouglasPeucker:function RamerDouglasPeucker(e,t){var r=[],o,s,n,a=function(e,t,r){var o,i,s,n,a,c,p,u,h,m,g,b=0,C=t;if(2>r-t){return[-1,0]}s=e[t].scrCoords;n=e[r].scrCoords;if(isNaN(s[1]+s[2])){return[NaN,t]}if(isNaN(n[1]+n[2])){return[NaN,r]}for(i=t+1;i<r;i++){a=e[i].scrCoords;if(isNaN(a[1]+a[2])){return[NaN,i]}c=a[1]-s[1];p=a[2]-s[2];u=n[1]-s[1];h=n[2]-s[2];m=u*u+h*h;if(m>=l.eps){g=(c*u+p*h)/m;if(0>g){g=0}else if(1<g){g=1}c=c-g*u;p=p-g*h;o=c*c+p*p}else{g=0;o=c*c+p*p}if(o>b){b=o;C=i}}return[Math.sqrt(b),C]},d=function(e,t,r,o,i){var s=a(e,t,r),n=s[1];if(isNaN(s[0])){d(e,t,n-1,o,i);i.push(e[n]);do{++n}while(n<=r&&isNaN(e[n].scrCoords[1]+e[n].scrCoords[2]));if(n<=r){i.push(e[n])}d(e,n+1,r,o,i)}else if(s[0]>o){d(e,t,n,o,i);d(e,n,r,o,i)}else{i.push(e[r])}};n=e.length;o=0;while(o<n&&isNaN(e[o].scrCoords[1]+e[o].scrCoords[2])){o+=1}s=n-1;while(s>o&&isNaN(e[s].scrCoords[1]+e[s].scrCoords[2])){s-=1}if(!(o>s||o===n)){r[0]=e[o];d(e,o,s,t,r)}return r},RamerDouglasPeuker:function RamerDouglasPeuker(t,r){e.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()");return this.RamerDouglasPeucker(t,r)},Visvalingam:function Visvalingam(t,r){var o,s,n,a,d=[],l=[],c=[],p,u,h,m,g;s=t.length;if(2>=s){return t}d[0]={used:!0,lft:null,node:null};p=0;for(o=1;o<s-1;o++){n=Math.abs(e.Math.Numerics.det([t[o-1].usrCoords,t[o].usrCoords,t[o+1].usrCoords]));if(!isNaN(n)){g={v:n,idx:o};l.push(g);d[o]={used:!0,lft:p,node:g};d[p].rt=o;p=o}}d[s-1]={used:!0,rt:null,lft:p,node:null};d[p].rt=s-1;a=-Infinity;while(l.length>r){l.sort(function(e,t){return t.v-e.v});o=l.pop().idx;d[o].used=!1;a=d[o].node.v;p=d[o].lft;u=d[o].rt;d[p].rt=u;d[u].lft=p;h=d[p].lft;if(null!==h){n=Math.abs(e.Math.Numerics.det([t[h].usrCoords,t[p].usrCoords,t[u].usrCoords]));d[p].node.v=n>=a?n:a}m=d[u].rt;if(null!==m){n=Math.abs(e.Math.Numerics.det([t[p].usrCoords,t[u].usrCoords,t[m].usrCoords]));d[u].node.v=n>=a?n:a}}o=0;c=[t[o]];do{o=d[o].rt;c.push(t[o])}while(null!==d[o].rt);return c}};return l.Numerics});define("math/statistics",["jxg","math/math","utils/type"],function(e,t,r){"use strict";t.Statistics={sum:function sum(e){var t,r=e.length,o=0;for(t=0;t<r;t++){o+=e[t]}return o},prod:function prod(e){var t,r=e.length,o=1;for(t=0;t<r;t++){o*=e[t]}return o},mean:function mean(e){if(0<e.length){return this.sum(e)/e.length}return 0},median:function median(e){var t,r;if(0<e.length){t=e.slice(0);t.sort(function(e,t){return e-t});r=t.length;if(1==r%2){return t[parseInt(.5*r,10)]}return .5*(t[.5*r-1]+t[.5*r])}return 0},variance:function variance(e){var t,r,o,s=e.length;if(1<s){t=this.mean(e);r=0;for(o=0;o<s;o++){r+=(e[o]-t)*(e[o]-t)}return r/(e.length-1)}return 0},sd:function sd(e){return Math.sqrt(this.variance(e))},weightedMean:function weightedMean(e,t){if(e.length!==t.length){throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.")}if(0<e.length){return this.mean(this.multiply(e,t))}return 0},max:function max(e){return Math.max.apply(this,e)},min:function min(e){return Math.min.apply(this,e)},range:function range(e){return[this.min(e),this.max(e)]},abs:function abs(e){var t,o,s;if(r.isArray(e)){o=e.length;s=[];for(t=0;t<o;t++){s[t]=Math.abs(e[t])}}else{s=Math.abs(e)}return s},add:function add(e,t){var o,s,n=[];e=r.evalSlider(e);t=r.evalSlider(t);if(r.isArray(e)&&r.isNumber(t)){s=e.length;for(o=0;o<s;o++){n[o]=e[o]+t}}else if(r.isNumber(e)&&r.isArray(t)){s=t.length;for(o=0;o<s;o++){n[o]=e+t[o]}}else if(r.isArray(e)&&r.isArray(t)){s=Math.min(e.length,t.length);for(o=0;o<s;o++){n[o]=e[o]+t[o]}}else{n=e+t}return n},div:function div(e,t){var o,s,n=[];e=r.evalSlider(e);t=r.evalSlider(t);if(r.isArray(e)&&r.isNumber(t)){s=e.length;for(o=0;o<s;o++){n[o]=e[o]/t}}else if(r.isNumber(e)&&r.isArray(t)){s=t.length;for(o=0;o<s;o++){n[o]=e/t[o]}}else if(r.isArray(e)&&r.isArray(t)){s=Math.min(e.length,t.length);for(o=0;o<s;o++){n[o]=e[o]/t[o]}}else{n=e/t}return n},divide:function divide(){e.deprecated("Statistics.divide()","Statistics.div()");t.Statistics.div.apply(t.Statistics,arguments)},mod:function(e,o,s){var n,a,d=[],l=function(e,t){return e%t};s=r.def(s,!1);if(s){l=t.mod}e=r.evalSlider(e);o=r.evalSlider(o);if(r.isArray(e)&&r.isNumber(o)){a=e.length;for(n=0;n<a;n++){d[n]=l(e[n],o)}}else if(r.isNumber(e)&&r.isArray(o)){a=o.length;for(n=0;n<a;n++){d[n]=l(e,o[n])}}else if(r.isArray(e)&&r.isArray(o)){a=Math.min(e.length,o.length);for(n=0;n<a;n++){d[n]=l(e[n],o[n])}}else{d=l(e,o)}return d},multiply:function multiply(e,t){var o,s,n=[];e=r.evalSlider(e);t=r.evalSlider(t);if(r.isArray(e)&&r.isNumber(t)){s=e.length;for(o=0;o<s;o++){n[o]=e[o]*t}}else if(r.isNumber(e)&&r.isArray(t)){s=t.length;for(o=0;o<s;o++){n[o]=e*t[o]}}else if(r.isArray(e)&&r.isArray(t)){s=Math.min(e.length,t.length);for(o=0;o<s;o++){n[o]=e[o]*t[o]}}else{n=e*t}return n},subtract:function subtract(e,t){var o,s,n=[];e=r.evalSlider(e);t=r.evalSlider(t);if(r.isArray(e)&&r.isNumber(t)){s=e.length;for(o=0;o<s;o++){n[o]=e[o]-t}}else if(r.isNumber(e)&&r.isArray(t)){s=t.length;for(o=0;o<s;o++){n[o]=e-t[o]}}else if(r.isArray(e)&&r.isArray(t)){s=Math.min(e.length,t.length);for(o=0;o<s;o++){n[o]=e[o]-t[o]}}else{n=e-t}return n},TheilSenRegression:function TheilSenRegression(e){var r,o,s=[],n=[],a=[];for(r=0;r<e.length;r++){n.length=0;for(o=0;o<e.length;o++){if(Math.abs(e[o].usrCoords[1]-e[r].usrCoords[1])>t.eps){n[o]=(e[o].usrCoords[2]-e[r].usrCoords[2])/(e[o].usrCoords[1]-e[r].usrCoords[1])}}s[r]=this.median(n);a.push(e[r].usrCoords[2]-s[r]*e[r].usrCoords[1])}return[this.median(a),this.median(s),-1]}};return t.Statistics});define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],function(e,r,o,h,m,g,b){"use strict";h.Geometry={};e.extend(h.Geometry,{angle:function angle(r,o,i){var n,d,l,p,h=[],a=[],m=[];e.deprecated("Geometry.angle()","Geometry.rad()");if(r.coords){h[0]=r.coords.usrCoords[1];h[1]=r.coords.usrCoords[2]}else{h[0]=r[0];h[1]=r[1]}if(o.coords){a[0]=o.coords.usrCoords[1];a[1]=o.coords.usrCoords[2]}else{a[0]=o[0];a[1]=o[1]}if(i.coords){m[0]=i.coords.usrCoords[1];m[1]=i.coords.usrCoords[2]}else{m[0]=i[0];m[1]=i[1]}n=h[0]-a[0];d=h[1]-a[1];l=m[0]-a[0];p=m[1]-a[1];return Math.atan2(n*p-d*l,n*l+d*p)},trueAngle:function trueAngle(e,t,r){return 57.29577951308232*this.rad(e,t,r)},rad:function rad(e,t,r){var o,i,s,n,a,d,l;if(e.coords){o=e.coords.usrCoords[1];i=e.coords.usrCoords[2]}else{o=e[0];i=e[1]}if(t.coords){s=t.coords.usrCoords[1];n=t.coords.usrCoords[2]}else{s=t[0];n=t[1]}if(r.coords){a=r.coords.usrCoords[1];d=r.coords.usrCoords[2]}else{a=r[0];d=r[1]}l=Math.atan2(d-n,a-s)-Math.atan2(i-n,o-s);if(0>l){l+=6.283185307179586}return l},angleBisector:function angleBisector(e,t,i,s){var n,a,d,l=e.coords.usrCoords,c=t.coords.usrCoords,p=i.coords.usrCoords,u,h;if(!g.exists(s)){s=e.board}if(0===c[0]){return new o(r.COORDS_BY_USER,[1,.5*(l[1]+p[1]),.5*(l[2]+p[2])],s)}u=l[1]-c[1];h=l[2]-c[2];n=Math.atan2(h,u);u=p[1]-c[1];h=p[2]-c[2];a=Math.atan2(h,u);d=.5*(n+a);if(n>a){d+=Math.PI}u=Math.cos(d)+c[1];h=Math.sin(d)+c[2];return new o(r.COORDS_BY_USER,[1,u,h],s)},reflection:function reflection(e,t,i){var s,n,a,d,l,c,p,u=t.coords.usrCoords,h=e.point1.coords.usrCoords,m=e.point2.coords.usrCoords;if(!g.exists(i)){i=t.board}l=m[1]-h[1];c=m[2]-h[2];s=u[1]-h[1];n=u[2]-h[2];p=(l*n-c*s)/(l*l+c*c);a=u[1]+2*p*c;d=u[2]-2*p*l;return new o(r.COORDS_BY_USER,[a,d],i)},rotation:function rotation(e,t,i,n){var a,d,l,p,u,h,m=t.coords.usrCoords,b=e.coords.usrCoords;if(!g.exists(n)){n=t.board}a=m[1]-b[1];d=m[2]-b[2];l=Math.cos(i);p=Math.sin(i);u=a*l-d*p+b[1];h=a*p+d*l+b[2];return new o(r.COORDS_BY_USER,[u,h],n)},perpendicular:function perpendicular(e,t,i){var s,n,a,d,l,p=e.point1.coords.usrCoords,u=e.point2.coords.usrCoords,m=t.coords.usrCoords;if(!g.exists(i)){i=t.board}if(t===e.point1){s=p[1]+u[2]-p[2];n=p[2]-u[1]+p[1];l=p[0]*u[0];if(Math.abs(l)<h.eps){s=u[2];n=-u[1]}d=[l,s,n];a=!0}else if(t===e.point2){s=u[1]+p[2]-u[2];n=u[2]-p[1]+u[1];l=p[0]*u[0];if(Math.abs(l)<h.eps){s=p[2];n=-p[1]}d=[l,s,n];a=!1}else if(Math.abs(h.innerProduct(m,e.stdform,3))<h.eps){s=m[1]+u[2]-m[2];n=m[2]-u[1]+m[1];l=u[0];if(Math.abs(l)<h.eps){s=u[2];n=-u[1]}a=!0;if(Math.abs(l)>h.eps&&Math.abs(s-m[1])<h.eps&&Math.abs(n-m[2])<h.eps){s=m[1]+p[2]-m[2];n=m[2]-p[1]+m[1];a=!1}d=[l,s,n]}else{d=[0,e.stdform[1],e.stdform[2]];d=h.crossProduct(d,m);d=h.crossProduct(d,e.stdform);a=!0}return[new o(r.COORDS_BY_USER,d,i),a]},circumcenterMidpoint:function circumcenterMidpoint(){e.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()");this.circumcenter.apply(this,arguments)},circumcenter:function circumcenter(e,t,i,s){var n,a,d,l,c=e.coords.usrCoords,p=t.coords.usrCoords,m=i.coords.usrCoords;if(!g.exists(s)){s=e.board}n=[p[0]-c[0],-p[2]+c[2],p[1]-c[1]];a=[.5*(c[0]+p[0]),.5*(c[1]+p[1]),.5*(c[2]+p[2])];d=h.crossProduct(n,a);n=[m[0]-p[0],-m[2]+p[2],m[1]-p[1]];a=[.5*(p[0]+m[0]),.5*(p[1]+m[1]),.5*(p[2]+m[2])];l=h.crossProduct(n,a);return new o(r.COORDS_BY_USER,h.crossProduct(d,l),s)},distance:function distance(e,t,r){var o,s=0;if(!r){r=Math.min(e.length,t.length)}for(o=0;o<r;o++){s+=(e[o]-t[o])*(e[o]-t[o])}return Math.sqrt(s)},affineDistance:function affineDistance(e,t,r){var o=this.distance(e,t,r);if(o>h.eps&&(Math.abs(e[0])<h.eps||Math.abs(t[0])<h.eps)){return 1/0}return o},sortVertices:function sortVertices(e){var t,r,o=b.each(e,b.coordsArray),s=o.length;for(t=1;t<s;t++){if(o[t][2]<o[0][2]||Math.abs(o[t][2]-o[0][2])<h.eps&&o[t][1]<o[0][1]){o=g.swap(o,t,0)}}r=o.shift();o.sort(function(e,t){var o=Math.atan2(e[2]-r[2],e[1]-r[1]),i=Math.atan2(t[2]-r[2],t[1]-r[1]);return o-i});o.unshift(r);o.unshift(o[o.length-1]);return o},signedTriangle:function signedTriangle(e,t,r){var o=b.coordsArray(e),i=b.coordsArray(t),s=b.coordsArray(r);return .5*((i[1]-o[1])*(s[2]-o[2])-(i[2]-o[2])*(s[1]-o[1]))},signedPolygon:function signedPolygon(e,t){var r,o,s=0,n=b.each(e,b.coordsArray);if(t===void 0){t=!0}if(!t){n=this.sortVertices(n)}else{n.unshift(n[n.length-1])}o=n.length;for(r=1;r<o;r++){s+=n[r-1][1]*n[r][2]-n[r][1]*n[r-1][2]}return .5*s},GrahamScan:function GrahamScan(e){var t,r=1,o=b.each(e,b.coordsArray),s=o.length;o=this.sortVertices(o);s=o.length;for(t=2;t<s;t++){while(0>=this.signedTriangle(o[r-1],o[r],o[t])){if(1<r){r-=1}else if(t===s-1){break}else{t+=1}}r+=1;o=g.swap(o,r,t)}return o.slice(0,r)},calcStraight:function calcStraight(e,t,o,i){var s,n,a,d,l,p,u,m,b,C;if(!g.exists(i)){i=10}p=g.evaluate(e.visProp.straightfirst);u=g.evaluate(e.visProp.straightlast);if(Math.abs(t.scrCoords[0])<h.eps){p=!0}if(Math.abs(o.scrCoords[0])<h.eps){u=!0}if(!p&&!u){return}m=[];m[0]=e.stdform[0]-e.stdform[1]*e.board.origin.scrCoords[1]/e.board.unitX+e.stdform[2]*e.board.origin.scrCoords[2]/e.board.unitY;m[1]=e.stdform[1]/e.board.unitX;m[2]=-e.stdform[2]/e.board.unitY;if(isNaN(m[0]+m[1]+m[2])){return}s=!1;n=!1;s=!p&&Math.abs(t.usrCoords[0])>=h.eps&&0<=t.scrCoords[1]&&t.scrCoords[1]<=e.board.canvasWidth&&0<=t.scrCoords[2]&&t.scrCoords[2]<=e.board.canvasHeight;n=!u&&Math.abs(o.usrCoords[0])>=h.eps&&0<=o.scrCoords[1]&&o.scrCoords[1]<=e.board.canvasWidth&&0<=o.scrCoords[2]&&o.scrCoords[2]<=e.board.canvasHeight;a=this.meetLineBoard(m,e.board,i);d=a[0];l=a[1];if(!s&&!n){if(!p&&u&&!this.isSameDirection(t,o,d)&&!this.isSameDirection(t,o,l)){return}if(p&&!u&&!this.isSameDirection(o,t,d)&&!this.isSameDirection(o,t,l)){return}}if(!s){if(!n){if(this.isSameDir(t,o,d,l)){b=d;C=l}else{C=d;b=l}}else{if(this.isSameDir(t,o,d,l)){b=d}else{b=l}}}else{if(!n){if(this.isSameDir(t,o,d,l)){C=l}else{C=d}}}if(b){t.setCoordinates(r.COORDS_BY_USER,b.usrCoords)}if(C){o.setCoordinates(r.COORDS_BY_USER,C.usrCoords)}},calcLineDelimitingPoints:function calcLineDelimitingPoints(e,t,o){var i,s,n,a,d,l,p,u,m,b,C=!1,y=!1;l=g.evaluate(e.visProp.straightfirst);p=g.evaluate(e.visProp.straightlast);if(Math.abs(t.scrCoords[0])<h.eps){l=!0}if(Math.abs(o.scrCoords[0])<h.eps){p=!0}u=[];u[0]=e.stdform[0]-e.stdform[1]*e.board.origin.scrCoords[1]/e.board.unitX+e.stdform[2]*e.board.origin.scrCoords[2]/e.board.unitY;u[1]=e.stdform[1]/e.board.unitX;u[2]=-e.stdform[2]/e.board.unitY;if(isNaN(u[0]+u[1]+u[2])){return}C=!l;y=!p;s=e.board.getBoundingBox();n=e.getSlope();if(0<=n){a=this.projectPointToLine({coords:{usrCoords:[1,s[2],s[1]]}},e,e.board);d=this.projectPointToLine({coords:{usrCoords:[1,s[0],s[3]]}},e,e.board)}else{a=this.projectPointToLine({coords:{usrCoords:[1,s[0],s[1]]}},e,e.board);d=this.projectPointToLine({coords:{usrCoords:[1,s[2],s[3]]}},e,e.board)}if(!C&&!y){if(!l&&!p){i=t.distance(r.COORDS_BY_USER,o);if(Math.abs(t.distance(r.COORDS_BY_USER,a)+a.distance(r.COORDS_BY_USER,o)-i)>h.eps){return}if(Math.abs(t.distance(r.COORDS_BY_USER,d)+d.distance(r.COORDS_BY_USER,o)-i)>h.eps){return}}if(!l&&p&&!this.isSameDirection(t,o,a)&&!this.isSameDirection(t,o,d)){return}if(l&&!p&&!this.isSameDirection(o,t,a)&&!this.isSameDirection(o,t,d)){return}}if(!C){if(!y){if(this.isSameDir(t,o,a,d)){m=a;b=d}else{b=a;m=d}}else{if(this.isSameDir(t,o,a,d)){m=a}else{m=d}}}else{if(!y){if(this.isSameDir(t,o,a,d)){b=d}else{b=a}}}if(m){t.setCoordinates(r.COORDS_BY_USER,m.usrCoords)}if(b){o.setCoordinates(r.COORDS_BY_USER,b.usrCoords)}},calcLabelQuadrant:function calcLabelQuadrant(e){var t;if(0>e){e+=2*Math.PI}t=Math.floor((e+Math.PI/8)/(Math.PI/4))%8;return["rt","urt","top","ulft","lft","llft","lrt"][t]},isSameDir:function isSameDir(e,t,r,o){var i=t.usrCoords[1]-e.usrCoords[1],s=t.usrCoords[2]-e.usrCoords[2],n=o.usrCoords[1]-r.usrCoords[1],a=o.usrCoords[2]-r.usrCoords[2];if(Math.abs(t.usrCoords[0])<h.eps){i=t.usrCoords[1];s=t.usrCoords[2]}if(Math.abs(e.usrCoords[0])<h.eps){i=-e.usrCoords[1];s=-e.usrCoords[2]}return 0<=i*n+s*a},isSameDirection:function isSameDirection(e,t,o){var i,s,n,a,d=!1;i=t.usrCoords[1]-e.usrCoords[1];s=t.usrCoords[2]-e.usrCoords[2];n=o.usrCoords[1]-e.usrCoords[1];a=o.usrCoords[2]-e.usrCoords[2];if(Math.abs(i)<h.eps){i=0}if(Math.abs(s)<h.eps){s=0}if(Math.abs(n)<h.eps){n=0}if(Math.abs(a)<h.eps){a=0}if(0<=i&&0<=n){d=0<=s&&0<=a||0>=s&&0>=a}else if(0>=i&&0>=n){d=0<=s&&0<=a||0>=s&&0>=a}return d},intersectionFunction:function intersectionFunction(e,t,s,n,i,a){var d,l=this;if(t.elementClass===r.OBJECT_CLASS_CURVE&&s.elementClass===r.OBJECT_CLASS_CURVE){d=function(){return l.meetCurveCurve(t,s,n,i,t.board)}}else if(t.elementClass===r.OBJECT_CLASS_CURVE&&s.elementClass===r.OBJECT_CLASS_LINE||s.elementClass===r.OBJECT_CLASS_CURVE&&t.elementClass===r.OBJECT_CLASS_LINE){d=function(){return l.meetCurveLine(t,s,n,t.board,a)}}else if(t.elementClass===r.OBJECT_CLASS_LINE&&s.elementClass===r.OBJECT_CLASS_LINE){d=function(){var e,i,d,p,u,h;d=p=g.evaluate(t.visProp.straightfirst);u=h=g.evaluate(t.visProp.straightlast);if(!g.evaluate(a)&&(!d||!u||!p||!h)){e=l.meetSegmentSegment(t.point1.coords.usrCoords,t.point2.coords.usrCoords,s.point1.coords.usrCoords,s.point2.coords.usrCoords,t.board);if(!d&&0>e[1]||!u&&1<e[1]||!p&&0>e[2]||!h&&1<e[2]){i=[0,NaN,NaN]}else{i=e[0]}return new o(r.COORDS_BY_USER,i,t.board)}return l.meet(t.stdform,s.stdform,n,t.board)}}else{d=function(){return l.meet(t.stdform,s.stdform,n,t.board)}}return d},meet:function meet(e,t,r,o){var i,s=h.eps;if(Math.abs(e[3])<s&&Math.abs(t[3])<s){i=this.meetLineLine(e,t,r,o)}else if(Math.abs(e[3])>=s&&Math.abs(t[3])<s){i=this.meetLineCircle(t,e,r,o)}else if(Math.abs(e[3])<s&&Math.abs(t[3])>=s){i=this.meetLineCircle(e,t,r,o)}else{i=this.meetCircleCircle(e,t,r,o)}return i},meetLineBoard:function meetLineBoard(e,t,n){var a=[],s,d,l,c;if(!g.exists(n)){n=0}a[0]=h.crossProduct(e,[n,0,1]);a[1]=h.crossProduct(e,[n,1,0]);a[2]=h.crossProduct(e,[-n-t.canvasHeight,0,1]);a[3]=h.crossProduct(e,[-n-t.canvasWidth,1,0]);for(l=0;4>l;l++){if(Math.abs(a[l][0])>h.eps){for(c=2;0<c;c--){a[l][c]/=a[l][0]}a[l][0]=1}}if(Math.abs(a[1][0])<h.eps){s=a[0];d=a[2]}else if(Math.abs(a[0][0])<h.eps){s=a[1];d=a[3]}else if(0>a[1][2]){s=a[0];if(a[3][2]>t.canvasHeight){d=a[2]}else{d=a[3]}}else if(a[1][2]>t.canvasHeight){s=a[2];if(0>a[3][2]){d=a[0]}else{d=a[3]}}else{s=a[1];if(0>a[3][2]){d=a[0]}else if(a[3][2]>t.canvasHeight){d=a[2]}else{d=a[3]}}s=new o(r.COORDS_BY_SCREEN,s.slice(1),t);d=new o(r.COORDS_BY_SCREEN,d.slice(1),t);return[s,d]},meetLineLine:function meetLineLine(e,t,n,i){var a=isNaN(e[5]+t[5])?[0,0,0]:h.crossProduct(e,t);return new o(r.COORDS_BY_USER,a,i)},meetLineCircle:function meetLineCircle(e,s,l,i){var p,u,m,g,y,v,f,P,_,S;if(s[4]<h.eps){if(Math.abs(h.innerProduct([1,s[6],s[7]],e,3))<h.eps){return new o(r.COORDS_BY_USER,s.slice(6,8),i)}return new o(r.COORDS_BY_USER,[NaN,NaN],i)}m=s[0];u=s.slice(1,3);p=s[3];g=e[0];y=e.slice(1,3);v=p;f=u[0]*y[1]-u[1]*y[0];P=p*g*g-(u[0]*y[0]+u[1]*y[1])*g+m;_=f*f-4*v*P;if(_>-h.eps*h.eps){_=Math.sqrt(Math.abs(_));S=[(-f+_)/(2*v),(-f-_)/(2*v)];return 0===l?new o(r.COORDS_BY_USER,[-S[0]*-y[1]-g*y[0],-S[0]*y[0]-g*y[1]],i):new o(r.COORDS_BY_USER,[-S[1]*-y[1]-g*y[0],-S[1]*y[0]-g*y[1]],i)}return new o(r.COORDS_BY_USER,[0,0,0],i)},meetCircleCircle:function meetCircleCircle(e,t,s,i){var n;if(e[4]<h.eps){if(Math.abs(this.distance(e.slice(6,2),t.slice(6,8))-t[4])<h.eps){return new o(r.COORDS_BY_USER,e.slice(6,8),i)}return new o(r.COORDS_BY_USER,[0,0,0],i)}if(t[4]<h.eps){if(Math.abs(this.distance(t.slice(6,2),e.slice(6,8))-e[4])<h.eps){return new o(r.COORDS_BY_USER,t.slice(6,8),i)}return new o(r.COORDS_BY_USER,[0,0,0],i)}n=[t[3]*e[0]-e[3]*t[0],t[3]*e[1]-e[3]*t[1],t[3]*e[2]-e[3]*t[2],0,1,1/0,1/0,1/0];n=h.normalize(n);return this.meetLineCircle(n,e,s,i)},meetCurveCurve:function meetCurveCurve(e,t,i,s,n,a){var d;if(g.exists(a)&&"newton"===a){d=m.generalizedNewton(e,t,i,s)}else{if(3===e.bezierDegree&&3===t.bezierDegree){d=this.meetBezierCurveRedBlueSegments(e,t,i)}else{d=this.meetCurveRedBlueSegments(e,t,i)}}return new o(r.COORDS_BY_USER,d,n)},meetCurveLine:function meetCurveLine(e,t,o,i,s){var n=[0,NaN,NaN],a,d;if(!g.exists(i)){i=e.board}if(e.elementClass===r.OBJECT_CLASS_CURVE){a=e;d=t}else{a=t;d=e}n=this.meetCurveLineDiscrete(a,d,o,i,!s);return n},meetCurveLineContinuous:function meetCurveLineContinuous(e,s,n,a,d){var l,c,p,u,g,b,C,f=h.eps,P=h.eps,_,S,E,O,T,A,w;u=this.meetCurveLineDiscrete(e,s,n,a,d);g=u.usrCoords[1];b=u.usrCoords[2];c=function(r){var t,o;if(r>e.maxX()||r<e.minX()){return 1/0}t=g-e.X(r);o=b-e.Y(r);return t*t+o*o};p=function(r){var t=s.stdform[0]+s.stdform[1]*e.X(r)+s.stdform[2]*e.Y(r);return t*t};_=50;S=(e.maxX()-e.minX())/_;E=e.minX();A=1e-4;T=NaN;for(O=0;O<_;O++){l=m.root(c,[Math.max(E,e.minX()),Math.min(E+S,e.maxX())]);w=Math.abs(c(l));if(w<=A){A=w;T=l;if(A<f){break}}E+=S}l=T;l=m.root(p,[Math.max(l-S,e.minX()),Math.min(l+S,e.maxX())]);w=p(l);if(isNaN(w)||Math.abs(w)>P){C=0}else{C=1}return new o(r.COORDS_BY_USER,[C,e.X(l),e.Y(l)],a)},meetCurveLineContinuousOld:function meetCurveLineContinuousOld(s,n,a,d){var l,c,p,u,g,b,C,y,v,f,P,_,S=10*h.eps;e.deprecated("Geometry.meetCurveLineContinuousOld()","Geometry.meetCurveLineContinuous()");u=function(e){var t=n.stdform[0]+n.stdform[1]*s.X(e)+n.stdform[2]*s.Y(e);return t*t};if(this.meetCurveLineContinuous.t1memo){v=this.meetCurveLineContinuous.t1memo;l=m.root(u,v)}else{v=s.minX();f=s.maxX();l=m.root(u,[v,f])}this.meetCurveLineContinuous.t1memo=l;P=s.X(l);_=s.Y(l);if(1===a){if(this.meetCurveLineContinuous.t2memo){v=this.meetCurveLineContinuous.t2memo}c=m.root(u,v);if(!(.1<Math.abs(c-l)&&.1<Math.abs(P-s.X(c))&&.1<Math.abs(_-s.Y(c)))){C=20;y=(s.maxX()-s.minX())/C;b=s.minX();for(p=0;p<C;p++){c=m.root(u,[b,b+y]);if(Math.abs(u(c))<=S&&.1<Math.abs(c-l)&&.1<Math.abs(P-s.X(c))&&.1<Math.abs(_-s.Y(c))){break}b+=y}}l=c;this.meetCurveLineContinuous.t2memo=l}if(Math.abs(u(l))>S){g=NaN}else{g=1}return new o(r.COORDS_BY_USER,[g,s.X(l),s.Y(l)],d)},meetCurveLineDiscrete:function meetCurveLineDiscrete(e,t,s,n,a){var l,c,u,m,b,C,y=t.point1.coords.usrCoords,v=t.point2.coords.usrCoords,f,P,_=0,S=e.numberPoints,E=g.evaluate(t.visProp.straightfirst),x=g.evaluate(t.visProp.straightlast);C=new o(r.COORDS_BY_USER,[0,NaN,NaN],n);if(0===y[0]){y=[1,v[1]+t.stdform[2],v[2]-t.stdform[1]]}else if(0===v[0]){v=[1,y[1]+t.stdform[2],y[2]-t.stdform[1]]}m=e.points[0].usrCoords;for(l=1;l<S;l++){u=m.slice(0);m=e.points[l].usrCoords;f=this.distance(u,m);if(f>h.eps){if(3===e.bezierDegree){P=this.meetBeziersegmentBeziersegment([e.points[l-1].usrCoords.slice(1),e.points[l].usrCoords.slice(1),e.points[l+1].usrCoords.slice(1),e.points[l+2].usrCoords.slice(1)],[y.slice(1),v.slice(1)],a);l+=2}else{P=[this.meetSegmentSegment(u,m,y,v)]}for(c=0;c<P.length;c++){b=P[c];if(0<=b[1]&&1>=b[1]){if(_===s){if(a&&(!E&&0>b[2]||!x&&1<b[2])){return C}C=new o(r.COORDS_BY_USER,b[0],n);return C}_+=1}}}}return C},meetCurveRedBlueSegments:function meetCurveRedBlueSegments(e,t,r){var o,s,n,a,d,l,c,p,u,h=0,g=t.numberPoints,b=e.numberPoints;if(1>=g||1>=b){return[0,NaN,NaN]}for(o=1;o<b;o++){n=e.points[o-1].usrCoords;a=e.points[o].usrCoords;p=Math.min(n[1],a[1]);u=Math.max(n[1],a[1]);l=t.points[0].usrCoords;for(s=1;s<g;s++){d=l;l=t.points[s].usrCoords;if(Math.min(d[1],l[1])<u&&Math.max(d[1],l[1])>p){c=this.meetSegmentSegment(n,a,d,l);if(0<=c[1]&&0<=c[2]&&(1>c[1]&&1>c[2]||o===b-1&&1===c[1]||s===g-1&&1===c[2])){if(h===r){return c[0]}h++}}}}return[0,NaN,NaN]},meetSegmentSegment:function meetSegmentSegment(e,r,o,i){var s,n,a,d=h.crossProduct(e,r),l=h.crossProduct(o,i),p=h.crossProduct(d,l),c=p[0];if(Math.abs(c)<h.eps){return[p,1/0,1/0]}a=[o[1]-e[1],o[2]-e[2]];s=(a[0]*(i[2]-o[2])-a[1]*(i[1]-o[1]))/c;n=(a[0]*(r[2]-e[2])-a[1]*(r[1]-e[1]))/c;return[p,s,n]},_bezierSplit:function _bezierSplit(e){var t,r,o,i,s,n;t=[.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1])];r=[.5*(e[1][0]+e[2][0]),.5*(e[1][1]+e[2][1])];o=[.5*(e[2][0]+e[3][0]),.5*(e[2][1]+e[3][1])];i=[.5*(t[0]+r[0]),.5*(t[1]+r[1])];s=[.5*(r[0]+o[0]),.5*(r[1]+o[1])];n=[.5*(i[0]+s[0]),.5*(i[1]+s[1])];return[[e[0],t,i,n],[n,s,o,e[3]]]},_bezierBbox:function _bezierBbox(e){var t=[];if(4===e.length){t[0]=Math.min(e[0][0],e[1][0],e[2][0],e[3][0]);t[1]=Math.max(e[0][1],e[1][1],e[2][1],e[3][1]);t[2]=Math.max(e[0][0],e[1][0],e[2][0],e[3][0]);t[3]=Math.min(e[0][1],e[1][1],e[2][1],e[3][1])}else{t[0]=Math.min(e[0][0],e[1][0]);t[1]=Math.max(e[0][1],e[1][1]);t[2]=Math.max(e[0][0],e[1][0]);t[3]=Math.min(e[0][1],e[1][1])}return t},_bezierOverlap:function _bezierOverlap(e,t){return e[2]>=t[0]&&e[0]<=t[2]&&e[1]>=t[3]&&e[3]<=t[1]},_bezierListConcat:function _bezierListConcat(e,t,r,o){var s,n=g.exists(o),a=0,d=t.length,l=e.length;if(0<l&&0<d&&(1===e[l-1][1]&&0===t[0][1]||n&&1===e[l-1][2]&&0===t[0][2])){a=1}for(s=a;s<d;s++){if(n){t[s][2]*=.5;t[s][2]+=o}t[s][1]*=.5;t[s][1]+=r;e.push(t[s])}},_bezierMeetSubdivision:function _bezierMeetSubdivision(e,t,r){var o,i,s,n,a,d,l,c,p,u,h,g,b=[];i=this._bezierBbox(t);o=this._bezierBbox(e);if(!this._bezierOverlap(i,o)){return[]}if(r<5){s=this._bezierSplit(e);d=s[0];l=s[1];s=this._bezierSplit(t);n=s[0];a=s[1];this._bezierListConcat(b,this._bezierMeetSubdivision(d,n,r+1),0,0);this._bezierListConcat(b,this._bezierMeetSubdivision(d,a,r+1),0,.5);this._bezierListConcat(b,this._bezierMeetSubdivision(l,n,r+1),.5,0);this._bezierListConcat(b,this._bezierMeetSubdivision(l,a,r+1),.5,.5);return b}h=[1].concat(e[0]);g=[1].concat(e[3]);p=[1].concat(t[0]);u=[1].concat(t[3]);c=this.meetSegmentSegment(h,g,p,u);if(0<=c[1]&&0<=c[2]&&1>=c[1]&&1>=c[2]){return[c]}return[]},_bezierLineMeetSubdivision:function _bezierLineMeetSubdivision(e,t,r,o){var i,s,n,a,d,l,c,p,u,h,g=[];i=this._bezierBbox(t);s=this._bezierBbox(e);if(o&&!this._bezierOverlap(s,i)){return[]}if(r<5){n=this._bezierSplit(e);a=n[0];d=n[1];this._bezierListConcat(g,this._bezierLineMeetSubdivision(a,t,r+1),0);this._bezierListConcat(g,this._bezierLineMeetSubdivision(d,t,r+1),.5);return g}u=[1].concat(e[0]);h=[1].concat(e[3]);c=[1].concat(t[0]);p=[1].concat(t[1]);l=this.meetSegmentSegment(u,h,c,p);if(0<=l[1]&&1>=l[1]){if(!o||0<=l[2]&&1>=l[2]){return[l]}}return[]},meetBeziersegmentBeziersegment:function meetBeziersegmentBeziersegment(e,t,r){var o,s,n;if(4===e.length&&4===t.length){o=this._bezierMeetSubdivision(e,t,0)}else{o=this._bezierLineMeetSubdivision(e,t,0,r)}o.sort(function(e,t){return 1e7*(e[1]-t[1])+(e[2]-t[2])});s=[];for(n=0;n<o.length;n++){if(0===n||o[n][1]!==o[n-1][1]||o[n][2]!==o[n-1][2]){s.push(o[n])}}return s},meetBezierCurveRedBlueSegments:function meetBezierCurveRedBlueSegments(e,t,r){var o,s,n,a,d,l,c,u=t.numberPoints,h=e.numberPoints,m=[];if(4>u||4>h){return[0,NaN,NaN]}for(s=0;s<h-3;s+=3){o=e.points;a=[[o[s].usrCoords[1],o[s].usrCoords[2]],[o[s+1].usrCoords[1],o[s+1].usrCoords[2]],[o[s+2].usrCoords[1],o[s+2].usrCoords[2]],[o[s+3].usrCoords[1],o[s+3].usrCoords[2]]];l=this._bezierBbox(a);for(n=0;n<u-3;n+=3){o=t.points;d=[[o[n].usrCoords[1],o[n].usrCoords[2]],[o[n+1].usrCoords[1],o[n+1].usrCoords[2]],[o[n+2].usrCoords[1],o[n+2].usrCoords[2]],[o[n+3].usrCoords[1],o[n+3].usrCoords[2]]];c=this._bezierBbox(d);if(this._bezierOverlap(l,c)){m=m.concat(this.meetBeziersegmentBeziersegment(a,d));if(m.length>r){return m[r][0]}}}}if(m.length>r){return m[r][0]}return[0,NaN,NaN]},bezierSegmentEval:function bezierSegmentEval(e,t){var r,o,i,s=1-e;o=0;i=0;r=s*s*s;o+=r*t[0][0];i+=r*t[0][1];r=3*e*s*s;o+=r*t[1][0];i+=r*t[1][1];r=3*e*e*s;o+=r*t[2][0];i+=r*t[2][1];r=e*e*e;o+=r*t[3][0];i+=r*t[3][1];return[1,o,i]},bezierArc:function bezierArc(e,t,o,i,s){var n,a,l,c,p,u,m,g=.5*Math.PI,b=t[1],C=t[2],f=t[0],P=[],_=[],S,E,O,T,A,w,j,N,R,L;p=this.distance(t,e);b/=f;C/=f;u=this.rad(e.slice(1),t.slice(1),o.slice(1));if(-1===s){u=2*Math.PI-u}n=e;n[1]/=n[0];n[2]/=n[0];n[0]/=n[0];c=n.slice(0);if(i){P=[b,b+.333*(n[1]-b),b+.666*(n[1]-b),n[1]];_=[C,C+.333*(n[2]-C),C+.666*(n[2]-C),n[2]]}else{P=[n[1]];_=[n[2]]}while(u>h.eps){if(u>g){m=g;u-=g}else{m=u;u=0}S=Math.cos(s*m);E=Math.sin(s*m);L=[[1,0,0],[b*(1-S)+C*E,S,-E],[C*(1-S)-b*E,E,S]];N=h.matVecMult(L,n);c=[N[0]/N[0],N[1]/N[0],N[2]/N[0]];O=n[1]-b;T=n[2]-C;A=c[1]-b;w=c[2]-C;R=Math.sqrt((O+A)*(O+A)+(T+w)*(T+w));if(Math.abs(w-T)>h.eps){j=8*((O+A)*(p/R-.5)/(w-T))/3}else{j=8*((T+w)*(p/R-.5)/(O-A))/3}a=[1,n[1]-j*T,n[2]+j*O];l=[1,c[1]+j*w,c[2]-j*A];P=P.concat([a[1],l[1],c[1]]);_=_.concat([a[2],l[2],c[2]]);n=c.slice(0)}if(i){P=P.concat([c[1]+.333*(b-c[1]),c[1]+.666*(b-c[1]),b]);_=_.concat([c[2]+.333*(C-c[2]),c[2]+.666*(C-c[2]),C])}return[P,_]},projectPointToCircle:function projectPointToCircle(e,t,i){var s,n,a,d,l,c=t.center.coords.usrCoords;if(!g.exists(i)){i=e.board}if(g.isPoint(e)){s=e.coords.distance(r.COORDS_BY_USER,t.center.coords);n=e.coords.usrCoords}else{s=e.distance(r.COORDS_BY_USER,t.center.coords);n=e.usrCoords}if(Math.abs(s)<h.eps){s=h.eps}l=t.Radius()/s;a=c[1]+l*(n[1]-c[1]);d=c[2]+l*(n[2]-c[2]);return new o(r.COORDS_BY_USER,[a,d],i)},projectPointToLine:function projectPointToLine(e,t,i){var s=[0,t.stdform[1],t.stdform[2]];if(!g.exists(i)){i=e.board}s=h.crossProduct(s,e.coords.usrCoords);return new o(r.COORDS_BY_USER,h.crossProduct(s,t.stdform),i)},projectCoordsToSegment:function projectCoordsToSegment(e,r,o){var i,n,a=[o[1]-r[1],o[2]-r[2]],s=[e[1]-r[1],e[2]-r[2]];if(Math.abs(a[0])<h.eps&&Math.abs(a[1])<h.eps){return[r,0]}i=h.innerProduct(s,a);n=h.innerProduct(a,a);i/=n;return[[1,i*a[0]+r[1],i*a[1]+r[2]],i]},projectCoordsToBeziersegment:function projectCoordsToBeziersegment(r,o,i){var s=e.Math.Numerics.fminbr(function minfunc(e){var t=[1,o.X(i+e),o.Y(i+e)];t[1]-=r[1];t[2]-=r[2];return t[1]*t[1]+t[2]*t[2]},[0,1]);return[[1,o.X(s+i),o.Y(s+i)],s]},projectPointToCurve:function projectPointToCurve(e,r,o){if(!g.exists(o)){o=e.board}var i=e.X(),s=e.Y(),n=e.position||0,t=this.projectCoordsToCurve(i,s,n,r,o);e.position=t[1];return t[0]},projectCoordsToCurve:function projectCoordsToCurve(e,s,n,a,l){var c,p,u,h,b,C,y,f,P,_,S,E,x,O,T,A,w,N,R,L,B,k=Number.POSITIVE_INFINITY;if(!g.exists(l)){l=a.board}if("plot"===g.evaluate(a.visProp.curvetype)){n=0;b=k;if(0===a.numberPoints){c=[0,1,1]}else{c=[a.Z(0),a.X(0),a.Y(0)]}if(1<a.numberPoints){f=[1,e,s];if(3===a.bezierDegree){h=0}else{S=[a.Z(0),a.X(0),a.Y(0)]}for(u=0;u<a.numberPoints-1;u++){if(3===a.bezierDegree){x=this.projectCoordsToBeziersegment(f,a,h)}else{E=[a.Z(u+1),a.X(u+1),a.Y(u+1)];x=this.projectCoordsToSegment(f,S,E)}y=x[1];P=x[0];if(0<=y&&1>=y){C=this.distance(P,f);_=u+y}else if(0>y){P=S;C=this.distance(S,f);_=u}else if(1<y&&u===a.numberPoints-2){P=E;C=this.distance(P,f);_=a.numberPoints-1}if(C<b){b=C;n=_;c=P}if(3===a.bezierDegree){h++;u+=2}else{S=E}}}p=new o(r.COORDS_BY_USER,c,l)}else{O=function(r){var t,o;if(r<a.minX()||r>a.maxX()){return NaN}t=e-a.X(r);o=s-a.Y(r);return t*t+o*o};w=O(n);R=50;N=(a.maxX()-a.minX())/R;T=a.minX();for(u=0;u<R;u++){A=O(T);if(A<w||isNaN(w)){n=T;w=A}T+=N}n=m.fminbr(O,[n-N,n+N]);L=a.minX();B=a.maxX();n=n<L?L:n;n=n>B?B:n;p=new o(r.COORDS_BY_USER,[a.X(n),a.Y(n)],l)}return[a.updateTransform(p),n]},projectCoordsToPolygon:function projectCoordsToPolygon(t,r){var o,s=r.vertices.length,n=1/0,a,l,c;for(o=0;o<s;o++){l=e.Math.Geometry.projectCoordsToSegment(t,r.vertices[o].coords.usrCoords,r.vertices[(o+1)%s].coords.usrCoords);a=e.Math.Geometry.distance(l[0],t,3);if(0<=l[1]&&1>=l[1]&&a<n){c=l[0].slice(0);n=a}}return c},projectPointToTurtle:function projectPointToTurtle(e,s,n){var a,d,l,c,p,u,h,m,b=0,C=0,v=Number.POSITIVE_INFINITY,f=s.objects.length;if(!g.exists(n)){n=e.board}for(p=0;p<f;p++){h=s.objects[p];if(h.elementClass===r.OBJECT_CLASS_CURVE){a=this.projectPointToCurve(e,h);u=this.distance(a.usrCoords,e.coords.usrCoords);if(u<v){l=a.usrCoords[1];c=a.usrCoords[2];d=e.position;v=u;m=h;C=b}b+=h.numberPoints}}a=new o(r.COORDS_BY_USER,[l,c],n);e.position=d+C;return m.updateTransform(a)},projectPointToPoint:function projectPointToPoint(e,t){return t.coords},projectPointToBoard:function projectPointToBoard(e,t){var r,o,s,n=t||e.board,a=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],d=e.coords||e,p=n.getBoundingBox();for(r=0;4>r;r++){s=a[r];if(s[0]*d.usrCoords[s[1]]<s[0]*p[s[2]]){o=h.crossProduct([1,p[s[3]],p[s[4]]],[1,p[s[5]],p[s[6]]]);o[3]=0;o=h.normalize(o);d=this.projectPointToLine({coords:d},{stdform:o},n)}}return d},distPointLine:function distPointLine(e,t){var r=t[1],o=t[2],i=t[0],s;if(Math.abs(r)+Math.abs(o)<h.eps){return Number.POSITIVE_INFINITY}s=r*e[1]+o*e[2]+i;r*=r;o*=o;return Math.abs(s)/Math.sqrt(r+o)},reuleauxPolygon:function reuleauxPolygon(e,r){var o,i=2*Math.PI,s=i/r,n=(r-1)/2,a=0,t=function(d,l){return function(c,t){var p=(c%i+i)%i,u=Math.floor(p/s)%r;if(!t){a=e[0].Dist(e[n]);o=h.Geometry.rad([e[0].X()+1,e[0].Y()],e[0],e[n%r])}if(isNaN(u)){return u}p=.5*p+.5*(u*s)+o;return e[u][d]()+a*Math[l](p)}};return[t("X","cos"),t("Y","sin"),0,i]}});return h.Geometry});define("utils/zip",["jxg"],function(e){"use strict";var t=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],n=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];e.Util=e.Util||{};e.Util.Unzip=function(a){var S,E,x,O,T,A,w=[],j=0,N=[],R=Array(32768),L=0,B=!1,k=a.length,Y=0,D=1,l=0,I=Array(288),X=Array(32),M=0,U=null,G=Array(64),J=Array(64),z=0,F=Array(17),H=[];F[0]=0;function d(){l+=8;if(Y<k){return a[Y++]}return-1}function p(){D=1}function u(){var e;try{l++;e=1&D;D>>=1;if(0===D){D=d();e=1&D;D=128|D>>1}return e}catch(t){throw t}}function h(e){var r=0,o=e;try{while(o--){r=r<<1|u()}if(e){r=t[r]>>8-e}}catch(t){throw t}return r}function m(){L=0}function g(e){E++;R[L++]=e;w.push(String.fromCharCode(e));if(32768==L){L=0}}function b(){this.b0=0;this.b1=0;this.jump=null;this.jumppos=-1}function C(){while(!0){if(F[z]>=T){return-1}if(O[F[z]]===z){return F[z]++}F[z]++}}function y(){var e=U[M],t;if(17===z){return-1}M++;z++;t=C();if(0<=t){e.b0=t}else{e.b0=32768;if(y()){return-1}}t=C();if(0<=t){e.b1=t;e.jump=null}else{e.b1=32768;e.jump=U[M];e.jumppos=M;if(y()){return-1}}z--;return 0}function v(e,t,r){var o;U=e;M=0;O=r;T=t;for(o=0;17>o;o++){F[o]=0}z=0;if(y()){return-1}return 0}function f(e){var t,r,o,s=0,n=e[s];while(!0){o=u();if(o){if(!(32768&n.b1)){return n.b1}n=n.jump;t=e.length;for(r=0;r<t;r++){if(e[r]===n){s=r;break}}}else{if(!(32768&n.b0)){return n.b0}s++;n=e[s]}}}function P(){var a,C,y,P,_,S,E,x,O,T,A,w,N,B,k,Y,D;do{a=u();y=h(2);if(0===y){p();T=d();T|=d()<<8;w=d();w|=d()<<8;if(65535&(T^~w)){e.debug("BlockLen checksum mismatch\n")}while(T--){C=d();g(C)}}else if(1===y){while(!0){_=t[h(7)]>>1;if(23<_){_=_<<1|u();if(199<_){_-=128;_=_<<1|u()}else{_-=48;if(143<_){_=_+136}}}else{_+=256}if(256>_){g(_)}else if(256===_){break}else{_-=257;O=h(o[_])+r[_];_=t[h(5)]>>3;if(8<s[_]){A=h(8);A|=h(s[_]-8)<<8}else{A=h(s[_])}A+=i[_];for(_=0;_<O;_++){C=R[32767&L-A];g(C)}}}}else if(2===y){E=Array(320);B=257+h(5);k=1+h(5);Y=4+h(4);for(_=0;19>_;_++){E[_]=0}for(_=0;_<Y;_++){E[n[_]]=h(3)}O=X.length;for(P=0;P<O;P++){X[P]=new b}if(v(X,19,E,0)){m();return 1}N=B+k;P=0;D=-1;while(P<N){D++;_=f(X);if(16>_){E[P++]=_}else if(16===_){_=3+h(2);if(P+_>N){m();return 1}S=P?E[P-1]:0;while(_--){E[P++]=S}}else{if(17===_){_=3+h(3)}else{_=11+h(7)}if(P+_>N){m();return 1}while(_--){E[P++]=0}}}O=I.length;for(P=0;P<O;P++){I[P]=new b}if(v(I,B,E,0)){m();return 1}O=I.length;for(P=0;P<O;P++){X[P]=new b}x=[];for(P=B;P<E.length;P++){x[P-B]=E[P]}if(v(X,k,x,0)){m();return 1}while(!0){_=f(I);if(256<=_){_-=256;if(0===_){break}_-=1;O=h(o[_])+r[_];_=f(X);if(8<s[_]){A=h(8);A|=h(s[_]-8)<<8}else{A=h(s[_])}A+=i[_];while(O--){C=R[32767&L-A];g(C)}}else{g(_)}}}}while(!a);m();p();return 0}function _(){var e,t,r,o,s,n=[];try{w=[];B=!1;n[0]=d();n[1]=d();if(120===n[0]&&218===n[1]){P();N[j]=[w.join(""),"geonext.gxt"];j++}if(31===n[0]&&139===n[1]){A();N[j]=[w.join(""),"file"];j++}if(80===n[0]&&75===n[1]){B=!0;n[2]=d();n[3]=d();if(3===n[2]&&4===n[3]){n[0]=d();n[1]=d();S=d();S|=d()<<8;s=d();s|=d()<<8;d();d();d();d();d();d()<<8;d()<<16;d()<<24;d();d()<<8;d()<<16;d()<<24;d();d()<<8;d()<<16;d()<<24;o=d();o|=d()<<8;r=d();r|=d()<<8;e=0;H=[];while(o--){t=d();if("/"===t|":"===t){e=0}else if(e<255){H[e++]=String.fromCharCode(t)}}if(!x){x=H}e=0;while(e<r){t=d();e++}E=0;if(8===s){P();N[j]=[,,];N[j][0]=w.join("");N[j][1]=H.join("");j++}A()}}}catch(t){throw t}}A=function(){var e,t,r=[];if(8&S){r[0]=d();r[1]=d();r[2]=d();r[3]=d();if(80===r[0]&&75===r[1]&&7===r[2]&&8===r[3]){d();d()<<8;d()<<16;d()<<24}else{r[0]|r[1]<<8|r[2]<<16|r[3]<<24}d();d()<<8;d()<<16;d()<<24;d();d()<<8;d()<<16;d()<<24}if(B){_()}r[0]=d();if(8!==r[0]){return}S=d();d();d();d();d();d();d();if(4&S){r[0]=d();r[2]=d();z=r[0]+256*r[1];for(e=0;e<z;e++){d()}}if(8&S){e=0;H=[];t=d();while(t){if("7"===t||":"===t){e=0}if(e<255){H[e++]=t}t=d()}}if(16&S){t=d();while(t){t=d()}}if(2&S){d();d()}P();d();d()<<8;d()<<16;d()<<24;d();d()<<8;d()<<16;d()<<24;if(B){_()}};e.Util.Unzip.prototype.unzipFile=function(e){var t;this.unzip();for(t=0;t<N.length;t++){if(N[t][1]===e){return N[t][0]}}return""};e.Util.Unzip.prototype.unzip=function(){_();return N}};return e.Util});define("utils/encoding",["jxg"],function(e){"use strict";var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];e.Util=e.Util||{};e.Util.UTF8={encode:function encode(e){var t,r,o="",i=e.length;e=e.replace(/\r\n/g,"\n");if("function"==typeof unescape&&"function"==typeof encodeURIComponent){return unescape(encodeURIComponent(e))}for(t=0;t<i;t++){r=e.charCodeAt(t);if(128>r){o+=String.fromCharCode(r)}else if(127<r&&2048>r){o+=String.fromCharCode(192|r>>6);o+=String.fromCharCode(128|63&r)}else{o+=String.fromCharCode(224|r>>12);o+=String.fromCharCode(128|63&r>>6);o+=String.fromCharCode(128|63&r)}}return o},decode:function decode(e){var r,o,s,n=0,a=0,d=0,l=[],c=e.length,p=[];for(r=0;r<c;r++){o=e.charCodeAt(r);s=t[o];if(d!==0){a=63&o|a<<6}else{a=255>>s&o}d=t[256+d+s];if(d===0){if(65535<a){l.push(55232+(a>>10),56320+(1023&a))}else{l.push(a)}n++;if(0==n%1e4){p.push(String.fromCharCode.apply(null,l));l=[]}}}p.push(String.fromCharCode.apply(null,l));return p.join("")},asciiCharCodeAt:function asciiCharCodeAt(e,t){var r=e.charCodeAt(t);if(255<r){switch(r){case 8364:r=128;break;case 8218:r=130;break;case 402:r=131;break;case 8222:r=132;break;case 8230:r=133;break;case 8224:r=134;break;case 8225:r=135;break;case 710:r=136;break;case 8240:r=137;break;case 352:r=138;break;case 8249:r=139;break;case 338:r=140;break;case 381:r=142;break;case 8216:r=145;break;case 8217:r=146;break;case 8220:r=147;break;case 8221:r=148;break;case 8226:r=149;break;case 8211:r=150;break;case 8212:r=151;break;case 732:r=152;break;case 8482:r=153;break;case 353:r=154;break;case 8250:r=155;break;case 339:r=156;break;case 382:r=158;break;case 376:r=159;break;default:break;}}return r}};return e.Util.UTF8});define("utils/base64",["jxg","utils/encoding"],function(e,t){"use strict";e.Util=e.Util||{};function r(e,t){return 255&e.charCodeAt(t)}function o(e,t){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e.charAt(t))}e.Util.Base64={encode:function encode(e){var o,s,n,a,d,l=[];d=t.encode(e);n=d.length;a=n%3;for(o=0;o<n-a;o+=3){s=r(d,o)<<16|r(d,o+1)<<8|r(d,o+2);l.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&s>>12),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&s>>6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&s))}switch(a){case 1:s=r(d,n-1);l.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>2),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&s<<4),"=","=");break;case 2:s=r(d,n-2)<<8|r(d,n-1);l.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>10),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&s>>4),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&s<<2),"=");break;}return l.join("")},decode:function decode(e,r){var s,n,a,d,l,c,p=[],u=[];s=e.replace(/[^A-Za-z0-9\+\/=]/g,"");a=s.length;if(0!=a%4){throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).")}if(s.charAt(a-1)==="="){d=1;if(s.charAt(a-2)==="="){d=2}a-=4}for(n=0;n<a;n+=4){l=o(s,n)<<18|o(s,n+1)<<12|o(s,n+2)<<6|o(s,n+3);u.push(l>>16,255&l>>8,255&l);if(0==n%1e4){p.push(String.fromCharCode.apply(null,u));u=[]}}switch(d){case 1:l=o(s,a)<<12|o(s,a+1)<<6|o(s,a+2);u.push(l>>10,255&l>>2);break;case 2:l=o(s,n)<<6|o(s,n+1);u.push(l>>4);break;}p.push(String.fromCharCode.apply(null,u));c=p.join("");if(r){c=t.decode(c)}return c},decodeAsArray:function decodeAsArray(e){var t,r=this.decode(e),o=[],s=r.length;for(t=0;t<s;t++){o[t]=r.charCodeAt(t)}return o}};return e.Util.Base64});define("server/server",["jxg","utils/zip","utils/base64","utils/type"],function(e,t,r,o){"use strict";e.Server={modules:{},runningCalls:{},handleError:function handleError(t){e.debug("error occured, server says: "+t.message)},callServer:function callServer(i,s,n,a){var d,l,c,p,u,h;a=a||!1;for(h in n){if(n.hasOwnProperty(h)){"&"+escape(h)+"="+escape(n[h])}}u=o.toJSON(n);do{p=i+Math.floor(4096*Math.random())}while(o.exists(this.runningCalls[p]));this.runningCalls[p]={action:i};if(o.exists(n.module)){this.runningCalls[p].module=n.module}d=e.serverBase+"JXGServer.py";l="action="+escape(i)+"&id="+p+"&dataJSON="+escape(r.encode(u));this.cbp=function(e){var n,a,d,l,c,p,u,h;n=new t.Unzip(r.decodeAsArray(e)).unzip();if(o.isArray(n)&&0<n.length){n=n[0][0]}if(!o.exists(n)){return}a=window.JSON&&window.JSON.parse?window.JSON.parse(n):new Function("return "+n)();if("error"===a.type){this.handleError(a)}else if("response"===a.type){p=a.id;for(u=0;u<a.fields.length;u++){d=a.fields[u];l=d.namespace+("object"===_typeof(new Function("return "+d.namespace)())?".":".prototype.")+d.name+" = "+d.value;new Function(l)()}for(u=0;u<a.handler.length;u++){d=a.handler[u];c=[];for(h=0;h<d.parameters.length;h++){c[h]="\""+d.parameters[h]+"\": "+d.parameters[h]}l="if(typeof JXG.Server.modules."+this.runningCalls[p].module+" == \"undefined\")JXG.Server.modules."+this.runningCalls[p].module+" = {};";l+="JXG.Server.modules."+this.runningCalls[p].module+"."+d.name+"_cb = "+d.callback+";";l+="JXG.Server.modules."+this.runningCalls[p].module+"."+d.name+" = function ("+d.parameters.join(",")+", __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == \"undefined\") __JXGSERVER_CB__ = JXG.Server.modules."+this.runningCalls[p].module+"."+d.name+"_cb;var __JXGSERVER_PAR__ = {"+c.join(",")+", \"module\": \""+this.runningCalls[p].module+"\", \"handler\": \""+d.name+"\" };JXG.Server.callServer(\"exec\", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};";new Function(l)()}delete this.runningCalls[p];s(a.data)}};this.cb=e.bind(this.cbp,this);if(window.XMLHttpRequest){c=new XMLHttpRequest;c.overrideMimeType("text/plain; charset=iso-8859-1")}else{c=new ActiveXObject("Microsoft.XMLHTTP")}if(c){c.open("POST",d,!a);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");if(!a){c.onreadystatechange=function(e){return function(){if(4===c.readyState&&200===c.status){e(c.responseText);return!0}return!1}}(this.cb)}c.send(l);if(a){this.cb(c.responseText);return!0}}return!1},loadModule_cb:function loadModule_cb(t){var r;for(r=0;r<t.length;r++){e.debug(t[r].name+": "+t[r].value)}},loadModule:function loadModule(t){return e.Server.callServer("load",e.Server.loadModule_cb,{module:t},!0)}};e.Server.load=e.Server.loadModule;return e.Server});define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],function(e,t,r,o,n,a){"use strict";var d;r.Symbolic={generateSymbolicCoordinatesPartial:function generateSymbolicCoordinatesPartial(e,r,o,i){var s,n,d,l=r.ancestors,c=0,p=function(e){var t;if("underscore"===i){t=o+"_{"+e+"}"}else if("brace"===i){t=o+"["+e+"]"}else{t=o+e}return t};e.listOfFreePoints=[];e.listOfDependantPoints=[];for(n in l){if(l.hasOwnProperty(n)){s=0;if(a.isPoint(l[n])){for(d in l[n].ancestors){if(l[n].ancestors.hasOwnProperty(d)){s++}}if(0===s){l[n].symbolic.x=l[n].coords.usrCoords[1];l[n].symbolic.y=l[n].coords.usrCoords[2];e.listOfFreePoints.push(l[n])}else{c+=1;l[n].symbolic.x=p(c);c+=1;l[n].symbolic.y=p(c);e.listOfDependantPoints.push(l[n])}}}}if(a.isPoint(r)){r.symbolic.x="x";r.symbolic.y="y"}return c},clearSymbolicCoordinates:function clearSymbolicCoordinates(e){var t=function(e){var r,o=e&&e.length||0;for(r=0;r<o;r++){if(a.isPoint(e[r])){e[r].symbolic.x="";e[r].symbolic.y=""}}};t(e.listOfFreePoints);t(e.listOfDependantPoints);delete e.listOfFreePoints;delete e.listOfDependantPoints},generatePolynomials:function generatePolynomials(e,r,o){var s,n,d,l=r.ancestors,c,p=[],u=[];if(o){this.generateSymbolicCoordinatesPartial(e,r,"u","brace")}l[r.id]=r;for(s in l){if(l.hasOwnProperty(s)){c=0;p=[];if(a.isPoint(l[s])){for(n in l[s].ancestors){if(l[s].ancestors.hasOwnProperty(n)){c++}}if(0<c){p=l[s].generatePolynomial();for(d=0;d<p.length;d++){u.push(p[d])}}}}}if(o){this.clearSymbolicCoordinates(e)}return u},geometricLocusByGroebnerBase:function geometricLocusByGroebnerBase(l,p){var u,h,m,g,b,C,y,v,f,P,_,S,E,x=l.options.locus,O={},T=this.generateSymbolicCoordinatesPartial(l,p,"u","brace"),A=new t(e.COORDS_BY_USR,[0,0],l),w=new t(e.COORDS_BY_USR,[l.canvasWidth,l.canvasHeight],l),j=1,N=0,R=0,L=0;if(n.modules.geoloci===d){n.loadModule("geoloci")}if(n.modules.geoloci===d){throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.")}y=A.usrCoords[1];v=w.usrCoords[1];f=w.usrCoords[2];P=A.usrCoords[2];if(x.translateToOrigin&&0<l.listOfFreePoints.length){if(x.toOrigin!==d&&null!==x.toOrigin&&a.isInArray(l.listOfFreePoints,x.toOrigin.id)){g=x.toOrigin}else{g=l.listOfFreePoints[0]}N=g.symbolic.x;R=g.symbolic.y;for(C=0;C<l.listOfFreePoints.length;C++){l.listOfFreePoints[C].symbolic.x-=N;l.listOfFreePoints[C].symbolic.y-=R}y-=N;v-=N;f-=R;P-=R;if(x.translateTo10&&1<l.listOfFreePoints.length){if(x.to10!==d&&null!==x.to10&&x.to10.id!==x.toOrigin.id&&a.isInArray(l.listOfFreePoints,x.to10.id)){b=x.to10}else{if(l.listOfFreePoints[0].id===g.id){b=l.listOfFreePoints[1]}else{b=l.listOfFreePoints[0]}}L=o.rad([1,0],[0,0],[b.symbolic.x,b.symbolic.y]);_=Math.cos(-L);S=Math.sin(-L);for(C=0;C<l.listOfFreePoints.length;C++){E=l.listOfFreePoints[C].symbolic.x;l.listOfFreePoints[C].symbolic.x=_*l.listOfFreePoints[C].symbolic.x-S*l.listOfFreePoints[C].symbolic.y;l.listOfFreePoints[C].symbolic.y=S*E+_*l.listOfFreePoints[C].symbolic.y}b.symbolic.y=0;E=y;y=_*y-S*f;f=S*E+_*f;E=v;v=_*v-S*P;P=S*E+_*P;if(x.stretch&&Math.abs(b.symbolic.x)>r.eps){j=b.symbolic.x;for(C=0;C<l.listOfFreePoints.length;C++){l.listOfFreePoints[C].symbolic.x/=j;l.listOfFreePoints[C].symbolic.y/=j}for(C=0;C<l.objectsList.length;C++){if(l.objectsList[C].elementClass===e.OBJECT_CLASS_CIRCLE&&"pointRadius"===l.objectsList[C].method){O[C]=l.objectsList[C].radius;l.objectsList[C].radius/=j}}y/=j;v/=j;f/=j;P/=j;b.symbolic.x=1}}for(C=0;C<l.listOfFreePoints.length;C++){E=l.listOfFreePoints[C].symbolic.x;if(Math.abs(E)<r.eps){l.listOfFreePoints[C].symbolic.x=0}if(Math.abs(E-Math.round(E))<r.eps){l.listOfFreePoints[C].symbolic.x=Math.round(E)}E=l.listOfFreePoints[C].symbolic.y;if(Math.abs(E)<r.eps){l.listOfFreePoints[C].symbolic.y=0}if(Math.abs(E-Math.round(E))<r.eps){l.listOfFreePoints[C].symbolic.y=Math.round(E)}}}u=this.generatePolynomials(l,p);h=u.join(",");this.cbp=function(e){m=e};this.cb=a.bind(this.cbp,this);n.modules.geoloci.lociCoCoA(y,v,f,P,T,h,j,L,N,R,this.cb,!0);this.clearSymbolicCoordinates(l);for(C in O){if(O.hasOwnProperty(C)){l.objects[C].radius=O[C]}}return m}};return r.Symbolic});define("math/poly",["jxg","math/math","utils/type"],function(e,t,r){"use strict";t.Poly={};t.Poly.Ring=function(e){this.vars=e};e.extend(t.Poly.Ring.prototype,{});t.Poly.Monomial=function(e,t,o){var s;if(!r.exists(e)){throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.")}if(!r.isArray(o)){o=[]}o=o.slice(0,e.vars.length);for(s=o.length;s<e.vars.length;s++){o.push(0)}this.ring=e;this.coefficient=t||0;this.exponents=r.deepCopy(o)};e.extend(t.Poly.Monomial.prototype,{copy:function copy(){return new t.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function print(){var e=[],t;for(t=0;t<this.ring.vars.length;t++){e.push(this.ring.vars[t]+"^"+this.exponents[t])}return this.coefficient+"*"+e.join("*")}});t.Poly.Polynomial=function(e,t){var o=function(){},i;if(!r.exists(e)){throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.")}if(r.exists(t)&&r.isString(t)){i=o(t)}else{i=[]}this.ring=e;this.monomials=i};e.extend(t.Poly.Polynomial.prototype,{findSignature:function findSignature(e){var t;for(t=0;t<this.monomials.length;t++){if(r.cmpArrays(this.monomials[t].exponents,e)){return t}}return-1},addSubMonomial:function addSubMonomial(e,t){var r=this.findSignature(e.exponents);if(-1<r){this.monomials[r].coefficient+=t*e.coefficient}else{e.coefficient*=t;this.monomials.push(e)}},add:function add(e){var t;if(r.exists(e)&&e.ring===this.ring){if(r.isArray(e.exponents)){this.addSubMonomial(e,1)}else{for(t=0;t<e.monomials.length;t++){this.addSubMonomial(e.monomials[t],1)}}}else{throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.")}},sub:function sub(e){var t;if(r.exists(e)&&e.ring===this.ring){if(r.isArray(e.exponents)){this.addSubMonomial(e,-1)}else{for(t=0;t<e.monomials.length;t++){this.addSubMonomial(e.monomials[t],-1)}}}else{throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.")}},copy:function copy(){var e,r;r=new t.Poly.Polynomial(this.ring);for(e=0;e<this.monomials.length;e++){r.monomials.push(this.monomials[e].copy())}return r},print:function print(){var e=[],t;for(t=0;t<this.monomials.length;t++){e.push("("+this.monomials[t].print()+")")}return e.join("+")}});return t.Poly});define("math/complex",["jxg","utils/type"],function(e,t){"use strict";e.Complex=function(e,t){this.isComplex=!0;if(e&&e.isComplex){t=e.imaginary;e=e.real}this.real=e||0;this.imaginary=t||0;this.absval=0;this.angle=0};e.extend(e.Complex.prototype,{toString:function toString(){return this.real+" + "+this.imaginary+"i"},add:function add(e){if(t.isNumber(e)){this.real+=e}else{this.real+=e.real;this.imaginary+=e.imaginary}return this},sub:function sub(e){if(t.isNumber(e)){this.real-=e}else{this.real-=e.real;this.imaginary-=e.imaginary}return this},mult:function mult(e){var r,o;if(t.isNumber(e)){this.real*=e;this.imaginary*=e}else{r=this.real;o=this.imaginary;this.real=r*e.real-o*e.imaginary;this.imaginary=r*e.imaginary+o*e.real}return this},div:function div(e){var r,o,i;if(t.isNumber(e)){if(Math.abs(e)<Math.eps){this.real=1/0;this.imaginary=1/0;return this}this.real/=e;this.imaginary/=e}else{if(Math.abs(e.real)<Math.eps&&Math.abs(e.imaginary)<Math.eps){this.real=1/0;this.imaginary=1/0;return this}r=e.real*e.real+e.imaginary*e.imaginary;i=this.real;o=this.imaginary;this.real=(i*e.real+o*e.imaginary)/r;this.imaginary=(o*e.real-i*e.imaginary)/r}return this},conj:function conj(){this.imaginary*=-1;return this}});e.C={};e.C.add=function(t,r){var o=new e.Complex(t);o.add(r);return o};e.C.sub=function(t,r){var o=new e.Complex(t);o.sub(r);return o};e.C.mult=function(t,r){var o=new e.Complex(t);o.mult(r);return o};e.C.div=function(t,r){var o=new e.Complex(t);o.div(r);return o};e.C.conj=function(t){var r=new e.Complex(t);r.conj();return r};e.C.abs=function(t){var r=new e.Complex(t);r.conj();r.mult(t);return Math.sqrt(r.real)};e.Complex.C=e.C;return e.Complex});define("utils/color",["jxg","utils/type","math/math"],function(e,t,r){"use strict";var o={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},s=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function process(e){return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function process(e){return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function process(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function process(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}];e.rgbParser=function(e,n,a){var d,l,c,p,u,h,m,C,y,v=e,f;if(!t.exists(e)){return[]}if(t.exists(n)&&t.exists(a)){v=[e,n,a]}d=v;f=!1;if(t.isArray(d)){for(h=0;3>h;h++){f=f||/\./.test(v[h].toString())}for(h=0;3>h;h++){f=f&&0<=v[h]&&1>=v[h]}if(f){return[Math.ceil(255*v[0]),Math.ceil(255*v[1]),Math.ceil(255*v[2])]}return v}if("string"==typeof v){d=v}if("#"===d.charAt(0)){d=d.substr(1,6)}d=d.replace(/ /g,"").toLowerCase();d=o[d]||d;for(h=0;h<s.length;h++){c=s[h].re;p=s[h].process;u=c.exec(d);if(u){l=p(u);m=l[0];C=l[1];y=l[2]}}if(isNaN(m)||isNaN(C)||isNaN(y)){return[]}m=0>m||isNaN(m)?0:255<m?255:m;C=0>C||isNaN(C)?0:255<C?255:C;y=0>y||isNaN(y)?0:255<y?255:y;return[m,C,y]};e.rgb2css=function(t,o,i){var s=e.rgbParser(t,o,i);return"rgb("+s[0]+", "+s[1]+", "+s[2]+")"};e.rgb2hex=function(t,o,i){var s,n,a;s=e.rgbParser(t,o,i);n=s[1];a=s[2];s=s[0];s=s.toString(16);n=n.toString(16);a=a.toString(16);if(1===s.length){s="0"+s}if(1===n.length){n="0"+n}if(1===a.length){a="0"+a}return"#"+s+n+a};e.hex2rgb=function(t){e.deprecated("JXG.hex2rgb()","JXG.rgb2css()");return e.rgb2css(t)};e.hsv2rgb=function(e,o,s){var n,a,d,l,c,u,h,m,g;e=(e%360+360)%360;if(0===o){if(isNaN(e)||e<r.eps){n=s;a=s;d=s}else{return"#ffffff"}}else{if(360<=e){u=0}else{u=e}u=u/60;c=Math.floor(u);l=u-c;h=s*(1-o);m=s*(1-o*l);g=s*(1-o*(1-l));switch(c){case 0:n=s;a=g;d=h;break;case 1:n=m;a=s;d=h;break;case 2:n=h;a=s;d=g;break;case 3:n=h;a=m;d=s;break;case 4:n=g;a=h;d=s;break;case 5:n=s;a=h;d=m;break;}}n=Math.round(255*n).toString(16);n=2===n.length?n:1===n.length?"0"+n:"00";a=Math.round(255*a).toString(16);a=2===a.length?a:1===a.length?"0"+a:"00";d=Math.round(255*d).toString(16);d=2===d.length?d:1===d.length?"0"+d:"00";return["#",n,a,d].join("")};e.rgb2hsv=function(t,o,i){var n,a,d,l,c,p,u,m,C,y,f,P,_;n=e.rgbParser(t,o,i);a=n[1];d=n[2];n=n[0];l=n/255;c=a/255;p=d/255;P=Math.max(n,a,d);_=Math.min(n,a,d);u=P/255;m=_/255;f=u;y=0;if(0<f){y=(f-m)/f}C=1/(u-m);if(0<y){if(P===n){C=(c-p)*C}else if(P===a){C=2+(p-l)*C}else{C=4+(l-c)*C}}C*=60;if(0>C){C+=360}if(P===_){C=0}return[C,y,f]};e.rgb2LMS=function(t,o,i){var n,a,d,c,p,u,h,C=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];n=e.rgbParser(t,o,i);a=n[1];d=n[2];n=n[0];n=Math.pow(n,.476190476);a=Math.pow(a,.476190476);d=Math.pow(d,.476190476);c=n*C[0][0]+a*C[0][1]+d*C[0][2];p=n*C[1][0]+a*C[1][1]+d*C[1][2];u=n*C[2][0]+a*C[2][1]+d*C[2][2];h=[c,p,u];h.l=c;h.m=p;h.s=u;return h};e.LMS2rgb=function(e,t,o){var i,s,n,a,d=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],l=function(e){var t=127,r=64;while(0<r){if(Math.pow(t,.476190476)>e){t-=r}else{if(Math.pow(t+1,.476190476)>e){return t}t+=r}r/=2}if(254==t&&13.994955247<e){return 255}return t};i=e*d[0][0]+t*d[0][1]+o*d[0][2];s=e*d[1][0]+t*d[1][1]+o*d[1][2];n=e*d[2][0]+t*d[2][1]+o*d[2][2];i=l(i);s=l(s);n=l(n);a=[i,s,n];a.r=i;a.g=s;a.b=n;return a};e.rgba2rgbo=function(e){var t;if(9===e.length&&"#"===e.charAt(0)){t=parseInt(e.substr(7,2).toUpperCase(),16)/255;e=e.substr(0,7)}else{t=1}return[e,t]};e.rgbo2rgba=function(e,t){var r;if("none"===e){return e}r=Math.round(255*t).toString(16);if(1===r.length){r="0"+r}return e+r};e.rgb2bw=function(t){var r,o,i;if("none"===t){return t}i=e.rgbParser(t);r=Math.floor(.3*i[0]+.59*i[1]+.11*i[2]);o="0123456789ABCDEF".charAt(15&r>>4)+"0123456789ABCDEF".charAt(15&r);t="#"+o+o+o;return t};e.rgb2cb=function(t,r){var o,i,n,a,d,c,p,u,h,g,b,C,y;if("none"===t){return t}d=e.rgb2LMS(t);i=d[0];n=d[1];a=d[2];r=r.toLowerCase();switch(r){case"protanopia":p=-.06150039994295001;u=.08277001656812001;h=-.013200141220000003;g=.05858939668799999;b=-.07934519995360001;C=.013289415272000003;y=.6903216543277437;c=a/n;if(c<y){i=-(u*n+h*a)/p}else{i=-(b*n+C*a)/g}break;case"tritanopia":p=-.00058973116217;u=.007690316482;h=-.01011703519052;g=.025495080838999994;b=-.0422740347;C=.017005316784;y=.8349489908460004;c=n/i;if(c<y){a=-(p*i+u*n)/h}else{a=-(g*i+b*n)/C}break;default:p=-.06150039994295001;u=.08277001656812001;h=-.013200141220000003;g=.05858939668799999;b=-.07934519995360001;C=.013289415272000003;y=.5763833686400911;c=a/i;if(c<y){n=-(p*i+h*a)/u}else{n=-(g*i+C*a)/b}break;}o=e.LMS2rgb(i,n,a);c="0123456789ABCDEF".charAt(15&o[0]>>4)+"0123456789ABCDEF".charAt(15&o[0]);t="#"+c;c="0123456789ABCDEF".charAt(15&o[1]>>4)+"0123456789ABCDEF".charAt(15&o[1]);t+=c;c="0123456789ABCDEF".charAt(15&o[2]>>4)+"0123456789ABCDEF".charAt(15&o[2]);t+=c;return t};e.autoHighlight=function(t){var r=e.rgba2rgbo(t),o=r[0],i=r[1];if("#"===t.charAt(0)){if(.3>i){i*=1.8}else{i*=.4}return e.rgbo2rgba(o,i)}return t};return e});define("options",["jxg","base/constants","math/math","utils/color","utils/type"],function(e,r,o,i,s){"use strict";e.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],zoomFactor:1,zoomX:1,zoomY:1,showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"\u2318",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,registerEvents:!0,minimizeReflow:"svg",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1}},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888",visible:"inherit",includeBoundaries:!1},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",strokeWidth:2,strokeColor:"blue",ticksDistance:.2},precision:{touch:15,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"},arc:{visible:!1}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1,center:{},radiuspoint:{},anglepoint:{}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},button:{disabled:!1},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:13,doAdvancedPlotOld:!1,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"black",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},inequality:{fillColor:"red",fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"black",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"black",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1,visible:"inherit"},label:{offset:[0,0]}},prescribedangle:{anglepoint:{size:2,visible:!1,withLabel:!1}},regularpolygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiuspoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglepoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,fixed:!0,scalable:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,precision:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,fixed:!0,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"black",highlightStrokeColor:"black",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}};e.Validator=function(){var t,r=function(e){return s.isString(e)},n=function(e){return Math.abs(e-Math.round(e))<o.eps},a=function(e){return n(e)&&0<e},d=function(e){return 0<e},l=function(e){return 0<=e},c={},p={attractorDistance:l,color:r,defaultDistance:s.isNumber,display:function validateDisplay(e){return"html"===e||"internal"===e},doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:function validatePointFace(t){return s.exists(e.normalizePointFace(t))},factor:s.isNumber,fillColor:r,fillOpacity:s.isNumber,firstArrow:!1,fontSize:n,dash:n,gridX:s.isNumber,gridY:s.isNumber,hasGrid:!1,highlightFillColor:r,highlightFillOpacity:s.isNumber,highlightStrokeColor:r,highlightStrokeOpacity:s.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:n,minorHeight:n,minorTicks:l,minTicksDistance:a,numberPointsHigh:a,numberPointsLow:a,opacity:s.isNumber,radius:s.isNumber,RDPsmoothing:!1,renderer:function validateRenderer(e){return"vml"===e||"svg"===e||"canvas"===e||"no"===e},right:function validatePixel(e){return /^[0-9]+px$/.test(e)},showCopyright:!1,showInfobox:!1,showNavigation:!1,size:n,snapSizeX:d,snapSizeY:d,snapWidth:s.isNumber,snapToGrid:!1,snatchDistance:l,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:r,strokeOpacity:s.isNumber,strokeWidth:n,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(t in p){if(p.hasOwnProperty(t)){c[t.toLowerCase()]=p[t]}}return c}();e.normalizePointFace=function(e){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[e]};e.useStandardOptions=function(i){var s,n,a,d,l=e.Options,o=i.hasGrid;i.options.grid.hasGrid=l.grid.hasGrid;i.options.grid.gridX=l.grid.gridX;i.options.grid.gridY=l.grid.gridY;i.options.grid.gridColor=l.grid.gridColor;i.options.grid.gridOpacity=l.grid.gridOpacity;i.options.grid.gridDash=l.grid.gridDash;i.options.grid.snapToGrid=l.grid.snapToGrid;i.options.grid.snapSizeX=l.grid.SnapSizeX;i.options.grid.snapSizeY=l.grid.SnapSizeY;i.takeSizeFromFile=l.takeSizeFromFile;d=function(e,t){e.visProp.fillcolor=t.fillColor;e.visProp.highlightfillcolor=t.highlightFillColor;e.visProp.strokecolor=t.strokeColor;e.visProp.highlightstrokecolor=t.highlightStrokeColor};for(s in i.objects){if(i.objects.hasOwnProperty(s)){a=i.objects[s];if(a.elementClass===r.OBJECT_CLASS_POINT){d(a,l.point)}else if(a.elementClass===r.OBJECT_CLASS_LINE){d(a,l.line);for(n=0;n<a.ticks.length;n++){a.ticks[n].majorTicks=l.line.ticks.majorTicks;a.ticks[n].minTicksDistance=l.line.ticks.minTicksDistance;a.ticks[n].visProp.minorheight=l.line.ticks.minorHeight;a.ticks[n].visProp.majorheight=l.line.ticks.majorHeight}}else if(a.elementClass===r.OBJECT_CLASS_CIRCLE){d(a,l.circle)}else if(a.type===r.OBJECT_TYPE_ANGLE){d(a,l.angle)}else if(a.type===r.OBJECT_TYPE_ARC){d(a,l.arc)}else if(a.type===r.OBJECT_TYPE_POLYGON){d(a,l.polygon)}else if(a.type===r.OBJECT_TYPE_CONIC){d(a,l.conic)}else if(a.type===r.OBJECT_TYPE_CURVE){d(a,l.curve)}else if(a.type===r.OBJECT_TYPE_SECTOR){a.arc.visProp.fillcolor=l.sector.fillColor;a.arc.visProp.highlightfillcolor=l.sector.highlightFillColor;a.arc.visProp.fillopacity=l.sector.fillOpacity;a.arc.visProp.highlightfillopacity=l.sector.highlightFillOpacity}}}i.fullUpdate();if(o&&!i.hasGrid){i.removeGrids(i)}else if(!o&&i.hasGrid){i.create("grid",[])}};e.useBlackWhiteOptions=function(t){var r=e.Options;r.point.fillColor=i.rgb2bw(r.point.fillColor);r.point.highlightFillColor=i.rgb2bw(r.point.highlightFillColor);r.point.strokeColor=i.rgb2bw(r.point.strokeColor);r.point.highlightStrokeColor=i.rgb2bw(r.point.highlightStrokeColor);r.line.fillColor=i.rgb2bw(r.line.fillColor);r.line.highlightFillColor=i.rgb2bw(r.line.highlightFillColor);r.line.strokeColor=i.rgb2bw(r.line.strokeColor);r.line.highlightStrokeColor=i.rgb2bw(r.line.highlightStrokeColor);r.circle.fillColor=i.rgb2bw(r.circle.fillColor);r.circle.highlightFillColor=i.rgb2bw(r.circle.highlightFillColor);r.circle.strokeColor=i.rgb2bw(r.circle.strokeColor);r.circle.highlightStrokeColor=i.rgb2bw(r.circle.highlightStrokeColor);r.arc.fillColor=i.rgb2bw(r.arc.fillColor);r.arc.highlightFillColor=i.rgb2bw(r.arc.highlightFillColor);r.arc.strokeColor=i.rgb2bw(r.arc.strokeColor);r.arc.highlightStrokeColor=i.rgb2bw(r.arc.highlightStrokeColor);r.polygon.fillColor=i.rgb2bw(r.polygon.fillColor);r.polygon.highlightFillColor=i.rgb2bw(r.polygon.highlightFillColor);r.sector.fillColor=i.rgb2bw(r.sector.fillColor);r.sector.highlightFillColor=i.rgb2bw(r.sector.highlightFillColor);r.curve.strokeColor=i.rgb2bw(r.curve.strokeColor);r.grid.gridColor=i.rgb2bw(r.grid.gridColor);e.useStandardOptions(t)};e.Options.normalizePointFace=e.normalizePointFace;return e.Options});define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],function(t,r,o,n,a,d,l,c){"use strict";t.AbstractRenderer=function(){this.vOffsetText=0;this.enhancedRendering=!0;this.container=null;this.type="";this.supportsForeignObject=!1};t.extend(t.AbstractRenderer.prototype,{_updateVisual:function _updateVisual(e,t,r){if(r||this.enhancedRendering){t=t||{};this.setObjectTransition(e);if(!l.evaluate(e.visProp.draft)){if(!t.stroke){if(e.highlighted){this.setObjectStrokeColor(e,e.visProp.highlightstrokecolor,e.visProp.highlightstrokeopacity);this.setObjectStrokeWidth(e,e.visProp.highlightstrokewidth)}else{this.setObjectStrokeColor(e,e.visProp.strokecolor,e.visProp.strokeopacity);this.setObjectStrokeWidth(e,e.visProp.strokewidth)}}if(!t.fill){if(e.highlighted){this.setObjectFillColor(e,e.visProp.highlightfillcolor,e.visProp.highlightfillopacity)}else{this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity)}}if(!t.dash){this.setDashStyle(e,e.visProp)}if(!t.shadow){this.setShadow(e)}if(!t.gradient){this.setShadow(e)}}else{this.setDraft(e)}}},drawPoint:function drawPoint(e){var t,o=r.normalizePointFace(l.evaluate(e.visProp.face));if("o"===o){t="ellipse"}else if("[]"===o){t="rect"}else{t="path"}e.rendNode=this.appendChildPrim(this.createPrim(t,e.id),l.evaluate(e.visProp.layer));this.appendNodesToElement(e,t);this._updateVisual(e,{dash:!0,shadow:!0},!0);this.updatePoint(e)},updatePoint:function updatePoint(e){var t=l.evaluate(e.visProp.size),o=r.normalizePointFace(l.evaluate(e.visProp.face)),i=l.evaluate(e.visProp.sizeunit),s=l.evaluate(e.visProp.zoom),n;if(!isNaN(e.coords.scrCoords[2]+e.coords.scrCoords[1])){if("user"===i){t*=Math.sqrt(e.board.unitX*e.board.unitY)}t*=!e.board||!s?1:Math.sqrt(e.board.zoomX*e.board.zoomY);n=0===t?0:t+1;if("o"===o){this.updateEllipsePrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2],n,n)}else if("[]"===o){this.updateRectPrim(e.rendNode,e.coords.scrCoords[1]-t,e.coords.scrCoords[2]-t,2*t,2*t)}else{this.updatePathPrim(e.rendNode,this.updatePathStringPoint(e,t,o),e.board)}this._updateVisual(e,{dash:!1,shadow:!1});this.setShadow(e)}},changePointStyle:function changePointStyle(e){var t=this.getElementById(e.id);if(l.exists(t)){this.remove(t)}this.drawPoint(e);l.clearVisPropOld(e);if(!e.visPropCalc.visible){this.hide(e)}if(l.evaluate(e.visProp.draft)){this.setDraft(e)}},drawLine:function drawLine(e){e.rendNode=this.appendChildPrim(this.createPrim("line",e.id),l.evaluate(e.visProp.layer));this.appendNodesToElement(e,"lines");this.updateLine(e)},updateLineEndings:function updateLineEndings(e,t){var r=new o(n.COORDS_BY_USER,e.point1.coords.usrCoords,e.board),i=new o(n.COORDS_BY_USER,e.point2.coords.usrCoords,e.board),s,a=null;a=l.evaluate(e.visProp.margin);d.calcStraight(e,r,i,a);s=this.getPositionArrowHead(e,r,i,t);this.updateLinePrim(e.rendNode,s.c1.scrCoords[1]+s.d1x,s.c1.scrCoords[2]+s.d1y,s.c2.scrCoords[1]-s.d2x,s.c2.scrCoords[2]-s.d2y,e.board);return s},updateArrowSize:function updateArrowSize(e,t){var r,o,i;o=l.evaluate(e.visProp.firstarrow);if(o){if(l.exists(o.size)){r=l.evaluate(o.size)}else{r=3}this._setArrowWidth(e.rendNodeTriangleStart,t.sFirst,e.rendNode,r)}i=l.evaluate(e.visProp.lastarrow);if(i){if(l.exists(i.size)){r=l.evaluate(i.size)}else{r=3}this._setArrowWidth(e.rendNodeTriangleEnd,t.sLast,e.rendNode,r)}return this},updateLine:function updateLine(e){var t=this.updateLineEndings(e,l.evaluate(e.visProp.strokewidth));this.makeArrows(e);this._updateVisual(e);this.updateArrowSize(e,t);this.setLineCap(e)},getPositionArrowHead:function getPositionArrowHead(e,t,r,i){var c,p,u,h,m,g,b,C,y=a.eps,v,f,P=0,_=0,S=l.evaluate(e.visProp.firstarrow),E=l.evaluate(e.visProp.lastarrow),x;m=g=b=C=0;if(S||E){p=l.evaluate(e.point1.visProp.size)+l.evaluate(e.point1.visProp.strokewidth);u=l.evaluate(e.point2.visProp.size)+l.evaluate(e.point2.visProp.strokewidth);c=p+u;if(E&&l.evaluate(e.visProp.touchlastpoint)){h=t.distance(n.COORDS_BY_SCREEN,r);if(h>c){b=(r.scrCoords[1]-t.scrCoords[1])*u/h;C=(r.scrCoords[2]-t.scrCoords[2])*u/h;r=new o(n.COORDS_BY_SCREEN,[r.scrCoords[1]-b,r.scrCoords[2]-C],e.board)}}if(S&&l.evaluate(e.visProp.touchfirstpoint)){h=t.distance(n.COORDS_BY_SCREEN,r);if(h>c){m=(r.scrCoords[1]-t.scrCoords[1])*p/h;g=(r.scrCoords[2]-t.scrCoords[2])*p/h;t=new o(n.COORDS_BY_SCREEN,[t.scrCoords[1]+m,t.scrCoords[2]+g],e.board)}}m=g=b=C=0;h=t.distance(n.COORDS_BY_SCREEN,r);if(l.exists(S.type)){v=l.evaluate(S.type)}if(l.exists(E.type)){f=l.evaluate(E.type)}if(S){if(l.exists(S.size)){x=l.evaluate(S.size)}else{x=3}P=i*x;if(2===v){P*=.5;y+=i*x}else if(3===v){P=i;y+=i}else{y+=i*x}}if(E){if(l.exists(E.size)){x=l.evaluate(E.size)}else{x=3}_=i*x;if(2===f){_*=.5;y+=i*x}else if(3===f){_=i;y+=i}else{y+=i*x}}if(S&&"vml"!==e.board.renderer.type){if(h>=y){m=(r.scrCoords[1]-t.scrCoords[1])*P/h;g=(r.scrCoords[2]-t.scrCoords[2])*P/h}else{P=0}}if(E&&"vml"!==e.board.renderer.type){if(h>=y){b=(r.scrCoords[1]-t.scrCoords[1])*_/h;C=(r.scrCoords[2]-t.scrCoords[2])*_/h}else{_=0}}}return{c1:t,c2:r,d1x:m,d1y:g,d2x:b,d2y:C,sFirst:P,sLast:_}},setLineCap:function setLineCap(){},drawTicks:function drawTicks(e){e.rendNode=this.appendChildPrim(this.createPrim("path",e.id),l.evaluate(e.visProp.layer));this.appendNodesToElement(e,"path")},updateTicks:function updateTicks(){},drawCurve:function drawCurve(e){e.rendNode=this.appendChildPrim(this.createPrim("path",e.id),l.evaluate(e.visProp.layer));this.appendNodesToElement(e,"path");if(1<e.numberPoints){this.makeArrows(e)}this._updateVisual(e,{shadow:!0},!0);this.updateCurve(e)},updateCurve:function updateCurve(e){var t=l.evaluate(e.visProp.strokewidth),r,o,i;if(l.evaluate(e.visProp.handdrawing)){this.updatePathPrim(e.rendNode,this.updatePathStringBezierPrim(e),e.board)}else{this.updatePathPrim(e.rendNode,this.updatePathStringPrim(e),e.board)}if(1<e.numberPoints){this.makeArrows(e);o=l.evaluate(e.visProp.firstarrow);if(o){if(l.exists(o.size)){r=l.evaluate(o.size)}else{r=3}this._setArrowWidth(e.rendNodeTriangleStart,t,e.rendNode,r)}i=l.evaluate(e.visProp.lastarrow);if(i){if(l.exists(i.size)){r=l.evaluate(i.size)}else{r=3}this._setArrowWidth(e.rendNodeTriangleEnd,t,e.rendNode,r)}}this._updateVisual(e)},drawEllipse:function drawEllipse(e){e.rendNode=this.appendChildPrim(this.createPrim("ellipse",e.id),l.evaluate(e.visProp.layer));this.appendNodesToElement(e,"ellipse");this.updateEllipse(e)},updateEllipse:function updateEllipse(e){this._updateVisual(e);var t=e.Radius();if(0<t&&Math.abs(e.center.coords.usrCoords[0])>a.eps&&!isNaN(t+e.center.coords.scrCoords[1]+e.center.coords.scrCoords[2])&&2e6>t*e.board.unitX){this.updateEllipsePrim(e.rendNode,e.center.coords.scrCoords[1],e.center.coords.scrCoords[2],t*e.board.unitX,t*e.board.unitY)}},drawPolygon:function drawPolygon(e){e.rendNode=this.appendChildPrim(this.createPrim("polygon",e.id),l.evaluate(e.visProp.layer));this.appendNodesToElement(e,"polygon");this.updatePolygon(e)},updatePolygon:function updatePolygon(e){this._updateVisual(e,{stroke:!0,dash:!0});this.updatePolygonPrim(e.rendNode,e)},displayCopyright:function displayCopyright(){},drawInternalText:function drawInternalText(){},updateInternalText:function updateInternalText(){},drawText:function drawText(e){var t,r,o;if("html"===l.evaluate(e.visProp.display)&&c.isBrowser&&"no"!==this.type){t=this.container.ownerDocument.createElement("div");t.style.position="absolute";t.className=l.evaluate(e.visProp.cssclass);o=l.evaluate(e.visProp.layer);if(!l.exists(o)){o=0}if(""===this.container.style.zIndex){r=0}else{r=parseInt(this.container.style.zIndex,10)}t.style.zIndex=r+o;this.container.appendChild(t);t.setAttribute("id",this.container.id+"_"+e.id)}else{t=this.drawInternalText(e)}e.rendNode=t;e.htmlStr="";this.updateText(e)},updateText:function updateText(r){var o=r.plaintext,i,e,s,n,a;if(r.visPropCalc.visible){this.updateTextStyle(r,!1);if("html"===l.evaluate(r.visProp.display)&&"no"!==this.type){if(!isNaN(r.coords.scrCoords[1]+r.coords.scrCoords[2])){e=r.coords.scrCoords[1];e=1e6>Math.abs(e)?e:1e6;n=r.getAnchorX();if("right"===n){i=Math.floor(r.board.canvasWidth-e)}else if("middle"===n){i=Math.floor(e-.5*r.size[0])}else{i=Math.floor(e)}if(r.visPropOld.left!==n+i){if("right"===n){r.rendNode.style.right=i+"px";r.rendNode.style.left="auto"}else{r.rendNode.style.left=i+"px";r.rendNode.style.right="auto"}r.visPropOld.left=n+i}e=r.coords.scrCoords[2]+this.vOffsetText;e=1e6>Math.abs(e)?e:1e6;a=r.getAnchorY();if("bottom"===a){i=Math.floor(r.board.canvasHeight-e)}else if("middle"===a){i=Math.floor(e-.5*r.size[1])}else{i=Math.floor(e)}if(r.visPropOld.top!==a+i){if("bottom"===a){r.rendNode.style.top="auto";r.rendNode.style.bottom=i+"px"}else{r.rendNode.style.bottom="auto";r.rendNode.style.top=i+"px"}r.visPropOld.top=a+i}}if(r.htmlStr!==o){try{r.rendNode.innerHTML=o}catch(t){s=r.rendNode.parentNode;r.rendNode.parentNode.removeChild(r.rendNode);r.rendNode.innerHTML=o;s.appendChild(r.rendNode)}r.htmlStr=o;if(l.evaluate(r.visProp.usemathjax)){try{MathJax.Hub.Queue(["Typeset",MathJax.Hub,r.rendNode])}catch(r){t.debug("MathJax (not yet) loaded")}}else if(l.evaluate(r.visProp.useasciimathml)){try{AMprocessNode(r.rendNode,!1)}catch(r){t.debug("AsciiMathML (not yet) loaded")}}}this.transformImage(r,r.transformations)}else{this.updateInternalText(r)}}},_css2js:function _css2js(e){var t=[],r,o,n,a,d,c=l.trim(e).replace(/;$/,"").split(";");o=c.length;for(r=0;r<o;++r){if(""!==l.trim(c[r])){d=c[r].split(":");n=l.trim(d[0].replace(/-([a-z])/gi,function(e,t){return t.toUpperCase()}));a=l.trim(d[1]);t.push({key:n,val:a})}}return t},updateTextStyle:function updateTextStyle(e,t){var r,o,i,s,n,a=e.visProp,d=c.isBrowser?a.display:"internal",p=["rendNode","rendNodeTag","rendNodeLabel"],u=p.length,h,m,g,b,C=["cssdefaultstyle","cssstyle"],y=C.length;if(t){i=a.highlightstrokecolor;o=a.highlightstrokeopacity;s=a.highlightcssclass}else{i=a.strokecolor;o=a.strokeopacity;s=a.cssclass}if("no"!==this.type&&("html"===d||"canvas"!==this.type)){for(g=0;g<y;g++){b=l.evaluate(a[(t?"highlight":"")+C[g]]);if(""!==b&&e.visPropOld[C[g]]!==b){h=this._css2js(b);for(n=0;n<u;n++){if(l.exists(e[p[n]])){for(m in h){if(h.hasOwnProperty(m)){e[p[n]].style[h[m].key]=h[m].val}}}}e.visPropOld[C[g]]=b}}r=l.evaluate(a.fontsize);if(e.visPropOld.fontsize!==r){e.needsSizeUpdate=!0;try{for(n=0;n<u;n++){if(l.exists(e[p[n]])){e[p[n]].style.fontSize=r+"px"}}}catch(t){for(n=0;n<u;n++){if(l.exists(e[p[n]])){e[p[n]].style.fontSize=r}}}e.visPropOld.fontsize=r}}this.setObjectTransition(e);if("html"===d&&"no"!==this.type){if(e.visPropOld.cssclass!==s){e.rendNode.className=s;e.visPropOld.cssclass=s;e.needsSizeUpdate=!0}this.setObjectStrokeColor(e,i,o)}else{this.updateInternalTextStyle(e,i,o)}return this},updateInternalTextStyle:function updateInternalTextStyle(e,t,r){this.setObjectStrokeColor(e,t,r)},drawImage:function drawImage(){},updateImage:function updateImage(e){this.updateRectPrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1],e.size[0],e.size[1]);this.updateImageURL(e);this.transformImage(e,e.transformations);this._updateVisual(e,{stroke:!0,dash:!0},!0)},joinTransforms:function joinTransforms(e,t){var r,o=e.board.origin.scrCoords[1],s=e.board.origin.scrCoords[2],n=e.board.unitX,d=e.board.unitY,l=t.length,c=[[1,0,0],[-o/n,1/n,0],[s/d,0,-1/d]];for(r=0;r<l;r++){c=a.matMatMult(t[r].matrix,c)}c=a.matMatMult([[1,0,0],[o,n,0],[s,0,-d]],c);return c},transformImage:function transformImage(){},updateImageURL:function updateImageURL(){},updateImageStyle:function updateImageStyle(e,t){e.rendNode.className=l.evaluate(t?e.visProp.highlightcssclass:e.visProp.cssclass)},appendChildPrim:function appendChildPrim(){},appendNodesToElement:function appendNodesToElement(){},createPrim:function createPrim(){return null},remove:function remove(){},makeArrows:function makeArrows(){},_setArrowWidth:function _setArrowWidth(){},updateEllipsePrim:function updateEllipsePrim(){},updateLinePrim:function updateLinePrim(){},updatePathPrim:function updatePathPrim(){},updatePathStringPoint:function updatePathStringPoint(){},updatePathStringPrim:function updatePathStringPrim(){},updatePathStringBezierPrim:function updatePathStringBezierPrim(){},updatePolygonPrim:function updatePolygonPrim(){},updateRectPrim:function updateRectPrim(){},setPropertyPrim:function setPropertyPrim(){},display:function display(e,t){if(e){e.visPropOld.visible=t}},show:function show(){},hide:function hide(){},setBuffering:function setBuffering(){},setDashStyle:function setDashStyle(){},setDraft:function setDraft(e){if(!l.evaluate(e.visProp.draft)){return}var t=e.board.options.elements.draft.color,r=e.board.options.elements.draft.opacity;this.setObjectTransition(e);if(e.type===n.OBJECT_TYPE_POLYGON){this.setObjectFillColor(e,t,r)}else{if(e.elementClass===n.OBJECT_CLASS_POINT){this.setObjectFillColor(e,t,r)}else{this.setObjectFillColor(e,"none",0)}this.setObjectStrokeColor(e,t,r);this.setObjectStrokeWidth(e,e.board.options.elements.draft.strokeWidth)}},removeDraft:function removeDraft(e){this.setObjectTransition(e);if(e.type===n.OBJECT_TYPE_POLYGON){this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity)}else{if(e.type===n.OBJECT_CLASS_POINT){this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity)}this.setObjectStrokeColor(e,e.visProp.strokecolor,e.visProp.strokeopacity);this.setObjectStrokeWidth(e,e.visProp.strokewidth)}},setGradient:function setGradient(){},updateGradient:function updateGradient(){},setObjectTransition:function setObjectTransition(){},setObjectFillColor:function setObjectFillColor(){},setObjectStrokeColor:function setObjectStrokeColor(){},setObjectStrokeWidth:function setObjectStrokeWidth(){},setShadow:function setShadow(){},highlight:function highlight(e){var t,r=e.visProp,o,s;this.setObjectTransition(e);if(!r.draft){if(e.type===n.OBJECT_TYPE_POLYGON){this.setObjectFillColor(e,r.highlightfillcolor,r.highlightfillopacity);for(t=0;t<e.borders.length;t++){this.setObjectStrokeColor(e.borders[t],e.borders[t].visProp.highlightstrokecolor,e.borders[t].visProp.highlightstrokeopacity)}}else{if(e.elementClass===n.OBJECT_CLASS_TEXT){this.updateTextStyle(e,!0)}else if(e.type===n.OBJECT_TYPE_IMAGE){this.updateImageStyle(e,!0);this.setObjectFillColor(e,r.highlightfillcolor,r.highlightfillopacity)}else{this.setObjectStrokeColor(e,r.highlightstrokecolor,r.highlightstrokeopacity);this.setObjectFillColor(e,r.highlightfillcolor,r.highlightfillopacity)}}if(r.highlightstrokewidth){o=Math.max(l.evaluate(r.highlightstrokewidth),l.evaluate(r.strokewidth));this.setObjectStrokeWidth(e,o);if(e.elementClass===n.OBJECT_CLASS_LINE){s=this.updateLineEndings(e,o);this.makeArrows(e);this.updateArrowSize(e,s)}}}return this},noHighlight:function noHighlight(e){var t,r=e.visProp,o,s;this.setObjectTransition(e);if(!l.evaluate(e.visProp.draft)){if(e.type===n.OBJECT_TYPE_POLYGON){this.setObjectFillColor(e,r.fillcolor,r.fillopacity);for(t=0;t<e.borders.length;t++){this.setObjectStrokeColor(e.borders[t],e.borders[t].visProp.strokecolor,e.borders[t].visProp.strokeopacity)}}else{if(e.elementClass===n.OBJECT_CLASS_TEXT){this.updateTextStyle(e,!1)}else if(e.type===n.OBJECT_TYPE_IMAGE){this.updateImageStyle(e,!1);this.setObjectFillColor(e,r.fillcolor,r.fillopacity)}else{this.setObjectStrokeColor(e,r.strokecolor,r.strokeopacity);this.setObjectFillColor(e,r.fillcolor,r.fillopacity)}}s=l.evaluate(r.strokewidth);this.setObjectStrokeWidth(e,s);if(e.elementClass===n.OBJECT_CLASS_LINE){o=this.updateLineEndings(e,s);this.makeArrows(e);this.updateArrowSize(e,o)}}return this},suspendRedraw:function suspendRedraw(){},unsuspendRedraw:function unsuspendRedraw(){},drawZoomBar:function drawZoomBar(e,t){var r,o,i=function(t){if(!t){t=window.event}if(t.stopPropagation){t.stopPropagation()}else{t.cancelBubble=!0}},s=function(s,n){var a=r.createElement("span");o.appendChild(a);a.appendChild(r.createTextNode(s));a.style.paddingLeft="7px";a.style.paddingRight="7px";c.addEvent(a,"mouseover",function(){this.style.backgroundColor=t.highlightfillcolor},a);c.addEvent(a,"mouseover",function(){this.style.backgroundColor=t.highlightfillcolor},a);c.addEvent(a,"mouseout",function(){this.style.backgroundColor=t.fillcolor},a);c.addEvent(a,"click",function(){l.bind(n,e)();return!1},e);c.addEvent(a,"mouseup",i,e);c.addEvent(a,"mousedown",i,e);c.addEvent(a,"touchend",i,e);c.addEvent(a,"touchstart",i,e)};if(c.isBrowser&&"no"!==this.type){r=e.containerObj.ownerDocument;o=r.createElement("div");o.setAttribute("id",e.containerObj.id+"_navigationbar");o.style.color=t.strokecolor;o.style.backgroundColor=t.fillcolor;o.style.padding=t.padding;o.style.position=t.position;o.style.fontSize=t.fontsize;o.style.cursor=t.cursor;o.style.zIndex=t.zindex;e.containerObj.appendChild(o);o.style.right=t.right;o.style.bottom=t.bottom;if(e.attr.showscreenshot){s(e.attr.screenshot.symbol,function(){setTimeout(function(){e.renderer.screenshot(e,"",!1)},330)})}if(e.attr.showreload){s("\u21BB",function(){e.reload()})}if(e.attr.showcleartraces){s("\u2297",function(){e.clearTraces()})}if(e.attr.shownavigation){if(e.attr.showzoom){s("\u2013",e.zoomOut);s("o",e.zoom100);s("+",e.zoomIn)}s("\u2190",e.clickLeftArrow);s("\u2193",e.clickUpArrow);s("\u2191",e.clickDownArrow);s("\u2192",e.clickRightArrow)}}},getElementById:function getElementById(e){if(l.exists(this.container)){return this.container.ownerDocument.getElementById(this.container.id+"_"+e)}return""},removeToInsertLater:function removeToInsertLater(e){var t=e.parentNode,r=e.nextSibling;t.removeChild(e);return function(){if(r){t.insertBefore(e,r)}else{t.appendChild(e)}}},resize:function resize(){},createTouchpoints:function createTouchpoints(){},showTouchpoint:function showTouchpoint(){},hideTouchpoint:function hideTouchpoint(){},updateTouchpoint:function updateTouchpoint(){},dumpToCanvas:function dumpToCanvas(){},screenshot:function screenshot(){}});return t.AbstractRenderer});define("renderer/no",["jxg","renderer/abstract"],function(e,t){"use strict";e.NoRenderer=function(){this.enhancedRendering=!1;this.type="no"};e.extend(e.NoRenderer.prototype,{drawPoint:function drawPoint(){},updatePoint:function updatePoint(){},changePointStyle:function changePointStyle(){},drawLine:function drawLine(){},updateLine:function updateLine(){},drawTicks:function drawTicks(){},updateTicks:function updateTicks(){},drawCurve:function drawCurve(){},updateCurve:function updateCurve(){},drawEllipse:function drawEllipse(){},updateEllipse:function updateEllipse(){},drawPolygon:function drawPolygon(){},updatePolygon:function updatePolygon(){},displayCopyright:function displayCopyright(){},drawInternalText:function drawInternalText(){},updateInternalText:function updateInternalText(){},drawText:function drawText(){},updateText:function updateText(){},updateTextStyle:function updateTextStyle(){},updateInternalTextStyle:function updateInternalTextStyle(){},drawImage:function drawImage(){},updateImage:function updateImage(){},transformImage:function transformImage(){},updateImageURL:function updateImageURL(){},appendChildPrim:function appendChildPrim(){},appendNodesToElement:function appendNodesToElement(){},createPrim:function createPrim(){return null},remove:function remove(){},makeArrows:function makeArrows(){},updateEllipsePrim:function updateEllipsePrim(){},updateLinePrim:function updateLinePrim(){},updatePathPrim:function updatePathPrim(){},updatePathStringPoint:function updatePathStringPoint(){},updatePathStringPrim:function updatePathStringPrim(){},updatePathStringBezierPrim:function updatePathStringBezierPrim(){},updatePolygonPrim:function updatePolygonPrim(){},updateRectPrim:function updateRectPrim(){},setPropertyPrim:function setPropertyPrim(){},display:function display(e,t){if(e){e.visPropOld.visible=t}},show:function show(){},hide:function hide(){},setBuffering:function setBuffering(){},setDashStyle:function setDashStyle(){},setDraft:function setDraft(){},removeDraft:function removeDraft(){},setGradient:function setGradient(){},updateGradient:function updateGradient(){},setObjectTransition:function setObjectTransition(){},setObjectFillColor:function setObjectFillColor(){},setObjectStrokeColor:function setObjectStrokeColor(){},setObjectStrokeWidth:function setObjectStrokeWidth(){},setShadow:function setShadow(){},highlight:function highlight(){},noHighlight:function noHighlight(){},suspendRedraw:function suspendRedraw(){},unsuspendRedraw:function unsuspendRedraw(){},drawZoomBar:function drawZoomBar(){},getElementById:function getElementById(){return null},resize:function resize(){},removeToInsertLater:function removeToInsertLater(){return function(){}}});e.NoRenderer.prototype=new t;return e.NoRenderer});define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],function(e,t,r,o,i){"use strict";e.FileReader={parseFileContent:function parseFileContent(t,s,n,a,d){var l=!1;if(!r.exists(a)){a=!0}try{l=new XMLHttpRequest;if("raw"===n.toLowerCase()){l.overrideMimeType("text/plain; charset=iso-8859-1")}else{l.overrideMimeType("text/xml; charset=iso-8859-1")}}catch(t){try{l=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{l=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){l=!1}}}if(!l){e.debug("AJAX not activated!");return}l.open("GET",t,a);if("raw"===n.toLowerCase()){this.cbp=function(){var e=l;if(4===e.readyState){s(e.responseText)}}}else{this.cbp=function(){var e=l,t="";if(4===e.readyState){if(r.exists(e.responseStream)&&("PK"===e.responseText.slice(0,2)||31===o.asciiCharCodeAt(e.responseText.slice(0,1),0))){t=i.decode(jxgBinFileReader(e))}else{t=e.responseText}this.parseString(t,s,n,d)}}}this.cb=r.bind(this.cbp,this);l.onreadystatechange=this.cb;try{l.send(null)}catch(e){throw new Error("JSXGraph: A problem occurred while trying to read '"+t+"'.")}},parseString:function parseString(t,o,i,s){var n,a;i=i.toLowerCase();n=e.readers[i];if(r.exists(n)){a=new n(o,t);a.read()}else{throw new Error("JSXGraph: There is no reader available for '"+i+"'.")}if(r.isFunction(s)){s(o)}}};if(!t.isMetroApp()&&t.isBrowser&&"object"===("undefined"==typeof navigator?"undefined":_typeof(navigator))&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write){document.write("<script type=\"text/vbscript\">\nFunction Base64Encode(inData)\n  Const Base64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n  Dim cOut, sOut, I\n  For I = 1 To LenB(inData) Step 3\n    Dim nGroup, pOut, sGroup\n    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _\n      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))\n    nGroup = Oct(nGroup)\n    nGroup = String(8 - Len(nGroup), \"0\") & nGroup\n    pOut = Mid(Base64, CLng(\"&o\" & Mid(nGroup, 1, 2)) + 1, 1) + _\n      Mid(Base64, CLng(\"&o\" & Mid(nGroup, 3, 2)) + 1, 1) + _\n      Mid(Base64, CLng(\"&o\" & Mid(nGroup, 5, 2)) + 1, 1) + _\n      Mid(Base64, CLng(\"&o\" & Mid(nGroup, 7, 2)) + 1, 1)\n    sOut = sOut + pOut\n  Next\n  Select Case LenB(inData) Mod 3\n    Case 1: '8 bit final\n      sOut = Left(sOut, Len(sOut) - 2) + \"==\"\n    Case 2: '16 bit final\n      sOut = Left(sOut, Len(sOut) - 1) + \"=\"\n  End Select\n  Base64Encode = sOut\nEnd Function\n\nFunction MyASC(OneChar)\n  If OneChar = \"\" Then MyASC = 0 Else MyASC = AscB(OneChar)\nEnd Function\n\nFunction jxgBinFileReader(xhr)\n    Dim byteString\n    Dim b64String\n    Dim i\n    byteString = xhr.responseBody\n    ReDim byteArray(LenB(byteString))\n    For i = 1 To LenB(byteString)\n        byteArray(i-1) = AscB(MidB(byteString, i, 1))\n    Next\n    b64String = Base64Encode(byteString)\n    jxgBinFileReader = b64String\nEnd Function\n</script>\n")}return e.FileReader});define("parser/geonext",["jxg","base/constants","utils/type"],function(e,t,r){"use strict";e.GeonextParser={replacePow:function replacePow(e){var t,r,o,s,n,a,d,l,u,h,m,g;e=e.replace(/(\s*)\^(\s*)/g,"^");h=e.indexOf("^");s=-1;while(0<=h&&h<e.length-1){if(s===h){throw new Error("JSXGraph: Error while parsing expression '"+e+"'")}s=h;u=e.slice(0,h);m=e.slice(h+1);if(")"===u.charAt(u.length-1)){t=1;r=u.length-2;while(0<=r&&0<t){o=u.charAt(r);if(")"===o){t++}else if("("===o){t-=1}r-=1}if(0===t){n="";d=u.substring(0,r+1);l=r;while(0<=l&&d.substr(l,1).match(/([\w\.]+)/)){n=RegExp.$1+n;l-=1}n+=u.substring(r+1,u.length);n=n.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else{throw new Error("JSXGraph: Missing '(' in expression")}}else{n="[\\w\\.]+"}if(m.match(/^([\w\.]*\()/)){t=1;r=RegExp.$1.length;while(r<m.length&&0<t){o=m.charAt(r);if(")"===o){t-=1}else if("("===o){t+=1}r+=1}if(0===t){a=m.substring(0,r);a=a.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else{throw new Error("JSXGraph: Missing ')' in expression")}}else{a="[\\w\\.]+"}g=new RegExp("("+n+")\\^("+a+")");e=e.replace(g,"pow($1,$2)");h=e.indexOf("^")}return e},replaceIf:function replaceIf(e){var t,r,o,n,a,d,l,p,u,h="",m=null,g=null,b=null;o=e.indexOf("If(");if(0>o){return e}e=e.replace(/""/g,"0");while(0<=o){t=e.slice(0,o);r=e.slice(o+3);a=1;n=0;d=-1;l=-1;while(n<r.length&&0<a){p=r.charAt(n);if(")"===p){a-=1}else if("("===p){a+=1}else if(","===p&&1===a){if(0>d){d=n}else{l=n}}n+=1}u=r.slice(0,n-1);r=r.slice(n);if(0>d){return""}if(0>l){return""}m=u.slice(0,d);g=u.slice(d+1,l);b=u.slice(l+1);m=this.replaceIf(m);g=this.replaceIf(g);b=this.replaceIf(b);h+=t+"(("+m+")?("+g+"):("+b+"))";e=r;m=null;g=null;o=e.indexOf("If(")}h+=r;return h},replaceNameById:function replaceNameById(e,t,r){var o,s,n,a,d=0,l=["X","Y","L","V"],c=function(e){if(r){return"$('"+e+"')"}return e};for(a=0;a<l.length;a++){d=e.indexOf(l[a]+"(");while(0<=d){if(0<=d){o=e.indexOf(")",d+2);if(0<=o){s=e.slice(d+2,o);s=s.replace(/\\(['"])?/g,"$1");n=t.elementsByName[s];if(n){e=e.slice(0,d+2)+(r?"$('":"")+c(n.id)+e.slice(o)}}}o=e.indexOf(")",d+2);d=e.indexOf(l[a]+"(",o)}}d=e.indexOf("Dist(");while(0<=d){if(0<=d){o=e.indexOf(",",d+5);if(0<=o){s=e.slice(d+5,o);s=s.replace(/\\(['"])?/g,"$1");n=t.elementsByName[s];if(n){e=e.slice(0,d+5)+c(n.id)+e.slice(o)}}}o=e.indexOf(",",d+5);d=e.indexOf(",",o);o=e.indexOf(")",d+1);if(0<=o){s=e.slice(d+1,o);s=s.replace(/\\(['"])?/g,"$1");n=t.elementsByName[s];if(n){e=e.slice(0,d+1)+c(n.id)+e.slice(o)}}o=e.indexOf(")",d+1);d=e.indexOf("Dist(",o)}l=["Deg","Rad"];for(a=0;a<l.length;a++){d=e.indexOf(l[a]+"(");while(0<=d){if(0<=d){o=e.indexOf(",",d+4);if(0<=o){s=e.slice(d+4,o);s=s.replace(/\\(['"])?/g,"$1");n=t.elementsByName[s];if(n){e=e.slice(0,d+4)+c(n.id)+e.slice(o)}}}o=e.indexOf(",",d+4);d=e.indexOf(",",o);o=e.indexOf(",",d+1);if(0<=o){s=e.slice(d+1,o);s=s.replace(/\\(['"])?/g,"$1");n=t.elementsByName[s];if(n){e=e.slice(0,d+1)+c(n.id)+e.slice(o)}}o=e.indexOf(",",d+1);d=e.indexOf(",",o);o=e.indexOf(")",d+1);if(0<=o){s=e.slice(d+1,o);s=s.replace(/\\(['"])?/g,"$1");n=t.elementsByName[s];if(n){e=e.slice(0,d+1)+c(n.id)+e.slice(o)}}o=e.indexOf(")",d+1);d=e.indexOf(l[a]+"(",o)}}return e},replaceIdByObj:function replaceIdByObj(e){var t=/(X|Y|L)\(([\w_]+)\)/g;e=e.replace(t,"$('$2').$1()");t=/(V)\(([\w_]+)\)/g;e=e.replace(t,"$('$2').Value()");t=/(Dist)\(([\w_]+),([\w_]+)\)/g;e=e.replace(t,"dist($('$2'), $('$3'))");t=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g;e=e.replace(t,"deg($('$2'),$('$3'),$('$4'))");t=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g;e=e.replace(t,"rad($('$1'),$('$2'),$('$3'))");t=/N\((.+)\)/g;e=e.replace(t,"($1)");return e},geonext2JS:function geonext2JS(e,t){var r,o,s,n=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],a=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];e=e.replace(/&lt;/g,"<");e=e.replace(/&gt;/g,">");e=e.replace(/&amp;/g,"&");o=e;o=this.replaceNameById(o,t);o=this.replaceIf(o);o=this.replacePow(o);o=this.replaceIdByObj(o);for(s=0;s<n.length;s++){r=new RegExp(["(\\W|^)(",n[s],")"].join(""),"ig");o=o.replace(r,["$1",a[s]].join(""))}o=o.replace(/True/g,"true");o=o.replace(/False/g,"false");o=o.replace(/fasle/g,"false");o=o.replace(/Pi/g,"PI");o=o.replace(/"/g,"'");return o},findDependencies:function findDependencies(e,o,i){var s,n,a,d;if(!r.exists(i)){i=e.board}s=i.elementsByName;for(n in s){if(s.hasOwnProperty(n)){if(n!==e.name){if(s[n].elementClass===t.OBJECT_CLASS_TEXT){if(!r.evaluate(s[n].visProp.islabel)){d=n.replace(/\[/g,"\\[");d=d.replace(/\]/g,"\\]");a=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+d+")(,[\\w\\[\\]'_ ]+)*\\)","g");if(0<=o.search(a)){s[n].addChild(e)}}}else{d=n.replace(/\[/g,"\\[");d=d.replace(/\]/g,"\\]");a=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+d+")(,[\\w\\[\\]'_ ]+)*\\)","g");if(0<=o.search(a)){s[n].addChild(e)}}}}}},gxt2jc:function gxt2jc(e,t){var r;e=e.replace(/&lt;/g,"<");e=e.replace(/&gt;/g,">");e=e.replace(/&amp;/g,"&");r=e;r=this.replaceNameById(r,t,!0);r=r.replace(/True/g,"true");r=r.replace(/False/g,"false");r=r.replace(/fasle/g,"false");return r}};return e.GeonextParser});define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","parser/geonext","utils/event","utils/color","utils/type"],function(e,t,r,o,i,s,n,a,d,l){"use strict";e.GeometryElement=function(e,r,o,i){var s,n,d;this.needsUpdate=!0;this.isDraggable=!1;this.isReal=!0;this.childElements={};this.hasLabel=!1;this.highlighted=!1;this.notExistingParents={};this.traces={};this.numTraces=0;this.transformations=[];this.baseElement=null;this.descendants={};this.ancestors={};this.parents=[];this.symbolic={};this.rendNode=null;this.elType="";this.dump=!0;this.subs={};this.inherits=[];this._pos=-1;this.stdform=[1,0,0,0,1,1,0,0];this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger"};this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]];this.visProp={};this.visPropCalc={visible:!1};a.eventify(this);this.mouseover=!1;this.lastDragTime=new Date;if(0<arguments.length){this.board=e;this.type=o;this._org_type=o;this.elementClass=i||t.OBJECT_CLASS_OTHER;this.id=r.id;s=r.name;if(!l.exists(s)){s=this.board.generateName(this)}if(""!==s){this.board.elementsByName[s]=this}this.name=s;this.needsRegularUpdate=r.needsregularupdate;l.clearVisPropOld(this);d=this.resolveShortcuts(r);for(n in d){if(d.hasOwnProperty(n)){this._set(n,d[n])}}this.visProp.draft=d.draft&&d.draft.draft;this.visProp.gradientangle="270";this.visProp.gradientsecondopacity=l.evaluate(this.visProp.fillopacity);this.visProp.gradientpositionx=.5;this.visProp.gradientpositiony=.5}};e.extend(e.GeometryElement.prototype,{addChild:function addChild(e){var t,r;this.childElements[e.id]=e;this.addDescendants(e);e.ancestors[this.id]=this;for(t in this.descendants){if(this.descendants.hasOwnProperty(t)){this.descendants[t].ancestors[this.id]=this;for(r in this.ancestors){if(this.ancestors.hasOwnProperty(r)){this.descendants[t].ancestors[this.ancestors[r].id]=this.ancestors[r]}}}}for(t in this.ancestors){if(this.ancestors.hasOwnProperty(t)){for(r in this.descendants){if(this.descendants.hasOwnProperty(r)){this.ancestors[t].descendants[this.descendants[r].id]=this.descendants[r]}}}}return this},addDescendants:function addDescendants(e){this.descendants[e.id]=e;for(var t in e.childElements){if(e.childElements.hasOwnProperty(t)){this.addDescendants(e.childElements[t])}}return this},addParents:function addParents(e){var t,r,o;if(l.isArray(e)){o=e}else{o=arguments}r=o.length;for(t=0;t<r;++t){if(!l.exists(o[t])){continue}if(l.isId(this.board,o[t])){this.parents.push(o[t])}else if(l.exists(o[t].id)){this.parents.push(o[t].id)}}this.parents=l.uniqueArray(this.parents)},setParents:function setParents(e){this.parents=[];this.addParents(e)},removeChild:function removeChild(e){delete this.childElements[e.id];this.removeDescendants(e);delete e.ancestors[this.id];return this},removeDescendants:function removeDescendants(e){delete this.descendants[e.id];for(var t in e.childElements){if(e.childElements.hasOwnProperty(t)){this.removeDescendants(e.childElements[t])}}return this},countChildren:function countChildren(){var e,t,r=0;t=this.childElements;for(e in t){if(t.hasOwnProperty(e)&&0>e.indexOf("Label")){r++}}return r},getName:function getName(){return this.name},addTransform:function addTransform(){return this},draggable:function draggable(){return this.isDraggable&&!l.evaluate(this.visProp.fixed)&&this.type!==t.OBJECT_TYPE_GLIDER},setPosition:function setPosition(e,r){var o=[],s,n,a,d;if(!l.exists(this.parents)){return this}a=this.parents.length;for(n=0;n<a;++n){s=this.board.select(this.parents[n]);if(l.isPoint(s)){if(!s.draggable()){return this}else{o.push(s)}}}if(3===r.length){r=r.slice(1)}d=this.board.create("transform",r,{type:"translate"});a=o.length;if(0<a){d.applyOnce(o)}else{if(0<this.transformations.length&&this.transformations[this.transformations.length-1].isNumericMatrix){this.transformations[this.transformations.length-1].melt(d)}else{this.addTransform(d)}}for(n=0;n<a;++n){if(o[n].type===t.OBJECT_TYPE_GLIDER){o[n].updateGlider()}}return this},setPositionDirectly:function setPositionDirectly(e,o,s){var n=new r(e,o,this.board,!1),a=new r(e,s,this.board,!1),d=i.subtract(n.usrCoords,a.usrCoords);this.setPosition(t.COORDS_BY_USER,d);return this},generatePolynomial:function generatePolynomial(){return[]},animate:function animate(e,t,o){o=o||{};var s,n,a,c=this.board.attr.animationdelay,u=Math.ceil(t/c),h=this,m=function(e,t,r){var o,i,s,n,l;o=d.rgb2hsv(e);i=d.rgb2hsv(t);s=(i[0]-o[0])/u;n=(i[1]-o[1])/u;l=(i[2]-o[2])/u;h.animationData[r]=[];for(a=0;a<u;a++){h.animationData[r][u-a-1]=d.hsv2rgb(o[0]+(a+1)*s,o[1]+(a+1)*n,o[2]+(a+1)*l)}},g=function(e,t,r,o){var i,n;e=parseFloat(e);t=parseFloat(t);if(isNaN(e)||isNaN(t)){return}n=(t-e)/u;h.animationData[r]=[];for(a=0;a<u;a++){i=e+(a+1)*n;h.animationData[r][u-a-1]=o?Math.floor(i):i}};this.animationData={};for(s in e){if(e.hasOwnProperty(s)){n=s.toLowerCase();switch(n){case"strokecolor":case"fillcolor":m(this.visProp[n],e[s],n);break;case"size":if(!l.isPoint(this)){break}g(this.visProp[n],e[s],n,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":g(this.visProp[n],e[s],n,!1);break;}}}this.animationCallback=o.callback;this.board.addAnimation(this);return this},update:function update(){if(l.evaluate(this.visProp.trace)){this.cloneToBackground()}return this},updateRenderer:function updateRenderer(){return this},fullUpdate:function fullUpdate(e){return this.prepareUpdate().update().updateVisibility(e).updateRenderer()},setDisplayRendNode:function setDisplayRendNode(e){var t,r,o,n,a;if(e===void 0){e=this.visPropCalc.visible}if(e===this.visPropOld.visible){return this}this.board.renderer.display(this,e);r=this.inherits.length;for(o=0;o<r;o++){a=this.inherits[o];if(l.isArray(a)){n=a.length;for(t=0;t<n;t++){if(l.exists(a[t])&&l.exists(a[t].rendNode)&&"inherit"===l.evaluate(a[t].visProp.visible)){a[t].setDisplayRendNode(e)}}}else{if(l.exists(a)&&l.exists(a.rendNode)&&"inherit"===l.evaluate(a.visProp.visible)){a.setDisplayRendNode(e)}}}if(this.hasLabel&&l.exists(this.label)&&l.exists(this.label.rendNode)){if("inherit"===l.evaluate(this.label.visProp.visible)){this.label.setDisplayRendNode(e)}}return this},hideElement:function hideElement(){e.deprecated("Element.hideElement()","Element.setDisplayRendNode()");this.visPropCalc.visible=this.visProp.visible=!1;this.board.renderer.display(this,!1);if(l.exists(this.label)&&this.hasLabel){this.label.hiddenByParent=!0;if(this.label.visPropCalc.visible){this.label.hideElement()}}return this},showElement:function showElement(){e.deprecated("Element.showElement()","Element.setDisplayRendNode()");this.visPropCalc.visible=this.visProp.visible=!0;this.board.renderer.display(this,!0);if(l.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent){this.label.hiddenByParent=!1;if(!this.label.visPropCalc.visible){this.label.showElement().updateRenderer()}}return this},updateVisibility:function updateVisibility(e){var t,r,o,n,a,d;if(this.needsUpdate){if(e!==void 0){this.visPropCalc.visible=e}else{d=l.evaluate(this.visProp.visible);if(l.exists(this.hiddenByParent)&&this.hiddenByParent){d=!1}if("inherit"!==d){this.visPropCalc.visible=d}}r=this.inherits.length;for(o=0;o<r;o++){a=this.inherits[o];if(l.isArray(a)){n=a.length;for(t=0;t<n;t++){if(l.exists(a[t])&&"inherit"===l.evaluate(a[t].visProp.visible)){a[t].prepareUpdate().updateVisibility(this.visPropCalc.visible)}}}else{if(l.exists(a)&&"inherit"===l.evaluate(a.visProp.visible)){a.prepareUpdate().updateVisibility(this.visPropCalc.visible)}}}if(l.exists(this.label)&&l.exists(this.label.visProp)&&l.evaluate(this.label.visProp.visible)){this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}}return this},_set:function _set(e,t){e=e.toLocaleLowerCase();if(this.visProp.hasOwnProperty(e)&&0<=e.indexOf("color")&&l.isString(t)&&9===t.length&&"#"===t.charAt(0)){t=d.rgba2rgbo(t);this.visProp[e]=t[0];this.visProp[e.replace("color","opacity")]=t[1]}else{this.visProp[e]=t}},resolveShortcuts:function resolveShortcuts(e){var t,r;for(t in s.shortcuts){if(s.shortcuts.hasOwnProperty(t)){if(l.exists(e[t])){for(r=0;r<s.shortcuts[t].length;r++){if(!l.exists(e[s.shortcuts[t][r]])){e[s.shortcuts[t][r]]=e[t]}}}}}return e},setLabel:function setLabel(e){if(!this.hasLabel){this.setAttribute({withlabel:!0})}this.setLabelText(e)},setLabelText:function setLabelText(e){if(l.exists(this.label)){e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.label.setText(e)}return this},setName:function setName(e){e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");if("slider"!==this.elType){this.setLabelText(e)}this.setAttribute({name:e})},setProperty:function setProperty(){e.deprecated("setProperty()","setAttribute()");this.setAttribute.apply(this,arguments)},setAttribute:function setAttribute(){var r,o,s,n,a,c,p,u,h,m={};for(r=0;r<arguments.length;r++){c=arguments[r];if(l.isString(c)){u=c.split(":");m[l.trim(u[0])]=l.trim(u[1])}else if(!l.isArray(c)){e.extend(m,c)}else{m[c[0]]=c[1]}}m=this.resolveShortcuts(m);for(r in m){if(m.hasOwnProperty(r)){n=r.replace(/\s+/g,"").toLowerCase();a=m[r];h=this.visProp[n];if(l.isObject(a)&&l.exists(this.visProp[n])){this.visProp[n]=l.merge(this.visProp[n],a);if(this.type===t.OBJECT_TYPE_TICKS&&l.exists(this.labels)){s=this.labels.length;for(o=0;o<s;o++){this.labels[o].setAttribute(a)}}continue}switch(n){case"name":h=this.name;delete this.board.elementsByName[this.name];this.name=a;this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!("false"===a||!1===a);this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":a=d.rgba2rgbo(a);p=a[1];a=a[0];if(0===p){if(l.exists(this.label)&&this.hasLabel){this.label.hideElement()}}if(l.exists(this.label)&&this.hasLabel){this.label.visProp.strokecolor=a;this.board.renderer.setObjectStrokeColor(this.label,a,p)}if(this.elementClass===t.OBJECT_CLASS_TEXT){this.visProp.strokecolor=a;this.visProp.strokeopacity=p;this.board.renderer.setObjectStrokeColor(this,a,p)}break;case"infoboxtext":if(l.isString(a)){this.infoboxText=a}else{this.infoboxText=!1}break;case"visible":if("false"===a){this.visProp.visible=!1}else if("true"===a){this.visProp.visible=!0}else{this.visProp.visible=a}this.setDisplayRendNode(l.evaluate(this.visProp.visible));break;case"face":if(l.isPoint(this)){this.visProp.face=a;this.board.renderer.changePointStyle(this)}break;case"trace":if("false"===a||!1===a){this.clearTrace();this.visProp.trace=!1}else{this.visProp.trace=!0}break;case"gradient":this.visProp.gradient=a;this.board.renderer.setGradient(this);break;case"gradientsecondcolor":a=d.rgba2rgbo(a);this.visProp.gradientsecondcolor=a[0];this.visProp.gradientsecondopacity=a[1];this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=a;this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=a;if(!l.evaluate(a)){if(this.label&&this.hasLabel){this.label.setAttribute({visible:!1})}}else{if(!this.label){this.createLabel()}this.label.setAttribute({visible:"inherit"})}this.hasLabel=a;break;case"radius":if(this.type===t.OBJECT_TYPE_ANGLE||this.type===t.OBJECT_TYPE_SECTOR){this.setRadius(a)}break;case"rotate":if(this.elementClass===t.OBJECT_CLASS_TEXT&&"internal"===l.evaluate(this.visProp.display)||this.type===t.OBJECT_TYPE_IMAGE){this.addRotation(a)}break;case"ticksdistance":if(this.type===t.OBJECT_TYPE_TICKS&&l.isNumber(a)){this.ticksFunction=this.makeTicksFunction(a)}break;case"generatelabelvalue":if(this.type===t.OBJECT_TYPE_TICKS&&l.isFunction(a)){this.generateLabelValue=a}break;case"onpolygon":if(this.type===t.OBJECT_TYPE_GLIDER){this.onPolygon=!!a}break;case"disabled":if(l.exists(this.rendNodeTag)){this.rendNodeTag.disabled=!!a}break;case"checked":if(l.exists(this.rendNodeTag)){this.rendNodeCheckbox.checked=!!a}break;case"maxlength":if(l.exists(this.rendNodeTag)){this.rendNodeTag.maxlength=!!a}break;default:if(l.exists(this.visProp[n])&&(!e.Validator[n]||e.Validator[n]&&e.Validator[n](a)||e.Validator[n]&&l.isFunction(a)&&e.Validator[n](a()))){a=a.toLowerCase&&"false"===a.toLowerCase()?!1:a;this._set(n,a)}break;}this.triggerEventHandlers(["attribute:"+n],[h,a,this])}}this.triggerEventHandlers(["attribute"],[m,this]);if(!l.evaluate(this.visProp.needsregularupdate)){this.board.fullUpdate()}else{this.board.update(this)}return this},getProperty:function getProperty(){e.deprecated("getProperty()","getAttribute()");this.getProperty.apply(this,arguments)},getAttribute:function getAttribute(e){var t;e=e.toLowerCase();switch(e){case"needsregularupdate":t=this.needsRegularUpdate;break;case"labelcolor":t=this.label.visProp.strokecolor;break;case"infoboxtext":t=this.infoboxText;break;case"withlabel":t=this.hasLabel;break;default:t=this.visProp[e];break;}return t},setDash:function setDash(e){this.setAttribute({dash:e});return this},prepareUpdate:function prepareUpdate(){this.needsUpdate=!0;return this},remove:function remove(){this.board.renderer.remove(this.board.renderer.getElementById(this.id));if(this.hasLabel){this.board.renderer.remove(this.board.renderer.getElementById(this.label.id))}return this},getTextAnchor:function getTextAnchor(){return new r(t.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function getLabelAnchor(){return new r(t.COORDS_BY_USER,[0,0],this.board)},setArrow:function setArrow(e,r){this.visProp.firstarrow=e;this.visProp.lastarrow=r;if(r){this.type=t.OBJECT_TYPE_VECTOR;this.elType="arrow"}this.prepareUpdate().update().updateVisibility().updateRenderer();return this},createGradient:function createGradient(){var e=l.evaluate(this.visProp.gradient);if("linear"===e||"radial"===e){this.board.renderer.setGradient(this)}},createLabel:function createLabel(){var t,r=this;if(e.elements.text){t=l.deepCopy(this.visProp.label,null);t.id=this.id+"Label";t.isLabel=!0;t.anchor=this;t.priv=this.visProp.priv;if(this.visProp.withlabel){this.label=e.elements.text(this.board,[0,0,function(){if(l.isFunction(r.name)){return r.name()}return r.name}],t);this.label.needsUpdate=!0;this.label.dump=!1;this.label.update();this.hasLabel=!0}}else{e.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text")}return this},highlight:function highlight(e){e=l.def(e,!1);if(l.evaluate(this.visProp.highlight)&&(!this.highlighted||e)){this.highlighted=!0;this.board.highlightedObjects[this.id]=this;this.board.renderer.highlight(this)}return this},noHighlight:function noHighlight(){if(this.highlighted){this.highlighted=!1;delete this.board.highlightedObjects[this.id];this.board.renderer.noHighlight(this)}return this},clearTrace:function clearTrace(){for(var e in this.traces){if(this.traces.hasOwnProperty(e)){this.board.renderer.remove(this.traces[e])}}this.numTraces=0;return this},cloneToBackground:function cloneToBackground(){return this},bounds:function bounds(){return[0,0,0,0]},normalize:function normalize(){this.stdform=o.normalize(this.stdform);return this},toJSON:function toJSON(){var e,t,r=["{\"name\":",this.name];r.push(", \"id\":"+this.id);e=[];for(t in this.visProp){if(this.visProp.hasOwnProperty(t)){if(l.exists(this.visProp[t])){e.push("\""+t+"\":"+this.visProp[t])}}}r.push(", \"visProp\":{"+e.toString()+"}");r.push("}");return r.join("")},addRotation:function addRotation(e){var r,o,i,s,n,a=this;if((this.elementClass===t.OBJECT_CLASS_TEXT&&"internal"===l.evaluate(this.visProp.display)||this.type===t.OBJECT_TYPE_IMAGE)&&0!==e){r=this.board.create("transform",[function(){return-a.X()},function(){return-a.Y()}],{type:"translate"});o=this.board.create("transform",[function(){return a.X()},function(){return a.Y()}],{type:"translate"});i=this.board.create("transform",[function(){return a.board.unitX/a.board.unitY},function(){return 1}],{type:"scale"});s=this.board.create("transform",[function(){return a.board.unitY/a.board.unitX},function(){return 1}],{type:"scale"});n=this.board.create("transform",[e*Math.PI/180],{type:"rotate"});r.bindTo(this);i.bindTo(this);n.bindTo(this);s.bindTo(this);o.bindTo(this)}return this},highlightStrokeColor:function highlightStrokeColor(t){e.deprecated("highlightStrokeColor()","setAttribute()");this.setAttribute({highlightStrokeColor:t});return this},strokeColor:function strokeColor(t){e.deprecated("strokeColor()","setAttribute()");this.setAttribute({strokeColor:t});return this},strokeWidth:function strokeWidth(t){e.deprecated("strokeWidth()","setAttribute()");this.setAttribute({strokeWidth:t});return this},fillColor:function fillColor(t){e.deprecated("fillColor()","setAttribute()");this.setAttribute({fillColor:t});return this},highlightFillColor:function highlightFillColor(t){e.deprecated("highlightFillColor()","setAttribute()");this.setAttribute({highlightFillColor:t});return this},labelColor:function labelColor(t){e.deprecated("labelColor()","setAttribute()");this.setAttribute({labelColor:t});return this},dash:function dash(t){e.deprecated("dash()","setAttribute()");this.setAttribute({dash:t});return this},visible:function visible(t){e.deprecated("visible()","setAttribute()");this.setAttribute({visible:t});return this},shadow:function shadow(t){e.deprecated("shadow()","setAttribute()");this.setAttribute({shadow:t});return this},getType:function getType(){return this.elType},getParents:function getParents(){return l.isArray(this.parents)?this.parents:[]},snapToGrid:function snapToGrid(){return this},snapToPoints:function snapToPoints(){return this},getAttributes:function getAttributes(){var e=l.deepCopy(this.visProp),t=[],r,o=t.length;e.id=this.id;e.name=this.name;for(r=0;r<o;r++){delete e[t[r]]}return e},hasPoint:function hasPoint(){return!1},handleSnapToGrid:function handleSnapToGrid(e,r){var o,i,s,n,a=!1,d=l.evaluate(this.visProp.snapsizex),c=l.evaluate(this.visProp.snapsizey);if(!l.exists(this.coords)){return this}a=l.evaluate(this.visProp.snaptogrid)||!0===e;if(a){o=this.coords.usrCoords[1];i=this.coords.usrCoords[2];if(0>=d&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks){s=this.board.defaultAxes.x.defaultTicks;d=s.ticksDelta*(l.evaluate(s.visProp.minorticks)+1)}if(0>=c&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks){s=this.board.defaultAxes.y.defaultTicks;c=s.ticksDelta*(l.evaluate(s.visProp.minorticks)+1)}if(0<d&&0<c){n=this.board.getBoundingBox();o=Math.round(o/d)*d;i=Math.round(i/c)*c;if(!r){if(o<n[0]){o+=d}else if(o>n[2]){o-=d}if(i<n[3]){i+=c}else if(i>n[1]){i-=c}}this.coords.setCoordinates(t.COORDS_BY_USER,[o,i])}}return this},addEvent:e.shortcut(e.GeometryElement.prototype,"on"),removeEvent:e.shortcut(e.GeometryElement.prototype,"off"),__evt__over:function __evt__over(){},__evt__mouseover:function __evt__mouseover(){},__evt__out:function __evt__out(){},__evt__mouseout:function __evt__mouseout(){},__evt__move:function __evt__move(){},__evt__mousemove:function __evt__mousemove(){},__evt__drag:function __evt__drag(){},__evt__mousedrag:function __evt__mousedrag(){},__evt__touchdrag:function __evt__touchdrag(){},__evt__down:function __evt__down(){},__evt__mousedown:function __evt__mousedown(){},__evt__touchdown:function __evt__touchdown(){},__evt__up:function __evt__up(){},__evt__mouseup:function __evt__mouseup(){},__evt__touchup:function __evt__touchup(){},__evt__attribute:function __evt__attribute(){},__evt__attribute_:function __evt__attribute_(){},__evt:function __evt(){}});return e.GeometryElement});define("base/transformation",["jxg","base/constants","math/math","utils/type"],function(e,t,r,o){"use strict";e.Transformation=function(e,r,o){this.elementClass=t.OBJECT_CLASS_OTHER;this.type=t.OBJECT_TYPE_TRANSFORMATION;this.matrix=[[1,0,0],[0,1,0],[0,0,1]];this.board=e;this.isNumericMatrix=!1;this.setMatrix(e,r,o);this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bind",melt:"melt"}};e.Transformation.prototype={};e.extend(e.Transformation.prototype,{update:function update(){return this},setMatrix:function setMatrix(e,t,s){var n;this.isNumericMatrix=!0;for(n=0;n<s.length;n++){if("number"!=typeof s[n]){this.isNumericMatrix=!1;break}}if("translate"===t){if(2!==s.length){throw new Error("JSXGraph: translate transformation needs 2 parameters.")}this.evalParam=o.createEvalFunction(e,s,2);this.update=function(){this.matrix[1][0]=this.evalParam(0);this.matrix[2][0]=this.evalParam(1)}}else if("scale"===t){if(2!==s.length){throw new Error("JSXGraph: scale transformation needs 2 parameters.")}this.evalParam=o.createEvalFunction(e,s,2);this.update=function(){this.matrix[1][1]=this.evalParam(0);this.matrix[2][2]=this.evalParam(1)}}else if("reflect"===t){if(4>s.length){s[0]=e.select(s[0])}if(2===s.length){s[1]=e.select(s[1])}if(4===s.length){this.evalParam=o.createEvalFunction(e,s,4)}this.update=function(){var e,t,o,i,n,a,l,c;if(1===s.length){l=s[0].stdform}else if(2===s.length){l=r.crossProduct(s[1].coords.usrCoords,s[0].coords.usrCoords)}else if(4===s.length){l=r.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])}e=l[1];t=l[2];o=l[0];c=[-o*e,-o*t,e*e+t*t];a=c[2];i=c[0]/c[2];n=c[1]/c[2];e=-l[2];t=l[1];this.matrix[1][1]=(e*e-t*t)/a;this.matrix[1][2]=2*e*t/a;this.matrix[2][1]=this.matrix[1][2];this.matrix[2][2]=-this.matrix[1][1];this.matrix[1][0]=i*(1-this.matrix[1][1])-n*this.matrix[1][2];this.matrix[2][0]=n*(1-this.matrix[2][2])-i*this.matrix[2][1]}}else if("rotate"===t){if(3===s.length){this.evalParam=o.createEvalFunction(e,s,3)}else if(0<s.length&&2>=s.length){this.evalParam=o.createEvalFunction(e,s,1);if(2===s.length&&!o.isArray(s[1])){s[1]=e.select(s[1])}}this.update=function(){var e,t,r=this.evalParam(0),i=Math.cos(r),n=Math.sin(r);this.matrix[1][1]=i;this.matrix[1][2]=-n;this.matrix[2][1]=n;this.matrix[2][2]=i;if(1<s.length){if(3===s.length){e=this.evalParam(1);t=this.evalParam(2)}else{if(o.isArray(s[1])){e=s[1][0];t=s[1][1]}else{e=s[1].X();t=s[1].Y()}}this.matrix[1][0]=e*(1-i)+t*n;this.matrix[2][0]=t*(1-i)-e*n}}}else if("shear"===t){if(2!==s.length){throw new Error("JSXGraph: shear transformation needs 2 parameters.")}this.evalParam=o.createEvalFunction(e,s,2);this.update=function(){this.matrix[1][2]=this.evalParam(0);this.matrix[2][1]=this.evalParam(1)}}else if("generic"===t){if(9!==s.length){throw new Error("JSXGraph: generic transformation needs 9 parameters.")}this.evalParam=o.createEvalFunction(e,s,9);this.update=function(){this.matrix[0][0]=this.evalParam(0);this.matrix[0][1]=this.evalParam(1);this.matrix[0][2]=this.evalParam(2);this.matrix[1][0]=this.evalParam(3);this.matrix[1][1]=this.evalParam(4);this.matrix[1][2]=this.evalParam(5);this.matrix[2][0]=this.evalParam(6);this.matrix[2][1]=this.evalParam(7);this.matrix[2][2]=this.evalParam(8)}}},apply:function apply(e,t){this.update();if(o.exists(t)){return r.matVecMult(this.matrix,e.initialCoords.usrCoords)}return r.matVecMult(this.matrix,e.coords.usrCoords)},applyOnce:function applyOnce(e){var s,n,a;if(!o.isArray(e)){e=[e]}n=e.length;for(a=0;a<n;a++){this.update();s=r.matVecMult(this.matrix,e[a].coords.usrCoords);e[a].coords.setCoordinates(t.COORDS_BY_USER,s)}},bindTo:function bindTo(e){var t,r;if(o.isArray(e)){r=e.length;for(t=0;t<r;t++){e[t].transformations.push(this)}}else{e.transformations.push(this)}},setProperty:function setProperty(){e.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function setAttribute(){},melt:function melt(e){var t=[],r,o,n,a,d,l;o=e.matrix.length;n=this.matrix[0].length;for(r=0;r<o;r++){t[r]=[]}this.update();e.update();for(r=0;r<o;r++){for(l=0;l<n;l++){d=0;for(a=0;a<o;a++){d+=e.matrix[r][a]*this.matrix[a][l]}t[r][l]=d}}this.update=function(){var e=this.matrix.length,o=this.matrix[0].length;for(r=0;r<e;r++){for(l=0;l<o;l++){this.matrix[r][l]=t[r][l]}}};return this},getParents:function getParents(){var e=[[].concat.apply([],this.matrix)];if(0!==this.parents.length){e=this.parents}return e}});e.createTransform=function(t,r,o){return new e.Transformation(t,o.type,r)};e.registerElement("transform",e.createTransform);return{Transformation:e.Transformation,createTransform:e.createTransform}});define("base/coordselement",["jxg","options","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation"],function(e,t,r,o,s,n,a,l,c,p,u){"use strict";e.CoordsElement=function(e,t){var r;if(!u.exists(e)){e=[1,0,0]}for(r=0;r<e.length;++r){e[r]=parseFloat(e[r])}this.coords=new a(l.COORDS_BY_USER,e,this.board);this.initialCoords=new a(l.COORDS_BY_USER,e,this.board);this.position=null;this.onPolygon=!1;this.slideObject=null;this.slideObjects=[];this.needsUpdateFromParent=!0;this.updateConstraint=function(){return this};this.groups=[];this.Xjc=null;this.Yjc=null;this.methodMap=u.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"});if(u.exists(this.element)){this.addAnchor(e,t)}this.isDraggable=!0};e.extend(e.CoordsElement.prototype,{updateCoords:function updateCoords(e){if(!this.needsUpdate){return this}if(!u.exists(e)){e=!1}if(this.type===l.OBJECT_TYPE_GLIDER){if(e){this.updateGliderFromParent()}else{this.updateGlider()}}if(!u.evaluate(this.visProp.frozen)){this.updateConstraint()}this.updateTransform();return this},updateGlider:function updateGlider(){var e,t,s,n,p,h,m,g,b,C,y,f=2*Math.PI,P,_,S,E,x,O,T=!1,A,w=this.slideObject;this.needsUpdateFromParent=!1;if(w.elementClass===l.OBJECT_CLASS_CIRCLE){if(u.evaluate(this.visProp.isgeonext)){f=1}x=o.projectPointToCircle(this,w,this.board);O=o.rad([w.center.X()+1,w.center.Y()],w.center,this)/f}else if(w.elementClass===l.OBJECT_CLASS_LINE){if(this.onPolygon){t=w.point1.coords.usrCoords;s=w.point2.coords.usrCoords;e=1;n=s[e]-t[e];if(Math.abs(n)<r.eps){e=2;n=s[e]-t[e]}m=o.projectPointToLine(this,w,this.board);g=(m.usrCoords[e]-t[e])/n;h=w.parentPolygon;if(0>g){for(e=0;e<h.borders.length;e++){if(w===h.borders[e]){w=h.borders[(e-1+h.borders.length)%h.borders.length];break}}}else if(1<g){for(e=0;e<h.borders.length;e++){if(w===h.borders[e]){w=h.borders[(e+1+h.borders.length)%h.borders.length];break}}}if(w.id!==this.slideObject.id){this.slideObject=w}}t=w.point1.coords;s=w.point2.coords;n=t.distance(l.COORDS_BY_USER,s);if(n<r.eps){x=t;T=!0;O=0}else{x=o.projectPointToLine(this,w,this.board);t=t.usrCoords.slice(0);s=s.usrCoords.slice(0);if(Math.abs(s[0])<r.eps){e=1;n=s[e];if(Math.abs(n)<r.eps){e=2;n=s[e]}n=(x.usrCoords[e]-t[e])/n;b=0<=n?1:-1;n=Math.abs(n);O=b*n/(n+1)}else if(Math.abs(t[0])<r.eps){e=1;n=t[e];if(Math.abs(n)<r.eps){e=2;n=t[e]}n=(x.usrCoords[e]-s[e])/n;if(0>n){O=(1-2*n)/(1-n)}else{O=1/(n+1)}}else{e=1;n=s[e]-t[e];if(Math.abs(n)<r.eps){e=2;n=s[e]-t[e]}O=(x.usrCoords[e]-t[e])/n}}A=u.evaluate(this.visProp.snapwidth);if(0<u.evaluate(A)&&Math.abs(this._smax-this._smin)>=r.eps){O=Math.max(Math.min(O,1),0);p=O*(this._smax-this._smin)+this._smin;p=Math.round(p/A)*A;O=(p-this._smin)/(this._smax-this._smin);this.update(!0)}t=w.point1.coords;if(!u.evaluate(w.visProp.straightfirst)&&Math.abs(t.usrCoords[0])>r.eps&&0>O){x=t;T=!0;O=0}s=w.point2.coords;if(!u.evaluate(w.visProp.straightlast)&&Math.abs(s.usrCoords[0])>r.eps&&1<O){x=s;T=!0;O=1}}else if(w.type===l.OBJECT_TYPE_TURTLE){this.updateConstraint();x=o.projectPointToTurtle(this,w,this.board);O=this.position}else if(w.elementClass===l.OBJECT_CLASS_CURVE){if(w.type===l.OBJECT_TYPE_ARC||w.type===l.OBJECT_TYPE_SECTOR){x=o.projectPointToCircle(this,w,this.board);P=o.rad(w.radiuspoint,w.center,this);C=0;y=o.rad(w.radiuspoint,w.center,w.anglepoint);O=P;A=u.evaluate(w.visProp.selection);if("minor"===A&&y>Math.PI||"major"===A&&y<Math.PI){C=y;y=2*Math.PI}if(P<C||P>y){O=y;if(P<C&&P>.5*C||P>y&&P>.5*y+Math.PI){O=C}this.needsUpdateFromParent=!0;this.updateGliderFromParent()}f=y-C;if(this.visProp.isgeonext){f=1}if(Math.abs(f)>r.eps){O/=f}}else{this.updateConstraint();if(0<w.transformations.length){w.updateTransformMatrix();E=r.inverse(w.transformMat);S=r.matVecMult(E,this.coords.usrCoords);_=new a(l.COORDS_BY_USER,S,this.board).usrCoords;S=o.projectCoordsToCurve(_[1],_[2],this.position||0,w,this.board);x=S[0];O=S[1]}else{x=o.projectPointToCurve(this,w,this.board);O=this.position}}}else if(u.isPoint(w)){x=o.projectPointToPoint(this,w,this.board);O=this.position}this.coords.setCoordinates(l.COORDS_BY_USER,x.usrCoords,T);this.position=O},updateGliderFromParent:function updateGliderFromParent(){var e,t,i,s,n,a=this.slideObject,d,p,h,m,g=2*Math.PI;if(!this.needsUpdateFromParent){this.needsUpdateFromParent=!0;return}if(a.elementClass===l.OBJECT_CLASS_CIRCLE){i=a.Radius();if(u.evaluate(this.visProp.isgeonext)){g=1}n=[a.center.X()+i*Math.cos(this.position*g),a.center.Y()+i*Math.sin(this.position*g)]}else if(a.elementClass===l.OBJECT_CLASS_LINE){e=a.point1.coords.usrCoords;t=a.point2.coords.usrCoords;if(0===e[0]&&0===e[1]&&0===e[2]||0===t[0]&&0===t[1]&&0===t[2]){n=[0,0,0]}else if(Math.abs(t[0])<r.eps){s=Math.min(Math.abs(this.position),1-r.eps);s/=1-s;if(0>this.position){s=-s}n=[e[0]+s*t[0],e[1]+s*t[1],e[2]+s*t[2]]}else if(Math.abs(e[0])<r.eps){s=Math.max(this.position,r.eps);s=Math.min(s,2-r.eps);if(1<s){s=(s-1)/(s-2)}else{s=(1-s)/s}n=[t[0]+s*e[0],t[1]+s*e[1],t[2]+s*e[2]]}else{s=this.position;n=[e[0]+s*(t[0]-e[0]),e[1]+s*(t[1]-e[1]),e[2]+s*(t[2]-e[2])]}}else if(a.type===l.OBJECT_TYPE_TURTLE){this.coords.setCoordinates(l.COORDS_BY_USER,[a.Z(this.position),a.X(this.position),a.Y(this.position)]);this.updateConstraint();n=o.projectPointToTurtle(this,a,this.board).usrCoords}else if(a.elementClass===l.OBJECT_CLASS_CURVE){this.coords.setCoordinates(l.COORDS_BY_USER,[a.Z(this.position),a.X(this.position),a.Y(this.position)]);if(a.type===l.OBJECT_TYPE_ARC||a.type===l.OBJECT_TYPE_SECTOR){d=o.rad([a.center.X()+1,a.center.Y()],a.center,a.radiuspoint);p=0;m=o.rad(a.radiuspoint,a.center,a.anglepoint);if("minor"===a.visProp.selection&&m>Math.PI||"major"===a.visProp.selection&&m<Math.PI){p=m;m=2*Math.PI}g=m-p;if(u.evaluate(this.visProp.isgeonext)){g=1}h=this.position*g;if(h<p||h>m){h=m;if(h<p&&h>.5*p||h>m&&h>.5*m+Math.PI){h=p}this.position=h;if(Math.abs(g)>r.eps){this.position/=g}}i=a.Radius();n=[a.center.X()+i*Math.cos(this.position*g+d),a.center.Y()+i*Math.sin(this.position*g+d)]}else{this.updateConstraint();n=o.projectPointToCurve(this,a,this.board).usrCoords}}else if(u.isPoint(a)){n=o.projectPointToPoint(this,a,this.board).usrCoords}this.coords.setCoordinates(l.COORDS_BY_USER,n,!1)},updateRendererGeneric:function updateRendererGeneric(e){if(!this.needsUpdate){return this}if(this.visPropCalc.visible){this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]);this.isReal=Math.abs(this.coords.usrCoords[0])>r.eps?this.isReal:!1;if(!this.isReal){this.updateVisibility(!1)}}if(this.visPropCalc.visible){this.board.renderer[e](this)}if(this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal){this.label.update();this.board.renderer.updateText(this.label)}this.setDisplayRendNode();this.needsUpdate=!1;return this},X:function X(){return this.coords.usrCoords[1]},Y:function Y(){return this.coords.usrCoords[2]},Z:function Z(){return this.coords.usrCoords[0]},XEval:function XEval(){return this.coords.usrCoords[1]},YEval:function YEval(){return this.coords.usrCoords[2]},ZEval:function ZEval(){return this.coords.usrCoords[0]},Dist:function Dist(e){if(this.isReal&&e.isReal){return this.coords.distance(l.COORDS_BY_USER,e.coords)}return NaN},snapToGrid:function snapToGrid(e){return this.handleSnapToGrid(e)},handleSnapToPoints:function handleSnapToPoints(e){var t,r,s,n=0,a,p=1/0,h=null,m,g,b=u.evaluate(this.visProp.ignoredsnaptopoints),C,y,v=!1;a=this.board.objectsList.length;if(b){C=b.length}if(u.evaluate(this.visProp.snaptopoints)||e){m=u.evaluate(this.visProp.attractorunit);g=u.evaluate(this.visProp.attractordistance);for(t=0;t<a;t++){r=this.board.objectsList[t];if(b){v=!1;for(y=0;y<C;y++){if(r==this.board.select(b[y])){v=!0;break}}if(v){continue}}if(u.isPoint(r)&&r!==this&&r.visPropCalc.visible){s=o.projectPointToPoint(this,r,this.board);if("screen"===m){n=s.distance(l.COORDS_BY_SCREEN,this.coords)}else{n=s.distance(l.COORDS_BY_USER,this.coords)}if(n<g&&n<p){p=n;h=s}}}if(null!==h){this.coords.setCoordinates(l.COORDS_BY_USER,h.usrCoords)}}return this},snapToPoints:function snapToPoints(e){return this.handleSnapToPoints(e)},handleAttractors:function handleAttractors(){var e,t,r,s=0,n,c=u.evaluate(this.visProp.attractorunit),p=u.evaluate(this.visProp.attractordistance),h=u.evaluate(this.visProp.snatchdistance),m=u.evaluate(this.visProp.attractors),g=m.length;if(0===p){return}for(e=0;e<g;e++){t=this.board.select(m[e]);if(u.exists(t)&&t!==this){if(u.isPoint(t)){r=o.projectPointToPoint(this,t,this.board)}else if(t.elementClass===l.OBJECT_CLASS_LINE){n=o.projectCoordsToSegment(this.coords.usrCoords,t.point1.coords.usrCoords,t.point2.coords.usrCoords);if(!u.evaluate(t.visProp.straightfirst)&&0>n[1]){r=t.point1.coords}else if(!u.evaluate(t.visProp.straightlast)&&1<n[1]){r=t.point2.coords}else{r=new a(l.COORDS_BY_USER,n[0],this.board)}}else if(t.elementClass===l.OBJECT_CLASS_CIRCLE){r=o.projectPointToCircle(this,t,this.board)}else if(t.elementClass===l.OBJECT_CLASS_CURVE){r=o.projectPointToCurve(this,t,this.board)}else if(t.type===l.OBJECT_TYPE_TURTLE){r=o.projectPointToTurtle(this,t,this.board)}if("screen"===c){s=r.distance(l.COORDS_BY_SCREEN,this.coords)}else{s=r.distance(l.COORDS_BY_USER,this.coords)}if(s<p){if(!(this.type===l.OBJECT_TYPE_GLIDER&&this.slideObject===t)){this.makeGlider(t)}break}else{if(t===this.slideObject&&s>=h){this.popSlideObject()}}}}return this},setPositionDirectly:function setPositionDirectly(e,t){var o,s,d,p=this.coords,h;if(this.relativeCoords){s=new a(e,t,this.board);if(u.evaluate(this.visProp.islabel)){d=n.subtract(s.scrCoords,p.scrCoords);this.relativeCoords.scrCoords[1]+=d[1];this.relativeCoords.scrCoords[2]+=d[2]}else{d=n.subtract(s.usrCoords,p.usrCoords);this.relativeCoords.usrCoords[1]+=d[1];this.relativeCoords.usrCoords[2]+=d[2]}return this}this.coords.setCoordinates(e,t);this.handleSnapToGrid();this.handleSnapToPoints();this.handleAttractors();for(o=this.transformations.length-1;0<=o;o--){if(e===l.COORDS_BY_SCREEN){h=new a(e,t,this.board).usrCoords}else{if(2===t.length){t=[1].concat(t)}h=t}this.initialCoords.setCoordinates(l.COORDS_BY_USER,r.matVecMult(r.inverse(this.transformations[o].matrix),h))}this.prepareUpdate().update();if(this.board.isSuspendedUpdate&&this.type===l.OBJECT_TYPE_GLIDER){this.updateGlider()}return this},setPositionByTransform:function setPositionByTransform(e,r){var o;r=new a(e,r,this.board);o=this.board.create("transform",r.usrCoords.slice(1),{type:"translate"});if(0<this.transformations.length&&this.transformations[this.transformations.length-1].isNumericMatrix){this.transformations[this.transformations.length-1].melt(o)}else{this.addTransform(this,o)}this.prepareUpdate().update();return this},setPosition:function setPosition(e,t){return this.setPositionDirectly(e,t)},setGliderPosition:function setGliderPosition(e){if(this.type===l.OBJECT_TYPE_GLIDER){this.position=e;this.board.update()}return this},makeGlider:function makeGlider(t){var r=this.board.select(t),o=!1,s,n,a;if(r.type===l.OBJECT_TYPE_POLYGON){s=Number.MAX_VALUE;for(n=0;n<r.borders.length;n++){a=e.Math.Geometry.distPointLine(this.coords.usrCoords,r.borders[n].stdform);if(a<s){s=a;t=r.borders[n]}}r=this.board.select(t);o=!0}if(!u.exists(r)){throw new Error("JSXGraph: slide object undefined.")}else if(r.type===l.OBJECT_TYPE_TICKS){throw new Error("JSXGraph: gliders on ticks are not possible.")}this.slideObject=this.board.select(t);this.slideObjects.push(this.slideObject);this.addParents(t);this.type=l.OBJECT_TYPE_GLIDER;this.elType="glider";this.visProp.snapwidth=-1;this.slideObject.addChild(this);this.isDraggable=!0;this.onPolygon=o;this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)};this.updateGlider();this.needsUpdateFromParent=!0;this.updateGliderFromParent();return this},popSlideObject:function popSlideObject(){if(0<this.slideObjects.length){this.slideObjects.pop();this.slideObject.removeChild(this);if(0===this.slideObjects.length){this.type=this._org_type;if(this.type===l.OBJECT_TYPE_POINT){this.elType="point"}else if(this.elementClass===l.OBJECT_CLASS_TEXT){this.elType="text"}else if(this.type===l.OBJECT_TYPE_IMAGE){this.elType="image"}this.slideObject=null}else{this.slideObject=this.slideObjects[this.slideObjects.length-1]}}},free:function free(){var e,t;if(this.type!==l.OBJECT_TYPE_GLIDER){this.transformations.length=0;if(!this.isDraggable){this.isDraggable=!0;if(this.elementClass===l.OBJECT_CLASS_POINT){this.type=l.OBJECT_TYPE_POINT;this.elType="point"}this.XEval=function(){return this.coords.usrCoords[1]};this.YEval=function(){return this.coords.usrCoords[2]};this.ZEval=function(){return this.coords.usrCoords[0]};this.Xjc=null;this.Yjc=null}else{return}}for(e in this.board.objects){if(this.board.objects.hasOwnProperty(e)){t=this.board.objects[e];if(t.descendants){delete t.descendants[this.id];delete t.childElements[this.id];if(this.hasLabel){delete t.descendants[this.label.id];delete t.childElements[this.label.id]}}}}this.ancestors={};this.slideObject=null;this.slideObjects=[];if(this.elementClass===l.OBJECT_CLASS_POINT){this.type=l.OBJECT_TYPE_POINT;this.elType="point"}else if(this.elementClass===l.OBJECT_CLASS_TEXT){this.type=this._org_type;this.elType="text"}else if(this.elementClass===l.OBJECT_CLASS_OTHER){this.type=this._org_type;this.elType="image"}},addConstraint:function addConstraint(e){var t,r,o=[],s=["X","Y"],n=function(e){return function(){return e}},a=function(e){return function(){return e.Value()}};if(this.elementClass===l.OBJECT_CLASS_POINT){this.type=l.OBJECT_TYPE_CAS}this.isDraggable=!1;for(t=0;t<e.length;t++){r=e[t];if(u.isString(r)){o[t]=this.board.jc.snippet(r,!0,null,!0);if(2===e.length){this[s[t]+"jc"]=e[t]}}else if(u.isFunction(r)){o[t]=r}else if(u.isNumber(r)){o[t]=n(r)}else if(u.isObject(r)&&u.isFunction(r.Value)){o[t]=a(r)}o[t].origin=r}if(1===e.length){this.updateConstraint=function(){var e=o[0]();if(u.isArray(e)){this.coords.setCoordinates(l.COORDS_BY_USER,e)}else{this.coords=e}}}else if(2===e.length){this.XEval=o[0];this.YEval=o[1];this.setParents([o[0].origin,o[1].origin]);this.updateConstraint=function(){this.coords.setCoordinates(l.COORDS_BY_USER,[this.XEval(),this.YEval()])}}else{this.ZEval=o[0];this.XEval=o[1];this.YEval=o[2];this.setParents([o[0].origin,o[1].origin,o[2].origin]);this.updateConstraint=function(){this.coords.setCoordinates(l.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])}}this.prepareUpdate().update();if(!this.board.isSuspendedUpdate){this.updateVisibility().updateRenderer()}return this},addAnchor:function addAnchor(e,t){if(t){this.relativeCoords=new a(l.COORDS_BY_SCREEN,e.slice(0,2),this.board)}else{this.relativeCoords=new a(l.COORDS_BY_USER,e,this.board)}this.element.addChild(this);if(t){this.addParents(this.element)}this.XEval=function(){var e,t,r,o=u.evaluate(this.visProp.offset);if(u.evaluate(this.visProp.islabel)){e=parseFloat(o[0]);r=this.element.getLabelAnchor();t=new a(l.COORDS_BY_SCREEN,[e+this.relativeCoords.scrCoords[1]+r.scrCoords[1],0],this.board);return t.usrCoords[1]}r=this.element.getTextAnchor();return this.relativeCoords.usrCoords[1]+r.usrCoords[1]};this.YEval=function(){var e,t,r,o=u.evaluate(this.visProp.offset);if(u.evaluate(this.visProp.islabel)){e=-parseFloat(o[1]);r=this.element.getLabelAnchor();t=new a(l.COORDS_BY_SCREEN,[0,e+this.relativeCoords.scrCoords[2]+r.scrCoords[2]],this.board);return t.usrCoords[2]}r=this.element.getTextAnchor();return this.relativeCoords.usrCoords[2]+r.usrCoords[2]};this.ZEval=u.createFunction(1,this.board,"");this.updateConstraint=function(){this.coords.setCoordinates(l.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])};this.coords=new a(l.COORDS_BY_SCREEN,[0,0],this.board)},updateTransform:function updateTransform(){var e;if(0===this.transformations.length){return this}for(e=0;e<this.transformations.length;e++){this.transformations[e].update()}return this},addTransform:function addTransform(e,t){var r,o=u.isArray(t)?t:[t],s=o.length;if(0===this.transformations.length){this.baseElement=e}for(r=0;r<s;r++){this.transformations.push(o[r])}return this},startAnimation:function startAnimation(e,t){var r=this;if(this.type===l.OBJECT_TYPE_GLIDER&&!u.exists(this.intervalCode)){this.intervalCode=window.setInterval(function(){r._anim(e,t)},250);if(!u.exists(this.intervalCount)){this.intervalCount=0}}return this},stopAnimation:function stopAnimation(){if(u.exists(this.intervalCode)){window.clearInterval(this.intervalCode);delete this.intervalCode}return this},moveAlong:function moveAlong(e,t,r){r=r||{};var o,n,a=[],d=[],c=this.board.attr.animationdelay,p=t/c,h,m,g,b=function(t,r){return function(){return e[t][r]}};if(u.isArray(e)){h=e.length;for(o=0;o<h;o++){if(u.isPoint(e[o])){d[o]=e[o]}else{d[o]={elementClass:l.OBJECT_CLASS_POINT,X:b(o,0),Y:b(o,1)}}}t=t||0;if(0===t){this.setPosition(l.COORDS_BY_USER,[d[d.length-1].X(),d[d.length-1].Y()]);return this.board.update(this)}if(!u.exists(r.interpolate)||r.interpolate){n=s.Neville(d);for(o=0;o<p;o++){a[o]=[];a[o][0]=n[0]((p-o)/p*n[3]());a[o][1]=n[1]((p-o)/p*n[3]())}}else{h=e.length-1;for(o=0;o<p;++o){m=Math.floor(o/p*h);g=o/p*h-m;a[o]=[];a[o][0]=(1-g)*d[m].X()+g*d[m+1].X();a[o][1]=(1-g)*d[m].Y()+g*d[m+1].Y()}a.push([d[h].X(),d[h].Y()]);a.reverse()}this.animationPath=a}else if(u.isFunction(e)){this.animationPath=e;this.animationStart=new Date().getTime()}this.animationCallback=r.callback;this.board.addAnimation(this);return this},moveTo:function moveTo(e,t,o){o=o||{};e=new a(l.COORDS_BY_USER,e,this.board);var s,n=this.board.attr.animationdelay,d=Math.ceil(t/n),c=[],p=this.coords.usrCoords[1],h=this.coords.usrCoords[2],m=e.usrCoords[1]-p,g=e.usrCoords[2]-h,b=function(e){if(o.effect&&"<>"===o.effect){return Math.pow(Math.sin(e/d*Math.PI/2),2)}return e/d};if(!u.exists(t)||0===t||Math.abs(e.usrCoords[0]-this.coords.usrCoords[0])>r.eps){this.setPosition(l.COORDS_BY_USER,e.usrCoords);return this.board.update(this)}if(!u.exists(o.callback)&&Math.abs(m)<r.eps&&Math.abs(g)<r.eps){return this}for(s=d;0<=s;s--){c[d-s]=[e.usrCoords[0],p+m*b(s),h+g*b(s)]}this.animationPath=c;this.animationCallback=o.callback;this.board.addAnimation(this);return this},visit:function visit(e,t,r){e=new a(l.COORDS_BY_USER,e,this.board);var o,s,n,d=this.board.attr.animationdelay,c=[],p=this.coords.usrCoords[1],h=this.coords.usrCoords[2],m=e.usrCoords[1]-p,g=e.usrCoords[2]-h,b=function(e){var t=e<n/2?2*e/n:2*(n-e)/n;if(r.effect&&"<>"===r.effect){return Math.pow(Math.sin(t*Math.PI/2),2)}return t};if(u.isNumber(r)){r={repeat:r}}else{r=r||{};if(!u.exists(r.repeat)){r.repeat=1}}n=Math.ceil(t/(d*r.repeat));for(s=0;s<r.repeat;s++){for(o=n;0<=o;o--){c[s*(n+1)+n-o]=[e.usrCoords[0],p+m*b(o),h+g*b(o)]}}this.animationPath=c;this.animationCallback=r.callback;this.board.addAnimation(this);return this},_anim:function _anim(e,t){var r,i,s,n,a,d,c,p,u=1;this.intervalCount+=1;if(this.intervalCount>t){this.intervalCount=0}if(this.slideObject.elementClass===l.OBJECT_CLASS_LINE){r=this.slideObject.point1.coords.distance(l.COORDS_BY_SCREEN,this.slideObject.point2.coords);i=this.slideObject.getSlope();if(i!==1/0){a=Math.atan(i);s=Math.round(this.intervalCount/t*r*Math.cos(a));n=Math.round(this.intervalCount/t*r*Math.sin(a))}else{s=0;n=Math.round(this.intervalCount/t*r)}if(0>e){d=this.slideObject.point2;if(0<this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]){u=-1}else if(0==this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]){if(0<this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]){u=-1}}}else{d=this.slideObject.point1;if(0<this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]){u=-1}else if(0==this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]){if(0<this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]){u=-1}}}this.coords.setCoordinates(l.COORDS_BY_SCREEN,[d.coords.scrCoords[1]+u*s,d.coords.scrCoords[2]+u*n])}else if(this.slideObject.elementClass===l.OBJECT_CLASS_CURVE){if(0<e){c=Math.round(this.intervalCount/t*this.board.canvasWidth)}else{c=Math.round((t-this.intervalCount)/t*this.board.canvasWidth)}this.coords.setCoordinates(l.COORDS_BY_SCREEN,[c,0]);this.coords=o.projectPointToCurve(this,this.slideObject,this.board)}else if(this.slideObject.elementClass===l.OBJECT_CLASS_CIRCLE){if(0>e){a=2*(this.intervalCount/t)*Math.PI}else{a=2*((t-this.intervalCount)/t)*Math.PI}p=this.slideObject.Radius();this.coords.setCoordinates(l.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+p*Math.cos(a),this.slideObject.center.coords.usrCoords[2]+p*Math.sin(a)])}this.board.update(this);return this},getTextAnchor:function getTextAnchor(){return this.coords},getLabelAnchor:function getLabelAnchor(){return this.coords},getParents:function getParents(){var e=[this.Z(),this.X(),this.Y()];if(0!==this.parents.length){e=this.parents}if(this.type===l.OBJECT_TYPE_GLIDER){e=[this.X(),this.Y(),this.slideObject.id]}return e}});e.CoordsElement.create=function(e,t,r,o,s,n){var a,d=!1,l;for(l=0;l<r.length;l++){if(u.isFunction(r[l])||u.isString(r[l])){d=!0}}if(!d){if(u.isNumber(r[0])&&u.isNumber(r[1])){a=new e(t,r,o,s,n);if(u.exists(o.slideobject)){a.makeGlider(o.slideobject)}else{a.baseElement=a}a.isDraggable=!0}else if(u.isObject(r[0])&&u.isTransformationOrArray(r[1])){a=new e(t,[0,0],o,s,n);a.addTransform(r[0],r[1]);a.isDraggable=!1}else{return!1}}else{a=new e(t,[0,0],o,s,n);a.addConstraint(r)}a.handleSnapToGrid();a.handleSnapToPoints();a.handleAttractors();a.addParents(r);return a};return e.CoordsElement});define("base/text",["jxg","base/constants","base/coords","base/element","parser/geonext","math/statistics","utils/env","utils/type","math/math","base/coordselement"],function(r,o,i,s,n,a,d,l,c,p){"use strict";var u={HTMLSliderInputEventHandler:function HTMLSliderInputEventHandler(){this._val=parseFloat(this.rendNodeRange.value);this.rendNodeOut.value=this.rendNodeRange.value;this.board.update()}};r.Text=function(e,t,r,i){this.constructor(e,r,o.OBJECT_TYPE_TEXT,o.OBJECT_CLASS_TEXT);this.element=this.board.select(r.anchor);this.coordsConstructor(t,l.evaluate(this.visProp.islabel));this.content="";this.plaintext="";this.plaintextOld=null;this.orgText="";this.needsSizeUpdate=!1;this.hiddenByParent=!1;this.size=[1,1];this.id=this.board.setId(this,"T");this._setUpdateText(i);this.updateText();this.board.renderer.drawText(this);this.board.finalizeAdding(this);if(l.isString(this.content)){this.notifyParents(this.content)}this.elType="text";this.methodMap=l.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})};r.Text.prototype=new s;l.copyPrototypeMethods(r.Text,p,"coordsConstructor");r.extend(r.Text.prototype,{hasPoint:function hasPoint(e,t){var o,i,s,n,a,d,p=this.board.options.precision.hasPoint;if(0<this.transformations.length){o=c.matVecMult(c.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,e,t]);e=o[1];t=o[2]}a=this.getAnchorX();if("right"===a){o=this.coords.scrCoords[1]-this.size[0]}else if("middle"===a){o=this.coords.scrCoords[1]-.5*this.size[0]}else{o=this.coords.scrCoords[1]}i=o+this.size[0];d=this.getAnchorY();if("top"===d){n=this.coords.scrCoords[2]+this.size[1]}else if("middle"===d){n=this.coords.scrCoords[2]+.5*this.size[1]}else{n=this.coords.scrCoords[2]}s=n-this.size[1];if("all"===l.evaluate(this.visProp.dragarea)){return e>=o-p&&e<i+p&&t>=s-p&&t<=n+p}return t>=s-p&&t<=n+p&&(e>=o-p&&e<=o+2*p||e>=i-2*p&&e<=i+p)},_setUpdateText:function _setUpdateText(e){var t,r,o=l.evaluate(this.visProp.parse),i=l.evaluate(this.visProp.usemathjax);this.orgText=e;if(l.isFunction(e)){this.updateText=function(){r=e().toString();if(o&&!i){this.plaintext=this.replaceSub(this.replaceSup(this.convertGeonext2CSS(r)))}else{this.plaintext=r}}}else if(l.isString(e)&&!o){this.updateText=function(){this.plaintext=e}}else{if(l.isNumber(e)){this.content=l.toFixed(e,l.evaluate(this.visProp.digits))}else{if(l.evaluate(this.visProp.useasciimathml)){this.content="'`"+e+"`'"}else if(i){this.content="'"+e+"'"}else{this.content=this.generateTerm(e,!0,!0)}}t=this.board.jc.snippet(this.content,!0,"",!1);this.updateText=function(){this.plaintext=t()}}},_setText:function _setText(e){this._setUpdateText(e);this.updateText();this.fullUpdate();if(!this.board.infobox||this.id!==this.board.infobox.id){this.updateSize()}return this},setTextJessieCode:function setTextJessieCode(e){var t;this.visProp.castext=e;if(l.isFunction(e)){t=function(){return l.sanitizeHTML(e())}}else{if(l.isNumber(e)){t=e}else{t=l.sanitizeHTML(e)}}return this._setText(t)},setText:function setText(e){return this._setText(e)},updateSize:function updateSize(){var e,t,r,o,i=l.evaluate(this.visProp.display);if(!d.isBrowser||"no"===this.board.renderer.type){return this}o=this.rendNode;if("html"===i||"vml"===this.board.renderer.type){if(l.exists(o.offsetWidth)){t=[o.offsetWidth,o.offsetHeight];if(0===t[0]&&0===t[1]){r=this;window.setTimeout(function(){r.size=[o.offsetWidth,o.offsetHeight];r.needsUpdate=!0;r.updateRenderer()},0)}else{this.size=t}}else{this.size=this.crudeSizeEstimate()}}else if("internal"===i){if("svg"===this.board.renderer.type){try{e=o.getBBox();this.size=[e.width,e.height]}catch(t){}}else if("canvas"===this.board.renderer.type){this.size=this.crudeSizeEstimate()}}return this},crudeSizeEstimate:function crudeSizeEstimate(){var e=parseFloat(l.evaluate(this.visProp.fontsize));return[.45*(e*this.plaintext.length),.9*e]},utf8_decode:function utf8_decode(e){return e.replace(/&#x(\w+);/g,function(e,t){return String.fromCharCode(parseInt(t,16))})},replaceSub:function replaceSub(e){if(!e.indexOf){return e}var t,r=e.indexOf("_{");while(0<=r){e=e.substr(0,r)+e.substr(r).replace(/_\{/,"<sub>");t=e.substr(r).indexOf("}");if(0<=t){e=e.substr(0,t)+e.substr(t).replace(/\}/,"</sub>")}r=e.indexOf("_{")}r=e.indexOf("_");while(0<=r){e=e.substr(0,r)+e.substr(r).replace(/_(.?)/,"<sub>$1</sub>");r=e.indexOf("_")}return e},replaceSup:function replaceSup(e){if(!e.indexOf){return e}var t,r=e.indexOf("^{");while(0<=r){e=e.substr(0,r)+e.substr(r).replace(/\^\{/,"<sup>");t=e.substr(r).indexOf("}");if(0<=t){e=e.substr(0,t)+e.substr(t).replace(/\}/,"</sup>")}r=e.indexOf("^{")}r=e.indexOf("^");while(0<=r){e=e.substr(0,r)+e.substr(r).replace(/\^(.?)/,"<sup>$1</sup>");r=e.indexOf("^")}return e},getSize:function getSize(){return this.size},setCoords:function setCoords(e,t){var r,i,s;if(l.isArray(e)&&1<e.length){t=e[1];e=e[0]}if(l.evaluate(this.visProp.islabel)&&l.exists(this.element)){r=this.element.getLabelAnchor();i=(e-r.usrCoords[1])*this.board.unitX;s=-(t-r.usrCoords[2])*this.board.unitY;this.relativeCoords.setCoordinates(o.COORDS_BY_SCREEN,[i,s])}else{this.coords.setCoordinates(o.COORDS_BY_USER,[e,t])}this.fullUpdate();return this},update:function update(e){if(!this.needsUpdate){return this}this.updateCoords(e);this.updateText();if("internal"===l.evaluate(this.visProp.display)){if(l.isString(this.plaintext)){this.plaintext=this.utf8_decode(this.plaintext)}}this.checkForSizeUpdate();if(this.needsSizeUpdate){this.updateSize()}return this},checkForSizeUpdate:function checkForSizeUpdate(){if(this.board.infobox&&this.id===this.board.infobox.id){this.needsSizeUpdate=!1}else{this.needsSizeUpdate=this.plaintextOld!==this.plaintext;if(this.needsSizeUpdate){this.plaintextOld=this.plaintext}}},updateRenderer:function updateRenderer(){return this.updateRendererGeneric("updateText")},expandShortMath:function expandShortMath(e){var t=/([\)0-9\.])\s*([\(a-zA-Z_])/g;return e.replace(t,"$1*$2")},generateTerm:function generateTerm(e,t,r){var o,s,a,d,c="\"\"";e=e||"";e=e.replace(/\r/g,"");e=e.replace(/\n/g,"");e=e.replace(/"/g,"'");e=e.replace(/'/g,"\\'");e=e.replace(/&amp;arc;/g,"&ang;");e=e.replace(/<arc\s*\/>/g,"&ang;");e=e.replace(/&lt;arc\s*\/&gt;/g,"&ang;");e=e.replace(/&lt;sqrt\s*\/&gt;/g,"&radic;");e=e.replace(/&lt;value&gt;/g,"<value>");e=e.replace(/&lt;\/value&gt;/g,"</value>");a=e.indexOf("<value>");d=e.indexOf("</value>");if(0<=a){while(0<=a){c+=" + \""+this.replaceSub(this.replaceSup(e.slice(0,a)))+"\"";s=e.slice(a+7,d);s=s.replace(/\s+/g,"");if(!0===t){s=this.expandShortMath(s)}if(r){o=s}else{o=n.geonext2JS(s,this.board)}o=o.replace(/\\"/g,"'");o=o.replace(/\\'/g,"'");if(0>o.indexOf("toFixed")){if(l.isNumber(l.bind(this.board.jc.snippet(o,!0,"",!1),this)())){c+="+("+o+").toFixed("+l.evaluate(this.visProp.digits)+")"}else{c+="+("+o+")"}}else{c+="+("+o+")"}e=e.slice(d+8);a=e.indexOf("<value>");d=e.indexOf("</value>")}}c+=" + \""+this.replaceSub(this.replaceSup(e))+"\"";c=this.convertGeonext2CSS(c);c=c.replace(/&amp;/g,"&");c=c.replace(/"/g,"'");return c},convertGeonext2CSS:function convertGeonext2CSS(e){if(l.isString(e)){e=e.replace(/<overline>/g,"<span style=text-decoration:overline>");e=e.replace(/&lt;overline&gt;/g,"<span style=text-decoration:overline>");e=e.replace(/<\/overline>/g,"</span>");e=e.replace(/&lt;\/overline&gt;/g,"</span>");e=e.replace(/<arrow>/g,"<span style=text-decoration:overline>");e=e.replace(/&lt;arrow&gt;/g,"<span style=text-decoration:overline>");e=e.replace(/<\/arrow>/g,"</span>");e=e.replace(/&lt;\/arrow&gt;/g,"</span>")}return e},notifyParents:function notifyParents(e){var t,r=null;e=e.replace(/&lt;value&gt;/g,"<value>");e=e.replace(/&lt;\/value&gt;/g,"</value>");do{t=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/;r=t.exec(e);if(null!==r){n.findDependencies(this,r[1],this.board);e=e.substr(r.index);e=e.replace(t,"")}}while(null!==r);return this},getParents:function getParents(){var e;if(this.relativeCoords!==void 0){e=[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]}else{e=[this.Z(),this.X(),this.Y(),this.orgText]}if(0!==this.parents.length){e=this.parents}return e},bounds:function bounds(){var e=this.coords.usrCoords;if(l.evaluate(this.visProp.islabel)||0===this.board.unitY||0===this.board.unitX){return[0,0,0,0]}else{return[e[1],e[2]+this.size[1]/this.board.unitY,e[1]+this.size[0]/this.board.unitX,e[2]]}},getAnchorX:function getAnchorX(){var e=l.evaluate(this.visProp.anchorx);if("auto"==e){switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";case"lft":case"llft":case"ulft":default:return"right";}}return e},getAnchorY:function getAnchorY(){var e=l.evaluate(this.visProp.anchory);if("auto"==e){switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";case"rt":case"lft":default:return"middle";}}return e}});r.createText=function(e,o,i){var s,n=l.copyAttributes(i,e.options,"text"),a=o.slice(0,-1),d=o[o.length-1];n.anchor=n.parent||n.anchor;s=p.create(r.Text,e,a,n,d);if(!s){throw new Error("JSXGraph: Can't create text with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]")}if(0!==l.evaluate(n.rotate)&&"internal"===n.display){s.addRotation(l.evaluate(n.rotate))}return s};r.registerElement("text",r.createText);r.createHTMLSlider=function(e,o,i){var s,n,a=l.copyAttributes(i,e.options,"htmlslider");if(2!==o.length||2!==o[0].length||3!==o[1].length){throw new Error("JSXGraph: Can't create htmlslider with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'.\nPossible parents are: [[x,y], [min, start, max]]")}a.anchor=a.parent||a.anchor;a.fixed=a.fixed||!0;n=[o[0][0],o[0][1],"<form style=\"display:inline\"><input type=\"range\" /><span></span><input type=\"text\" /></form>"];s=r.createText(e,n,a);s.type=l.OBJECT_TYPE_HTMLSLIDER;s.rendNodeForm=s.rendNode.childNodes[0];s.rendNodeRange=s.rendNodeForm.childNodes[0];s.rendNodeRange.min=o[1][0];s.rendNodeRange.max=o[1][2];s.rendNodeRange.step=a.step;s.rendNodeRange.value=o[1][1];s.rendNodeLabel=s.rendNodeForm.childNodes[1];s.rendNodeLabel.id=s.rendNode.id+"_label";if(a.withlabel){s.rendNodeLabel.innerHTML=s.name+"="}s.rendNodeOut=s.rendNodeForm.childNodes[2];s.rendNodeOut.value=o[1][1];try{s.rendNodeForm.id=s.rendNode.id+"_form";s.rendNodeRange.id=s.rendNode.id+"_range";s.rendNodeOut.id=s.rendNode.id+"_out"}catch(t){r.debug(t)}s.rendNodeRange.style.width=a.widthrange+"px";s.rendNodeRange.style.verticalAlign="middle";s.rendNodeOut.style.width=a.widthout+"px";s._val=o[1][1];if(r.supportsVML()){d.addEvent(s.rendNodeForm,"change",u.HTMLSliderInputEventHandler,s)}else{d.addEvent(s.rendNodeForm,"input",u.HTMLSliderInputEventHandler,s)}s.Value=function(){return this._val};return s};r.registerElement("htmlslider",r.createHTMLSlider);return{Text:r.Text,createText:r.createText,createHTMLSlider:r.createHTMLSlider}});define("utils/uuid",["jxg"],function(e){"use strict";var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");e.Util=e.Util||{};e.Util.genUUID=function(){var e,o,s=[],n=0;for(o=0;36>o;o++){if(8===o||13===o||18===o||23===o){s[o]="-"}else if(14===o){s[o]="4"}else{if(2>=n){n=0|33554432+16777216*Math.random()}e=15&n;n=n>>4;s[o]=t[19===o?8|3&e:e]}}return s.join("")};return e.Util});define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],function(JXG,Const,Text,Mat,Geometry,Statistics,Type,UUID,Env){if(!Object.create){Object.create=function(e,t){if("object"!==_typeof(e)&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object: "+e);else if(null===e)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if("undefined"!=typeof t)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");function r(){}r.prototype=e;return new r}}var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}};JXG.JessieCode=function(e,t){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null};this.scopes=[];this.scopes.push(this.scope);this.dpstack=[[]];this.pscope=0;this.propstack=[{}];this.propscope=0;this.lhs=[];this.isLHS=!1;this.warnLog="jcwarn";this.$log=[];this.builtIn=this.defineBuiltIn();this.board=null;this.lineToElement={};this.parCurLine=1;this.parCurColumn=0;this.line=1;this.col=1;if(JXG.CA){this.CA=new JXG.CA(this.node,this.createNode,this)}this.code="";if("string"==typeof e){this.parse(e,t)}};JXG.extend(JXG.JessieCode.prototype,{node:function node(e,t,r){return{type:e,value:t,children:r}},createNode:function createNode(e,t){var r=this.node(e,t,[]),o;for(o=2;o<arguments.length;o++){r.children.push(arguments[o])}if("node_const"==r.type&&Type.isNumber(r.value)){r.isMath=!0}r.line=this.parCurLine;r.col=this.parCurColumn;return r},pushScope:function pushScope(e){var t={args:e,locals:{},context:null,previous:this.scope};this.scope.hasChild=!0;this.scope=t;t.id=this.scopes.push(t)-1;return t},popScope:function popScope(){var e=this.scope.previous;this.scope=null!==e?e:this.scope;return this.scope},getElementById:function getElementById(e){return this.board.objects[e]},log:function log(){this.$log.push(arguments);if("object"===("undefined"==typeof console?"undefined":_typeof(console))&&console.log){console.log.apply(console,arguments)}},creator:function(){var e={},t;t=function(t){var r;if("function"==typeof e[this.board.id+t]){r=e[this.board.id+t]}else{r=function(e){return function(r,o){var i;if(Type.exists(o)){i=o}else{i={name:0!==e.lhs[e.scope]?e.lhs[e.scope]:""}}return e.board.create(t,r,i)}}(this);r.creator=!0;e[this.board.id+t]=r}return r};t.clearCache=function(){e={}};return t}(),letvar:function letvar(e,t){if(this.builtIn[e]){this._warn("\""+e+"\" is a predefined value.")}this.scope.locals[e]=t},isLocalVariable:function isLocalVariable(e){var t=this.scope;while(null!==t){if(Type.exists(t.locals[e])){return t}t=t.previous}return null},isParameter:function isParameter(e){var t=this.scope;while(null!==t){if(-1<Type.indexOf(t.args,e)){return t}t=t.previous}return null},isCreator:function isCreator(e){return!!JXG.elements[e]},isMathMethod:function isMathMethod(e){return"E"!==e&&!!Math[e]},isBuiltIn:function isBuiltIn(e){return!!this.builtIn[e]},getvar:function getvar(e,t){var r;t=Type.def(t,!1);r=this.isLocalVariable(e);if(null!==r){return r.locals[e]}if(this.isCreator(e)){return this.creator(e)}if(this.isBuiltIn(e)){return this.builtIn[e]}if(this.isMathMethod(e)){return Math[e]}if(!t){r=this.board.select(e);if(r!==e){return r}}},resolve:function resolve(e){var t=this.scope;while(null!==t){if(Type.exists(t.locals[e])){return t.locals[e]}t=t.previous}},getvarJS:function getvarJS(e,t,o){var i,n="";t=Type.def(t,!1);o=Type.def(o,!1);i=this.isParameter(e);if(null!==i){return e}i=this.isLocalVariable(e);if(null!==i&&!o){return"$jc$.resolve('"+e+"')"}if(this.isCreator(e)){return"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(o?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+e+"'].concat([a, props])); })"}if(o){this._error("Syntax error (attribute values are allowed with element creators only)")}if(this.isBuiltIn(e)){return this.builtIn[e].src||this.builtIn[e]}if(this.isMathMethod(e)){return"Math."+e}if(!t){if(Type.isId(this.board,e)){n="$jc$.board.objects['"+e+"']"}else if(Type.isName(this.board,e)){n="$jc$.board.elementsByName['"+e+"']"}else if(Type.isGroup(this.board,e)){n="$jc$.board.groups['"+e+"']"}return n}return""},makeMap:function makeMap(e){e.isMap=!0;return e},functionCodeJS:function functionCodeJS(e){var t=e.children[0].join(", "),r="",o="";if("op_map"===e.value){r="{ return  ";o=" }"}return"function ("+t+") {\nvar $oldscope$ = $jc$.scope;\n$jc$.scope = $jc$.scopes["+this.scope.id+"];\nvar r = (function () "+r+this.compile(e.children[1],!0)+o+")();\n$jc$.scope = $oldscope$;\nreturn r;\n}"},defineFunction:function defineFunction(node){var fun,i,list=node.children[0],scope=this.pushScope(list);if(this.board.options.jc.compile){this.isLHS=!1;for(i=0;i<list.length;i++){scope.locals[list[i]]=list[i]}this.replaceNames(node.children[1]);fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{fun=eval(str);return fun}catch(t){$jc$._warn("error compiling function\n\n"+str+"\n\n"+t.toString());return function(){}}}(this);this.popScope()}else{fun=function(e,t,o){return function(){var i,s;s=t.scope;t.scope=t.scopes[o];for(i=0;i<e.length;i++){t.scope.locals[e[i]]=arguments[i]}i=t.execute(node.children[1]);t.scope=s;return i}}(list,this,scope.id)}fun.node=node;fun.scope=scope;fun.toJS=fun.toString;fun.toString=function(e){return function(){return e.compile(e.replaceIDs(Type.deepCopy(node)))}}(this);fun.deps={};this.collectDependencies(node.children[1],fun.deps);return fun},mergeAttributes:function mergeAttributes(){var e,t={};for(e=0;e<arguments.length;e++){t=Type.deepCopy(t,arguments[e],!0)}return t},setProp:function setProp(e,t,r){var o={},i,s;if(e.elementClass===Const.OBJECT_CLASS_POINT&&("X"===t||"Y"===t)){t=t.toLowerCase();if(e.isDraggable&&"number"==typeof r){i="x"===t?r:e.X();s="y"===t?r:e.Y();e.setPosition(Const.COORDS_BY_USER,[i,s])}else if(e.isDraggable&&("function"==typeof r||"string"==typeof r)){i="x"===t?r:e.coords.usrCoords[1];s="y"===t?r:e.coords.usrCoords[2];e.addConstraint([i,s])}else if(!e.isDraggable){i="x"===t?r:e.XEval.origin;s="y"===t?r:e.YEval.origin;e.addConstraint([i,s])}this.board.update()}else if(e.elementClass===Const.OBJECT_CLASS_TEXT&&("X"===t||"Y"===t)){if("number"==typeof r){e[t]=function(){return r}}else if("function"==typeof r){e.isDraggable=!1;e[t]=r}else if("string"==typeof r){e.isDraggable=!1;e[t]=Type.createFunction(r,this.board,null,!0);e[t+"jc"]=r}e[t].origin=r;this.board.update()}else if(e.type&&e.elementClass&&e.visProp){if(Type.exists(e[e.methodMap[t]])&&"function"!=typeof e[e.methodMap[t]]){e[e.methodMap[t]]=r}else{o[t]=r;e.setAttribute(o)}}else{e[t]=r}},_genericParse:function _genericParse(e,t,r,o){var s,n,a,d,l=e.replace(/\r\n/g,"\n").split("\n"),c=[];if(!o){this.code+=e+"\n"}if(Text){n=Text.Text.prototype.setText;Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode}try{if(!Type.exists(r)){r=!1}for(s=0;s<l.length;s++){if(r){l[s]=JXG.GeonextParser.geonext2JS(l[s],this.board)}c.push(l[s])}e=c.join("\n");a=parser.parse(e);if(this.CA){a=this.CA.expandDerivatives(a,null,a);a=this.CA.removeTrivialNodes(a)}switch(t){case"parse":d=this.execute(a);break;case"manipulate":d=this.compile(a);break;case"getAst":d=a;break;default:d=!1;}}catch(t){console.log(t)}finally{if(Text){Text.Text.prototype.setText=n}}return d},parse:function parse(e,t,r){return this._genericParse(e,"parse",t,r)},manipulate:function manipulate(e,t,r){return this._genericParse(e,"manipulate",t,r)},getAST:function getAST(e,t,r){return this._genericParse(e,"getAst",t,r)},snippet:function snippet(e,t,r,o){var i;t=Type.def(t,!0);r=Type.def(r,"");o=Type.def(o,!1);i=(t?" function ("+r+") { return ":"")+e+(t?"; }":"")+";";return this.parse(i,o,!0)},replaceIDs:function replaceIDs(e){var t,r;if(e.replaced){r=this.board.objects[e.children[1][0].value];if(Type.exists(r)&&""!==r.name){e.type="node_var";e.value=r.name;e.children.length=0;delete e.replaced}}if(e.children){for(t=e.children.length;0<t;t--){if(Type.exists(e.children[t-1])){e.children[t-1]=this.replaceIDs(e.children[t-1])}}}return e},replaceNames:function replaceNames(e){var t,r;r=e.value;if("node_op"===e.type&&"op_lhs"===r&&1===e.children.length){this.isLHS=!0}else if("node_var"===e.type){if(this.isLHS){this.letvar(r,!0)}else if(!Type.exists(this.getvar(r,!0))&&Type.exists(this.board.elementsByName[r])){e=this.createReplacementNode(e)}}if(e.children){for(t=e.children.length;0<t;t--){if(Type.exists(e.children[t-1])){e.children[t-1]=this.replaceNames(e.children[t-1])}}}if("node_op"===e.type&&"op_lhs"===e.value&&1===e.children.length){this.isLHS=!1}return e},createReplacementNode:function createReplacementNode(e){var t=e.value,r=this.board.elementsByName[t];e=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",r.id)]);e.replaced=!0;return e},collectDependencies:function collectDependencies(t,r){var o,s,n,a;if(Type.isArray(t)){a=t.length;for(o=0;o<a;o++){this.collectDependencies(t[o],r)}return}s=t.value;if("node_var"===t.type){n=this.getvar(s);if(n&&n.visProp&&n.type&&n.elementClass&&n.id){r[n.id]=n}}if("node_op"===t.type&&"op_execfun"===t.value&&1<t.children.length&&"$"===t.children[0].value&&0<t.children[1].length){n=t.children[1][0].value;r[n]=this.board.objects[n]}if(t.children){for(o=t.children.length;0<o;o--){if(Type.exists(t.children[o-1])){this.collectDependencies(t.children[o-1],r)}}}},resolveProperty:function resolveProperty(t,r,o){o=Type.def(o,!1);if(t&&t.methodMap){if(Type.exists(t.subs)&&Type.exists(t.subs[r])){t=t.subs}else if(Type.exists(t.methodMap[r])){r=t.methodMap[r]}else{t=t.visProp;r=r.toLowerCase()}}if(Type.isFunction(t)){this._error("Accessing function properties is not allowed.")}if(!Type.exists(t)){this._error(t+" is not an object")}if(!Type.exists(t[r])){this._error("unknown property "+r)}if(o&&"function"==typeof t[r]){return function(){return t[r].apply(t,arguments)}}return t[r]},getLHS:function getLHS(e){var t;if("node_var"===e.type){t={o:this.scope.locals,what:e.value}}else if("node_op"===e.type&&"op_property"===e.value){t={o:this.execute(e.children[0]),what:e.children[1]}}else if("node_op"===e.type&&"op_extvalue"===e.value){t={o:this.execute(e.children[0]),what:this.execute(e.children[1])}}else{throw new Error("Syntax error: Invalid left-hand side of assignment.")}return t},getLHSCompiler:function getLHSCompiler(e,t){var r;if("node_var"===e.type){r=e.value}else if("node_op"===e.type&&"op_property"===e.value){r=[this.compile(e.children[0],t),"'"+e.children[1]+"'"]}else if("node_op"===e.type&&"op_extvalue"===e.value){r=[this.compile(e.children[0],t),"node_const"===e.children[1].type?e.children[1].value:this.compile(e.children[1],t)]}else{throw new Error("Syntax error: Invalid left-hand side of assignment.")}return r},execute:function execute(t){var r,o,s,n,a,d,c,p,u=[],h,m,g;r=0;if(!t){return r}this.line=t.line;this.col=t.col;switch(t.type){case"node_op":switch(t.value){case"op_none":if(t.children[0]){this.execute(t.children[0])}if(t.children[1]){r=this.execute(t.children[1])}break;case"op_assign":o=this.getLHS(t.children[0]);this.lhs[this.scope.id]=o[1];if(o.o.type&&o.o.elementClass&&o.o.methodMap&&"label"===o.what){this._error("Left-hand side of assignment is read-only.")}r=this.execute(t.children[1]);if(o.o!==this.scope.locals||Type.isArray(o.o)&&"number"==typeof o.what){this.setProp(o.o,o.what,r)}else{this.letvar(o.what,r)}this.lhs[this.scope.id]=0;break;case"op_if":if(this.execute(t.children[0])){r=this.execute(t.children[1])}break;case"op_conditional":case"op_if_else":if(this.execute(t.children[0])){r=this.execute(t.children[1])}else{r=this.execute(t.children[2])}break;case"op_while":while(this.execute(t.children[0])){this.execute(t.children[1])}break;case"op_do":do{this.execute(t.children[0])}while(this.execute(t.children[1]));break;case"op_for":for(this.execute(t.children[0]);this.execute(t.children[1]);this.execute(t.children[2])){this.execute(t.children[3])}break;case"op_proplst":if(t.children[0]){this.execute(t.children[0])}if(t.children[1]){this.execute(t.children[1])}break;case"op_emptyobject":r={};break;case"op_proplst_val":this.propstack.push({});this.propscope++;this.execute(t.children[0]);r=this.propstack[this.propscope];this.propstack.pop();this.propscope--;break;case"op_prop":this.propstack[this.propscope][t.children[0]]=this.execute(t.children[1]);break;case"op_array":r=[];a=t.children[0].length;for(s=0;s<a;s++){r.push(this.execute(t.children[0][s]))}break;case"op_extvalue":r=this.execute(t.children[0]);s=this.execute(t.children[1]);if("number"==typeof s&&Math.abs(Math.round(s)-s)<Mat.eps){r=r[s]}else{r=d}break;case"op_return":if(0===this.scope){this._error("Unexpected return.")}else{return this.execute(t.children[0])}break;case"op_map":if(!t.children[1].isMath&&"node_var"!==t.children[1].type){this._error("execute: In a map only function calls and mathematical expressions are allowed.")}h=this.defineFunction(t);h.isMap=!0;r=h;break;case"op_function":h=this.defineFunction(t);h.isMap=!1;r=h;break;case"op_execfun":this.dpstack.push([]);this.pscope++;c=t.children[1];if(Type.exists(t.children[2])){if(t.children[3]){p=t.children[2];m={};for(s=0;s<p.length;s++){m=Type.deepCopy(m,this.execute(p[s]),!0)}}else{m=this.execute(t.children[2])}}h=this.execute(t.children[0]);if(h&&h.sc){g=h.sc}else{g=this}if(!h.creator&&Type.exists(t.children[2])){this._error("Unexpected value. Only element creators are allowed to have a value after the function call.")}for(s=0;s<c.length;s++){u[s]=this.execute(c[s]);this.dpstack[this.pscope].push({line:t.children[1][s].line,col:t.children[1][s].ecol})}if("function"==typeof h&&!h.creator){r=h.apply(g,u)}else if("function"==typeof h&&!!h.creator){n=this.line;try{r=h(u,m);r.jcLineStart=n;r.jcLineEnd=t.eline;for(s=n;s<=t.line;s++){this.lineToElement[s]=r}r.debugParents=this.dpstack[this.pscope]}catch(e){this._error(e.toString())}}else{this._error("Function '"+h+"' is undefined.")}this.dpstack.pop();this.pscope--;break;case"op_property":n=this.execute(t.children[0]);o=t.children[1];r=this.resolveProperty(n,o,!1);if(Type.exists(r)){r.sc=n}break;case"op_use":this._warn("Use of the 'use' operator is deprecated.");this.use(t.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function.");o=this.getvar(t.children[0]);r=this.del(o);break;case"op_equ":r=this.execute(t.children[0])==this.execute(t.children[1]);break;case"op_neq":r=this.execute(t.children[0])!=this.execute(t.children[1]);break;case"op_approx":r=Math.abs(this.execute(t.children[0])-this.execute(t.children[1]))<Mat.eps;break;case"op_grt":r=this.execute(t.children[0])>this.execute(t.children[1]);break;case"op_lot":r=this.execute(t.children[0])<this.execute(t.children[1]);break;case"op_gre":r=this.execute(t.children[0])>=this.execute(t.children[1]);break;case"op_loe":r=this.execute(t.children[0])<=this.execute(t.children[1]);break;case"op_or":r=this.execute(t.children[0])||this.execute(t.children[1]);break;case"op_and":r=this.execute(t.children[0])&&this.execute(t.children[1]);break;case"op_not":r=!this.execute(t.children[0]);break;case"op_add":r=this.add(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_sub":r=this.sub(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_div":r=this.div(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_mod":r=this.mod(this.execute(t.children[0]),this.execute(t.children[1]),!0);break;case"op_mul":r=this.mul(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_exp":r=this.pow(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_neg":r=this.neg(this.execute(t.children[0]));break;}break;case"node_var":r=this.getvar(t.value);break;case"node_const":r=+t.value;break;case"node_const_bool":r=t.value;break;case"node_str":r=t.value.replace(/\\(.)/,"$1");break;}return r},compile:function compile(t,r){var o,s,n,a="";if(!Type.exists(r)){r=!1}if(!t){return a}switch(t.type){case"node_op":switch(t.value){case"op_none":if(t.children[0]){a=this.compile(t.children[0],r)}if(t.children[1]){a+=this.compile(t.children[1],r)}break;case"op_assign":if(r){o=this.getLHSCompiler(t.children[0],r);if(Type.isArray(o)){a="$jc$.setProp("+o[0]+", "+o[1]+", "+this.compile(t.children[1],r)+");\n"}else{if(this.isLocalVariable(o)!==this.scope){this.scope.locals[o]=!0}a="$jc$.scopes["+this.scope.id+"].locals['"+o+"'] = "+this.compile(t.children[1],r)+";\n"}}else{o=this.compile(t.children[0]);a=o+" = "+this.compile(t.children[1],r)+";\n"}break;case"op_if":a=" if ("+this.compile(t.children[0],r)+") "+this.compile(t.children[1],r);break;case"op_if_else":a=" if ("+this.compile(t.children[0],r)+")"+this.compile(t.children[1],r);a+=" else "+this.compile(t.children[2],r);break;case"op_conditional":a="(("+this.compile(t.children[0],r)+")?("+this.compile(t.children[1],r);a+="):("+this.compile(t.children[2],r)+"))";break;case"op_while":a=" while ("+this.compile(t.children[0],r)+") {\n"+this.compile(t.children[1],r)+"}\n";break;case"op_do":a=" do {\n"+this.compile(t.children[0],r)+"} while ("+this.compile(t.children[1],r)+");\n";break;case"op_for":a=" for ("+this.compile(t.children[0],r)+"; "+this.compile(t.children[1],r)+"; "+this.compile(t.children[2],r)+") {\n"+this.compile(t.children[3],r)+"\n}\n";break;case"op_proplst":if(t.children[0]){a=this.compile(t.children[0],r)+", "}a+=this.compile(t.children[1],r);break;case"op_prop":a=t.children[0]+": "+this.compile(t.children[1],r);break;case"op_emptyobject":a=r?"{}":"<< >>";break;case"op_proplst_val":a=this.compile(t.children[0],r);break;case"op_array":n=[];for(s=0;s<t.children[0].length;s++){n.push(this.compile(t.children[0][s],r))}a="["+n.join(", ")+"]";break;case"op_extvalue":a=this.compile(t.children[0],r)+"["+this.compile(t.children[1],r)+"]";break;case"op_return":a=" return "+this.compile(t.children[0],r)+";\n";break;case"op_map":if(!t.children[1].isMath&&"node_var"!==t.children[1].type){this._error("compile: In a map only function calls and mathematical expressions are allowed.")}n=t.children[0];if(r){a=" $jc$.makeMap(function ("+n.join(", ")+") { return "+this.compile(t.children[1],r)+"; })"}else{a="map ("+n.join(", ")+") -> "+this.compile(t.children[1],r)}break;case"op_function":n=t.children[0];this.pushScope(n);if(r){a=this.functionCodeJS(t)}else{a=" function ("+n.join(", ")+") "+this.compile(t.children[1],r)}this.popScope();break;case"op_execfunmath":console.log("TODO");a="-1";break;case"op_execfun":if(t.children[2]){n=[];for(s=0;s<t.children[2].length;s++){n.push(this.compile(t.children[2][s],r))}if(r){o="$jc$.mergeAttributes("+n.join(", ")+")"}}t.children[0].withProps=!!t.children[2];n=[];for(s=0;s<t.children[1].length;s++){n.push(this.compile(t.children[1][s],r))}a=this.compile(t.children[0],r)+"("+n.join(", ")+(t.children[2]&&r?", "+o:"")+")"+(t.children[2]&&!r?o:"");if(r&&"$"===t.children[0].value){a="$jc$.board.objects["+this.compile(t.children[1][0],r)+"]"}break;case"op_property":if(r&&"X"!==t.children[1]&&"Y"!==t.children[1]){a="$jc$.resolveProperty("+this.compile(t.children[0],r)+", '"+t.children[1]+"', true)"}else{a=this.compile(t.children[0],r)+"."+t.children[1]}break;case"op_use":this._warn("Use of the 'use' operator is deprecated.");if(r){a="$jc$.use('"}else{a="use('"}a+=t.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function.");if(r){a="$jc$.del("}else{a="remove("}a+=this.compile(t.children[0],r)+")";break;case"op_equ":a="("+this.compile(t.children[0],r)+" == "+this.compile(t.children[1],r)+")";break;case"op_neq":a="("+this.compile(t.children[0],r)+" != "+this.compile(t.children[1],r)+")";break;case"op_approx":a="("+this.compile(t.children[0],r)+" ~= "+this.compile(t.children[1],r)+")";break;case"op_grt":a="("+this.compile(t.children[0],r)+" > "+this.compile(t.children[1],r)+")";break;case"op_lot":a="("+this.compile(t.children[0],r)+" < "+this.compile(t.children[1],r)+")";break;case"op_gre":a="("+this.compile(t.children[0],r)+" >= "+this.compile(t.children[1],r)+")";break;case"op_loe":a="("+this.compile(t.children[0],r)+" <= "+this.compile(t.children[1],r)+")";break;case"op_or":a="("+this.compile(t.children[0],r)+" || "+this.compile(t.children[1],r)+")";break;case"op_and":a="("+this.compile(t.children[0],r)+" && "+this.compile(t.children[1],r)+")";break;case"op_not":a="!("+this.compile(t.children[0],r)+")";break;case"op_add":if(r){a="$jc$.add("+this.compile(t.children[0],r)+", "+this.compile(t.children[1],r)+")"}else{a="("+this.compile(t.children[0],r)+" + "+this.compile(t.children[1],r)+")"}break;case"op_sub":if(r){a="$jc$.sub("+this.compile(t.children[0],r)+", "+this.compile(t.children[1],r)+")"}else{a="("+this.compile(t.children[0],r)+" - "+this.compile(t.children[1],r)+")"}break;case"op_div":if(r){a="$jc$.div("+this.compile(t.children[0],r)+", "+this.compile(t.children[1],r)+")"}else{a="("+this.compile(t.children[0],r)+" / "+this.compile(t.children[1],r)+")"}break;case"op_mod":if(r){a="$jc$.mod("+this.compile(t.children[0],r)+", "+this.compile(t.children[1],r)+", true)"}else{a="("+this.compile(t.children[0],r)+" % "+this.compile(t.children[1],r)+")"}break;case"op_mul":if(r){a="$jc$.mul("+this.compile(t.children[0],r)+", "+this.compile(t.children[1],r)+")"}else{a="("+this.compile(t.children[0],r)+" * "+this.compile(t.children[1],r)+")"}break;case"op_exp":if(r){a="$jc$.pow("+this.compile(t.children[0],r)+", "+this.compile(t.children[1],r)+")"}else{a="("+this.compile(t.children[0],r)+"^"+this.compile(t.children[1],r)+")"}break;case"op_neg":if(r){a="$jc$.neg("+this.compile(t.children[0],r)+")"}else{a="(-"+this.compile(t.children[0],r)+")"}break;}break;case"node_var":if(r){a=this.getvarJS(t.value,!1,t.withProps)}else{a=t.value}break;case"node_const":a=t.value;break;case"node_const_bool":a=t.value;break;case"node_str":a="'"+t.value+"'";break;}if(t.needsBrackets){a="{\n"+a+"}\n"}return a},X:function X(t){return t.X()},Y:function Y(t){return t.Y()},V:function V(t){return t.Value()},L:function L(t){return t.L()},dist:function dist(e,t){if(!Type.exists(e)||!Type.exists(e.Dist)){this._error("Error: Can't calculate distance.")}return e.Dist(t)},add:function add(e,t){var r,o,s;e=Type.evalSlider(e);t=Type.evalSlider(t);if(Type.isArray(e)&&Type.isArray(t)){o=Math.min(e.length,t.length);s=[];for(r=0;r<o;r++){s[r]=e[r]+t[r]}}else if(Type.isNumber(e)&&Type.isNumber(t)){s=e+t}else if(Type.isString(e)||Type.isString(t)){s=e.toString()+t.toString()}else{this._error("Operation + not defined on operands "+_typeof(e)+" and "+_typeof(t))}return s},sub:function sub(e,t){var r,o,s;e=Type.evalSlider(e);t=Type.evalSlider(t);if(Type.isArray(e)&&Type.isArray(t)){o=Math.min(e.length,t.length);s=[];for(r=0;r<o;r++){s[r]=e[r]-t[r]}}else if(Type.isNumber(e)&&Type.isNumber(t)){s=e-t}else{this._error("Operation - not defined on operands "+_typeof(e)+" and "+_typeof(t))}return s},neg:function neg(e){var t,r,o;e=Type.evalSlider(e);if(Type.isArray(e)){r=e.length;o=[];for(t=0;t<r;t++){o[t]=-e[t]}}else if(Type.isNumber(e)){o=-e}else{this._error("Unary operation - not defined on operand "+_typeof(e))}return o},mul:function mul(e,t){var r,o,s;e=Type.evalSlider(e);t=Type.evalSlider(t);if(Type.isArray(e)&&Type.isNumber(t)){r=e;e=t;t=e}if(Type.isArray(e)&&Type.isArray(t)){o=Math.min(e.length,t.length);s=Mat.innerProduct(e,t,o)}else if(Type.isNumber(e)&&Type.isArray(t)){o=t.length;s=[];for(r=0;r<o;r++){s[r]=e*t[r]}}else if(Type.isNumber(e)&&Type.isNumber(t)){s=e*t}else{this._error("Operation * not defined on operands "+_typeof(e)+" and "+_typeof(t))}return s},div:function div(e,t){var r,o,s;e=Type.evalSlider(e);t=Type.evalSlider(t);if(Type.isArray(e)&&Type.isNumber(t)){o=e.length;s=[];for(r=0;r<o;r++){s[r]=e[r]/t}}else if(Type.isNumber(e)&&Type.isNumber(t)){s=e/t}else{this._error("Operation * not defined on operands "+_typeof(e)+" and "+_typeof(t))}return s},mod:function mod(e,t){var r,o,s;e=Type.evalSlider(e);t=Type.evalSlider(t);if(Type.isArray(e)&&Type.isNumber(t)){o=e.length;s=[];for(r=0;r<o;r++){s[r]=Mat.mod(e[r],t,!0)}}else if(Type.isNumber(e)&&Type.isNumber(t)){s=Mat.mod(e,t,!0)}else{this._error("Operation * not defined on operands "+_typeof(e)+" and "+_typeof(t))}return s},pow:function pow(e,t){e=Type.evalSlider(e);t=Type.evalSlider(t);return Math.pow(e,t)},DDD:function DDD(){console.log("Dummy derivative function. This should never appear!")},ifthen:function ifthen(e,t,r){if(e){return t}return r},del:function del(e){if("object"===_typeof(e)&&JXG.exists(e.type)&&JXG.exists(e.elementClass)){this.board.removeObject(e)}},use:function use(e){var t,r,o=!1;if("string"==typeof e){for(t in JXG.boards){if(JXG.boards.hasOwnProperty(t)&&JXG.boards[t].container===e){r=JXG.boards[t];o=!0;break}}}else{r=e;o=!0}if(o){this.board=r;this.builtIn.$board=r;this.builtIn.$board.src="$jc$.board"}else{this._error("Board '"+e+"' not found!")}},findSymbol:function findSymbol(e,t){var r,o;t=Type.def(t,-1);if(-1===t){o=this.scope}else{o=this.scopes[t]}while(null!==o){for(r in o.locals){if(o.locals.hasOwnProperty(r)&&o.locals[r]===e){return[r,o]}}o=o.previous}return[]},importModule:function importModule(e){return priv.modules[e.toLowerCase()]},defineBuiltIn:function defineBuiltIn(){var e=this,t={PI:Math.PI,EULER:Math.E,X:e.X,Y:e.Y,V:e.V,L:e.L,dist:e.dist,rad:Geometry.rad,deg:Geometry.trueAngle,factorial:Mat.factorial,trunc:Type.trunc,log:Mat.log,ln:Math.log,log10:Mat.log10,lg:Mat.log10,log2:Mat.log2,lb:Mat.log2,ld:Mat.log2,cosh:Mat.cosh,sinh:Mat.sinh,IfThen:e.ifthen,import:e.importModule,use:e.use,remove:e.del,$:e.getElementById,$board:e.board,$log:e.log,D:e.DDD};t.rad.sc=Geometry;t.deg.sc=Geometry;t.factorial.sc=Mat;t.X.src="$jc$.X";t.Y.src="$jc$.Y";t.V.src="$jc$.V";t.L.src="$jc$.L";t.dist.src="$jc$.dist";t.rad.src="JXG.Math.Geometry.rad";t.deg.src="JXG.Math.Geometry.trueAngle";t.factorial.src="JXG.Math.factorial";t.trunc.src="JXG.trunc";t.ln.src="Math.log";t.log10.src="JXG.Math.log10";t.lg.src="JXG.Math.log10";t.log2.src="JXG.Math.log2";t.lb.src="JXG.Math.log2";t.ld.src="JXG.Math.log2";t.cosh.src="JXG.Math.cosh";t.sinh.src="JXG.Math.sinh";t["import"].src="$jc$.importModule";t.use.src="$jc$.use";t.remove.src="$jc$.del";t.IfThen.src="$jc$.ifthen";t.$.src="(function (n) { return $jc$.board.select(n); })";if(t.$board){t.$board.src="$jc$.board"}t.$log.src="$jc$.log";return t},_debug:function _debug(e){if("object"===("undefined"==typeof console?"undefined":_typeof(console))){console.log(e)}else if(Env.isBrowser&&document&&null!==document.getElementById("debug")){document.getElementById("debug").innerHTML+=e+"<br />"}},_error:function _error(t){var r=new Error("Error("+this.line+"): "+t);r.line=this.line;throw r},_warn:function _warn(e){if("object"===("undefined"==typeof console?"undefined":_typeof(console))){console.log("Warning("+this.line+"): "+e)}else if(Env.isBrowser&&document&&null!==document.getElementById(this.warnLog)){document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+e+"<br />"}},_log:function _log(e){if("object"!==("undefined"==typeof window?"undefined":_typeof(window))&&"object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.postMessage){self.postMessage({type:"log",msg:"Log: "+e.toString()})}else{console.log("Log: ",arguments)}}});var parser=function(){var t=function(e,t,r,o){for(r=r||{},o=e.length;o--;r[e[o]]=t){}return r},r=[2,14],o=[1,13],i=[1,37],s=[1,14],n=[1,15],a=[1,21],d=[1,16],l=[1,17],c=[1,33],p=[1,18],u=[1,19],h=[1,12],m=[1,59],g=[1,60],b=[1,58],C=[1,46],y=[1,48],v=[1,49],f=[1,50],P=[1,51],_=[1,52],S=[1,53],E=[1,54],x=[1,45],O=[1,38],T=[1,39],A=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],w=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],j=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],N=[2,48],R=[1,72],L=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],B=[1,78],k=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Y=[1,82],D=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],I=[1,83],X=[1,84],M=[1,85],U=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],G=[1,89],J=[1,90],z=[1,91],F=[1,92],H=[1,97],$=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],V=[1,103],q=[1,104],W=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],Z=[1,105],Q=[1,106],K=[1,107],ee=[1,126],te=[1,139],re=[83,86],oe=[1,149],ie=[10,66,86],se=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],ne=[1,166],ae=[10,86],de={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,6],[92,1],[92,3]],performAction:function(e,t,r,o,i,s,n){var a=s.length-1;switch(i){case 1:return s[a-1];break;case 2:this.$=le.createNode(ce(n[a-4]),"node_op","op_if",s[a-2],s[a]);break;case 3:this.$=le.createNode(ce(n[a-6]),"node_op","op_if_else",s[a-4],s[a-2],s[a]);break;case 4:this.$=le.createNode(ce(n[a-4]),"node_op","op_while",s[a-2],s[a]);break;case 5:this.$=le.createNode(ce(n[a-8]),"node_op","op_for",s[a-6],s[a-4],s[a-2],s[a]);break;case 6:this.$=le.createNode(ce(n[a-6]),"node_op","op_do",s[a-5],s[a-2]);break;case 7:this.$=le.createNode(ce(n[a-1]),"node_op","op_use",s[a]);break;case 8:this.$=le.createNode(ce(n[a-1]),"node_op","op_delete",s[a]);break;case 9:this.$=le.createNode(ce(n[a-1]),"node_op","op_return",void 0);break;case 10:this.$=le.createNode(ce(n[a-2]),"node_op","op_return",s[a-1]);break;case 11:case 14:this.$=le.createNode(ce(n[a]),"node_op","op_none");break;case 12:this.$=s[a-1];this.$.needsBrackets=!0;break;case 13:this.$=le.createNode(ce(n[a-1]),"node_op","op_none",s[a-1],s[a]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=s[a];break;case 22:case 65:case 93:this.$=s[a-1];break;case 25:this.$=le.createNode(ce(n[a-2]),"node_op","op_assign",s[a-2],s[a]);this.$.isMath=!1;break;case 27:this.$=le.createNode(ce(n[a-4]),"node_op","op_conditional",s[a-4],s[a-2],s[a]);this.$.isMath=!1;break;case 29:this.$=le.createNode(ce(n[a-2]),"node_op","op_or",s[a-2],s[a]);this.$.isMath=!1;break;case 31:this.$=le.createNode(ce(n[a-2]),"node_op","op_and",s[a-2],s[a]);this.$.isMath=!1;break;case 33:this.$=le.createNode(ce(n[a-2]),"node_op","op_equ",s[a-2],s[a]);this.$.isMath=!1;break;case 34:this.$=le.createNode(ce(n[a-2]),"node_op","op_neq",s[a-2],s[a]);this.$.isMath=!1;break;case 35:this.$=le.createNode(ce(n[a-2]),"node_op","op_approx",s[a-2],s[a]);this.$.isMath=!1;break;case 37:this.$=le.createNode(ce(n[a-2]),"node_op","op_lot",s[a-2],s[a]);this.$.isMath=!1;break;case 38:this.$=le.createNode(ce(n[a-2]),"node_op","op_grt",s[a-2],s[a]);this.$.isMath=!1;break;case 39:this.$=le.createNode(ce(n[a-2]),"node_op","op_loe",s[a-2],s[a]);this.$.isMath=!1;break;case 40:this.$=le.createNode(ce(n[a-2]),"node_op","op_gre",s[a-2],s[a]);this.$.isMath=!1;break;case 42:this.$=le.createNode(ce(n[a-2]),"node_op","op_add",s[a-2],s[a]);this.$.isMath=!0;break;case 43:this.$=le.createNode(ce(n[a-2]),"node_op","op_sub",s[a-2],s[a]);this.$.isMath=!0;break;case 45:this.$=le.createNode(ce(n[a-2]),"node_op","op_mul",s[a-2],s[a]);this.$.isMath=!0;break;case 46:this.$=le.createNode(ce(n[a-2]),"node_op","op_div",s[a-2],s[a]);this.$.isMath=!0;break;case 47:this.$=le.createNode(ce(n[a-2]),"node_op","op_mod",s[a-2],s[a]);this.$.isMath=!0;break;case 49:this.$=le.createNode(ce(n[a-2]),"node_op","op_exp",s[a-2],s[a]);this.$.isMath=!0;break;case 51:this.$=le.createNode(ce(n[a-1]),"node_op","op_not",s[a]);this.$.isMath=!1;break;case 53:this.$=le.createNode(ce(n[a-1]),"node_op","op_neg",s[a]);this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=s[a];this.$.isMath=!1;break;case 59:case 91:this.$=le.createNode(ce(n[a-2]),"node_op","op_property",s[a-2],s[a]);this.$.isMath=!0;break;case 60:case 90:this.$=le.createNode(ce(n[a-3]),"node_op","op_extvalue",s[a-3],s[a-1]);this.$.isMath=!0;break;case 61:this.$=le.createNode(ce(n[a]),"node_var",s[a]);break;case 69:this.$=s[a];this.$.isMath=!0;break;case 70:this.$=le.createNode(ce(n[a]),"node_const",null);break;case 71:this.$=le.createNode(ce(n[a]),"node_const_bool",!0);break;case 72:this.$=le.createNode(ce(n[a]),"node_const_bool",!1);break;case 73:this.$=le.createNode(ce(n[a]),"node_str",s[a].substring(1,s[a].length-1));break;case 74:this.$=le.createNode(ce(n[a]),"node_const",parseFloat(s[a]));break;case 75:this.$=le.createNode(ce(n[a]),"node_const",NaN);break;case 76:this.$=le.createNode(ce(n[a]),"node_const",1/0);break;case 77:this.$=le.createNode(ce(n[a-1]),"node_op","op_array",[]);break;case 78:this.$=le.createNode(ce(n[a-2]),"node_op","op_array",s[a-1]);break;case 79:this.$=le.createNode(ce(n[a-1]),"node_op","op_emptyobject",{});break;case 80:this.$=le.createNode(ce(n[a-2]),"node_op","op_proplst_val",s[a-1]);break;case 82:this.$=le.createNode(ce(n[a-2]),"node_op","op_proplst",s[a-2],s[a]);break;case 83:this.$=le.createNode(ce(n[a-2]),"node_op","op_prop",s[a-2],s[a]);break;case 87:case 89:this.$=le.createNode(ce(n[a-1]),"node_op","op_execfun",s[a-1],s[a]);this.$.isMath=!0;break;case 88:this.$=le.createNode(ce(n[a-2]),"node_op","op_execfun",s[a-2],s[a-1],s[a],!0);this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 103:this.$=[s[a]];break;case 95:case 99:case 104:this.$=s[a-2].concat(s[a]);break;case 96:this.$=le.createNode(ce(n[a]),"node_var",s[a]);this.$.isMath=!0;break;case 100:this.$=le.createNode(ce(n[a-3]),"node_op","op_function",[],s[a]);this.$.isMath=!1;break;case 101:this.$=le.createNode(ce(n[a-4]),"node_op","op_function",s[a-2],s[a]);this.$.isMath=!1;break;case 102:this.$=le.createNode(ce(n[a-5]),"node_op","op_map",s[a-3],s[a]);break;}},table:[t([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],r,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:o,8:i,9:20,11:4,13:7,14:s,15:n,16:a,17:d,18:8,19:l,20:c,21:p,22:9,23:u,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{1:[2,1]},t(A,[2,13]),t(w,[2,15]),t(w,[2,16]),t(w,[2,17]),t(w,[2,18]),t(w,[2,19]),t(w,[2,20]),t(w,[2,21]),t([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],r,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:o,8:i,9:20,11:65,13:7,14:s,15:n,16:a,17:d,18:8,19:l,20:c,21:p,22:9,23:u,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{20:[1,66]},{20:[1,67]},{8:i,9:69,16:[1,68],20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{16:[1,70]},t(w,[2,11]),t(j,[2,23]),t(j,[2,24]),t([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],N,{32:[1,71],57:R}),t([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),t(L,[2,54],{88:77,8:B,64:[1,75],65:[1,76]}),t(L,[2,55],{88:79,8:B,64:[1,81],65:[1,80]}),t(k,[2,28],{39:Y}),t(j,[2,56]),t(j,[2,57]),t(j,[2,58]),t(D,[2,30],{41:I,42:X,43:M}),t(j,[2,61]),t(j,[2,62]),t(j,[2,63]),t(j,[2,64]),{8:i,9:86,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:[1,87]},{8:[1,88]},t(U,[2,32],{45:G,46:J,47:z,48:F}),t(j,[2,66]),t(j,[2,67]),t(j,[2,68]),t(j,[2,69]),{20:H,72:98,73:99,77:P,78:_,79:S,80:E,83:[1,93],84:94,85:95,87:96},{8:i,20:c,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,81:101,82:x,91:O,93:T},t($,[2,36],{50:V,51:q}),t(j,[2,70]),t(j,[2,71]),t(j,[2,72]),t(j,[2,73]),t(j,[2,74]),t(j,[2,75]),t(j,[2,76]),t(W,[2,41],{53:Z,54:Q,55:K}),t(j,[2,44]),t(j,[2,50]),{8:i,20:c,31:109,50:m,51:g,52:108,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,50:m,51:g,52:110,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,50:m,51:g,52:111,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{6:6,7:o,8:i,9:20,11:4,13:7,14:s,15:n,16:a,17:d,18:8,19:l,20:c,21:p,22:9,23:u,24:11,25:5,26:h,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,9:113,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,9:114,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,9:115,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{14:[1,116]},t(w,[2,7]),t(w,[2,8]),t(w,[2,9]),{16:[1,117]},t(w,[2,22]),{8:i,20:c,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,50:m,51:g,52:119,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,36:121,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{20:[1,122]},{8:i,9:123,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},t(j,[2,87],{89:124,90:125,68:127,20:ee,82:x}),{8:i,10:[1,128],20:c,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,81:129,82:x,91:O,93:T},t(j,[2,89]),{8:i,9:130,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{20:[1,131]},{8:i,20:c,31:109,38:132,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,40:133,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,40:134,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,40:135,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{10:[1,136]},{10:[1,137],20:te,92:138},{20:te,92:140},{8:i,20:c,31:109,44:141,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,44:142,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,44:143,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,44:144,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},t(j,[2,79]),{83:[1,145],86:[1,146]},t(re,[2,81]),{35:[1,147]},{35:[2,84]},{35:[2,85]},{35:[2,86]},t(j,[2,77]),{66:[1,148],86:oe},t(ie,[2,98]),{8:i,20:c,31:109,49:150,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,49:151,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,50:m,51:g,52:152,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,50:m,51:g,52:153,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,31:109,50:m,51:g,52:154,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},t(j,[2,51]),t([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],N,{57:R}),t(j,[2,52]),t(j,[2,53]),t([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,155]},{10:[1,156]},{16:[1,157]},{8:[1,158]},t(w,[2,10]),t(j,[2,25]),t(j,[2,49]),{35:[1,159]},t(k,[2,29],{39:Y}),t(j,[2,59]),{66:[1,160]},t([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,161]}),t(j,[2,94]),t(j,[2,96]),t(j,[2,97]),t(se,[2,92]),{10:[1,162],86:oe},{66:[1,163]},t(j,[2,91]),t(D,[2,31],{41:I,42:X,43:M}),t(U,[2,33],{45:G,46:J,47:z,48:F}),t(U,[2,34],{45:G,46:J,47:z,48:F}),t(U,[2,35],{45:G,46:J,47:z,48:F}),t(j,[2,65]),{25:164,26:h},{10:[1,165],86:ne},t(ae,[2,103]),{10:[1,167],86:ne},t($,[2,37],{50:V,51:q}),t($,[2,38],{50:V,51:q}),t($,[2,39],{50:V,51:q}),t($,[2,40],{50:V,51:q}),t(j,[2,80]),{20:H,72:98,73:99,77:P,78:_,79:S,80:E,85:168,87:96},{8:i,20:c,29:169,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},t(j,[2,78]),{8:i,20:c,29:170,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},t(W,[2,42],{53:Z,54:Q,55:K}),t(W,[2,43],{53:Z,54:Q,55:K}),t(j,[2,45]),t(j,[2,46]),t(j,[2,47]),{6:6,7:o,8:i,9:20,11:171,13:7,14:s,15:n,16:a,17:d,18:8,19:l,20:c,21:p,22:9,23:u,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{6:6,7:o,8:i,9:20,11:172,13:7,14:s,15:n,16:a,17:d,18:8,19:l,20:c,21:p,22:9,23:u,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,9:173,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,9:174,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,20:c,29:175,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},t(j,[2,60]),{20:ee,68:127,82:x,90:176},t(se,[2,93]),t(j,[2,90]),t(j,[2,100]),{25:177,26:h},{20:[1,178]},{94:[1,179]},t(re,[2,82]),t(re,[2,83]),t(ie,[2,99]),t(A,[2,2],{12:[1,180]}),t(w,[2,4]),{16:[1,181]},{10:[1,182]},t(j,[2,27]),t(j,[2,95]),t(j,[2,101]),t(ae,[2,104]),{8:i,9:183,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{6:6,7:o,8:i,9:20,11:184,13:7,14:s,15:n,16:a,17:d,18:8,19:l,20:c,21:p,22:9,23:u,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{8:i,9:185,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},{16:[1,186]},t(j,[2,102]),t(w,[2,3]),{10:[1,187]},t(w,[2,6]),{6:6,7:o,8:i,9:20,11:188,13:7,14:s,15:n,16:a,17:d,18:8,19:l,20:c,21:p,22:9,23:u,24:11,25:5,26:h,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:m,51:g,52:56,56:57,58:b,59:26,60:27,61:29,62:30,63:31,65:C,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:f,77:P,78:_,79:S,80:E,82:x,91:O,93:T},t(w,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(e,t){if(t.recoverable){this.trace(e)}else{var r=new Error(e);r.hash=t;throw r}},parse:function(e){var t=this,o=[0],i=[null],s=[],n=this.table,a="",d=0,l=0,c=0,u=s.slice.call(arguments,1),h=Object.create(this.lexer),m={yy:{}};for(var g in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,g)){m.yy[g]=this.yy[g]}}h.setInput(e,m.yy);m.yy.lexer=h;m.yy.parser=this;if("undefined"==typeof h.yylloc){h.yylloc={}}var b=h.yylloc;s.push(b);var C=h.options&&h.options.ranges;if("function"==typeof m.yy.parseError){this.parseError=m.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}_token_stack:var y=function(){var e=h.lex()||1;if("number"!=typeof e){e=t.symbols_[e]||e}return e};var v,f,P,_,S,E={},x,O,T,A;while(!0){P=o[o.length-1];if(this.defaultActions[P]){_=this.defaultActions[P]}else{if(null===v||"undefined"==typeof v){v=y()}_=n[P]&&n[P][v]}if("undefined"==typeof _||!_.length||!_[0]){var w="";A=[];for(x in n[P]){if(this.terminals_[x]&&x>2){A.push("'"+this.terminals_[x]+"'")}}if(h.showPosition){w="Parse error on line "+(d+1)+":\n"+h.showPosition()+"\nExpecting "+A.join(", ")+", got '"+(this.terminals_[v]||v)+"'"}else{w="Parse error on line "+(d+1)+": Unexpected "+(v==1?"end of input":"'"+(this.terminals_[v]||v)+"'")}this.parseError(w,{text:h.match,token:this.terminals_[v]||v,line:h.yylineno,loc:b,expected:A})}if(_[0]instanceof Array&&1<_.length){throw new Error("Parse Error: multiple actions possible at state: "+P+", token: "+v)}switch(_[0]){case 1:o.push(v);i.push(h.yytext);s.push(h.yylloc);o.push(_[1]);v=null;if(!f){l=h.yyleng;a=h.yytext;d=h.yylineno;b=h.yylloc;if(0<c){c--}}else{v=f;f=null}break;case 2:O=this.productions_[_[1]][1];E.$=i[i.length-O];E._$={first_line:s[s.length-(O||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(O||1)].first_column,last_column:s[s.length-1].last_column};if(C){E._$.range=[s[s.length-(O||1)].range[0],s[s.length-1].range[1]]}S=this.performAction.apply(E,[a,l,d,m.yy,_[1],i,s].concat(u));if("undefined"!=typeof S){return S}if(O){o=o.slice(0,2*(-1*O));i=i.slice(0,-1*O);s=s.slice(0,-1*O)}o.push(this.productions_[_[1]][0]);i.push(E.$);s.push(E._$);T=n[o[o.length-2]][o[o.length-1]];o.push(T);break;case 3:return!0;}}return!0}},le={node:function node(e,t,r){return{type:e,value:t,children:r}},createNode:function createNode(e,t,r){var o,s=this.node(t,r,[]);for(o=3;o<arguments.length;o++){s.children.push(arguments[o])}s.line=e[0];s.col=e[1];s.eline=e[2];s.ecol=e[3];return s}},ce=function(e){return[e.first_line,e.first_column,e.last_line,e.last_column]},pe=function(){var e={EOF:1,parseError:function(e,t){if(this.yy.parser){this.yy.parser.parseError(e,t)}else{throw new Error(e)}},setInput:function setInput(e,t){this.yy=t||this.yy||{};this._input=e;this._more=this._backtrack=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function input(){var e=this._input[0];this.yytext+=e;this.yyleng++;this.offset++;this.match+=e;this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);if(t){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return e},unput:function unput(e){var t=e.length,o=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-t);this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(o.length-1){this.yylineno-=o.length-1}var s=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:o?(o.length===i.length?this.yylloc.first_column:0)+i[i.length-o.length].length-o[0].length:this.yylloc.first_column-t};if(this.options.ranges){this.yylloc.range=[s[0],s[0]+this.yyleng-t]}this.yyleng=this.yytext.length;return this},more:function more(){this._more=!0;return this},reject:function reject(){if(this.options.backtrack_lexer){this._backtrack=!0}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function less(e){this.unput(this.match.slice(e))},pastInput:function pastInput(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function upcomingInput(){var e=this.match;if(20>e.length){e+=this._input.substr(0,20-e.length)}return(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function showPosition(){var e=this.pastInput(),t=Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function test_match(e,t){var r,o,i;if(this.options.backtrack_lexer){i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){i.yylloc.range=this.yylloc.range.slice(0)}}o=e[0].match(/(?:\r\n?|\n).*/g);if(o){this.yylineno+=o.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-o[o.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length};this.yytext+=e[0];this.match+=e[0];this.matches=e;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=!1;this._backtrack=!1;this._input=this._input.slice(e[0].length);this.matched+=e[0];r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=!1}if(r){return r}else if(this._backtrack){for(var s in i){this[s]=i[s]}return!1}return!1},next:function next(){if(this.done){return this.EOF}if(!this._input){this.done=!0}var e,t,r,o;if(!this._more){this.yytext="";this.match=""}for(var s=this._currentRules(),n=0;n<s.length;n++){r=this._input.match(this.rules[s[n]]);if(r&&(!t||r[0].length>t[0].length)){t=r;o=n;if(this.options.backtrack_lexer){e=this.test_match(r,s[n]);if(!1!==e){return e}else if(this._backtrack){t=!1;continue}else{return!1}}else if(!this.options.flex){break}}}if(t){e=this.test_match(t,s[o]);if(!1!==e){return e}return!1}if(""===this._input){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function(){var e=this.next();if(e){return e}else{return this.lex()}},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;if(0<e){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function(e){e=this.conditionStack.length-1-Math.abs(e||0);if(0<=e){return this.conditionStack[e]}else{return"INITIAL"}},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,o){switch(r){case 0:break;case 1:return 78;break;case 2:return 78;break;case 3:return 77;break;case 4:return 77;break;case 5:break;case 6:break;case 7:return 7;break;case 8:return 12;break;case 9:return 14;break;case 10:return 17;break;case 11:return 15;break;case 12:return 91;break;case 13:return 93;break;case 14:return 19;break;case 15:return 23;break;case 16:return 21;break;case 17:return 75;break;case 18:return 76;break;case 19:return 74;break;case 20:return 80;break;case 21:return 94;break;case 22:return 82;break;case 23:return 83;break;case 24:return 26;break;case 25:return 27;break;case 26:return 16;break;case 27:return"#";break;case 28:return 34;break;case 29:return 35;break;case 30:return 79;break;case 31:return 64;break;case 32:return 65;break;case 33:return 66;break;case 34:return 8;break;case 35:return 10;break;case 36:return 58;break;case 37:return 57;break;case 38:return 53;break;case 39:return 54;break;case 40:return 55;break;case 41:return 50;break;case 42:return 51;break;case 43:return 47;break;case 44:return 45;break;case 45:return 48;break;case 46:return 46;break;case 47:return 41;break;case 48:return 43;break;case 49:return 42;break;case 50:return 39;break;case 51:return 37;break;case 52:return 32;break;case 53:return 86;break;case 54:return 5;break;case 55:return 20;break;case 56:return"INVALID";break;}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],inclusive:!0}}};return e}();de.lexer=pe;function e(){this.yy={}}e.prototype=de;de.Parser=e;return new e}();if("undefined"!=typeof require&&"undefined"!=typeof exports){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function(e){if(!e[1]){console.log("Usage: "+e[0]+" FILE");process.exit(1)}var t=require("fs").readFileSync(require("path").normalize(e[1]),"utf8");return exports.parser.parse(t)};if("undefined"!=typeof module&&require.main===module){exports.main(process.argv.slice(1))}}parser.yy.parseError=parser.parseError;return JXG.JessieCode});define("base/point",["jxg","options","math/math","math/geometry","math/numerics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation","base/coordselement"],function(e,t,r,o,i,s,n,a,d,l,c,p){"use strict";e.Point=function(e,t,r){this.constructor(e,r,n.OBJECT_TYPE_POINT,n.OBJECT_CLASS_POINT);this.element=this.board.select(r.anchor);this.coordsConstructor(t);this.elType="point";this.id=this.board.setId(this,"P");this.board.renderer.drawPoint(this);this.board.finalizeAdding(this);this.createLabel()};e.Point.prototype=new a;l.copyPrototypeMethods(e.Point,p,"coordsConstructor");e.extend(e.Point.prototype,{hasPoint:function hasPoint(e,t){var o=this.coords.scrCoords,i,s=l.evaluate(this.visProp.sizeunit);i=parseFloat(l.evaluate(this.visProp.size));if("user"===s){i*=Math.sqrt(this.board.unitX*this.board.unitY)}i+=.5*parseFloat(l.evaluate(this.visProp.strokewidth));if(i<this.board.options.precision.hasPoint){i=this.board.options.precision.hasPoint}return Math.abs(o[1]-e)<i+2&&Math.abs(o[2]-t)<i+2},update:function update(e){if(!this.needsUpdate){return this}this.updateCoords(e);if(l.evaluate(this.visProp.trace)){this.cloneToBackground(!0)}return this},updateTransform:function updateTransform(){var e,t;if(0===this.transformations.length||null===this.baseElement){return this}if(this===this.baseElement){e=this.transformations[0].apply(this.baseElement,"self")}else{e=this.transformations[0].apply(this.baseElement)}this.coords.setCoordinates(n.COORDS_BY_USER,e);for(t=1;t<this.transformations.length;t++){this.coords.setCoordinates(n.COORDS_BY_USER,this.transformations[t].apply(this))}return this},updateRenderer:function updateRenderer(){this.updateRendererGeneric("updatePoint");return this},bounds:function bounds(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function makeIntersection(t,r,s,e){var i;t=this.board.select(t);r=this.board.select(r);i=o.intersectionFunction(this.board,t,r,s,e,l.evaluate(this.visProp.alwaysintersect));this.addConstraint([i]);try{t.addChild(this);r.addChild(this)}catch(o){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+_typeof(t)+"' and '"+_typeof(r)+"'.")}this.type=n.OBJECT_TYPE_INTERSECTION;this.elType="intersection";this.parents=[t.id,r.id,s,e];this.generatePolynomial=function(){var e=t.generatePolynomial(this),o=r.generatePolynomial(this);if(0===e.length||0===o.length){return[]}return[e[0],o[0]]};this.prepareUpdate().update()},setStyle:function setStyle(e){this.visProp.face=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"][e];this.visProp.size=[2,3,4,1,2,3,4,2,3,4,2,3,4][e];this.board.renderer.changePointStyle(this);return this},normalizeFace:function normalizeFace(r){e.deprecated("Point.normalizeFace()","JXG.normalizePointFace()");return t.normalizePointFace(r)},face:function face(t){e.deprecated("Point.face()","Point.setAttribute()");this.setAttribute({face:t})},size:function size(t){e.deprecated("Point.size()","Point.setAttribute()");this.setAttribute({size:t})},cloneToBackground:function cloneToBackground(){var e={id:this.id+"T"+this.numTraces};this.numTraces+=1;e.coords=this.coords;e.visProp=l.deepCopy(this.visProp,this.visProp.traceattributes,!0);e.visProp.layer=this.board.options.layer.trace;e.elementClass=n.OBJECT_CLASS_POINT;e.board=this.board;l.clearVisPropOld(e);e.visPropCalc={visible:l.evaluate(e.visProp.visible)};this.board.renderer.drawPoint(e);this.traces[e.id]=e.rendNode;return this}});e.createPoint=function(t,r,o){var i,s;s=l.copyAttributes(o,t.options,"point");i=p.create(e.Point,t,r,s);if(!i){throw new Error("JSXGraph: Can't create point with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]")}return i};e.createGlider=function(e,t,r){var o,i,s=l.copyAttributes(r,e.options,"glider");if(1===t.length){i=[0,0]}else{i=t.slice(0,2)}o=e.create("point",i,s);o.makeGlider(t[t.length-1]);return o};e.createIntersectionPoint=function(e,t,r){var s,a,d,c,p,u,h=l.copyAttributes(r,e.options,"intersection");t.push(0,0);a=e.select(t[0]);d=e.select(t[1]);p=t[2]||0;u=t[3]||0;s=e.create("point",[0,0,0],h);c=o.intersectionFunction(e,a,d,p,u,s.visProp.alwaysintersect);s.addConstraint([c]);try{a.addChild(s);d.addChild(s)}catch(r){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.")}s.type=n.OBJECT_TYPE_INTERSECTION;s.elType="intersection";s.setParents([a.id,d.id]);s.intersectionNumbers=[p,u];s.getParents=function(){return this.parents.concat(this.intersectionNumbers)};s.generatePolynomial=function(){var e=a.generatePolynomial(s),t=d.generatePolynomial(s);if(0===e.length||0===t.length){return[]}return[e[0],t[0]]};return s};e.createOtherIntersectionPoint=function(e,t,i){var s,a,d,p;if(3!==t.length||!l.isPoint(t[2])||t[0].elementClass!==n.OBJECT_CLASS_LINE&&t[0].elementClass!==n.OBJECT_CLASS_CIRCLE||t[1].elementClass!==n.OBJECT_CLASS_LINE&&t[1].elementClass!==n.OBJECT_CLASS_CIRCLE){throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+_typeof(t[0])+"',  '"+_typeof(t[1])+"'and  '"+_typeof(t[2])+"'.\nPossible parent types: [circle|line,circle|line,point]")}a=e.select(t[0]);d=e.select(t[1]);p=e.select(t[2]);s=e.create("point",[function(){var e=o.meet(a.stdform,d.stdform,0,a.board);if(Math.abs(p.X()-e.usrCoords[1])>r.eps||Math.abs(p.Y()-e.usrCoords[2])>r.eps||Math.abs(p.Z()-e.usrCoords[0])>r.eps){return e}return o.meet(a.stdform,d.stdform,1,a.board)}],i);s.type=n.OBJECT_TYPE_INTERSECTION;s.elType="otherintersection";s.setParents([a.id,d.id,p]);a.addChild(s);d.addChild(s);s.generatePolynomial=function(){var e=a.generatePolynomial(s),t=d.generatePolynomial(s);if(0===e.length||0===t.length){return[]}return[e[0],t[0]]};return s};e.createPolePoint=function(t,r,o){var i,a,d,l,c,p,u;if(1<r.length){l=r[0].type===n.OBJECT_TYPE_CONIC||r[0].elementClass===n.OBJECT_CLASS_CIRCLE;c=r[1].type===n.OBJECT_TYPE_CONIC||r[1].elementClass===n.OBJECT_CLASS_CIRCLE;p=r[0].elementClass===n.OBJECT_CLASS_LINE;u=r[1].elementClass===n.OBJECT_CLASS_LINE}if(2!==r.length||!(l&&u||p&&c)){throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent type: [conic|circle,line], [line,conic|circle]")}if(u){a=t.select(r[0]);d=t.select(r[1])}else{a=t.select(r[1]);d=t.select(r[0])}i=t.create("point",[function(){var t=a.quadraticform,r=d.stdform.slice(0,3);return[e.Math.Numerics.det([r,t[1],t[2]]),e.Math.Numerics.det([t[0],r,t[2]]),e.Math.Numerics.det([t[0],t[1],r])]}],o);i.elType="polepoint";i.setParents([a.id,d.id]);a.addChild(i);d.addChild(i);return i};e.registerElement("point",e.createPoint);e.registerElement("glider",e.createGlider);e.registerElement("intersection",e.createIntersectionPoint);e.registerElement("otherintersection",e.createOtherIntersectionPoint);e.registerElement("polepoint",e.createPolePoint);return{Point:e.Point,createPoint:e.createPoint,createGlider:e.createGlider,createIntersection:e.createIntersectionPoint,createOtherIntersection:e.createOtherIntersectionPoint,createPolePoint:e.createPolePoint}});define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],function(e,r,o,i,s,n,a,d,l,c){"use strict";e.Line=function(t,r,o,i){this.constructor(t,i,n.OBJECT_TYPE_LINE,n.OBJECT_CLASS_LINE);this.point1=this.board.select(r);this.point2=this.board.select(o);this.ticks=[];this.defaultTicks=null;this.parentPolygon=null;this.id=this.board.setId(this,"L");this.board.renderer.drawLine(this);this.board.finalizeAdding(this);this.elType="line";this.point1.addChild(this);this.point2.addChild(this);this.inherits.push(this.point1,this.point2);this.updateStdform();this.createLabel();this.methodMap=e.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"})};e.Line.prototype=new d;e.extend(e.Line.prototype,{hasPoint:function hasPoint(e,t){var p=[],c,u=[1,e,t],h,m,g,b,C,y,v,f=l.evaluate(this.visProp.strokewidth);v=this.board.options.precision.hasPoint+.5*f;p[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY;p[1]=this.stdform[1]/this.board.unitX;p[2]=this.stdform[2]/-this.board.unitY;c=o.distPointLine(u,p);if(isNaN(c)||c>v){return!1}if(l.evaluate(this.visProp.straightfirst)&&l.evaluate(this.visProp.straightlast)){return!0}m=this.point1.coords;g=this.point2.coords;h=[0,p[1],p[2]];h=r.crossProduct(h,u);h=r.crossProduct(h,p);h[1]/=h[0];h[2]/=h[0];h[0]=1;h=new a(n.COORDS_BY_SCREEN,h.slice(1),this.board).usrCoords;b=m.distance(n.COORDS_BY_USER,g);m=m.usrCoords.slice(0);g=g.usrCoords.slice(0);if(b<r.eps){C=0}else{if(b===Number.POSITIVE_INFINITY){b=1/r.eps;if(Math.abs(g[0])<r.eps){b/=o.distance([0,0,0],g);g=[1,m[1]+g[1]*b,m[2]+g[2]*b]}else{b/=o.distance([0,0,0],m);m=[1,g[1]+m[1]*b,g[2]+m[2]*b]}}y=1;b=g[y]-m[y];if(Math.abs(b)<r.eps){y=2;b=g[y]-m[y]}C=(h[y]-m[y])/b}if(!l.evaluate(this.visProp.straightfirst)&&0>C){return!1}return!(!l.evaluate(this.visProp.straightlast)&&1<C)},update:function update(){var e;if(!this.needsUpdate){return this}if(this.constrained){if(l.isFunction(this.funps)){e=this.funps();if(e&&e.length&&2===e.length){this.point1=e[0];this.point2=e[1]}}else{if(l.isFunction(this.funp1)){e=this.funp1();if(l.isPoint(e)){this.point1=e}else if(e&&e.length&&2===e.length){this.point1.setPositionDirectly(n.COORDS_BY_USER,e)}}if(l.isFunction(this.funp2)){e=this.funp2();if(l.isPoint(e)){this.point2=e}else if(e&&e.length&&2===e.length){this.point2.setPositionDirectly(n.COORDS_BY_USER,e)}}}}this.updateSegmentFixedLength();this.updateStdform();if(l.evaluate(this.visProp.trace)){this.cloneToBackground(!0)}return this},updateSegmentFixedLength:function updateSegmentFixedLength(){var e,t,o,i,s,a,c,p;if(!this.hasFixedLength){return this}e=this.point1.Dist(this.point2);t=this.fixedLength();o=this.fixedLengthOldCoords[0].distance(n.COORDS_BY_USER,this.point1.coords);i=this.fixedLengthOldCoords[1].distance(n.COORDS_BY_USER,this.point2.coords);if(o>r.eps||i>r.eps||e!==t){s=this.point1.isDraggable&&this.point1.type!==n.OBJECT_TYPE_GLIDER&&!l.evaluate(this.point1.visProp.fixed);a=this.point2.isDraggable&&this.point2.type!==n.OBJECT_TYPE_GLIDER&&!l.evaluate(this.point2.visProp.fixed);if(e>r.eps){if(o>i&&a||o<=i&&a&&!s){this.point2.setPositionDirectly(n.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*t/e,this.point1.Y()+(this.point2.Y()-this.point1.Y())*t/e]);this.point2.fullUpdate()}else if(o<=i&&s||o>i&&s&&!a){this.point1.setPositionDirectly(n.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*t/e,this.point2.Y()+(this.point1.Y()-this.point2.Y())*t/e]);this.point1.fullUpdate()}}else{c=Math.random()-.5;p=Math.random()-.5;e=Math.sqrt(c*c+p*p);if(a){this.point2.setPositionDirectly(n.COORDS_BY_USER,[this.point1.X()+c*t/e,this.point1.Y()+p*t/e]);this.point2.fullUpdate()}else if(s){this.point1.setPositionDirectly(n.COORDS_BY_USER,[this.point2.X()+c*t/e,this.point2.Y()+p*t/e]);this.point1.fullUpdate()}}this.fixedLengthOldCoords[0].setCoordinates(n.COORDS_BY_USER,this.point1.coords.usrCoords);this.fixedLengthOldCoords[1].setCoordinates(n.COORDS_BY_USER,this.point2.coords.usrCoords)}return this},updateStdform:function updateStdform(){var e=r.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=e[0];this.stdform[1]=e[1];this.stdform[2]=e[2];this.stdform[3]=0;this.normalize()},updateRenderer:function updateRenderer(){if(!this.needsUpdate){return this}if(this.visPropCalc.visible){this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&r.innerProduct(this.stdform,this.stdform,3)>=r.eps*r.eps;if(!this.isReal){this.updateVisibility(!1)}}if(this.visPropCalc.visible){this.board.renderer.updateLine(this)}if(this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal){this.label.update();this.board.renderer.updateText(this.label)}this.setDisplayRendNode();this.needsUpdate=!1;return this},generatePolynomial:function generatePolynomial(e){var t=this.point1.symbolic.x,r=this.point1.symbolic.y,o=this.point2.symbolic.x,i=this.point2.symbolic.y,s=e.symbolic.x,n=e.symbolic.y;return[["(",r,")*(",s,")-(",r,")*(",o,")+(",n,")*(",o,")-(",t,")*(",n,")+(",t,")*(",i,")-(",s,")*(",i,")"].join("")]},getRise:function getRise(){if(Math.abs(this.stdform[2])>=r.eps){return-this.stdform[0]/this.stdform[2]}return 1/0},getSlope:function getSlope(){if(Math.abs(this.stdform[2])>=r.eps){return-this.stdform[1]/this.stdform[2]}return 1/0},getAngle:function getAngle(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function setStraight(e,t){this.visProp.straightfirst=e;this.visProp.straightlast=t;this.board.renderer.updateLine(this);return this},getTextAnchor:function getTextAnchor(){return new a(n.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function setLabelRelativeCoords(e){if(l.exists(this.label)){this.label.relativeCoords=new a(n.COORDS_BY_SCREEN,[e[0],-e[1]],this.board)}},getLabelAnchor:function getLabelAnchor(){var e,t,i=0,s=new a(n.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),d=new a(n.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),c=l.evaluate(this.visProp.straightfirst),p=l.evaluate(this.visProp.straightlast);if(c||p){o.calcStraight(this,s,d,0)}s=s.scrCoords;d=d.scrCoords;if(!l.exists(this.label)){return new a(n.COORDS_BY_SCREEN,[NaN,NaN],this.board)}switch(l.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":if(s[1]<=d[1]){e=s[1];t=s[2]}else{e=d[1];t=d[2]}break;case"rt":case"lrt":case"urt":if(s[1]>d[1]){e=s[1];t=s[2]}else{e=d[1];t=d[2]}break;default:e=.5*(s[1]+d[1]);t=.5*(s[2]+d[2]);}if(c||p){if(l.exists(this.label)){i=l.evaluate(this.label.visProp.fontsize)}if(Math.abs(e)<r.eps){e=i+0}else if(this.board.canvasWidth+r.eps>e&&e>this.board.canvasWidth-i-r.eps){e=this.board.canvasWidth-i}if(r.eps+i>t&&t>-r.eps){t=i}else if(this.board.canvasHeight+r.eps>t&&t>this.board.canvasHeight-i-r.eps){t=this.board.canvasHeight-i}}return new a(n.COORDS_BY_SCREEN,[e,t],this.board)},cloneToBackground:function cloneToBackground(){var e={},t,o,i;e.id=this.id+"T"+this.numTraces;e.elementClass=n.OBJECT_CLASS_LINE;this.numTraces++;e.point1=this.point1;e.point2=this.point2;e.stdform=this.stdform;e.board=this.board;e.visProp=l.deepCopy(this.visProp,this.visProp.traceattributes,!0);e.visProp.layer=this.board.options.layer.trace;l.clearVisPropOld(e);e.visPropCalc={visible:l.evaluate(e.visProp.visible)};o=this.getSlope();t=this.getRise();e.getSlope=function(){return o};e.getRise=function(){return t};i=this.board.renderer.enhancedRendering;this.board.renderer.enhancedRendering=!0;this.board.renderer.drawLine(e);this.board.renderer.enhancedRendering=i;this.traces[e.id]=e.rendNode;return this},addTransform:function addTransform(e){var t,r=l.isArray(e)?e:[e],o=r.length;for(t=0;t<o;t++){this.point1.transformations.push(r[t]);this.point2.transformations.push(r[t])}return this},snapToGrid:function snapToGrid(e){var r,i,d,c,p,u,h,m,g;if(l.evaluate(this.visProp.snaptogrid)){if(3>this.parents.length){this.point1.handleSnapToGrid(!0,!0);this.point2.handleSnapToGrid(!0,!0)}else if(l.exists(e)){m=l.evaluate(this.visProp.snapsizex);g=l.evaluate(this.visProp.snapsizey);r=new a(n.COORDS_BY_SCREEN,[e.Xprev,e.Yprev],this.board);u=r.usrCoords[1];h=r.usrCoords[2];if(0>=m&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks){p=this.board.defaultAxes.x.defaultTicks;m=p.ticksDelta*(l.evaluate(p.visProp.minorticks)+1)}if(0>=g&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks){p=this.board.defaultAxes.y.defaultTicks;g=p.ticksDelta*(l.evaluate(p.visProp.minorticks)+1)}if(0<m&&0<g){i=o.projectPointToLine({coords:r},this,this.board);d=s.subtract([1,Math.round(u/m)*m,Math.round(h/g)*g],i.usrCoords);c=this.board.create("transform",d.slice(1),{type:"translate"});c.applyOnce([this.point1,this.point2])}}}else{this.point1.handleSnapToGrid(!1,!0);this.point2.handleSnapToGrid(!1,!0)}return this},snapToPoints:function snapToPoints(){var e=l.evaluate(this.visProp.snaptopoints);if(3>this.parents.length){this.point1.handleSnapToPoints(e);this.point2.handleSnapToPoints(e)}return this},X:function X(e){var o,i=this.stdform[2];o=Math.abs(this.point1.coords.usrCoords[0])>r.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1];e=2*(e-.5);return(1-Math.abs(e))*o-e*i},Y:function Y(e){var o,i=this.stdform[1];o=Math.abs(this.point1.coords.usrCoords[0])>r.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2];e=2*(e-.5);return(1-Math.abs(e))*o+e*i},Z:function Z(e){var o=Math.abs(this.point1.coords.usrCoords[0])>r.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];e=2*(e-.5);return(1-Math.abs(e))*o},L:function L(){return this.point1.Dist(this.point2)},minX:function minX(){return 0},maxX:function maxX(){return 1},bounds:function bounds(){var e=this.point1.coords.usrCoords,t=this.point2.coords.usrCoords;return[Math.min(e[1],t[1]),Math.max(e[2],t[2]),Math.max(e[1],t[1]),Math.min(e[2],t[2])]},addTicks:function addTicks(e){if(""===e.id||!l.exists(e.id)){e.id=this.id+"_ticks_"+(this.ticks.length+1)}this.board.renderer.drawTicks(e);this.ticks.push(e);return e.id},remove:function remove(){this.removeAllTicks();d.prototype.remove.call(this)},removeAllTicks:function removeAllTicks(){var e;for(e=this.ticks.length;0<e;e--){this.removeTicks(this.ticks[e-1])}this.ticks=[];this.board.update()},removeTicks:function removeTicks(e){var r,o;if(l.exists(this.defaultTicks)&&this.defaultTicks===e){this.defaultTicks=null}for(r=this.ticks.length;0<r;r--){if(this.ticks[r-1]===e){this.board.removeObject(this.ticks[r-1]);if(this.ticks[r-1].ticks){for(o=0;o<this.ticks[r-1].ticks.length;o++){if(l.exists(this.ticks[r-1].labels[o])){this.board.removeObject(this.ticks[r-1].labels[o])}}}delete this.ticks[r-1];break}}}});e.createLine=function(t,r,o){var s,n,a,d,p,u,h=[],m=!1,g=!1,b;if(2===r.length){if(l.isArray(r[0])&&1<r[0].length){u=l.copyAttributes(o,t.options,"line","point1");a=t.create("point",r[0],u)}else if(l.isString(r[0])||l.isPoint(r[0])){a=t.select(r[0])}else if(l.isFunction(r[0])&&l.isPoint(r[0]())){a=r[0]();g=!0}else if(l.isFunction(r[0])&&r[0]().length&&2<=r[0]().length){u=l.copyAttributes(o,t.options,"line","point1");a=c.createPoint(t,r[0](),u);g=!0}else if(l.isObject(r[0])&&l.isTransformationOrArray(r[1])){m=!0;u=l.copyAttributes(o,t.options,"line","point1");a=t.create("point",[r[0].point1,r[1]],u)}else{throw new Error("JSXGraph: Can't create line with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]")}if(m){u=l.copyAttributes(o,t.options,"line","point2");d=t.create("point",[r[0].point2,r[1]],u)}else if(l.isArray(r[1])&&1<r[1].length){u=l.copyAttributes(o,t.options,"line","point2");d=t.create("point",r[1],u)}else if(l.isString(r[1])||l.isPoint(r[1])){d=t.select(r[1])}else if(l.isFunction(r[1])&&l.isPoint(r[1]())){d=r[1]();g=!0}else if(l.isFunction(r[1])&&r[1]().length&&2<=r[1]().length){u=l.copyAttributes(o,t.options,"line","point2");d=c.createPoint(t,r[1](),u);g=!0}else{throw new Error("JSXGraph: Can't create line with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]")}u=l.copyAttributes(o,t.options,"line");n=new e.Line(t,a,d,u);if(g){n.constrained=!0;n.funp1=r[0];n.funp2=r[1]}else if(!m){n.isDraggable=!0}n.setParents([a.id,d.id])}else if(3===r.length){b=!0;for(p=0;3>p;p++){if(l.isNumber(r[p])){h[p]=l.createFunction(r[p])}else if(l.isFunction(r[p])){h[p]=r[p];b=!1}else{throw new Error("JSXGraph: Can't create line with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"' and '"+_typeof(r[2])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]")}}u=l.copyAttributes(o,t.options,"line","point1");if(b){a=t.create("point",[h[2]()*h[2]()+h[1]()*h[1](),h[2]()-h[1]()*h[0]()+h[2](),-h[1]()-h[2]()*h[0]()-h[1]()],u)}else{a=t.create("point",[function(){return .5*(h[2]()*h[2]()+h[1]()*h[1]())},function(){return .5*(h[2]()-h[1]()*h[0]()+h[2]())},function(){return .5*(-h[1]()-h[2]()*h[0]()-h[1]())}],u)}u=l.copyAttributes(o,t.options,"line","point2");if(b){d=t.create("point",[h[2]()*h[2]()+h[1]()*h[1](),-h[1]()*h[0]()+h[2](),-h[2]()*h[0]()-h[1]()],u)}else{d=t.create("point",[function(){return h[2]()*h[2]()+h[1]()*h[1]()},function(){return-h[1]()*h[0]()+h[2]()},function(){return-h[2]()*h[0]()-h[1]()}],u)}a.prepareUpdate().update();d.prepareUpdate().update();u=l.copyAttributes(o,t.options,"line");n=new e.Line(t,a,d,u);n.isDraggable=b;n.setParents([a,d])}else if(1===r.length&&l.isFunction(r[0])&&2===r[0]().length&&l.isPoint(r[0]()[0])&&l.isPoint(r[0]()[1])){s=r[0]();u=l.copyAttributes(o,t.options,"line");n=new e.Line(t,s[0],s[1],u);n.constrained=!0;n.funps=r[0];n.setParents(s)}else if(1===r.length&&l.isFunction(r[0])&&3===r[0]().length&&l.isNumber(r[0]()[0])&&l.isNumber(r[0]()[1])&&l.isNumber(r[0]()[2])){s=r[0];u=l.copyAttributes(o,t.options,"line","point1");a=t.create("point",[function(){var e=s();return[.5*(e[2]*e[2]+e[1]*e[1]),.5*(e[2]-e[1]*e[0]+e[2]),.5*(-e[1]-e[2]*e[0]-e[1])]}],u);u=l.copyAttributes(o,t.options,"line","point2");d=t.create("point",[function(){var e=s();return[e[2]*e[2]+e[1]*e[1],-e[1]*e[0]+e[2],-e[2]*e[0]-e[1]]}],u);u=l.copyAttributes(o,t.options,"line");n=new e.Line(t,a,d,u);n.constrained=!0;n.funps=r[0];n.setParents([a,d])}else{throw new Error("JSXGraph: Can't create line with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]")}return n};e.registerElement("line",e.createLine);e.createSegment=function(e,t,r){var o,i;r.straightFirst=!1;r.straightLast=!1;i=l.copyAttributes(r,e.options,"segment");o=e.create("line",t.slice(0,2),i);if(3===t.length){o.hasFixedLength=!0;if(l.isNumber(t[2])){o.fixedLength=function(){return t[2]}}else if(l.isFunction(t[2])){o.fixedLength=t[2]}else{throw new Error("JSXGraph: Can't create segment with third parent type '"+_typeof(t[2])+"'.\nPossible third parent types: number or function")}o.getParents=function(){return this.parents.concat(this.fixedLength())};o.fixedLengthOldCoords=[];o.fixedLengthOldCoords[0]=new a(n.COORDS_BY_USER,o.point1.coords.usrCoords.slice(1,3),e);o.fixedLengthOldCoords[1]=new a(n.COORDS_BY_USER,o.point2.coords.usrCoords.slice(1,3),e)}o.elType="segment";return o};e.registerElement("segment",e.createSegment);e.createArrow=function(e,t,r){var o;r.firstArrow=!1;r.lastArrow=!0;o=e.create("line",t,r).setStraight(!1,!1);o.type=n.OBJECT_TYPE_VECTOR;o.elType="arrow";return o};e.registerElement("arrow",e.createArrow);e.createAxis=function(e,t,r){var o,i,s,a,d;if((l.isArray(t[0])||l.isPoint(t[0]))&&(l.isArray(t[1])||l.isPoint(t[1]))){o=l.copyAttributes(r,e.options,"axis");s=e.create("line",t,o);s.type=n.OBJECT_TYPE_AXIS;s.isDraggable=!1;s.point1.isDraggable=!1;s.point2.isDraggable=!1;for(a in s.ancestors){if(s.ancestors.hasOwnProperty(a)){s.ancestors[a].type=n.OBJECT_TYPE_AXISPOINT}}i=l.copyAttributes(r,e.options,"axis","ticks");if(l.exists(i.ticksdistance)){d=i.ticksdistance}else if(l.isArray(i.ticks)){d=i.ticks}else{d=1}s.defaultTicks=e.create("ticks",[s,d],i);s.defaultTicks.dump=!1;s.elType="axis";s.subs={ticks:s.defaultTicks};s.inherits.push(s.defaultTicks)}else{throw new Error("JSXGraph: Can't create axis with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]")}return s};e.registerElement("axis",e.createAxis);e.createTangent=function(e,t,o){var s,a,d,u,h,m,b;if(1===t.length){s=t[0];a=s.slideObject}else if(2===t.length){if(l.isPoint(t[0])){s=t[0];a=t[1]}else if(l.isPoint(t[1])){a=t[0];s=t[1]}else{throw new Error("JSXGraph: Can't create tangent with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]")}}else{throw new Error("JSXGraph: Can't create tangent with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]")}if(a.elementClass===n.OBJECT_CLASS_LINE){b=e.create("line",[a.point1,a.point2],o);b.glider=s}else if(a.elementClass===n.OBJECT_CLASS_CURVE&&a.type!==n.OBJECT_TYPE_CONIC){if("plot"!==l.evaluate(a.visProp.curvetype)){d=a.X;u=a.Y;b=e.create("line",[function(){return-s.X()*i.D(u)(s.position)+s.Y()*i.D(d)(s.position)},function(){return i.D(u)(s.position)},function(){return-i.D(d)(s.position)}],o);s.addChild(b);b.glider=s}else{b=e.create("line",[function(){var e=Math.floor(s.position),t,r;if(e===a.numberPoints-1){e--}if(0>e){return 1}t=a.points[e].usrCoords;r=a.points[e+1].usrCoords;return t[2]*r[1]-t[1]*r[2]},function(){var e=Math.floor(s.position),t,r;if(e===a.numberPoints-1){e--}if(0>e){return 0}t=a.points[e].usrCoords;r=a.points[e+1].usrCoords;return r[2]-t[2]},function(){var e=Math.floor(s.position),t,r;if(e===a.numberPoints-1){e--}if(0>e){return 0}t=a.points[e].usrCoords;r=a.points[e+1].usrCoords;return t[1]-r[1]}],o);s.addChild(b);b.glider=s}}else if(a.type===n.OBJECT_TYPE_TURTLE){b=e.create("line",[function(){var e=Math.floor(s.position);for(h=0;h<a.objects.length;h++){m=a.objects[h];if(m.type===n.OBJECT_TYPE_CURVE){if(e<m.numberPoints){break}e-=m.numberPoints}}if(e===m.numberPoints-1){e--}if(0>e){return 1}return m.Y(e)*m.X(e+1)-m.X(e)*m.Y(e+1)},function(){var e=Math.floor(s.position);for(h=0;h<a.objects.length;h++){m=a.objects[h];if(m.type===n.OBJECT_TYPE_CURVE){if(e<m.numberPoints){break}e-=m.numberPoints}}if(e===m.numberPoints-1){e--}if(0>e){return 0}return m.Y(e+1)-m.Y(e)},function(){var e=Math.floor(s.position);for(h=0;h<a.objects.length;h++){m=a.objects[h];if(m.type===n.OBJECT_TYPE_CURVE){if(e<m.numberPoints){break}e-=m.numberPoints}}if(e===m.numberPoints-1){e--}if(0>e){return 0}return m.X(e)-m.X(e+1)}],o);s.addChild(b);b.glider=s}else if(a.elementClass===n.OBJECT_CLASS_CIRCLE||a.type===n.OBJECT_TYPE_CONIC){b=e.create("line",[function(){return r.matVecMult(a.quadraticform,s.coords.usrCoords)[0]},function(){return r.matVecMult(a.quadraticform,s.coords.usrCoords)[1]},function(){return r.matVecMult(a.quadraticform,s.coords.usrCoords)[2]}],o);s.addChild(b);b.glider=s}if(!l.exists(b)){throw new Error("JSXGraph: Couldn't create tangent with the given parents.")}b.elType="tangent";b.type=n.OBJECT_TYPE_TANGENT;b.setParents(t);return b};e.createRadicalAxis=function(e,t,o){var i,s,d;if(2!==t.length||t[0].elementClass!==n.OBJECT_CLASS_CIRCLE||t[1].elementClass!==n.OBJECT_CLASS_CIRCLE){throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent type: [circle,circle]")}s=e.select(t[0]);d=e.select(t[1]);i=e.create("line",[function(){var e=s.stdform,t=d.stdform;return r.matVecMult(r.transpose([e.slice(0,3),t.slice(0,3)]),[t[3],-e[3]])}],o);i.elType="radicalaxis";i.setParents([s.id,d.id]);s.addChild(i);d.addChild(i);return i};e.createPolarLine=function(e,t,r){var o,i,s,a,d,c,p;if(1<t.length){a=t[0].type===n.OBJECT_TYPE_CONIC||t[0].elementClass===n.OBJECT_CLASS_CIRCLE;d=t[1].type===n.OBJECT_TYPE_CONIC||t[1].elementClass===n.OBJECT_CLASS_CIRCLE;c=l.isPoint(t[0]);p=l.isPoint(t[1])}if(2!==t.length||!(a&&p||c&&d)){throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent type: [conic|circle,point], [point,conic|circle]")}if(p){i=e.select(t[0]);s=e.select(t[1])}else{i=e.select(t[1]);s=e.select(t[0])}o=e.create("tangent",[i,s],r);o.elType="polarline";return o};e.registerElement("tangent",e.createTangent);e.registerElement("polar",e.createTangent);e.registerElement("radicalaxis",e.createRadicalAxis);e.registerElement("polarline",e.createPolarLine);return{Line:e.Line,createLine:e.createLine,createTangent:e.createTangent,createPolar:e.createTangent,createSegment:e.createSegment,createAxis:e.createAxis,createArrow:e.createArrow,createRadicalAxis:e.createRadicalAxis,createPolarLine:e.createPolarLine}});define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","math/numerics","math/geometry","parser/geonext","utils/type","base/transformation","math/qdt"],function(e,r,o,i,s,n,a,l,c,u,h,m){"use strict";e.Curve=function(e,t,o){this.constructor(e,o,r.OBJECT_TYPE_CURVE,r.OBJECT_CLASS_CURVE);this.points=[];this.numberPoints=u.evaluate(this.visProp.numberpointshigh);this.bezierDegree=1;this.dataX=null;this.dataY=null;this.qdt=null;if(u.exists(t[0])){this.varname=t[0]}else{this.varname="x"}this.xterm=t[1];this.yterm=t[2];this.generateTerm(this.varname,this.xterm,this.yterm,t[3],t[4]);this.updateCurve();this.id=this.board.setId(this,"G");this.board.renderer.drawCurve(this);this.board.finalizeAdding(this);this.createGradient();this.elType="curve";this.createLabel();if(u.isString(this.xterm)){this.notifyParents(this.xterm)}if(u.isString(this.yterm)){this.notifyParents(this.yterm)}this.methodMap=u.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})};e.Curve.prototype=new i;e.extend(e.Curve.prototype,{minX:function minX(){var e;if("polar"===u.evaluate(this.visProp.curvetype)){return 0}e=new o(r.COORDS_BY_SCREEN,[0,0],this.board,!1);return e.usrCoords[1]},maxX:function maxX(){var e;if("polar"===u.evaluate(this.visProp.curvetype)){return 2*Math.PI}e=new o(r.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board,!1);return e.usrCoords[1]},X:function X(){return NaN},Y:function Y(){return NaN},Z:function Z(){return 1},hasPoint:function hasPoint(e,n,a){var p,h,m,g,b,C,v,f,P=[],_,S,E=u.evaluate(this.visProp.numberpointslow),O=(this.maxX()-this.minX())/E,d=this.board.options.precision.hasPoint,T=1/0,A,w,j;h=new o(r.COORDS_BY_SCREEN,[e,n],this.board,!1);e=h.usrCoords[1];n=h.usrCoords[2];d+=.5*u.evaluate(this.visProp.strokewidth);d*=d;A=this.board.unitX*this.board.unitX;w=this.board.unitY*this.board.unitY;j=u.evaluate(this.visProp.curvetype);if("parameter"===j||"polar"===j){if(0<this.transformations.length){this.updateTransformMatrix();g=s.inverse(this.transformMat);b=s.matVecMult(g,[1,e,n]);e=b[1];n=b[2]}for(C=0,p=this.minX();C<E;C++){v=this.X(p,!0);f=this.Y(p,!0);T=(e-v)*(e-v)*A+(n-f)*(n-f)*w;if(T<=d){return!0}p+=O}}else if("plot"===j||"functiongraph"===j){if(!u.exists(a)||0>a){a=0}if(u.exists(this.qdt)&&u.evaluate(this.visProp.useqdt)&&3!==this.bezierDegree){S=this.qdt.query(new o(r.COORDS_BY_USER,[e,n],this.board));_=S.points;m=_.length}else{_=this.points;m=this.numberPoints-1}for(C=a;C<m;C++){if(3===this.bezierDegree){P.push(l.projectCoordsToBeziersegment([1,e,n],this,C))}else{if(S){if(_[C].prev){P=l.projectCoordsToSegment([1,e,n],_[C].prev.usrCoords,_[C].usrCoords)}if(_[C].next&&_[C+1]!==_[C].next){P=l.projectCoordsToSegment([1,e,n],_[C].usrCoords,_[C].next.usrCoords)}}else{P=l.projectCoordsToSegment([1,e,n],_[C].usrCoords,_[C+1].usrCoords)}}if(0<=P[1]&&1>=P[1]&&(e-P[0][1])*(e-P[0][1])*A+(n-P[0][2])*(n-P[0][2])*w<=d){return!0}}return!1}return T<d},allocatePoints:function allocatePoints(){var e,t;t=this.numberPoints;if(this.points.length<this.numberPoints){for(e=this.points.length;e<t;e++){this.points[e]=new o(r.COORDS_BY_USER,[0,0],this.board,!1)}}},update:function update(){if(this.needsUpdate){if(u.evaluate(this.visProp.trace)){this.cloneToBackground(!0)}this.updateCurve()}return this},updateRenderer:function updateRenderer(){if(!this.needsUpdate){return this}if(this.visPropCalc.visible){this.checkReal();if(!this.isReal){this.updateVisibility(!1)}}if(this.visPropCalc.visible){this.board.renderer.updateCurve(this)}if(this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal){this.label.update();this.board.renderer.updateText(this.label)}this.setDisplayRendNode();this.needsUpdate=!1;return this},updateDataArray:function updateDataArray(){},updateCurve:function updateCurve(){var e,t,o,s,n,d,l=!1;this.updateTransformMatrix();this.updateDataArray();t=this.minX();o=this.maxX();if(u.exists(this.dataX)){this.numberPoints=this.dataX.length;e=this.numberPoints;this.allocatePoints();for(d=0;d<e;d++){s=d;if(u.exists(this.dataY)){n=d;this.points[d].setCoordinates(r.COORDS_BY_USER,[this.dataX[d],this.dataY[d]],!1)}else{n=this.X(s);this.points[d].setCoordinates(r.COORDS_BY_USER,[this.dataX[d],this.Y(n,l)],!1)}this.points[d]._t=d;this.updateTransform(this.points[d]);l=!0}}else{if(u.evaluate(this.visProp.doadvancedplot)){this.updateParametricCurve(t,o)}else if(u.evaluate(this.visProp.doadvancedplotold)){this.updateParametricCurveOld(t,o)}else{if(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH){this.numberPoints=u.evaluate(this.visProp.numberpointshigh)}else{this.numberPoints=u.evaluate(this.visProp.numberpointslow)}this.allocatePoints();this.updateParametricCurveNaive(t,o,this.numberPoints)}e=this.numberPoints;if(u.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH){this.qdt=new m(this.board.getBoundingBox());for(d=0;d<this.points.length;d++){this.qdt.insert(this.points[d]);if(0<d){this.points[d].prev=this.points[d-1]}if(d<e-1){this.points[d].next=this.points[d+1]}}}for(d=0;d<e;d++){this.updateTransform(this.points[d])}}if("plot"!==u.evaluate(this.visProp.curvetype)&&u.evaluate(this.visProp.rdpsmoothing)){this.points=a.RamerDouglasPeucker(this.points,.2);this.numberPoints=this.points.length}return this},updateTransformMatrix:function updateTransformMatrix(){var e,r,o=this.transformations.length;this.transformMat=[[1,0,0],[0,1,0],[0,0,1]];for(r=0;r<o;r++){e=this.transformations[r];e.update();this.transformMat=s.matMatMult(e.matrix,this.transformMat)}return this},checkReal:function checkReal(){var e=!1,t,r,o=this.numberPoints;for(t=0;t<o;t++){r=this.points[t].usrCoords;if(!isNaN(r[1])&&!isNaN(r[2])&&Math.abs(r[0])>s.eps){e=!0;break}}this.isReal=e},updateParametricCurveNaive:function updateParametricCurveNaive(e,o,s){var n,a,d=!1;for(n=0;n<s;n++){a=e+n*((o-e)/s);this.points[n].setCoordinates(r.COORDS_BY_USER,[this.X(a,d),this.Y(a,d)],!1);this.points[n]._t=a;d=!0}return this},updateParametricCurveOld:function updateParametricCurveOld(n,a){var l,c,p,u,h,m,g,b,C,v,f,P,_=!1,S=new o(r.COORDS_BY_USER,[0,0],this.board,!1),E=[],O=[],T=[],A=[],w=!1,N=0,R=function(e,t,r){var o,i,n=r[1]-e[1],a=r[2]-e[2],l=t[0]-e[1],c=t[1]-e[2],p=l*l+c*c;if(p>=s.eps){o=(n*l+a*c)/p;if(0<o){if(1>=o){n-=o*l;a-=o*c}else{n-=l;a-=c}}}i=n*n+a*a;return Math.sqrt(i)};e.deprecated("Curve.updateParametricCurveOld()");if(this.board.updateQuality===this.board.BOARD_QUALITY_LOW){v=15;f=10;P=10}else{v=21;f=.7;P=.7}A[0]=a-n;for(l=1;l<v;l++){A[l]=.5*A[l-1]}l=1;E[0]=1;O[0]=0;c=n;S.setCoordinates(r.COORDS_BY_USER,[this.X(c,_),this.Y(c,_)],!1);_=!0;m=S.scrCoords[1];g=S.scrCoords[2];t0=c;c=a;S.setCoordinates(r.COORDS_BY_USER,[this.X(c,_),this.Y(c,_)],!1);u=S.scrCoords[1];h=S.scrCoords[2];T[0]=[u,h];b=1;C=0;this.points=[];this.points[N++]=new o(r.COORDS_BY_SCREEN,[m,g],this.board,!1);do{w=this.isDistOK(u-m,h-g,f,P)||this.isSegmentOutside(m,g,u,h);while(C<v&&(!w||6>C)&&(7>=C||this.isSegmentDefined(m,g,u,h))){E[b]=l;O[b]=C;T[b]=[u,h];b+=1;l=2*l-1;C++;c=n+l*A[C];S.setCoordinates(r.COORDS_BY_USER,[this.X(c,_),this.Y(c,_)],!1,!0);u=S.scrCoords[1];h=S.scrCoords[2];w=this.isDistOK(u-m,h-g,f,P)||this.isSegmentOutside(m,g,u,h)}if(1<N){p=R(this.points[N-2].scrCoords,[u,h],this.points[N-1].scrCoords);if(.015>p){N-=1}}this.points[N]=new o(r.COORDS_BY_SCREEN,[u,h],this.board,!1);this.points[N]._t=c;N+=1;m=u;g=h;t0=c;b-=1;u=T[b][0];h=T[b][1];C=O[b]+1;l=2*E[b]}while(0<b&&5e5>N);this.numberPoints=this.points.length;return this},isSegmentOutside:function isSegmentOutside(e,t,r,o){return 0>t&&0>o||t>this.board.canvasHeight&&o>this.board.canvasHeight||0>e&&0>r||e>this.board.canvasWidth&&r>this.board.canvasWidth},isDistOK:function isDistOK(e,t,r,o){return Math.abs(e)<r&&Math.abs(t)<o&&!isNaN(e+t)},isSegmentDefined:function isSegmentDefined(e,t,r,o){return!(isNaN(e+t)&&isNaN(r+o))},_insertPoint:function _insertPoint(e,r){var t=!isNaN(this._lastCrds[1]+this._lastCrds[2]),o=!isNaN(e.scrCoords[1]+e.scrCoords[2]),i=this.board.canvasWidth,s=this.board.canvasHeight;o=o&&e.scrCoords[1]>-500&&e.scrCoords[2]>-500&&e.scrCoords[1]<i+500&&e.scrCoords[2]<s+500;if(!o&&t||o&&(!t||.7<Math.abs(e.scrCoords[1]-this._lastCrds[1])||.7<Math.abs(e.scrCoords[2]-this._lastCrds[2]))){e._t=r;this.points.push(e);this._lastCrds=e.copy("scrCoords")}},_intersectWithBorder:function _intersectWithBorder(e,t,r){var o,i,n,a;if(0>=r){o=[-t[0],1,0];i=s.crossProduct(o,e);if(0!==i[0]){n=i[1]/i[0];a=i[2]/i[0]}else{a=1/0}if(a<t[3]){o=[-t[3],0,1];i=s.crossProduct(o,e);if(0!==i[0]){n=i[1]/i[0];a=i[2]/i[0]}else{n=1/0}}else if(a>t[1]){o=[-t[1],0,1];i=s.crossProduct(o,e);if(0!==i[0]){n=i[1]/i[0];a=i[2]/i[0]}else{n=1/0}}}else{o=[-t[2],1,0];i=s.crossProduct(o,e);if(0!==i[0]){n=i[1]/i[0];a=i[2]/i[0]}else{a=1/0}if(a<t[3]){o=[-t[3],0,1];i=s.crossProduct(o,e);if(0!==i[0]){n=i[1]/i[0];a=i[2]/i[0]}else{n=1/0}}else if(a>t[1]){o=[-t[1],0,1];i=s.crossProduct(o,e);if(0!==i[0]){n=i[1]/i[0];a=i[2]/i[0]}else{n=1/0}}}return[1,n,a]},_borderCase:function _borderCase(e,i,s,n,a,d,l){var u,h,m,g=null,b,C=!1,y,v,f,P,_,S,E,x,O,T,A;if(1>=l){h=new o(r.COORDS_BY_USER,[0,0],this.board,!1);b=0;do{if(isNaN(e[1]+e[2])&&!isNaN(s[1]+s[2])){y=n;v=d;f=a}else if(isNaN(i[1]+i[2])&&!isNaN(s[1]+s[2])){y=a;v=d;f=n}else if(isNaN(s[1]+s[2])&&!isNaN(i[1]+i[2])){y=d;v=a;f=a+(a-d)}else if(isNaN(s[1]+s[2])&&!isNaN(e[1]+e[2])){y=d;v=n;f=n-(d-n)}else{return!1}u=.5*(y+v);h.setCoordinates(r.COORDS_BY_USER,[this.X(u,!0),this.Y(u,!0)],!1);m=h.usrCoords;C=isNaN(m[1]+m[2]);if(C){y=u}else{f=v;v=u}++b}while(C&&b<30);if(b<30){g=m.slice();s=m.slice();v=u}_=this.X(v,!0);E=this.X(f,!0);O=(_-E)/(v-f);S=this.Y(v,!0);x=this.Y(f,!0);T=(S-x)/(v-f);P=this.board.getBoundingBox();if(500<Math.sqrt(O*O+T*T)){A=[O*S-T*_,T,-O];g=this._intersectWithBorder(A,P,_-E)}if(null!==g){this._insertPoint(new o(r.COORDS_BY_USER,g,this.board,!1));return!0}}return!1},_triangleDists:function _triangleDists(e,t,r){var o,i,s,n,a;o=[e[0]*t[0],.5*(e[1]+t[1]),.5*(e[2]+t[2])];i=l.distance(e,t,3);s=l.distance(e,r,3);n=l.distance(r,t,3);a=l.distance(r,o,3);return[i,s,n,a]},_isUndefined:function _isUndefined(e,s,n,a){var d,l,c;if(!isNaN(e[1]+e[2])||!isNaN(n[1]+n[2])){return!1}c=new o(r.COORDS_BY_USER,[0,0],this.board,!1);for(l=0;20>l;++l){d=s+Math.random()*(a-s);c.setCoordinates(r.COORDS_BY_USER,[this.X(d,!0),this.Y(d,!0)],!1);if(!isNaN(c.scrCoords[0]+c.scrCoords[1]+c.scrCoords[2])){return!1}}return!0},_isOutside:function _isOutside(e,t,r){var o=this.board.canvasWidth,i=this.board.canvasHeight;return!!(e[1]<-500&&r[1]<-500||e[2]<-500&&r[2]<-500||e[1]>o+500&&r[1]>o+500||e[2]>i+500&&r[2]>i+500)},_plotRecursive:function _plotRecursive(e,t,i,s,n,a){var d,l,p,u=0,h,m,g,b=new o(r.COORDS_BY_USER,[0,0],this.board,!1);if(65536<this.numberPoints){return}if(n<this.nanLevel&&this._isUndefined(e,t,i,s)){return this}if(n<this.nanLevel&&this._isOutside(e,t,i,s)){return this}d=.5*(t+s);b.setCoordinates(r.COORDS_BY_USER,[this.X(d,!0),this.Y(d,!0)],!1);l=b.scrCoords;if(this._borderCase(e,i,l,t,s,d,n)){return this}p=this._triangleDists(e,i,l);h=n<this.smoothLevel&&p[3]<a;m=n<this.jumpLevel&&(p[2]>.99*p[0]||p[1]>.99*p[0]||p[0]===1/0||p[1]===1/0||p[2]===1/0);g=n<this.smoothLevel+2&&p[0]<.5*(p[1]+p[2]);if(g){u=0;h=!1}--n;if(m){this._insertPoint(new o(r.COORDS_BY_SCREEN,[NaN,NaN],this.board,!1),d)}else if(n<=u||h){this._insertPoint(b,d)}else{this._plotRecursive(e,t,l,d,n,a);this._insertPoint(b,d);this._plotRecursive(l,d,i,s,n,a)}return this},updateParametricCurve:function updateParametricCurve(e,t){var i,s,n,d,l=!1,c=new o(r.COORDS_BY_USER,[0,0],this.board,!1),p=new o(r.COORDS_BY_USER,[0,0],this.board,!1),h,m;if(this.board.updateQuality===this.board.BOARD_QUALITY_LOW){h=u.evaluate(this.visProp.recursiondepthlow)||13;m=2;this.smoothLevel=5;this.jumpLevel=5}else{h=u.evaluate(this.visProp.recursiondepthhigh)||17;m=2;this.smoothLevel=3;this.jumpLevel=3}this.nanLevel=h-4;this.points=[];i=e;c.setCoordinates(r.COORDS_BY_USER,[this.X(i,l),this.Y(i,l)],!1);n=c.copy("scrCoords");l=!0;s=t;p.setCoordinates(r.COORDS_BY_USER,[this.X(s,l),this.Y(s,l)],!1);d=p.copy("scrCoords");c._t=i;this.points.push(c);this._lastCrds=c.copy("scrCoords");this._plotRecursive(n,i,d,s,h,m);p._t=s;this.points.push(p);this.numberPoints=this.points.length;return this},updateTransform:function updateTransform(e){var t,o=this.transformations.length;if(0<o){t=s.matVecMult(this.transformMat,e.usrCoords);e.setCoordinates(r.COORDS_BY_USER,[t[1],t[2]],!1,!0)}return e},addTransform:function addTransform(e){var t,r=u.isArray(e)?e:[e],o=r.length;for(t=0;t<o;t++){this.transformations.push(r[t])}return this},interpolationFunctionFromArray:function interpolationFunctionFromArray(e){return function(r){var t,o,s,n,a=this["data"+e],d=a.length,l=[];if(isNaN(r)){return NaN}if(0>r){if(u.isFunction(a[0])){return a[0]()}return a[0]}if(3===this.bezierDegree){d/=3;if(r>=d){if(u.isFunction(a[a.length-1])){return a[a.length-1]()}return a[a.length-1]}t=3*Math.floor(r);s=r%1;n=1-s;for(o=0;4>o;o++){if(u.isFunction(a[t+o])){l[o]=a[t+o]()}else{l[o]=a[t+o]}}return n*n*(n*l[0]+3*s*l[1])+(3*n*l[2]+s*l[3])*s*s}if(r>d-2){t=d-2}else{t=parseInt(Math.floor(r),10)}if(t===r){if(u.isFunction(a[t])){return a[t]()}return a[t]}for(o=0;2>o;o++){if(u.isFunction(a[t+o])){l[o]=a[t+o]()}else{l[o]=a[t+o]}}return l[0]+(l[1]-l[0])*(r-t)}},generateTerm:function generateTerm(e,t,r,o,i){var s,n;if(u.isArray(t)){this.dataX=t;this.numberPoints=this.dataX.length;this.X=this.interpolationFunctionFromArray("X");this.visProp.curvetype="plot";this.isDraggable=!0}else{this.X=u.createFunction(t,this.board,e);if(u.isString(t)){this.visProp.curvetype="functiongraph"}else if(u.isFunction(t)||u.isNumber(t)){this.visProp.curvetype="parameter"}this.isDraggable=!0}if(u.isArray(r)){this.dataY=r;this.Y=this.interpolationFunctionFromArray("Y")}else{this.Y=u.createFunction(r,this.board,e)}if(u.isFunction(t)&&u.isArray(r)){s=u.createFunction(r[0],this.board,"");n=u.createFunction(r[1],this.board,"");this.X=function(e){return t(e)*Math.cos(e)+s()};this.Y=function(e){return t(e)*Math.sin(e)+n()};this.visProp.curvetype="polar"}if(u.exists(o)){this.minX=u.createFunction(o,this.board,"")}if(u.exists(i)){this.maxX=u.createFunction(i,this.board,"")}},notifyParents:function notifyParents(e){var t,r,o=!1,i;i={xterm:1,yterm:1};for(t in i){if(i.hasOwnProperty(t)&&this.hasOwnProperty(t)&&this[t].origin){o=!0;for(r in this[t].origin.deps){if(this[t].origin.deps.hasOwnProperty(r)){this[t].origin.deps[r].addChild(this)}}}}if(!o){c.findDependencies(this,e,this.board)}},getLabelAnchor:function getLabelAnchor(){var e,t,i,s=.05*this.board.canvasWidth,n=.05*this.board.canvasHeight,a=.95*this.board.canvasWidth,d=.95*this.board.canvasHeight;switch(u.evaluate(this.visProp.label.position)){case"ulft":t=s;i=n;break;case"llft":t=s;i=d;break;case"rt":t=a;i=.5*d;break;case"lrt":t=a;i=d;break;case"urt":t=a;i=n;break;case"top":t=.5*a;i=n;break;case"bot":t=.5*a;i=d;break;default:t=s;i=.5*d;}e=new o(r.COORDS_BY_SCREEN,[t,i],this.board,!1);return l.projectCoordsToCurve(e.usrCoords[1],e.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function cloneToBackground(){var e,t={id:this.id+"T"+this.numTraces,elementClass:r.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:u.deepCopy(this.visProp,this.visProp.traceattributes,!0)};t.visProp.layer=this.board.options.layer.trace;t.visProp.curvetype=this.visProp.curvetype;this.numTraces++;u.clearVisPropOld(t);t.visPropCalc={visible:u.evaluate(t.visProp.visible)};e=this.board.renderer.enhancedRendering;this.board.renderer.enhancedRendering=!0;this.board.renderer.drawCurve(t);this.board.renderer.enhancedRendering=e;this.traces[t.id]=t.rendNode;return this},bounds:function bounds(){var e=1/0,t=-Infinity,r=1/0,o=-Infinity,s=this.points.length,n,d,l;if(3===this.bezierDegree){for(n=0;n<s;n++){this.points[n].X=u.bind(function(){return this.usrCoords[1]},this.points[n]);this.points[n].Y=u.bind(function(){return this.usrCoords[2]},this.points[n])}d=a.bezier(this.points);l=d[3]();e=a.fminbr(function(e){return d[0](e)},[0,l]);t=a.fminbr(function(e){return-d[0](e)},[0,l]);r=a.fminbr(function(e){return d[1](e)},[0,l]);o=a.fminbr(function(e){return-d[1](e)},[0,l]);e=d[0](e);t=d[0](t);r=d[1](r);o=d[1](o);return[e,o,t,r]}for(n=0;n<s;n++){if(e>this.points[n].usrCoords[1]){e=this.points[n].usrCoords[1]}if(t<this.points[n].usrCoords[1]){t=this.points[n].usrCoords[1]}if(r>this.points[n].usrCoords[2]){r=this.points[n].usrCoords[2]}if(o<this.points[n].usrCoords[2]){o=this.points[n].usrCoords[2]}}return[e,o,t,r]},getParents:function getParents(){var e=[this.xterm,this.yterm,this.minX(),this.maxX()];if(0!==this.parents.length){e=this.parents}return e},moveTo:function moveTo(e){var t=[],o;if(0<this.points.length&&!u.evaluate(this.visProp.fixed)){o=this.points[0];if(3===e.length){t=[e[0]-o.usrCoords[0],e[1]-o.usrCoords[1],e[2]-o.usrCoords[2]]}else{t=[e[0]-o.usrCoords[1],e[1]-o.usrCoords[2]]}this.setPosition(r.COORDS_BY_USER,t)}return this}});e.createCurve=function(t,o,i){var s,n,a=u.copyAttributes(i,t.options,"curve");s=t.select(o[0]);if(u.isObject(s)&&(s.type===r.OBJECT_TYPE_CURVE||s.type===r.OBJECT_TYPE_ANGLE||s.type===r.OBJECT_TYPE_ARC||s.type===r.OBJECT_TYPE_CONIC||s.type===r.OBJECT_TYPE_SECTOR)&&u.isTransformationOrArray(o[1])){if(s.type===r.OBJECT_TYPE_SECTOR){a=u.copyAttributes(i,t.options,"sector")}else if(s.type===r.OBJECT_TYPE_ARC){a=u.copyAttributes(i,t.options,"arc")}else if(s.type===r.OBJECT_TYPE_ANGLE){if(!u.exists(i.withLabel)){i.withLabel=!1}a=u.copyAttributes(i,t.options,"angle")}else{a=u.copyAttributes(i,t.options,"curve")}a=u.copyAttributes(a,t.options,"curve");n=new e.Curve(t,["x",[],[]],a);n.updateDataArray=function(){var e,t=s.numberPoints;this.bezierDegree=s.bezierDegree;this.dataX=[];this.dataY=[];for(e=0;e<t;e++){this.dataX.push(s.points[e].usrCoords[1]);this.dataY.push(s.points[e].usrCoords[2])}return this};n.addTransform(o[1]);return n}else{a=u.copyAttributes(i,t.options,"curve");return new e.Curve(t,["x"].concat(o),a)}};e.registerElement("curve",e.createCurve);e.createFunctiongraph=function(t,r,o){var i,s=["x","x"].concat(r);i=u.copyAttributes(o,t.options,"curve");i.curvetype="functiongraph";return new e.Curve(t,s,i)};e.registerElement("functiongraph",e.createFunctiongraph);e.registerElement("plot",e.createFunctiongraph);e.createSpline=function(t,r,o){var i,s;s=function(){var e,o=[],s=[];return function(n,t){var d,l,p;if(!t){o=[];s=[];if(2===r.length&&u.isArray(r[0])&&u.isArray(r[1])&&r[0].length===r[1].length){for(d=0;d<r[0].length;d++){if(u.isFunction(r[0][d])){o.push(r[0][d]())}else{o.push(r[0][d])}if(u.isFunction(r[1][d])){s.push(r[1][d]())}else{s.push(r[1][d])}}}else{for(d=0;d<r.length;d++){if(u.isPoint(r[d])){o.push(r[d].X());s.push(r[d].Y())}else if(u.isArray(r[d])&&2===r[d].length){for(l=0;l<r.length;l++){if(u.isFunction(r[l][0])){o.push(r[l][0]())}else{o.push(r[l][0])}if(u.isFunction(r[l][1])){s.push(r[l][1]())}else{s.push(r[l][1])}}}else if(u.isFunction(r[d])&&2===r[d]().length){p=r[d]();o.push(p[0]);s.push(p[1])}}}e=a.splineDef(o,s)}return a.splineEval(n,o,s,e)}};o=u.copyAttributes(o,t.options,"curve");o.curvetype="functiongraph";i=new e.Curve(t,["x","x",s()],o);i.setParents(r);i.elType="spline";return i};e.registerElement("spline",e.createSpline);e.createCardinalSpline=function(t,r,o){var s,n,d,l,c,h,m,g;if(!u.exists(r[0])||!u.isArray(r[0])){throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs\nPossible parent types: [points:array, tau:number|function, type:string]")}if(!u.exists(r[1])||!u.isNumber(r[1])&&!u.isFunction(r[1])){throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'\nPossible parent types: [points:array, tau:number|function, type:string]")}if(!u.exists(r[2])||!u.isString(r[2])){throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'\nPossible parent types: [points:array, tau:number|function, type:string]")}o=u.copyAttributes(o,t.options,"curve");o=u.copyAttributes(o,t.options,"cardinalspline");o.curvetype="parameter";l=r[0];c=[];if(!o.isarrayofcoordinates&&2===l.length&&u.isArray(l[0])&&u.isArray(l[1])&&l[0].length===l[1].length){for(h=0;h<l[0].length;h++){c[h]=[];if(u.isFunction(l[0][h])){c[h].push(l[0][h]())}else{c[h].push(l[0][h])}if(u.isFunction(l[1][h])){c[h].push(l[1][h]())}else{c[h].push(l[1][h])}}}else{for(h=0;h<l.length;h++){if(u.isString(l[h])){c.push(t.select(l[h]))}else if(u.isPoint(l[h])){c.push(l[h])}else if(u.isArray(l[h])&&2===l[h].length){c[h]=[];if(u.isFunction(l[h][0])){c[h].push(l[h][0]())}else{c[h].push(l[h][0])}if(u.isFunction(l[h][1])){c[h].push(l[h][1]())}else{c[h].push(l[h][1])}}else if(u.isFunction(l[h])&&2===l[h]().length){c.push(r[h]())}}}if(!0===o.createpoints){n=u.providePoints(t,c,o,"cardinalspline",["points"])}else{n=[];for(h=0;h<c.length;h++){if(u.isPoint(c[h])){n.push(c[h])}else{n.push(function(e){return{X:function X(){return c[e][0]},Y:function Y(){return c[e][1]}}}(h))}}}d=r[1];r[2];g=["x"].concat(a.CardinalSpline(n,d));s=new e.Curve(t,g,o);m=n.length;s.setParents(n);for(h=0;h<m;h++){if(u.isPoint(n[h])){n[h].addChild(s)}}s.elType="cardinalspline";return s};e.registerElement("cardinalspline",e.createCardinalSpline);e.createRiemannsum=function(e,t,r){var o,i,s,d,l,p;p=u.copyAttributes(r,e.options,"riemannsum");p.curvetype="plot";s=t[0];o=u.createFunction(t[1],e,"");if(!u.exists(o)){throw new Error("JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]")}i=u.createFunction(t[2],e,"",!1);if(!u.exists(i)){throw new Error("JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]")}d=[[0],[0]].concat(t.slice(3));l=e.create("curve",d,p);l.sum=0;l.Value=function(){return this.sum};l.updateDataArray=function(){var e=a.riemann(s,o(),i(),this.minX(),this.maxX());this.dataX=e[0];this.dataY=e[1];this.sum=e[2]};return l};e.registerElement("riemannsum",e.createRiemannsum);e.createTracecurve=function(e,t,o){var i,s,n,a;if(2!==t.length){throw new Error("JSXGraph: Can't create trace curve with given parent'\nPossible parent types: [glider, point]")}s=e.select(t[0]);n=e.select(t[1]);if(s.type!==r.OBJECT_TYPE_GLIDER||!u.isPoint(n)){throw new Error("JSXGraph: Can't create trace curve with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [glider, point]")}a=u.copyAttributes(o,e.options,"tracecurve");a.curvetype="plot";i=e.create("curve",[[0],[0]],a);i.updateDataArray=function(){var e,o,d,l,c,p,u,h,m,g=a.numberpoints,b=s.position,C=s.slideObject,v=C.minX(),f=C.maxX();o=(f-v)/g;this.dataX=[];this.dataY=[];if(C.elementClass!==r.OBJECT_CLASS_CURVE){g++}for(e=0;e<g;e++){d=v+e*o;p=C.X(d)/C.Z(d);u=C.Y(d)/C.Z(d);s.setPositionDirectly(r.COORDS_BY_USER,[p,u]);h=!1;for(l in this.board.objects){if(this.board.objects.hasOwnProperty(l)){c=this.board.objects[l];if(c===s){h=!0}if(h&&c.needsRegularUpdate){m=c.visProp.trace;c.visProp.trace=!1;c.needsUpdate=!0;c.update(!0);c.visProp.trace=m;if(c===n){break}}}}this.dataX[e]=n.X();this.dataY[e]=n.Y()}s.position=b;h=!1;for(l in this.board.objects){if(this.board.objects.hasOwnProperty(l)){c=this.board.objects[l];if(c===s){h=!0}if(h&&c.needsRegularUpdate){m=c.visProp.trace;c.visProp.trace=!1;c.needsUpdate=!0;c.update(!0);c.visProp.trace=m;if(c===n){break}}}}};return i};e.registerElement("tracecurve",e.createTracecurve);e.createStepfunction=function(e,t,r){var o,i;if(2!==t.length){throw new Error("JSXGraph: Can't create step function with given parent'\nPossible parent types: [array, array|function]")}i=u.copyAttributes(r,e.options,"stepfunction");o=e.create("curve",t,i);o.updateDataArray=function(){var e,t=0,r=this.xterm.length;this.dataX=[];this.dataY=[];if(0===r){return}this.dataX[t]=this.xterm[0];this.dataY[t]=this.yterm[0];++t;for(e=1;e<r;++e){this.dataX[t]=this.xterm[e];this.dataY[t]=this.dataY[t-1];++t;this.dataX[t]=this.xterm[e];this.dataY[t]=this.yterm[e];++t}};return o};e.registerElement("stepfunction",e.createStepfunction);e.createDerivative=function(e,t,o){var i,s,n,d,l;if(1!==t.length&&t[0].class!==r.OBJECT_CLASS_CURVE){throw new Error("JSXGraph: Can't create derivative curve with given parent'\nPossible parent types: [curve]")}l=u.copyAttributes(o,e.options,"curve");s=t[0];n=a.D(s.X);d=a.D(s.Y);i=e.create("curve",[function(e){return s.X(e)},function(e){return d(e)/n(e)},s.minX(),s.maxX()],l);i.setParents(s);return i};e.registerElement("derivative",e.createDerivative);return{Curve:e.Curve,createCurve:e.createCurve,createFunctiongraph:e.createFunctiongraph,createPlot:e.createPlot,createSpline:e.createSpline,createRiemannsum:e.createRiemannsum,createTracecurve:e.createTracecurve,createStepfunction:e.createStepfunction}});define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type","base/point","base/curve"],function(e,t,o,s,n,c,u){"use strict";e.createEllipse=function(e,r,s){var n,a,d,l,p,h,c,m=[],g=u.copyAttributes(s,e.options,"conic","foci"),b=u.copyAttributes(s,e.options,"conic","center"),y=u.copyAttributes(s,e.options,"conic");for(h=0;2>h;h++){if(1<r[h].length){m[h]=e.create("point",r[h],g)}else if(u.isPoint(r[h])){m[h]=e.select(r[h])}else if(u.isFunction(r[h])&&u.isPoint(r[h]())){m[h]=r[h]()}else if(u.isString(r[h])){m[h]=e.select(r[h])}else{throw new Error("JSXGraph: Can't create Ellipse with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,point,point], [point,point,number|function]")}}if(u.isNumber(r[2])){p=u.createFunction(r[2],e)}else if(u.isFunction(r[2])&&u.isNumber(r[2]())){p=r[2]}else{if(u.isPoint(r[2])){l=e.select(r[2])}else if(1<r[2].length){l=e.create("point",r[2],g)}else if(u.isFunction(r[2])&&u.isPoint(r[2]())){l=r[2]()}else if(u.isString(r[2])){l=e.select(r[2])}else{throw new Error("JSXGraph: Can't create Ellipse with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"' and '"+_typeof(r[2])+"'.\nPossible parent types: [point,point,point], [point,point,number|function]")}p=function(){return l.Dist(m[0])+l.Dist(m[1])}}if(!u.exists(r[4])){r[4]=2*Math.PI}if(!u.exists(r[3])){r[3]=0}d=e.create("point",[function(){return .5*(m[0].X()+m[1].X())},function(){return .5*(m[0].Y()+m[1].Y())}],b);a=e.create("curve",[function(){return 0},function(){return 0},r[3],r[4]],y);a.majorAxis=p;c=a.hasPoint;n=function(e,t){var o,i,s,n,d,l,c,u,h;if(!t){o=p();i=o*o;s=m[0].X();n=m[0].Y();d=m[1].X();l=m[1].Y();c=s-d;u=n-l;h=(i-s*s-n*n+d*d+l*l)/(2*o);a.quadraticform=[[h*h-d*d-l*l,h*c/o+d,h*u/o+l],[h*c/o+d,c*c/i-1,c*u/i],[h*u/o+l,c*u/i,u*u/i-1]]}};a.X=function(e,t){var o=p(),r=m[1].Dist(m[0]),i=.5*(r*r-o*o)/(r*Math.cos(e)-o),s=Math.atan2(m[1].Y()-m[0].Y(),m[1].X()-m[0].X());if(!t){n(e,t)}return m[0].X()+Math.cos(s+e)*i};a.Y=function(e){var t=p(),r=m[1].Dist(m[0]),o=.5*(r*r-t*t)/(r*Math.cos(e)-t),i=Math.atan2(m[1].Y()-m[0].Y(),m[1].X()-m[0].X());return m[0].Y()+Math.sin(i+e)*o};a.midpoint=a.center=d;a.type=t.OBJECT_TYPE_CONIC;a.subs={center:a.center};a.inherits.push(a.center,m[0],m[1]);if(u.isPoint(l)){a.inherits.push(l)}a.hasPoint=function(e,i){var s,n,a,d,l;if(u.evaluate(this.visProp.hasinnerpoints)){s=m[0].coords;n=m[1].coords;a=this.majorAxis();d=new o(t.COORDS_BY_SCREEN,[e,i],this.board);l=d.distance(t.COORDS_BY_USER,s)+d.distance(t.COORDS_BY_USER,n);return l<=a}return c.apply(this,arguments)};d.addChild(a);for(h=0;2>h;h++){if(u.isPoint(m[h])){m[h].addChild(a)}}if(u.isPoint(l)){l.addChild(a)}a.setParents(r);return a};e.createHyperbola=function(e,r,o){var s,n,a,d,l,c,p=[],h=u.copyAttributes(o,e.options,"conic","foci"),m=u.copyAttributes(o,e.options,"conic","center"),g=u.copyAttributes(o,e.options,"conic");for(c=0;2>c;c++){if(1<r[c].length){p[c]=e.create("point",r[c],h)}else if(u.isPoint(r[c])){p[c]=e.select(r[c])}else if(u.isFunction(r[c])&&u.isPoint(r[c]())){p[c]=r[c]()}else if(u.isString(r[c])){p[c]=e.select(r[c])}else{throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,point,point], [point,point,number|function]")}}if(u.isNumber(r[2])){l=u.createFunction(r[2],e)}else if(u.isFunction(r[2])&&u.isNumber(r[2]())){l=r[2]}else{if(u.isPoint(r[2])){d=e.select(r[2])}else if(1<r[2].length){d=e.create("point",r[2],h)}else if(u.isFunction(r[2])&&u.isPoint(r[2]())){d=r[2]()}else if(u.isString(r[2])){d=e.select(r[2])}else{throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"' and '"+_typeof(r[2])+"'.\nPossible parent types: [point,point,point], [point,point,number|function]")}l=function(){return d.Dist(p[0])-d.Dist(p[1])}}if(!u.exists(r[4])){r[4]=1.0001*Math.PI}if(!u.exists(r[3])){r[3]=-1.0001*Math.PI}a=e.create("point",[function(){return .5*(p[0].X()+p[1].X())},function(){return .5*(p[0].Y()+p[1].Y())}],m);n=e.create("curve",[function(){return 0},function(){return 0},r[3],r[4]],g);n.majorAxis=l;s=function(e,t){var o,i,s,a,d,c,u,h,m;if(!t){o=l();i=o*o;s=p[0].X();a=p[0].Y();d=p[1].X();c=p[1].Y();u=s-d;h=a-c;m=(i-s*s-a*a+d*d+c*c)/(2*o);n.quadraticform=[[m*m-d*d-c*c,m*u/o+d,m*h/o+c],[m*u/o+d,u*u/i-1,u*h/i],[m*h/o+c,u*h/i,h*h/i-1]]}};n.X=function(e,t){var o=l(),r=p[1].Dist(p[0]),i=.5*(r*r-o*o)/(r*Math.cos(e)+o),n=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());if(!t){s(e,t)}return p[0].X()+Math.cos(n+e)*i};n.Y=function(e){var t=l(),r=p[1].Dist(p[0]),o=.5*(r*r-t*t)/(r*Math.cos(e)+t),i=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return p[0].Y()+Math.sin(i+e)*o};n.midpoint=n.center=a;n.subs={center:n.center};n.inherits.push(n.center,p[0],p[1]);if(u.isPoint(d)){n.inherits.push(d)}n.type=t.OBJECT_TYPE_CONIC;a.addChild(n);for(c=0;2>c;c++){if(u.isPoint(p[c])){p[c].addChild(n)}}if(u.isPoint(d)){d.addChild(n)}n.setParents(r);return n};e.createParabola=function(e,r,o){var i,s,n,p=r[0],h=r[1],a=u.copyAttributes(o,e.options,"conic","foci"),d=u.copyAttributes(o,e.options,"conic","center"),l=u.copyAttributes(o,e.options,"conic");if(1<r[0].length){p=e.create("point",r[0],a)}else if(u.isPoint(r[0])){p=e.select(r[0])}else if(u.isFunction(r[0])&&u.isPoint(r[0]())){p=r[0]()}else if(u.isString(r[0])){p=e.select(r[0])}else{throw new Error("JSXGraph: Can't create Parabola with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,line]")}if(!u.exists(r[3])){r[3]=10}if(!u.exists(r[2])){r[2]=-10}n=e.create("point",[function(){return c.projectPointToLine(p,h,e).usrCoords}],d);s=e.create("curve",[function(){return 0},function(){return 0},r[2],r[3]],l);s.midpoint=s.center=n;s.subs={center:s.center};s.inherits.push(s.center);i=function(e,t){var r,o,i,n,d,l;if(!t){r=h.stdform[1];o=h.stdform[2];i=h.stdform[0];n=r*r+o*o;d=p.X();l=p.Y();s.quadraticform=[[i*i-n*(d*d+l*l),i*r+n*d,i*o+n*l],[i*r+n*d,-o*o,r*o],[i*o+n*l,r*o,-r*r]]}};s.X=function(e,t){var r,o,s=h.getAngle(),n=c.distPointLine(p.coords.usrCoords,h.stdform),d=h.point1.coords.usrCoords,l=h.point2.coords.usrCoords,u=p.coords.usrCoords;if(0===d[0]){d=[1,l[1]+h.stdform[2],l[2]-h.stdform[1]]}else if(0===l[0]){l=[1,d[1]+h.stdform[2],d[2]-h.stdform[1]]}o=0<=(l[1]-d[1])*(u[2]-d[2])-(l[2]-d[2])*(u[1]-d[1])?1:-1;r=o*n/(1-Math.sin(e));if(!t){i(e,t)}return p.X()+Math.cos(e+s)*r};s.Y=function(e){var t,r,o=h.getAngle(),i=c.distPointLine(p.coords.usrCoords,h.stdform),s=h.point1.coords.usrCoords,n=h.point2.coords.usrCoords,d=p.coords.usrCoords;if(0===s[0]){s=[1,n[1]+h.stdform[2],n[2]-h.stdform[1]]}else if(0===n[0]){n=[1,s[1]+h.stdform[2],s[2]-h.stdform[1]]}r=0<=(n[1]-s[1])*(d[2]-s[2])-(n[2]-s[2])*(d[1]-s[1])?1:-1;t=r*i/(1-Math.sin(e));return p.Y()+Math.sin(e+o)*t};s.type=t.OBJECT_TYPE_CONIC;n.addChild(s);if(u.isPoint(p)){p.addChild(s);s.inherits.push(p)}h.addChild(s);s.setParents(r);return s};e.createConic=function(e,r,o){var d,l,h,m,g,C,y,v,f,P,_,S,E,x,O=[[1,0,0],[0,1,0],[0,0,1]],T=[[1,0,0],[0,1,0],[0,0,1]],A=[],w=[],p=u.copyAttributes(o,e.options,"conic","point"),j=u.copyAttributes(o,e.options,"conic","center"),N=u.copyAttributes(o,e.options,"conic");if(5===r.length){x=!0}else if(6===r.length){x=!1}else{throw new Error("JSXGraph: Can't create generic Conic with "+r.length+" parameters.")}if(x){for(S=0;5>S;S++){if(1<r[S].length){A[S]=e.create("point",r[S],p)}else if(u.isPoint(r[S])){A[S]=e.select(r[S])}else if(u.isFunction(r[S])&&u.isPoint(r[S]())){A[S]=r[S]()}else if(u.isString(r[S])){A[S]=e.select(r[S])}else{throw new Error("JSXGraph: Can't create Conic section with parent types '"+_typeof(r[S])+"'.\nPossible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]")}}}else{E=[[0,0,0],[0,0,0],[0,0,0]];E[0][0]=u.isFunction(r[2])?function(){return r[2]()}:function(){return r[2]};E[0][1]=u.isFunction(r[4])?function(){return r[4]()}:function(){return r[4]};E[0][2]=u.isFunction(r[5])?function(){return r[5]()}:function(){return r[5]};E[1][1]=u.isFunction(r[0])?function(){return r[0]()}:function(){return r[0]};E[1][2]=u.isFunction(r[3])?function(){return r[3]()}:function(){return r[3]};E[2][2]=u.isFunction(r[1])?function(){return r[1]()}:function(){return r[1]}}g=function(e){var t,r;for(t=0;3>t;t++){for(r=t;3>r;r++){e[t][r]+=e[r][t]}}for(t=0;3>t;t++){for(r=0;r<t;r++){e[t][r]=e[r][t]}}return e};m=function(e,t){var r,o,s=[[0,0,0],[0,0,0],[0,0,0]];for(r=0;3>r;r++){for(o=0;3>o;o++){s[r][o]=e[r]*t[o]}}return g(s)};h=function(e,t,r){var o,n,a,d,l,c=[[0,0,0],[0,0,0],[0,0,0]];l=s.matVecMult(t,r);a=s.innerProduct(r,l);l=s.matVecMult(e,r);d=s.innerProduct(r,l);for(o=0;3>o;o++){for(n=0;3>n;n++){c[o][n]=a*e[o][n]-d*t[o][n]}}return c};l=e.create("curve",[function(){return 0},function(){return 0},0,2*Math.PI],N);d=function(e,t){var r,o,a,d;if(!t){if(x){for(r=0;5>r;r++){w[r]=A[r].coords.usrCoords}P=m(s.crossProduct(w[0],w[1]),s.crossProduct(w[2],w[3]));_=m(s.crossProduct(w[0],w[2]),s.crossProduct(w[1],w[3]));T=h(P,_,w[4])}else{for(r=0;3>r;r++){for(o=r;3>o;o++){T[r][o]=E[r][o]();if(o>r){T[o][r]=T[r][o]}}}}l.quadraticform=T;C=n.Jacobi(T);if(0>C[0][0][0]){C[0][0][0]*=-1;C[0][1][1]*=-1;C[0][2][2]*=-1}for(r=0;3>r;r++){a=0;for(o=0;3>o;o++){a+=C[1][o][r]*C[1][o][r]}a=Math.sqrt(a)}O=C[1];f=Math.sqrt(Math.abs(C[0][0][0]));y=Math.sqrt(Math.abs(C[0][1][1]));v=Math.sqrt(Math.abs(C[0][2][2]))}if(0>=C[0][1][1]&&0>=C[0][2][2]){d=s.matVecMult(O,[1/f,Math.cos(e)/y,Math.sin(e)/v])}else if(0>=C[0][1][1]&&0<C[0][2][2]){d=s.matVecMult(O,[Math.cos(e)/f,1/y,Math.sin(e)/v])}else if(0>C[0][2][2]){d=s.matVecMult(O,[Math.sin(e)/f,Math.cos(e)/y,1/v])}if(u.exists(d)){d[1]/=d[0];d[2]/=d[0];d[0]=1}else{d=[1,NaN,NaN]}return d};l.X=function(e,t){return d(e,t)[1]};l.Y=function(e,t){return d(e,t)[2]};l.midpoint=e.create("point",[function(){var e=l.quadraticform;return[e[1][1]*e[2][2]-e[1][2]*e[1][2],e[1][2]*e[0][2]-e[2][2]*e[0][1],e[0][1]*e[1][2]-e[1][1]*e[0][2]]}],j);l.type=t.OBJECT_TYPE_CONIC;l.center=l.midpoint;l.subs={center:l.center};l.inherits.push(l.center);l.inherits=l.inherits.concat(A);if(x){for(S=0;5>S;S++){if(u.isPoint(A[S])){A[S].addChild(l)}}l.setParents(r)}l.addChild(l.center);return l};e.registerElement("ellipse",e.createEllipse);e.registerElement("hyperbola",e.createHyperbola);e.registerElement("parabola",e.createParabola);e.registerElement("conic",e.createConic);return{createEllipse:e.createEllipse,createHyperbola:e.createHyperbola,createParabola:e.createParabola,createConic:e.createConic}});define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],function(e,t,o,s,n,a,d){"use strict";e.Circle=function(e,t,r,o,i){this.constructor(e,i,s.OBJECT_TYPE_CIRCLE,s.OBJECT_CLASS_CIRCLE);this.method=t;this.midpoint=this.board.select(r);this.center=this.board.select(r);this.point2=null;this.radius=0;this.line=null;this.circle=null;if("twoPoints"===t){this.point2=e.select(o);this.radius=this.Radius()}else if("pointRadius"===t){this.gxtterm=o;this.updateRadius=d.createFunction(o,this.board,null,!0);this.updateRadius()}else if("pointLine"===t){this.line=e.select(o);this.radius=this.line.point1.coords.distance(s.COORDS_BY_USER,this.line.point2.coords)}else if("pointCircle"===t){this.circle=e.select(o);this.radius=this.circle.Radius()}this.id=this.board.setId(this,"C");this.board.renderer.drawEllipse(this);this.board.finalizeAdding(this);this.createGradient();this.elType="circle";this.createLabel();this.center.addChild(this);if("pointRadius"===t){this.notifyParents(o)}else if("pointLine"===t){this.line.addChild(this)}else if("pointCircle"===t){this.circle.addChild(this)}else if("twoPoints"===t){this.point2.addChild(this)}this.methodMap=d.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})};e.Circle.prototype=new t;e.extend(e.Circle.prototype,{hasPoint:function hasPoint(e,t){var i=this.board.options.precision.hasPoint,n=this.center.coords.usrCoords,a=new o(s.COORDS_BY_SCREEN,[e,t],this.board),l=this.Radius(),r,c,p;r=n[1]-a.usrCoords[1];c=n[2]-a.usrCoords[2];p=Math.sqrt(r*r+c*c);i+=.5*d.evaluate(this.visProp.strokewidth);i/=Math.sqrt(this.board.unitX*this.board.unitY);if(d.evaluate(this.visProp.hasinnerpoints)){return p<l+i}return Math.abs(p-l)<i},generatePolynomial:function generatePolynomial(e){var t=this.center.symbolic.x,r=this.center.symbolic.y,o=e.symbolic.x,i=e.symbolic.y,s=this.generateRadiusSquared();if(""===s){return[]}return["(("+o+")-("+t+"))^2 + (("+i+")-("+r+"))^2 - ("+s+")"]},generateRadiusSquared:function generateRadiusSquared(){var e,t,r,o,i,s,n="";if("twoPoints"===this.method){e=this.center.symbolic.x;t=this.center.symbolic.y;r=this.point2.symbolic.x;o=this.point2.symbolic.y;n="(("+r+")-("+e+"))^2 + (("+o+")-("+t+"))^2"}else if("pointRadius"===this.method){if(d.isNumber(this.radius)){n=(this.radius*this.radius).toString()}}else if("pointLine"===this.method){r=this.line.point1.symbolic.x;o=this.line.point1.symbolic.y;i=this.line.point2.symbolic.x;s=this.line.point2.symbolic.y;n="(("+r+")-("+i+"))^2 + (("+o+")-("+s+"))^2"}else if("pointCircle"===this.method){n=this.circle.Radius()}return n},update:function update(){if(this.needsUpdate){if(d.evaluate(this.visProp.trace)){this.cloneToBackground(!0)}if("pointLine"===this.method){this.radius=this.line.point1.coords.distance(s.COORDS_BY_USER,this.line.point2.coords)}else if("pointCircle"===this.method){this.radius=this.circle.Radius()}else if("pointRadius"===this.method){this.radius=this.updateRadius()}this.updateStdform();this.updateQuadraticform()}return this},updateQuadraticform:function updateQuadraticform(){var e=this.center,t=e.X(),o=e.Y(),i=this.Radius();this.quadraticform=[[t*t+o*o-i*i,-t,-o],[-t,1,0],[-o,0,1]]},updateStdform:function updateStdform(){this.stdform[3]=.5;this.stdform[4]=this.Radius();this.stdform[1]=-this.center.coords.usrCoords[1];this.stdform[2]=-this.center.coords.usrCoords[2];if(!isFinite(this.stdform[4])){this.stdform[0]=d.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0}this.normalize()},updateRenderer:function updateRenderer(){if(!this.needsUpdate){return this}if(this.visPropCalc.visible){this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal;if(!this.isReal){this.updateVisibility(!1)}}if(this.visPropCalc.visible){this.board.renderer.updateEllipse(this)}if(this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal){this.label.update();this.board.renderer.updateText(this.label)}this.setDisplayRendNode();this.needsUpdate=!1;return this},notifyParents:function notifyParents(e){if(d.isString(e)){a.findDependencies(this,e,this.board)}},setRadius:function setRadius(e){this.updateRadius=d.createFunction(e,this.board,null,!0);this.board.update();return this},Radius:function Radius(e){if(d.exists(e)){this.setRadius(e);return this.Radius()}if("twoPoints"===this.method){if(d.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||d.cmpArrays(this.center.coords.usrCoords,[0,0,0])){return NaN}return this.center.Dist(this.point2)}if("pointLine"===this.method||"pointCircle"===this.method){return this.radius}if("pointRadius"===this.method){return this.updateRadius()}return NaN},getRadius:function getRadius(){e.deprecated("Circle.getRadius()","Circle.Radius()");return this.Radius()},getTextAnchor:function getTextAnchor(){return this.center.coords},getLabelAnchor:function getLabelAnchor(){var e,t,i=this.Radius(),r=this.center.coords.usrCoords;switch(d.evaluate(this.visProp.label.position)){case"lft":e=r[1]-i;t=r[2];break;case"llft":e=r[1]-Math.sqrt(.5)*i;t=r[2]-Math.sqrt(.5)*i;break;case"rt":e=r[1]+i;t=r[2];break;case"lrt":e=r[1]+Math.sqrt(.5)*i;t=r[2]-Math.sqrt(.5)*i;break;case"urt":e=r[1]+Math.sqrt(.5)*i;t=r[2]+Math.sqrt(.5)*i;break;case"top":e=r[1];t=r[2]+i;break;case"bot":e=r[1];t=r[2]-i;break;default:e=r[1]-Math.sqrt(.5)*i;t=r[2]+Math.sqrt(.5)*i;break;}return new o(s.COORDS_BY_USER,[e,t],this.board)},cloneToBackground:function cloneToBackground(){var e,t=this.Radius(),r={id:this.id+"T"+this.numTraces,elementClass:s.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function Radius(){return t},getRadius:function getRadius(){return t},board:this.board,visProp:d.deepCopy(this.visProp,this.visProp.traceattributes,!0)};r.visProp.layer=this.board.options.layer.trace;this.numTraces++;d.clearVisPropOld(r);r.visPropCalc={visible:d.evaluate(r.visProp.visible)};e=this.board.renderer.enhancedRendering;this.board.renderer.enhancedRendering=!0;this.board.renderer.drawEllipse(r);this.board.renderer.enhancedRendering=e;this.traces[r.id]=r.rendNode;return this},addTransform:function addTransform(e){var t,r=d.isArray(e)?e:[e],o=r.length;for(t=0;t<o;t++){this.center.transformations.push(r[t]);if("twoPoints"===this.method){this.point2.transformations.push(r[t])}}return this},snapToGrid:function snapToGrid(){var e=d.evaluate(this.visProp.snaptogrid);this.center.handleSnapToGrid(e,!0);if("twoPoints"===this.method){this.point2.handleSnapToGrid(e,!0)}return this},snapToPoints:function snapToPoints(){var e=d.evaluate(this.visProp.snaptopoints);this.center.handleSnapToPoints(e);if("twoPoints"===this.method){this.point2.handleSnapToPoints(e)}return this},X:function X(e){return this.Radius()*Math.cos(2*e*Math.PI)+this.center.coords.usrCoords[1]},Y:function Y(e){return this.Radius()*Math.sin(2*e*Math.PI)+this.center.coords.usrCoords[2]},Z:function Z(){return 1},minX:function minX(){return 0},maxX:function maxX(){return 1},Area:function Area(){var e=this.Radius();return e*e*Math.PI},bounds:function bounds(){var e=this.center.coords.usrCoords,t=this.Radius();return[e[1]-t,e[2]+t,e[1]+t,e[2]-t]},getParents:function getParents(){if(1===this.parents.length){return this.parents.concat(this.radius)}return this.parents}});e.createCircle=function(t,r,o){var a,l,c,u,h;l=[];h=t.select(r[0]);if(d.isObject(h)&&h.elementClass===s.OBJECT_CLASS_CIRCLE&&d.isTransformationOrArray(r[1])){u=d.copyAttributes(o,t.options,"circle");a=n.createEllipse(t,[h.center,h.center,function(){return 2*h.Radius()}],u);a.addTransform(r[1]);return a}else{for(c=0;c<r.length;c++){if(d.isPointType(t,r[c])){l=l.concat(d.providePoints(t,[r[c]],o,"circle",["center"]));if(!1===l[l.length-1]){throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}}else{l.push(r[c])}}}u=d.copyAttributes(o,t.options,"circle");if(2===l.length&&d.isPoint(l[0])&&d.isPoint(l[1])){a=new e.Circle(t,"twoPoints",l[0],l[1],u)}else if((d.isNumber(l[0])||d.isFunction(l[0])||d.isString(l[0]))&&d.isPoint(l[1])){a=new e.Circle(t,"pointRadius",l[1],l[0],u)}else if((d.isNumber(l[1])||d.isFunction(l[1])||d.isString(l[1]))&&d.isPoint(l[0])){a=new e.Circle(t,"pointRadius",l[0],l[1],u)}else if(l[0].elementClass===s.OBJECT_CLASS_CIRCLE&&d.isPoint(l[1])){a=new e.Circle(t,"pointCircle",l[1],l[0],u)}else if(l[1].elementClass===s.OBJECT_CLASS_CIRCLE&&d.isPoint(l[0])){a=new e.Circle(t,"pointCircle",l[0],l[1],u)}else if(l[0].elementClass===s.OBJECT_CLASS_LINE&&d.isPoint(l[1])){a=new e.Circle(t,"pointLine",l[1],l[0],u)}else if(l[1].elementClass===s.OBJECT_CLASS_LINE&&d.isPoint(l[0])){a=new e.Circle(t,"pointLine",l[0],l[1],u)}else if(3===r.length&&d.isPoint(l[0])&&d.isPoint(l[1])&&d.isPoint(l[2])){if(e.elements.circumcircle){a=e.elements.circumcircle(t,l,u)}else{throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).")}}else{throw new Error("JSXGraph: Can't create circle with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]")}a.isDraggable=!0;a.setParents(l);a.elType="circle";for(c=0;c<l.length;c++){if(d.isPoint(l[c])){a.inherits.push(l[c])}}return a};e.registerElement("circle",e.createCircle);return{Circle:e.Circle,createCircle:e.createCircle}});define("base/composition",["jxg","utils/type"],function(e,t){"use strict";e.Composition=function(r){var o,s=this,n=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"],a=function(e){return function(){for(var r in s.elements){if(s.elements.hasOwnProperty(r)){if(t.exists(s.elements[r][e])){s.elements[r][e].apply(s.elements[r],arguments)}}}return s}};for(o=0;o<n.length;o++){this[n[o]]=a(n[o])}this.elements={};this.objects=this.elements;this.elementsByName={};this.objectsList=[];this.groups={};this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"};for(o in r){if(r.hasOwnProperty(o)){this.add(o,r[o])}}this.dump=!0;this.subs={}};e.extend(e.Composition.prototype,{add:function add(e,r){if(!t.exists(this[e])&&t.exists(r)){if(t.exists(r.id)){this.elements[r.id]=r}else{this.elements[e]=r}if(t.exists(r.name)){this.elementsByName[r.name]=r}r.on("attribute:name",this.nameListener,this);this.objectsList.push(r);this[e]=r;this.methodMap[e]=r;return!0}return!1},remove:function remove(t){var r=!1,o;for(o in this.elements){if(this.elements.hasOwnProperty(o)){if(this.elements[o].id===this[t].id){r=!0;break}}}if(r){delete this.elements[this[t].id];delete this[t]}return r},nameListener:function nameListener(e,t,r){delete this.elementsByName[e];this.elementsByName[t]=r},select:function select(r){if(t.exists(e.Board)){return e.Board.prototype.select.call(this,r)}return new e.Composition},getParents:function getParents(){return this.parents},getType:function getType(){return this.elType},getAttributes:function getAttributes(){var t={},r;for(r in this.subs){if(this.subs.hasOwnProperty(r)){t[r]=this.subs[r].visProp}}return this.attr}});return e.Composition});define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element","base/line","base/transformation"],function(e,t,r,o,i,s,n){"use strict";e.Polygon=function(r,o,n){this.constructor(r,n,t.OBJECT_TYPE_POLYGON,t.OBJECT_CLASS_AREA);var a,d,c,p,u=s.copyAttributes(n,r.options,"polygon","borders");this.withLines=n.withlines;this.attr_line=u;this.vertices=[];for(a=0;a<o.length;a++){this.vertices[a]=this.board.select(o[a])}if(0<this.vertices.length&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id){this.vertices.push(this.vertices[0])}this.borders=[];if(this.withLines){c=this.vertices.length-1;for(p=0;p<c;p++){a=(p+1)%c;u.id=u.ids&&u.ids[a];u.name=u.names&&u.names[a];u.strokecolor=s.isArray(u.colors)&&u.colors[a%u.colors.length]||u.strokecolor;u.visible=s.exists(n.borders.visible)?n.borders.visible:n.visible;if(!1===u.strokecolor){u.strokecolor="none"}d=r.create("segment",[this.vertices[a],this.vertices[a+1]],u);d.dump=!1;this.borders[a]=d;d.parentPolygon=this}}this.inherits.push(this.vertices,this.borders);this.id=this.board.setId(this,"Py");for(a=0;a<this.vertices.length-1;a++){this.board.select(this.vertices[a]).addChild(this)}this.board.renderer.drawPolygon(this);this.board.finalizeAdding(this);this.createGradient();this.elType="polygon";this.createLabel();this.methodMap=e.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})};e.Polygon.prototype=new n;e.extend(e.Polygon.prototype,{hasPoint:function hasPoint(e,t){var r,o,n,a=!1;if(s.evaluate(this.visProp.hasinnerpoints)){n=this.vertices.length;for(r=0,o=n-2;r<n-1;o=r++){if(this.vertices[r].coords.scrCoords[2]>t!=this.vertices[o].coords.scrCoords[2]>t&&e<(this.vertices[o].coords.scrCoords[1]-this.vertices[r].coords.scrCoords[1])*(t-this.vertices[r].coords.scrCoords[2])/(this.vertices[o].coords.scrCoords[2]-this.vertices[r].coords.scrCoords[2])+this.vertices[r].coords.scrCoords[1]){a=!a}}if(a){return!0}}n=this.borders.length;for(r=0;r<n;r++){if(this.borders[r].hasPoint(e,t)){a=!0;break}}return a},updateRenderer:function updateRenderer(){var e,t;if(!this.needsUpdate){return this}if(this.visPropCalc.visible){t=this.vertices.length;this.isReal=!0;for(e=0;e<t;++e){if(!this.vertices[e].isReal){this.isReal=!1;break}}if(!this.isReal){this.updateVisibility(!1)}}if(this.visPropCalc.visible){this.board.renderer.updatePolygon(this)}if(this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal){this.label.update();this.board.renderer.updateText(this.label)}this.setDisplayRendNode();this.needsUpdate=!1;return this},getTextAnchor:function getTextAnchor(){var e,o,s,n,d;if(0===this.vertices.length){return new r(t.COORDS_BY_USER,[1,0,0],this.board)}e=this.vertices[0].X();o=this.vertices[0].Y();s=e;n=o;for(d=0;d<this.vertices.length;d++){if(this.vertices[d].X()<e){e=this.vertices[d].X()}if(this.vertices[d].X()>s){s=this.vertices[d].X()}if(this.vertices[d].Y()>o){o=this.vertices[d].Y()}if(this.vertices[d].Y()<n){n=this.vertices[d].Y()}}return new r(t.COORDS_BY_USER,[.5*(e+s),.5*(o+n)],this.board)},getLabelAnchor:e.shortcut(e.Polygon.prototype,"getTextAnchor"),cloneToBackground:function cloneToBackground(){var e={},t;e.id=this.id+"T"+this.numTraces;this.numTraces++;e.vertices=this.vertices;e.visProp=s.deepCopy(this.visProp,this.visProp.traceattributes,!0);e.visProp.layer=this.board.options.layer.trace;e.board=this.board;s.clearVisPropOld(e);e.visPropCalc={visible:s.evaluate(e.visProp.visible)};t=this.board.renderer.enhancedRendering;this.board.renderer.enhancedRendering=!0;this.board.renderer.drawPolygon(e);this.board.renderer.enhancedRendering=t;this.traces[e.id]=e.rendNode;return this},hideElement:function hideElement(t){var r;e.deprecated("Element.hideElement()","Element.setDisplayRendNode()");this.visPropCalc.visible=!1;this.board.renderer.display(this,!1);if(!t){for(r=0;r<this.borders.length;r++){this.borders[r].hideElement()}}if(this.hasLabel&&s.exists(this.label)){this.label.hiddenByParent=!0;if(this.label.visPropCalc.visible){this.label.hideElement()}}},showElement:function showElement(t){var r;e.deprecated("Element.showElement()","Element.setDisplayRendNode()");this.visPropCalc.visible=!0;this.board.renderer.display(this,!0);if(!t){for(r=0;r<this.borders.length;r++){this.borders[r].showElement().updateRenderer()}}if(s.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent){this.label.hiddenByParent=!1;if(!this.label.visPropCalc.visible){this.label.showElement().updateRenderer()}}return this},Area:function Area(){return Math.abs(i.signedPolygon(this.vertices,!0))},Perimeter:function Perimeter(){var e,t=this.vertices.length,r=0;for(e=1;e<t;++e){r+=this.vertices[e].Dist(this.vertices[e-1])}return r},boundingBox:function boundingBox(){var e=[0,0,0,0],t,r,o=this.vertices.length-1;if(0==o){return e}e[0]=this.vertices[0].X();e[2]=e[0];e[1]=this.vertices[0].Y();e[3]=e[1];for(t=1;t<o;++t){r=this.vertices[t].X();if(r<e[0]){e[0]=r}else if(r>e[2]){e[2]=r}r=this.vertices[t].Y();if(r>e[1]){e[1]=r}else if(r<e[3]){e[3]=r}}return e},bounds:function bounds(){return this.boundingBox()},remove:function remove(){var e;for(e=0;e<this.borders.length;e++){this.board.removeObject(this.borders[e])}n.prototype.remove.call(this)},findPoint:function findPoint(e){var t;if(!s.isPoint(e)){return-1}for(t=0;t<this.vertices.length;t++){if(this.vertices[t].id===e.id){return t}}return-1},addPoints:function addPoints(){var e=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(e))},insertPoints:function insertPoints(e){var t,r=[],o;if(0===arguments.length){return this}if(0>e||e>this.vertices.length-2){return this}for(t=1;t<arguments.length;t++){if(s.isPoint(arguments[t])){r.push(arguments[t])}}o=this.vertices.slice(0,e+1).concat(r);this.vertices=o.concat(this.vertices.slice(e+1));if(this.withLines){o=this.borders.slice(0,e);this.board.removeObject(this.borders[e]);for(t=0;t<r.length;t++){o.push(this.board.create("segment",[this.vertices[e+t],this.vertices[e+t+1]],this.attr_line))}o.push(this.board.create("segment",[this.vertices[e+r.length],this.vertices[e+r.length+1]],this.attr_line));this.borders=o.concat(this.borders.slice(e+1))}this.board.update();return this},removePoints:function removePoints(){var e,t,r,o=[],n=[],a=[],d=[];this.vertices=this.vertices.slice(0,this.vertices.length-1);for(e=0;e<arguments.length;e++){r=arguments[e];if(s.isPoint(r)){r=this.findPoint(r)}if(s.isNumber(r)&&-1<r&&r<this.vertices.length&&-1===s.indexOf(a,r)){a.push(r)}}for(e=0;e<a.length;e++){this.vertices[a[e]].removeChild(this)}a=a.sort();o=this.vertices.slice();n=this.borders.slice();if(this.withLines){d.push([a[a.length-1]])}for(e=a.length-1;-1<e;e--){o[a[e]]=-1;if(this.withLines&&a[e]-1>a[e-1]){d[d.length-1][1]=a[e];d.push([a[e-1]])}}if(this.withLines){d[d.length-1][1]=a[0]}this.vertices=[];for(e=0;e<o.length;e++){if(s.isPoint(o[e])){this.vertices.push(o[e])}}if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id){this.vertices.push(this.vertices[0])}if(this.withLines){for(e=0;e<d.length;e++){for(t=d[e][1]-1;t<d[e][0]+1;t++){if(0>t){t=0;this.board.removeObject(this.borders[n.length-1]);n[n.length-1]=-1}else if(t>n.length-1){t=n.length-1}this.board.removeObject(this.borders[t]);n[t]=-1}if(0!==d[e][1]&&d[e][0]!==o.length-1){n[d[e][0]-1]=this.board.create("segment",[o[Math.max(d[e][1]-1,0)],o[Math.min(d[e][0]+1,this.vertices.length-1)]],this.attr_line)}}this.borders=[];for(e=0;e<n.length;e++){if(-1!==n[e]){this.borders.push(n[e])}}if(d[0][1]===this.vertices.length-1||0===d[d.length-1][1]){this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}}this.board.update();return this},getParents:function getParents(){this.setParents(this.vertices);return this.parents},getAttributes:function getAttributes(){var e=n.prototype.getAttributes.call(this),t;if(this.withLines){e.lines=e.lines||{};e.lines.ids=[];e.lines.colors=[];for(t=0;t<this.borders.length;t++){e.lines.ids.push(this.borders[t].id);e.lines.colors.push(this.borders[t].visProp.strokecolor)}}return e},snapToGrid:function snapToGrid(){var e,t;if(s.evaluate(this.visProp.snaptogrid)){t=!0}else{t=!1}for(e=0;e<this.vertices.length;e++){this.vertices[e].handleSnapToGrid(t,!0)}},setPositionDirectly:function setPositionDirectly(e,s,n){var a,d,l,p,u=new r(e,s,this.board),c=new r(e,n,this.board);p=this.vertices.length-1;for(l=0;l<p;l++){if(!this.vertices[l].draggable()){return this}}a=o.subtract(u.usrCoords,c.usrCoords);d=this.board.create("transform",a.slice(1),{type:"translate"});d.applyOnce(this.vertices.slice(0,-1));return this},sutherlandHodgman:function sutherlandHodgman(t){var r=e.Math.Geometry.sortVertices(this.vertices),o=e.Math.Geometry.sortVertices(t.vertices),s=r.length-1,n=o.length-1,a,d=[],l,c,p,u,h,m,g=function(e,t,r){return 0<=(t[1]-e[1])*(r[2]-e[2])-(t[2]-e[2])*(r[1]-e[1])};for(c=0;c<n;c++){d.push(o[c])}for(c=0;c<s;c++){l=d.slice(0);a=l.length;d=[];u=l[a-1];for(p=0;p<a;p++){h=l[p];if(g(r[c],r[c+1],h)){if(!g(r[c],r[c+1],u)){m=e.Math.Geometry.meetSegmentSegment(u,h,r[c],r[c+1]);m[0][1]/=m[0][0];m[0][2]/=m[0][0];m[0][0]=1;d.push(m[0])}d.push(h)}else if(g(r[c],r[c+1],u)){m=e.Math.Geometry.meetSegmentSegment(u,h,r[c],r[c+1]);m[0][1]/=m[0][0];m[0][2]/=m[0][0];m[0][0]=1;d.push(m[0])}u=h}}return d},intersect:function intersect(e){return this.sutherlandHodgman(e)}});e.createPolygon=function(r,o,n){var a,d,l,c,p=[],u,h,m=!1;u=s.copyAttributes(n,r.options,"polygon");c=r.select(o[0]);if(s.isObject(c)&&c.type===t.OBJECT_TYPE_POLYGON&&s.isTransformationOrArray(o[1])){m=!0;l=c.vertices.length-1;h=s.copyAttributes(n,r.options,"polygon","vertices");for(d=0;d<l;d++){if(h.withlabel){h.name=""===c.vertices[d].name?"":c.vertices[d].name+"'"}p.push(r.create("point",[c.vertices[d],o[1]],h))}}else{p=s.providePoints(r,o,n,"polygon",["vertices"]);if(!1===p){throw new Error("JSXGraph: Can't create polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied")}}u=s.copyAttributes(n,r.options,"polygon");a=new e.Polygon(r,p,u);a.isDraggable=!0;if(m){l=c.vertices.length-1;for(d=0;d<l;d++){p[d].prepareUpdate().update().updateVisibility(s.evaluate(a.visProp.visible)).updateRenderer()}}return a};e.createRegularPolygon=function(e,r,o){var a,d,l,c=[],u,h,m,g;h=r.length;l=r[h-1];if(s.isNumber(l)&&(3!==r.length||3>l)){throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.")}if(s.isNumber(e.select(l))){h--;m=!1}else{l=h;m=!0}c=s.providePoints(e,r.slice(0,h),o,"regularpolygon",["vertices"]);if(!1===c){throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates")}g=s.copyAttributes(o,e.options,"regularpolygon","vertices");for(d=2;d<l;d++){u=e.create("transform",[Math.PI*(2-(l-2)/l),c[d-1]],{type:"rotate"});if(m){c[d].addTransform(c[d-2],u);c[d].fullUpdate()}else{if(s.isArray(g.ids)&&g.ids.length>=l-2){g.id=g.ids[d-2]}c[d]=e.create("point",[c[d-2],u],g);c[d].type=t.OBJECT_TYPE_CAS;c[d].isDraggable=!0;c[d].visProp.fixed=!1}}g=s.copyAttributes(o,e.options,"regularpolygon");a=e.create("polygon",c,g);a.elType="regularpolygon";return a};e.registerElement("polygon",e.createPolygon);e.registerElement("regularpolygon",e.createRegularPolygon);return{Polygon:e.Polygon,createPolygon:e.createPolygon,createRegularPolygon:e.createRegularPolygon}});define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants","base/curve","element/composition"],function(e,t,r,o,i,s,n){"use strict";e.createArc=function(a,d,l){var c,p,u;u=s.providePoints(a,d,l,"arc",["center","radiuspoint","anglepoint"]);if(!1===u||3>u.length){throw new Error("JSXGraph: Can't create Arc with parent types '"+_typeof(d[0])+"' and '"+_typeof(d[1])+"' and '"+_typeof(d[2])+"'.\nPossible parent types: [point,point,point], [arc, transformation]")}p=s.copyAttributes(l,a.options,"arc");c=a.create("curve",[[0],[0]],p);c.elType="arc";c.setParents(u);c.type=n.OBJECT_TYPE_ARC;c.center=u[0];c.radiuspoint=u[1];c.point2=c.radiuspoint;c.anglepoint=u[2];c.point3=c.anglepoint;c.center.addChild(c);c.radiuspoint.addChild(c);c.anglepoint.addChild(c);c.useDirection=p.usedirection;c.updateDataArray=function(){var e,r,o,i,n,a,d=1,l=this.radiuspoint,c=this.center,p=this.anglepoint,h=s.evaluate(this.visProp.selection);r=t.rad(l,c,p);if("minor"===h&&r>Math.PI||"major"===h&&r<Math.PI){d=-1}if(this.useDirection){i=u[1].coords.usrCoords;n=u[3].coords.usrCoords;a=u[2].coords.usrCoords;o=(i[1]-a[1])*(i[2]-n[2])-(i[2]-a[2])*(i[1]-n[1]);if(0>o){this.radiuspoint=u[1];this.anglepoint=u[2]}else{this.radiuspoint=u[2];this.anglepoint=u[1]}}l=l.coords.usrCoords;c=c.coords.usrCoords;p=p.coords.usrCoords;e=t.bezierArc(l,c,p,!1,d);this.dataX=e[0];this.dataY=e[1];this.bezierDegree=3;this.updateStdform();this.updateQuadraticform()};c.Radius=function(){return this.radiuspoint.Dist(this.center)};c.getRadius=function(){e.deprecated("Arc.getRadius()","Arc.Radius()");return this.Radius()};c.Value=function(){return this.Radius()*t.rad(this.radiuspoint,this.center,this.anglepoint)};c.hasPoint=function(e,i){var a,d,l,p,u,h,m,g,b,C=this.Radius(),y=s.evaluate(this.visProp.selection);if(s.evaluate(this.visProp.hasinnerpoints)){return this.hasPointSector(e,i)}b=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY);d=new o(n.COORDS_BY_SCREEN,[e,i],this.board);if(0<this.transformations.length){this.updateTransformMatrix();m=r.inverse(this.transformMat);g=r.matVecMult(m,d.usrCoords);d=new o(n.COORDS_BY_USER,g,this.board)}a=this.center.coords.distance(n.COORDS_BY_USER,d);l=Math.abs(a-C)<b;if(l){p=t.rad(this.radiuspoint,this.center,d.usrCoords.slice(1));u=0;h=t.rad(this.radiuspoint,this.center,this.anglepoint);if("minor"===y&&h>Math.PI||"major"===y&&h<Math.PI){u=h;h=2*Math.PI}if(p<u||p>h){l=!1}}return l};c.hasPointSector=function(e,i){var a,d,l,c=new o(n.COORDS_BY_SCREEN,[e,i],this.board),p=this.Radius(),r=this.center.coords.distance(n.COORDS_BY_USER,c),u=r<p,h=s.evaluate(this.visProp.selection);if(u){a=t.rad(this.radiuspoint,this.center,c.usrCoords.slice(1));d=0;l=t.rad(this.radiuspoint,this.center,this.anglepoint);if("minor"===h&&l>Math.PI||"major"===h&&l<Math.PI){d=l;l=2*Math.PI}if(a<d||a>l){u=!1}}return u};c.getTextAnchor=function(){return this.center.coords};c.getLabelAnchor=function(){var e,r,i,a,d,l=t.rad(this.radiuspoint,this.center,this.anglepoint),c=10/this.board.unitX,p=10/this.board.unitY,u=this.point2.coords.usrCoords,h=this.center.coords.usrCoords,m=u[1]-h[1],g=u[2]-h[2],b=s.evaluate(this.visProp.selection),C=this.label?this.label.visProp:this.visProp.label;if("minor"===b&&l>Math.PI||"major"===b&&l<Math.PI){l=-(2*Math.PI-l)}e=new o(n.COORDS_BY_USER,[h[1]+Math.cos(.5*l)*m-Math.sin(.5*l)*g,h[2]+Math.sin(.5*l)*m+Math.cos(.5*l)*g],this.board);i=e.usrCoords[1]-h[1];a=e.usrCoords[2]-h[2];d=Math.sqrt(i*i+a*a);i=i*(d+c)/d;a=a*(d+p)/d;r=[h[1]+i,h[2]+a];C.position=t.calcLabelQuadrant(t.rad([1,0],[0,0],r));return new o(n.COORDS_BY_USER,r,this.board)};c.updateQuadraticform=i.Circle.prototype.updateQuadraticform;c.updateStdform=i.Circle.prototype.updateStdform;c.methodMap=e.deepCopy(c.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"});c.prepareUpdate().update();return c};e.registerElement("arc",e.createArc);e.createSemicircle=function(e,t,r){var o,i,n,a;a=s.providePoints(e,t,r,"point");if(!1===a||2!==a.length){throw new Error("JSXGraph: Can't create Semicircle with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [point,point]")}n=s.copyAttributes(r,e.options,"semicircle","center");i=e.create("midpoint",a,n);i.dump=!1;n=s.copyAttributes(r,e.options,"semicircle");o=e.create("arc",[i,a[1],a[0]],n);o.elType="semicircle";o.setParents([a[0].id,a[1].id]);o.subs={midpoint:i};o.inherits.push(i);o.midpoint=o.center=i;return o};e.registerElement("semicircle",e.createSemicircle);e.createCircumcircleArc=function(e,t,r){var o,i,n,a;a=s.providePoints(e,t,r,"point");if(!1===a||3!==a.length){throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"' and '"+_typeof(t[2])+"'.\nPossible parent types: [point,point,point]")}n=s.copyAttributes(r,e.options,"circumcirclearc","center");i=e.create("circumcenter",a,n);i.dump=!1;n=s.copyAttributes(r,e.options,"circumcirclearc");n.usedirection=!0;o=e.create("arc",[i,a[0],a[2],a[1]],n);o.elType="circumcirclearc";o.setParents([a[0].id,a[1].id,a[2].id]);o.subs={center:i};o.inherits.push(i);o.center=i;return o};e.registerElement("circumcirclearc",e.createCircumcircleArc);e.createMinorArc=function(t,r,o){o.selection="minor";return e.createArc(t,r,o)};e.registerElement("minorarc",e.createMinorArc);e.createMajorArc=function(t,r,o){o.selection="major";return e.createArc(t,r,o)};e.registerElement("majorarc",e.createMajorArc);return{createArc:e.createArc,createSemicircle:e.createSemicircle,createCircumcircleArc:e.createCircumcircleArc,createMinorArc:e.createMinorArc,createMajorArc:e.createMajorArc}});define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type","base/point","base/curve","base/transformation","element/composition"],function(e,t,o,i,s,n,a){"use strict";e.createSector=function(r,d,l){var p,c,u="invalid",h,m,g;if(d[0].elementClass===n.OBJECT_CLASS_LINE&&d[1].elementClass===n.OBJECT_CLASS_LINE&&(a.isArray(d[2])||a.isNumber(d[2]))&&(a.isArray(d[3])||a.isNumber(d[3]))&&(a.isNumber(d[4])||a.isFunction(d[4]))){u="2lines"}else{g=a.providePoints(r,d,l,"sector",["center","radiuspoint","anglepoint"]);if(!1===g){throw new Error("JSXGraph: Can't create Sector with parent types '"+_typeof(d[0])+"' and '"+_typeof(d[1])+"' and '"+_typeof(d[2])+"'.")}u="3points"}c=a.copyAttributes(l,r.options,"sector");p=r.create("curve",[[0],[0]],c);p.type=n.OBJECT_TYPE_SECTOR;p.elType="sector";if("2lines"==u){p.Radius=function(){return a.evaluate(d[4])};p.line1=r.select(d[0]);p.line2=r.select(d[1]);p.line1.addChild(p);p.line2.addChild(p);p.setParents(d);p.point1={visProp:{}};p.point2={visProp:{}};p.point3={visProp:{}};h=t.meetLineLine(p.line1.stdform,p.line2.stdform,0,r);if(a.isArray(d[2])){if(2===d[2].length){d[2]=[1].concat(d[2])}m=t.projectPointToLine({coords:{usrCoords:d[2]}},p.line1,r);m=i.subtract(m.usrCoords,h.usrCoords);p.direction1=0<=o.innerProduct(m,[0,p.line1.stdform[2],-p.line1.stdform[1]],3)?1:-1}else{p.direction1=0<=d[2]?1:-1}if(a.isArray(d[3])){if(2===d[3].length){d[3]=[1].concat(d[3])}m=t.projectPointToLine({coords:{usrCoords:d[3]}},p.line2,r);m=i.subtract(m.usrCoords,h.usrCoords);p.direction2=0<=o.innerProduct(m,[0,p.line2.stdform[2],-p.line2.stdform[1]],3)?1:-1}else{p.direction2=0<=d[3]?1:-1}p.updateDataArray=function(){var e,a,d,l=[0,0,0],c=[0,0,0],u=[0,0,0],h;a=this.line1;d=this.line2;c=o.crossProduct(a.stdform,d.stdform);if(Math.abs(c[0])>o.eps*o.eps){c[1]/=c[0];c[2]/=c[0];c[0]/=c[0]}e=this.direction1*this.Radius();l=i.add(c,[0,e*a.stdform[2],-e*a.stdform[1]]);e=this.direction2*this.Radius();u=i.add(c,[0,e*d.stdform[2],-e*d.stdform[1]]);this.point2.coords=new s(n.COORDS_BY_USER,l,p.board);this.point1.coords=new s(n.COORDS_BY_USER,c,p.board);this.point3.coords=new s(n.COORDS_BY_USER,u,p.board);if(Math.abs(l[0])<o.eps||Math.abs(c[0])<o.eps||Math.abs(u[0])<o.eps){this.dataX=[NaN];this.dataY=[NaN];return}h=t.bezierArc(l,c,u,!0,1);this.dataX=h[0];this.dataY=h[1];this.bezierDegree=3};p.methodMap=e.deepCopy(p.methodMap,{radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"});p.prepareUpdate().update()}else if("3points"==u){p.point1=g[0];p.point2=g[1];p.point3=g[2];p.point1.addChild(p);p.point2.addChild(p);p.point3.addChild(p);p.useDirection=l.usedirection;p.setParents(g);if(a.exists(g[3])){p.point4=g[3];p.point4.addChild(p)}p.methodMap=e.deepCopy(p.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"});p.updateDataArray=function(){var e,r,o,i,s,n=this.point2,d=this.point1,l=this.point3,c,p=1,u=a.evaluate(this.visProp.selection);if(!n.isReal||!d.isReal||!l.isReal){this.dataX=[NaN];this.dataY=[NaN];return}c=t.rad(n,d,l);if("minor"===u&&c>Math.PI||"major"===u&&c<Math.PI){p=-1}if(this.useDirection&&a.exists(this.point4)){o=this.point2.coords.usrCoords;i=this.point4.coords.usrCoords;s=this.point3.coords.usrCoords;r=(o[1]-s[1])*(o[2]-i[2])-(o[2]-s[2])*(o[1]-i[1]);if(0<=r){l=this.point2;n=this.point3}}n=n.coords.usrCoords;d=d.coords.usrCoords;l=l.coords.usrCoords;e=t.bezierArc(n,d,l,!0,p);this.dataX=e[0];this.dataY=e[1];this.bezierDegree=3};p.Radius=function(){return this.point2.Dist(this.point1)};c=a.copyAttributes(l,r.options,"sector","arc");c.withLabel=!1;c.name+="_arc";p.arc=r.create("arc",[p.point1,p.point2,p.point3],c);p.addChild(p.arc)}p.center=p.point1;p.radiuspoint=p.point2;p.anglepoint=p.point3;p.hasPointCurve=function(e,o){var i,d,l,c,p=new s(n.COORDS_BY_SCREEN,[e,o],this.board),u=this.Radius(),r=this.center.coords.distance(n.COORDS_BY_USER,p),h,m=a.evaluate(this.visProp.selection);c=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY);h=Math.abs(r-u)<c;if(h){i=t.rad(this.point2,this.center,p.usrCoords.slice(1));d=0;l=t.rad(this.point2,this.center,this.point3);if("minor"===m&&l>Math.PI||"major"===m&&l<Math.PI){d=l;l=2*Math.PI}if(i<d||i>l){h=!1}}return h};p.hasPointSector=function(e,o){var i,d=new s(n.COORDS_BY_SCREEN,[e,o],this.board),l=this.Radius(),r=this.point1.coords.distance(n.COORDS_BY_USER,d),c,p,u=r<l,h=a.evaluate(this.visProp.selection);if(u){i=t.rad(this.radiuspoint,this.center,d.usrCoords.slice(1));c=0;p=t.rad(this.radiuspoint,this.center,this.anglepoint);if("minor"===h&&p>Math.PI||"major"===h&&p<Math.PI){c=p;p=2*Math.PI}if(i<c||i>p){u=!1}}return u};p.hasPoint=function(e,t){if(a.evaluate(this.visProp.highlightonsector)||a.evaluate(this.visProp.hasinnerpoints)){return this.hasPointSector(e,t)}return this.hasPointCurve(e,t)};p.getTextAnchor=function(){return this.point1.coords};p.getLabelAnchor=function(){var e,r,o,i,d,l=t.rad(this.point2,this.point1,this.point3),c=13/this.board.unitX,p=13/this.board.unitY,u=this.point2.coords.usrCoords,h=this.point1.coords.usrCoords,m=u[1]-h[1],g=u[2]-h[2],b=a.evaluate(this.visProp.selection),C=this.label?this.label.visProp:this.visProp.label;if("minor"===b&&l>Math.PI||"major"===b&&l<Math.PI){l=-(2*Math.PI-l)}e=new s(n.COORDS_BY_USER,[h[1]+Math.cos(.5*l)*m-Math.sin(.5*l)*g,h[2]+Math.sin(.5*l)*m+Math.cos(.5*l)*g],this.board);o=e.usrCoords[1]-h[1];i=e.usrCoords[2]-h[2];d=Math.sqrt(o*o+i*i);o=o*(d+c)/d;i=i*(d+p)/d;r=[h[1]+o,h[2]+i];C.position=t.calcLabelQuadrant(t.rad([1,0],[0,0],r));return new s(n.COORDS_BY_USER,r,this.board)};p.setRadius=function(e){p.Radius=function(){return a.evaluate(e)}};p.getRadius=function(){e.deprecated("Sector.getRadius()","Sector.Radius()");return this.Radius()};if("3points"==u){p.setPositionDirectly=function(e,r,o){var n,a,d=new s(e,r,this.board),l=new s(e,o,this.board);if(!p.point1.draggable()||!p.point2.draggable()||!p.point3.draggable()){return this}n=i.subtract(d.usrCoords,l.usrCoords);a=this.board.create("transform",n.slice(1),{type:"translate"});a.applyOnce([p.point1,p.point2,p.point3]);return this}}p.prepareUpdate().update();return p};e.registerElement("sector",e.createSector);e.createCircumcircleSector=function(e,t,r){var o,i,s,n;n=a.providePoints(e,t,r,"point");if(!1===n){throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"' and '"+_typeof(t[2])+"'.")}i=e.create("circumcenter",n.slice(0,3),s);i.dump=!1;s=a.copyAttributes(r,e.options,"circumcirclesector");o=e.create("sector",[i,n[0],n[2],n[1]],s);o.elType="circumcirclesector";o.setParents(n);o.center=i;o.subs={center:i};return o};e.registerElement("circumcirclesector",e.createCircumcircleSector);e.createMinorSector=function(t,r,o){o.selection="minor";return e.createSector(t,r,o)};e.registerElement("minorsector",e.createMinorSector);e.createMajorSector=function(t,r,o){o.selection="major";return e.createSector(t,r,o)};e.registerElement("majorsector",e.createMajorSector);e.createAngle=function(e,r,d){var l,c,p,u,h,m,g="invalid";if(r[0].elementClass===n.OBJECT_CLASS_LINE&&r[1].elementClass===n.OBJECT_CLASS_LINE&&(a.isArray(r[2])||a.isNumber(r[2]))&&(a.isArray(r[3])||a.isNumber(r[3]))){g="2lines"}else{m=a.providePoints(e,r,d,"point");if(!1===m){throw new Error("JSXGraph: Can't create angle with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"' and '"+_typeof(r[2])+"'.")}g="3points"}p=a.copyAttributes(d,e.options,"angle");if(!a.exists(p.name)||""===p.name){p.name=e.generateName({type:n.OBJECT_TYPE_ANGLE})}if(a.exists(p.radius)){c=p.radius}else{c=0}if("2lines"==g){r.push(c);l=e.create("sector",r,p);l.updateDataArraySector=l.updateDataArray;l.setAngle=function(){};l.free=function(){}}else{l=e.create("sector",[m[1],m[0],m[2]],p);l.arc.visProp.priv=!0;l.point=l.point2=l.radiuspoint=m[0];l.pointsquare=l.point3=l.anglepoint=m[2];l.Radius=function(){return a.evaluate(c)};l.updateDataArraySector=function(){var e=this.point2,o=this.point1,i=this.point3,s=this.Radius(),r=o.Dist(e),n,d,l=1,c=a.evaluate(this.visProp.selection);d=t.rad(e,o,i);if("minor"===c&&d>Math.PI||"major"===c&&d<Math.PI){l=-1}e=e.coords.usrCoords;o=o.coords.usrCoords;i=i.coords.usrCoords;e=[1,o[1]+(e[1]-o[1])*s/r,o[2]+(e[2]-o[2])*s/r];i=[1,o[1]+(i[1]-o[1])*s/r,o[2]+(i[2]-o[2])*s/r];n=t.bezierArc(e,o,i,!0,l);this.dataX=n[0];this.dataY=n[1];this.bezierDegree=3};l.setAngle=function(e){var r,o=this.anglepoint,i=this.radiuspoint;if(o.draggable()){r=this.board.create("transform",[e,this.center],{type:"rotate"});o.addTransform(i,r);o.isDraggable=!1;o.setParents(i)}return this};l.free=function(){var e=this.anglepoint;if(0<e.transformations.length){e.transformations.pop();e.isDraggable=!0;e.parents=[]}return this};l.setParents(m)}if(a.exists(l.visProp.text)){l.label.setText(a.evaluate(l.visProp.text))}l.elType="angle";l.type=n.OBJECT_TYPE_ANGLE;l.subs={};l.updateDataArraySquare=function(){var e,i,s,n=this.Radius(),r,a,d,l,c;if("2lines"==g){this.updateDataArraySector()}e=this.point2;i=this.point1;s=this.point3;e=e.coords.usrCoords;i=i.coords.usrCoords;s=s.coords.usrCoords;r=t.distance(e,i,3);a=t.distance(s,i,3);e=[1,i[1]+(e[1]-i[1])*n/r,i[2]+(e[2]-i[2])*n/r];s=[1,i[1]+(s[1]-i[1])*n/a,i[2]+(s[2]-i[2])*n/a];d=o.crossProduct(s,i);l=[-e[1]*d[1]-e[2]*d[2],e[0]*d[1],e[0]*d[2]];d=o.crossProduct(e,i);c=[-s[1]*d[1]-s[2]*d[2],s[0]*d[1],s[0]*d[2]];d=o.crossProduct(l,c);d[1]/=d[0];d[2]/=d[0];this.dataX=[i[1],e[1],d[1],s[1],i[1]];this.dataY=[i[2],e[2],d[2],s[2],i[2]];this.bezierDegree=1};l.updateDataArrayNone=function(){this.dataX=[NaN];this.dataY=[NaN];this.bezierDegree=1};l.updateDataArray=function(){var e=a.evaluate(this.visProp.type),r=t.trueAngle(this.point2,this.point1,this.point3),i=a.evaluate(this.visProp.selection);if("minor"===i&&180<r||"major"===i&&180>r){r=360-r}if(Math.abs(r-90)<a.evaluate(this.visProp.orthosensitivity)+o.eps){e=a.evaluate(this.visProp.orthotype)}if("none"===e){this.updateDataArrayNone()}else if("square"===e){this.updateDataArraySquare()}else if("sector"===e){this.updateDataArraySector()}else if("sectordot"===e){this.updateDataArraySector();if(!this.dot.visProp.visible){this.dot.setAttribute({visible:!0})}}if(!this.visProp.visible||"sectordot"!==e&&this.dot.visProp.visible){this.dot.setAttribute({visible:!1})}};u=a.copyAttributes(d,e.options,"angle","dot");l.dot=e.create("point",[function(){var e,i,s,n,c,p,u,h,m;if(a.exists(l.dot)&&!l.dot.visProp.visible){return[0,0]}e=l.point2.coords.usrCoords;i=l.point1.coords.usrCoords;s=l.Radius();n=t.distance(e,i,3);c=t.rad(l.point2,l.point1,l.point3);m=a.evaluate(l.visProp.selection);if("minor"===m&&c>Math.PI||"major"===m&&c<Math.PI){c=-(2*Math.PI-c)}c*=.5;p=Math.cos(c);u=Math.sin(c);e=[1,i[1]+(e[1]-i[1])*s/n,i[2]+(e[2]-i[2])*s/n];h=[[1,0,0],[i[1]-.5*i[1]*p+.5*i[2]*u,.5*p,.5*-u],[i[2]-.5*i[1]*u-.5*i[2]*p,.5*u,.5*p]];return o.matVecMult(h,e)}],u);l.dot.dump=!1;l.subs.dot=l.dot;if("2lines"==g){for(h=0;2>h;h++){e.select(r[h]).addChild(l.dot)}}else{for(h=0;3>h;h++){e.select(m[h]).addChild(l.dot)}}l.getLabelAnchor=function(){var e,i=12,c,p,u,h,m,g,b,C,y=a.evaluate(l.visProp.selection),v=this.label?this.label.visProp:this.visProp.label;if(a.exists(this.label.visProp.fontSize)){i=dy=a.evaluate(this.label.visProp.fontSize)}i/=this.board.unitX;c=l.point2.coords.usrCoords;p=l.point1.coords.usrCoords;u=l.Radius();h=t.distance(c,p,3);m=t.rad(l.point2,l.point1,l.point3);if("minor"===y&&m>Math.PI||"major"===y&&m<Math.PI){m=-(2*Math.PI-m)}m*=.5;g=Math.cos(m);b=Math.sin(m);c=[1,p[1]+(c[1]-p[1])*u/h,p[2]+(c[2]-p[2])*u/h];C=[[1,0,0],[p[1]-.5*p[1]*g+.5*p[2]*b,.5*g,.5*-b],[p[2]-.5*p[1]*b-.5*p[2]*g,.5*b,.5*g]];e=o.matVecMult(C,c);e[1]/=e[0];e[2]/=e[0];e[0]/=e[0];h=t.distance(e,p,3);e=[e[0],p[1]+(e[1]-p[1])*(u+i)/h,p[2]+(e[2]-p[2])*(u+i)/h];v.position=t.calcLabelQuadrant(t.rad([1,0],[0,0],e));return new s(n.COORDS_BY_USER,e,this.board)};l.Value=function(){return t.rad(this.point2,this.point1,this.point3)};l.methodMap=a.deepCopy(l.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"});return l};e.registerElement("angle",e.createAngle);e.createNonreflexAngle=function(r,o,i){var s;i.selection="minor";s=e.createAngle(r,o,i);s.Value=function(){var e=t.rad(this.point2,this.point1,this.point3);return e<Math.PI?e:2*Math.PI-e};return s};e.registerElement("nonreflexangle",e.createNonreflexAngle);e.createReflexAngle=function(r,o,i){var s;i.selection="major";s=e.createAngle(r,o,i);s.Value=function(){var e=t.rad(this.point2,this.point1,this.point3);return e>=Math.PI?e:2*Math.PI-e};return s};e.registerElement("reflexangle",e.createReflexAngle);return{createSector:e.createSector,createCircumcircleSector:e.createCircumcircleSector,createMinorSector:e.createMinorSector,createMajorSector:e.createMajorSector,createAngle:e.createAngle,createReflexAngle:e.createReflexAngle,createNonreflexAngle:e.createNonreflexAngle}});define("element/composition",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/text","base/polygon","element/arc","element/sector"],function(e,t,r,o,i,s,n,d,l,c,u,h,m,g,b,C){"use strict";e.createOrthogonalProjection=function(e,o,i){var s,a,c,u;o[0]=e.select(o[0]);o[1]=e.select(o[1]);if(n.isPointType(e,o[0])&&o[1].elementClass===d.OBJECT_CLASS_LINE){a=n.providePoints(e,[o[0]],i,"point")[0];s=o[1]}else if(n.isPointType(e,o[1])&&o[0].elementClass===d.OBJECT_CLASS_LINE){a=n.providePoints(e,[o[1]],i,"point")[0];s=o[0]}else{throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'.\nPossible parent types: [point,line]")}u=n.copyAttributes(i,e.options,"orthogonalprojection");c=e.create("point",[function(){return r.projectPointToLine(a,s,e)}],u);a.addChild(c);s.addChild(c);c.elType="orthogonalprojection";c.setParents([a.id,c.id]);c.update();c.generatePolynomial=function(){var e=s.point1.symbolic.x,t=s.point1.symbolic.y,r=s.point2.symbolic.x,o=s.point2.symbolic.y,i=a.symbolic.x,n=a.symbolic.y,d=c.symbolic.x,l=c.symbolic.y;return["("+t+")*("+d+")-("+t+")*("+r+")+("+l+")*("+r+")-("+e+")*("+l+")+("+e+")*("+o+")-("+d+")*("+o+")","("+n+")*("+t+")-("+n+")*("+o+")-("+l+")*("+t+")+("+l+")*("+o+")+("+i+")*("+e+")-("+i+")*("+r+")-("+d+")*("+e+")+("+d+")*("+r+")"]};return c};e.createPerpendicular=function(e,t,r){var o,i,s,a;t[0]=e.select(t[0]);t[1]=e.select(t[1]);if(n.isPointType(e,t[0])&&t[1].elementClass===d.OBJECT_CLASS_LINE){i=t[1];o=n.providePoints(e,[t[0]],r,"point")[0]}else if(n.isPointType(e,t[1])&&t[0].elementClass===d.OBJECT_CLASS_LINE){i=t[0];o=n.providePoints(e,[t[1]],r,"point")[0]}else{throw new Error("JSXGraph: Can't create perpendicular with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [line,point]")}a=n.copyAttributes(r,e.options,"perpendicular");s=c.createLine(e,[function(){return i.stdform[2]*o.X()-i.stdform[1]*o.Y()},function(){return-i.stdform[2]*o.Z()},function(){return i.stdform[1]*o.Z()}],a);s.elType="perpendicular";s.setParents([i.id,o.id]);return s};e.createPerpendicularPoint=function(e,o,i){var s,a,c;o[0]=e.select(o[0]);o[1]=e.select(o[1]);if(n.isPointType(e,o[0])&&o[1].elementClass===d.OBJECT_CLASS_LINE){a=n.providePoints(e,[o[0]],i,"point")[0];s=o[1]}else if(n.isPointType(e,o[1])&&o[0].elementClass===d.OBJECT_CLASS_LINE){a=n.providePoints(e,[o[1]],i,"point")[0];s=o[0]}else{throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'.\nPossible parent types: [point,line]")}c=e.create("point",[function(){return r.perpendicular(s,a,e)[0]}],i);a.addChild(c);s.addChild(c);c.elType="perpendicularpoint";c.setParents([a.id,s.id]);c.update();c.generatePolynomial=function(){var e=s.point1.symbolic.x,t=s.point1.symbolic.y,r=s.point2.symbolic.x,o=s.point2.symbolic.y,i=a.symbolic.x,n=a.symbolic.y,d=c.symbolic.x,l=c.symbolic.y;return["("+t+")*("+d+")-("+t+")*("+r+")+("+l+")*("+r+")-("+e+")*("+l+")+("+e+")*("+o+")-("+d+")*("+o+")","("+n+")*("+t+")-("+n+")*("+o+")-("+l+")*("+t+")+("+l+")*("+o+")+("+i+")*("+e+")-("+i+")*("+r+")-("+d+")*("+e+")+("+d+")*("+r+")"]};return c};e.createPerpendicularSegment=function(o,i,s){var a,u,h,m,g;i[0]=o.select(i[0]);i[1]=o.select(i[1]);if(n.isPointType(o,i[0])&&i[1].elementClass===d.OBJECT_CLASS_LINE){u=i[1];a=n.providePoints(o,[i[0]],s,"point")[0]}else if(n.isPointType(o,i[1])&&i[0].elementClass===d.OBJECT_CLASS_LINE){u=i[0];a=n.providePoints(o,[i[1]],s,"point")[0]}else{throw new Error("JSXGraph: Can't create perpendicular with parent types '"+_typeof(i[0])+"' and '"+_typeof(i[1])+"'.\nPossible parent types: [line,point]")}g=n.copyAttributes(s,o.options,"perpendicularsegment","point");m=e.createPerpendicularPoint(o,[u,a],g);m.dump=!1;if(!n.exists(s.layer)){s.layer=o.options.layer.line}g=n.copyAttributes(s,o.options,"perpendicularsegment");h=c.createLine(o,[function(){return r.perpendicular(u,a,o)[1]?[m,a]:[a,m]}],g);h.point=m;h.elType="perpendicularsegment";h.setParents([a.id,u.id]);h.subs={point:m};h.inherits.push(m);return h};e.createMidpoint=function(e,r,o){var s,l,c,p,u;for(p=0;p<r.length;++p){r[p]=e.select(r[p])}if(2===r.length&&n.isPointType(e,r[0])&&n.isPointType(e,r[1])){r=n.providePoints(e,r,o,"point");s=r[0];l=r[1]}else if(1===r.length&&r[0].elementClass===d.OBJECT_CLASS_LINE){s=r[0].point1;l=r[0].point2}else{throw new Error("JSXGraph: Can't create midpoint.\nPossible parent types: [point,point], [line]")}u=n.copyAttributes(o,e.options,"midpoint");c=e.create("point",[function(){var e=s.coords.usrCoords[1]+l.coords.usrCoords[1];if(isNaN(e)||Math.abs(s.coords.usrCoords[0])<t.eps||Math.abs(l.coords.usrCoords[0])<t.eps){return NaN}return .5*e},function(){var e=s.coords.usrCoords[2]+l.coords.usrCoords[2];if(isNaN(e)||Math.abs(s.coords.usrCoords[0])<t.eps||Math.abs(l.coords.usrCoords[0])<t.eps){return NaN}return .5*e}],u);s.addChild(c);l.addChild(c);c.elType="midpoint";c.setParents([s.id,l.id]);c.prepareUpdate().update();c.generatePolynomial=function(){var e=s.symbolic.x,t=s.symbolic.y,r=l.symbolic.x,o=l.symbolic.y,i=c.symbolic.x,n=c.symbolic.y;return["("+t+")*("+i+")-("+t+")*("+r+")+("+n+")*("+r+")-("+e+")*("+n+")+("+e+")*("+o+")-("+i+")*("+o+")","("+e+")^2 - 2*("+e+")*("+i+")+("+t+")^2-2*("+t+")*("+n+")-("+r+")^2+2*("+r+")*("+i+")-("+o+")^2+2*("+o+")*("+n+")"]};return c};e.createParallelPoint=function(e,t,r){var o,s,l,u,h;for(h=0;h<t.length;++h){t[h]=e.select(t[h])}if(3===t.length&&n.isPointType(e,t[0])&&n.isPointType(e,t[1])&&n.isPointType(e,t[2])){t=n.providePoints(e,t,r,"point");o=t[0];s=t[1];l=t[2]}else if(n.isPointType(e,t[0])&&t[1].elementClass===d.OBJECT_CLASS_LINE){l=n.providePoints(e,[t[0]],r,"point")[0];o=t[1].point1;s=t[1].point2}else if(n.isPointType(e,t[1])&&t[0].elementClass===d.OBJECT_CLASS_LINE){l=n.providePoints(e,[t[1]],r,"point")[0];o=t[0].point1;s=t[0].point2}else{throw new Error("JSXGraph: Can't create parallel point with parent types '"+_typeof(t[0])+"', '"+_typeof(t[1])+"' and '"+_typeof(t[2])+"'.\nPossible parent types: [line,point], [point,point,point]")}u=e.create("point",[function(){return l.coords.usrCoords[1]+s.coords.usrCoords[1]-o.coords.usrCoords[1]},function(){return l.coords.usrCoords[2]+s.coords.usrCoords[2]-o.coords.usrCoords[2]}],r);o.addChild(u);s.addChild(u);l.addChild(u);u.elType="parallelpoint";u.setParents([o.id,s.id,l.id]);u.prepareUpdate().update();u.generatePolynomial=function(){var e=o.symbolic.x,t=o.symbolic.y,r=s.symbolic.x,i=s.symbolic.y,n=l.symbolic.x,a=l.symbolic.y,d=u.symbolic.x,c=u.symbolic.y;return["("+i+")*("+d+")-("+i+")*("+n+")-("+t+")*("+d+")+("+t+")*("+n+")-("+c+")*("+r+")+("+c+")*("+e+")+("+a+")*("+r+")-("+a+")*("+e+")","("+c+")*("+e+")-("+c+")*("+n+")-("+i+")*("+e+")+("+i+")*("+n+")-("+d+")*("+t+")+("+d+")*("+a+")+("+r+")*("+t+")-("+r+")*("+a+")"]};return u};e.createParallel=function(e,r,o){var s,a,d,l,c,u;for(c=0;c<r.length;++c){r[c]=e.select(r[c])}s=null;if(3===r.length){r=n.providePoints(e,r,o,"point");s=r[2];l=function(){return t.crossProduct(r[0].coords.usrCoords,r[1].coords.usrCoords)}}else if(n.isPointType(e,r[0])){s=n.providePoints(e,[r[0]],o,"point")[0];l=function(){return r[1].stdform}}else if(n.isPointType(e,r[1])){s=n.providePoints(e,[r[1]],o,"point")[0];l=function(){return r[0].stdform}}if(!n.exists(o.layer)){o.layer=e.options.layer.line}u=n.copyAttributes(o,e.options,"parallel","point");a=e.create("point",[function(){return t.crossProduct([1,0,0],l())}],u);a.isDraggable=!0;u=n.copyAttributes(o,e.options,"parallel");d=e.create("line",[s,a],u);d.elType="parallel";d.subs={point:a};d.inherits.push(a);d.setParents([r[0].id,r[1].id]);if(3===r.length){d.addParents(r[2].id)}d.point=a;return d};e.createArrowParallel=function(t,r,o){var i;try{o.firstArrow=!1;o.lastArrow=!0;i=e.createParallel(t,r,o).setAttribute({straightFirst:!1,straightLast:!1});i.elType="arrowparallel";return i}catch(t){throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [line,point], [point,point,point]")}};e.createNormal=function(e,r,s){var a,u,h,m,b,C,y,v,P;for(m=0;m<r.length;++m){r[m]=e.select(r[m])}if(1===r.length){a=r[0];u=a.slideObject}else if(2===r.length){if(n.isPointType(e,r[0])){a=n.providePoints(e,[r[0]],s,"point")[0];u=r[1]}else if(n.isPointType(e,r[1])){u=r[0];a=n.providePoints(e,[r[1]],s,"point")[0]}else{throw new Error("JSXGraph: Can't create normal with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,line], [point,circle], [glider]")}}else{throw new Error("JSXGraph: Can't create normal with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,line], [point,circle], [glider]")}y=n.copyAttributes(s,e.options,"normal");if(u.elementClass===d.OBJECT_CLASS_LINE){P=n.copyAttributes(s,e.options,"normal","point");v=e.create("point",[function(){var e=t.crossProduct([1,0,0],u.stdform);return[e[0],-e[2],e[1]]}],P);v.isDraggable=!0;h=e.create("line",[a,v],y);h.point=v;h.subs={point:v};h.inherits.push(v)}else if(u.elementClass===d.OBJECT_CLASS_CIRCLE){h=e.create("line",[u.midpoint,a],y)}else if(u.elementClass===d.OBJECT_CLASS_CURVE){if("plot"!==n.evaluate(u.visProp.curvetype)){b=u.X;C=u.Y;h=e.create("line",[function(){return-a.X()*o.D(b)(a.position)-a.Y()*o.D(C)(a.position)},function(){return o.D(b)(a.position)},function(){return o.D(C)(a.position)}],y)}else{h=e.create("line",[function(){var e=Math.floor(a.position),t=a.position-e;if(e===u.numberPoints-1){e-=1;t=1}if(0>e){return 1}return(u.Y(e)+t*(u.Y(e+1)-u.Y(e)))*(u.Y(e)-u.Y(e+1))-(u.X(e)+t*(u.X(e+1)-u.X(e)))*(u.X(e+1)-u.X(e))},function(){var e=Math.floor(a.position);if(e===u.numberPoints-1){e-=1}if(0>e){return 0}return u.X(e+1)-u.X(e)},function(){var e=Math.floor(a.position);if(e===u.numberPoints-1){e-=1}if(0>e){return 0}return u.Y(e+1)-u.Y(e)}],y)}}else if(u.type===d.OBJECT_TYPE_TURTLE){h=e.create("line",[function(){var e,t,r=Math.floor(a.position),o=a.position-r;for(t=0;t<u.objects.length;t++){e=u.objects[t];if(e.type===d.OBJECT_TYPE_CURVE){if(r<e.numberPoints){break}r-=e.numberPoints}}if(r===e.numberPoints-1){r-=1;o=1}if(0>r){return 1}return(e.Y(r)+o*(e.Y(r+1)-e.Y(r)))*(e.Y(r)-e.Y(r+1))-(e.X(r)+o*(e.X(r+1)-e.X(r)))*(e.X(r+1)-e.X(r))},function(){var e,t,r=Math.floor(a.position);for(t=0;t<u.objects.length;t++){e=u.objects[t];if(e.type===d.OBJECT_TYPE_CURVE){if(r<e.numberPoints){break}r-=e.numberPoints}}if(r===e.numberPoints-1){r-=1}if(0>r){return 0}return e.X(r+1)-e.X(r)},function(){var e,t,r=Math.floor(a.position);for(t=0;t<u.objects.length;t++){e=u.objects[t];if(e.type===d.OBJECT_TYPE_CURVE){if(r<e.numberPoints){break}r-=e.numberPoints}}if(r===e.numberPoints-1){r-=1}if(0>r){return 0}return e.Y(r+1)-e.Y(r)}],y)}else{throw new Error("JSXGraph: Can't create normal with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [point,line], [point,circle], [glider]")}h.elType="normal";h.setParents(r);return h};e.createBisector=function(e,t,o){var s,a,d,u;t=n.providePoints(e,t,o,"point");if(n.isPoint(t[0])&&n.isPoint(t[1])&&n.isPoint(t[2])){u=n.copyAttributes(o,e.options,"bisector","point");u.snapToGrid=!1;s=e.create("point",[function(){return r.angleBisector(t[0],t[1],t[2],e)}],u);s.dump=!1;for(d=0;3>d;d++){t[d].addChild(s)}if(!n.exists(o.layer)){o.layer=e.options.layer.line}u=n.copyAttributes(o,e.options,"bisector");a=c.createLine(e,[t[1],s],u);a.point=s;a.elType="bisector";a.setParents(t);a.subs={point:s};a.inherits.push(s);return a}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [point,point,point]")};e.createAngularBisectorsOfTwoLines=function(e,t,r){var o,i,s,a,l=e.select(t[0]),c=e.select(t[1]);if(l.elementClass!==d.OBJECT_CLASS_LINE||c.elementClass!==d.OBJECT_CLASS_LINE){throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [line,line]")}if(!n.exists(r.layer)){r.layer=e.options.layer.line}s=n.copyAttributes(r,e.options,"bisectorlines","line1");o=e.create("line",[function(){var e=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]),t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return l.stdform[0]/e-c.stdform[0]/t},function(){var e=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]),t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return l.stdform[1]/e-c.stdform[1]/t},function(){var e=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]),t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return l.stdform[2]/e-c.stdform[2]/t}],s);if(!n.exists(r.layer)){r.layer=e.options.layer.line}s=n.copyAttributes(r,e.options,"bisectorlines","line2");i=e.create("line",[function(){var e=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]),t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return l.stdform[0]/e+c.stdform[0]/t},function(){var e=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]),t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return l.stdform[1]/e+c.stdform[1]/t},function(){var e=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]),t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return l.stdform[2]/e+c.stdform[2]/t}],s);a=new m({line1:o,line2:i});o.dump=!1;i.dump=!1;a.elType="bisectorlines";a.setParents([l.id,c.id]);a.subs={line1:o,line2:i};return a};e.createCircumcenter=function(e,t,o){var s,d,u,h,m;t=n.providePoints(e,t,o,"point");if(n.isPoint(t[0])&&n.isPoint(t[1])&&n.isPoint(t[2])){u=t[0];h=t[1];m=t[2];s=l.createPoint(e,[function(){return r.circumcenter(u,h,m,e)}],o);for(d=0;3>d;d++){t[d].addChild(s)}s.elType="circumcenter";s.setParents(t);s.generatePolynomial=function(){var e=u.symbolic.x,t=u.symbolic.y,r=h.symbolic.x,o=h.symbolic.y,i=m.symbolic.x,n=m.symbolic.y,a=s.symbolic.x,d=s.symbolic.y,l=["((",a,")-(",e,"))^2+((",d,")-(",t,"))^2-((",a,")-(",r,"))^2-((",d,")-(",o,"))^2"].join(""),c=["((",a,")-(",e,"))^2+((",d,")-(",t,"))^2-((",a,")-(",i,"))^2-((",d,")-(",n,"))^2"].join("");return[l,c]};return s}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+_typeof(t[0])+"', '"+_typeof(t[1])+"' and '"+_typeof(t[2])+"'.\nPossible parent types: [point,point,point]")};e.createIncenter=function(e,t,r){var o,i,l,u;t=n.providePoints(e,t,r,"point");if(3<=t.length&&n.isPoint(t[0])&&n.isPoint(t[1])&&n.isPoint(t[2])){i=t[0];l=t[1];u=t[2];o=e.create("point",[function(){var t,r,o;t=Math.sqrt((l.X()-u.X())*(l.X()-u.X())+(l.Y()-u.Y())*(l.Y()-u.Y()));r=Math.sqrt((i.X()-u.X())*(i.X()-u.X())+(i.Y()-u.Y())*(i.Y()-u.Y()));o=Math.sqrt((l.X()-i.X())*(l.X()-i.X())+(l.Y()-i.Y())*(l.Y()-i.Y()));return new s(d.COORDS_BY_USER,[(t*i.X()+r*l.X()+o*u.X())/(t+r+o),(t*i.Y()+r*l.Y()+o*u.Y())/(t+r+o)],e)}],r);o.elType="incenter";o.setParents(t)}else{throw new Error("JSXGraph: Can't create incenter with parent types '"+_typeof(t[0])+"', '"+_typeof(t[1])+"' and '"+_typeof(t[2])+"'.\nPossible parent types: [point,point,point]")}return o};e.createCircumcircle=function(t,r,o){var i,s,a;r=n.providePoints(t,r,o,"point");if(!1===r){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+_typeof(r[0])+"', '"+_typeof(r[1])+"' and '"+_typeof(r[2])+"'.\nPossible parent types: [point,point,point]")}try{a=n.copyAttributes(o,t.options,"circumcircle","center");i=e.createCircumcenter(t,r,a);i.dump=!1;if(!n.exists(o.layer)){o.layer=t.options.layer.circle}a=n.copyAttributes(o,t.options,"circumcircle");s=u.createCircle(t,[i,r[0]],a);s.elType="circumcircle";s.setParents(r);s.subs={center:i};s.inherits.push(s)}catch(t){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+_typeof(r[0])+"', '"+_typeof(r[1])+"' and '"+_typeof(r[2])+"'.\nPossible parent types: [point,point,point]")}return s};e.createIncircle=function(t,r,o){var i,s,a;r=n.providePoints(t,r,o,"point");if(!1===r){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+_typeof(r[0])+"', '"+_typeof(r[1])+"' and '"+_typeof(r[2])+"'.\nPossible parent types: [point,point,point]")}try{a=n.copyAttributes(o,t.options,"incircle","center");i=e.createIncenter(t,r,a);i.dump=!1;if(!n.exists(o.layer)){o.layer=t.options.layer.circle}a=n.copyAttributes(o,t.options,"incircle");s=u.createCircle(t,[i,function(){var e=Math.sqrt((r[1].X()-r[2].X())*(r[1].X()-r[2].X())+(r[1].Y()-r[2].Y())*(r[1].Y()-r[2].Y())),t=Math.sqrt((r[0].X()-r[2].X())*(r[0].X()-r[2].X())+(r[0].Y()-r[2].Y())*(r[0].Y()-r[2].Y())),o=Math.sqrt((r[1].X()-r[0].X())*(r[1].X()-r[0].X())+(r[1].Y()-r[0].Y())*(r[1].Y()-r[0].Y())),i=(e+t+o)/2;return Math.sqrt((i-e)*(i-t)*(i-o)/i)}],a);s.elType="incircle";s.setParents(r);s.center=i;s.subs={center:s.center};s.inherits.push(i)}catch(t){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+_typeof(r[0])+"', '"+_typeof(r[1])+"' and '"+_typeof(r[2])+"'.\nPossible parent types: [point,point,point]")}return s};e.createReflection=function(e,o,s){var a,p,m,b,y;for(y=0;y<o.length;++y){o[y]=e.select(o[y])}if(n.isPoint(o[0])){p=n.providePoints(e,[o[0]],s,"point")[0]}else if(o[0].elementClass===d.OBJECT_CLASS_CURVE||o[0].elementClass===d.OBJECT_CLASS_LINE||o[0].type===d.OBJECT_TYPE_POLYGON||o[0].elementClass===d.OBJECT_CLASS_CIRCLE){p=o[0]}else{throw new Error("JSXGraph: Can't create reflection element with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'."+"\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, line]")}if(o[1].elementClass===d.OBJECT_CLASS_LINE){a=o[1]}else{throw new Error("JSXGraph: Can't create reflected element with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'."+"\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, line]")}b=h.createTransform(e,[a],{type:"reflect"});if(n.isPoint(p)){m=l.createPoint(e,[p,b],s)}else if(p.elementClass===d.OBJECT_CLASS_CURVE){m=g.createCurve(e,[p,b],s)}else if(p.elementClass===d.OBJECT_CLASS_LINE){m=c.createLine(e,[p,b],s)}else if(p.type===d.OBJECT_TYPE_POLYGON){m=C.createPolygon(e,[p,b],s)}else if(p.elementClass===d.OBJECT_CLASS_CIRCLE){m=u.createCircle(e,[p,b],s)}else{throw new Error("JSXGraph: Can't create reflected element with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'."+"\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, line]")}p.addChild(m);a.addChild(m);m.elType="reflection";m.setParents([p,a]);m.prepareUpdate().update();if(n.isPoint(m)){m.generatePolynomial=function(){var e=a.point1.symbolic.x,t=a.point1.symbolic.y,r=a.point2.symbolic.x,o=a.point2.symbolic.y,i=p.symbolic.x,s=p.symbolic.y,n=m.symbolic.x,d=m.symbolic.y,l=["((",d,")-(",s,"))*((",t,")-(",o,"))+((",e,")-(",r,"))*((",n,")-(",i,"))"].join(""),c=["((",n,")-(",e,"))^2+((",d,")-(",t,"))^2-((",i,")-(",e,"))^2-((",s,")-(",t,"))^2"].join("");return[l,c]}}return m};e.createMirrorElement=function(e,o,i){var s,a,p,b;if(n.isPoint(o[0])){s=n.providePoints(e,[o[0]],i,"point")[0]}else if(o[0].elementClass===d.OBJECT_CLASS_CURVE||o[0].elementClass===d.OBJECT_CLASS_LINE||o[0].type===d.OBJECT_TYPE_POLYGON||o[0].elementClass===d.OBJECT_CLASS_CIRCLE){s=o[0]}else{throw new Error("JSXGraph: Can't create mirror element with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'."+"\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, point]")}if(n.isPoint(o[1])){a=n.providePoints(e,[o[1]],i,"point")[0]}else{throw new Error("JSXGraph: Can't create mirror element with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'."+"\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, point]")}b=h.createTransform(e,[Math.PI,a],{type:"rotate"});if(n.isPoint(s)){p=l.createPoint(e,[s,b],i)}else if(s.elementClass===d.OBJECT_CLASS_CURVE){p=g.createCurve(e,[s,b],i)}else if(s.elementClass===d.OBJECT_CLASS_LINE){p=c.createLine(e,[s,b],i)}else if(s.type===d.OBJECT_TYPE_POLYGON){p=C.createPolygon(e,[s,b],i)}else if(s.elementClass===d.OBJECT_CLASS_CIRCLE){p=u.createCircle(e,[s,b],i)}else{throw new Error("JSXGraph: Can't create mirror element with parent types '"+_typeof(o[0])+"' and '"+_typeof(o[1])+"'."+"\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, point]")}s.addChild(p);a.addChild(p);p.elType="mirrorpoint";p.setParents([s,a]);p.prepareUpdate().update();return p};e.createMirrorPoint=function(t,r,o){return e.createMirrorElement(t,r,o)};e.createIntegral=function(r,i,a){var l,c,u,h,m,g,b,C,y,v,f,P,_,S=null,E;if(n.isArray(i[0])&&i[1].elementClass===d.OBJECT_CLASS_CURVE){l=i[0];c=i[1]}else if(n.isArray(i[1])&&i[0].elementClass===d.OBJECT_CLASS_CURVE){l=i[1];c=i[0]}else{throw new Error("JSXGraph: Can't create integral with parent types '"+_typeof(i[0])+"' and '"+_typeof(i[1])+"'.\nPossible parent types: [[number|function,number|function],curve]")}u=n.copyAttributes(a,r.options,"integral");u.withLabel=!1;E=r.create("curve",[[0],[0]],u);h=l[0];m=l[1];if(n.isFunction(h)){g=h;b=function(){return c.Y(g())};h=g()}else{g=h;b=c.Y(h)}if(n.isFunction(m)){C=m;y=function(){return c.Y(C())};m=C()}else{C=m;y=c.Y(m)}u=n.copyAttributes(a,r.options,"integral","curveLeft");v=r.create("glider",[g,b,c],u);if(n.isFunction(g)){v.hideElement()}u=n.copyAttributes(a,r.options,"integral","baseLeft");f=r.create("point",[function(){if("y"===n.evaluate(E.visProp.axis)){return 0}return v.X()},function(){if("y"===n.evaluate(E.visProp.axis)){return v.Y()}return 0}],u);u=n.copyAttributes(a,r.options,"integral","curveRight");P=r.create("glider",[C,y,c],u);if(n.isFunction(C)){P.hideElement()}u=n.copyAttributes(a,r.options,"integral","baseRight");_=r.create("point",[function(){if("y"===n.evaluate(E.visProp.axis)){return 0}return P.X()},function(){if("y"===n.evaluate(E.visProp.axis)){return P.Y()}return 0}],u);u=n.copyAttributes(a,r.options,"integral");if(!1!==u.withlabel&&"y"!==u.axis){u=n.copyAttributes(a,r.options,"integral","label");u=n.copyAttributes(u,r.options,"label");S=r.create("text",[function(){var e=new s(d.COORDS_BY_SCREEN,[n.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),t=this.board.getBoundingBox(),r=.1*(t[2]-t[0]),o=P.X();if(o<t[0]){o=t[0]+r}else if(o>t[2]){o=t[2]-r}return o+e.usrCoords[1]},function(){var e=new s(d.COORDS_BY_SCREEN,[0,n.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),t=this.board.getBoundingBox(),r=.1*(t[1]-t[3]),o=P.Y();if(o>t[1]){o=t[1]-r}else if(o<t[3]){o=t[3]+r}return o+e.usrCoords[2]},function(){var e=o.NewtonCotes([f.X(),_.X()],c.Y);return"&int; = "+n.toFixed(e,4)}],u);S.dump=!1;v.addChild(S);P.addChild(S)}v.dump=!1;f.dump=!1;P.dump=!1;_.dump=!1;E.elType="integral";E.setParents([c.id,l]);E.subs={curveLeft:v,baseLeft:f,curveRight:P,baseRight:_};E.inherits.push(v,f,P,_);if(u.withLabel){E.subs.label=S;E.inherits.push(S)}E.Value=function(){return o.I([f.X(),_.X()],c.Y)};E.updateDataArray=function(){var e,t,r,o,s,a,d,l,p;if("y"===n.evaluate(this.visProp.axis)){if(v.Y()<P.Y()){a=v.X();l=v.Y();d=P.X();p=P.Y()}else{a=P.X();l=P.Y();d=v.X();p=v.Y()}o=Math.min(a,d);s=Math.max(a,d);e=[0,a];t=[l,l];for(r=0;r<c.numberPoints;r++){if(l<=c.points[r].usrCoords[2]&&o<=c.points[r].usrCoords[1]&&c.points[r].usrCoords[2]<=p&&c.points[r].usrCoords[1]<=s){e.push(c.points[r].usrCoords[1]);t.push(c.points[r].usrCoords[2])}}e.push(d);t.push(p);e.push(0);t.push(p);e.push(0);t.push(l)}else{if(f.X()<_.X()){o=f.X();s=_.X()}else{o=_.X();s=f.X()}e=[o,o];t=[0,c.Y(o)];for(r=0;r<c.numberPoints;r++){if(o<=c.points[r].usrCoords[1]&&c.points[r].usrCoords[1]<=s){e.push(c.points[r].usrCoords[1]);t.push(c.points[r].usrCoords[2])}}e.push(s);t.push(c.Y(s));e.push(s);t.push(0);e.push(o);t.push(0)}this.dataX=e;this.dataY=t};v.addChild(E);P.addChild(E);f.addChild(E);_.addChild(E);E.baseLeft=f;E.baseRight=_;E.curveLeft=v;E.curveRight=P;E.methodMap=e.deepCopy(E.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"});E.label=S;return E};e.createGrid=function(e,t,r){var o,i;i=n.copyAttributes(r,e.options,"grid");o=e.create("curve",[[null],[null]],i);o.elType="grid";o.type=d.OBJECT_TYPE_GRID;o.updateDataArray=function(){var t,r,a,l,c,p=n.evaluate(this.visProp.gridx),u=n.evaluate(this.visProp.gridy);if(n.isArray(this.visProp.topleft)){l=new s(n.evaluate(this.visProp.tltype)||d.COORDS_BY_USER,this.visProp.topleft,e)}else{l=new s(d.COORDS_BY_SCREEN,[0,0],e)}if(n.isArray(this.visProp.bottomright)){c=new s(n.evaluate(this.visProp.brtype)||d.COORDS_BY_USER,this.visProp.bottomright,e)}else{c=new s(d.COORDS_BY_SCREEN,[e.canvasWidth,e.canvasHeight],e)}e.options.grid.hasGrid=!0;o.dataX=[];o.dataY=[];t=Math.floor(l.usrCoords[2]/u)*u;r=Math.ceil(c.usrCoords[2]/u)*u;if(l.usrCoords[2]<c.usrCoords[2]){t=Math.ceil(c.usrCoords[2]/u)*u;r=Math.floor(l.usrCoords[2]/u)*u}for(a=t;a>r-u;a-=u){o.dataX.push(l.usrCoords[1],c.usrCoords[1],NaN);o.dataY.push(a,a,NaN)}t=Math.ceil(l.usrCoords[1]/p)*p;r=Math.floor(c.usrCoords[1]/p)*p;if(l.usrCoords[1]>c.usrCoords[1]){t=Math.floor(c.usrCoords[1]/p)*p;r=Math.ceil(l.usrCoords[1]/p)*p}for(a=t;a<r+p;a+=p){o.dataX.push(a,a,NaN);o.dataY.push(l.usrCoords[2],c.usrCoords[2],NaN)}};o.hasPoint=function(){return!1};e.grids.push(o);return o};e.createInequality=function(e,o,i){var s,l,c;c=n.copyAttributes(i,e.options,"inequality");if(o[0].elementClass===d.OBJECT_CLASS_LINE){l=e.create("curve",[[],[]],c);l.hasPoint=function(){return!1};l.updateDataArray=function(){var i,s,n,a=e.getBoundingBox(),l=c.inverse?-1:1,p=1.5,u=p*Math.max(a[2]-a[0],a[1]-a[3]),m={coords:{usrCoords:[1,(a[0]+a[2])/2,c.inverse?a[1]:a[3]]}},g=o[0].stdform.slice(1),b=g;n=p*Math.max(r.perpendicular(o[0],m,e)[0].distance(d.COORDS_BY_USER,m.coords),u);n*=l;m={coords:{usrCoords:[1,(a[0]+a[2])/2,(a[1]+a[3])/2]}};if(Math.abs(t.innerProduct(m.coords.usrCoords,o[0].stdform,3))>=t.eps){m=r.perpendicular(o[0],m,e)[0].usrCoords}else{m=m.coords.usrCoords}i=[1,m[1]+g[1]*u,m[2]-g[0]*u];s=[1,m[1]-b[1]*u,m[2]+b[0]*u];this.dataX=[i[1],i[1]+g[0]*n,s[1]+b[0]*n,s[1],i[1]];this.dataY=[i[2],i[2]+g[1]*n,s[2]+b[1]*n,s[2],i[2]]}}else if(o[0].elementClass===d.OBJECT_CLASS_CURVE&&"functiongraph"===o[0].visProp.curvetype){l=e.create("curve",[[],[]],c);l.hasPoint=function(){return!1};l.updateDataArray=function(){var e=this.board.getBoundingBox(),t=1.5*(c.inverse?e[1]:e[3]),r,s;this.dataX=[];this.dataY=[];s=o[0].points.length;if(0>=s){return}this.dataX.push(o[0].points[0].usrCoords[1]);this.dataY.push(t);for(r=0;r<s;r++){this.dataX.push(o[0].points[r].usrCoords[1]);this.dataY.push(o[0].points[r].usrCoords[2])}this.dataX.push(o[0].points[s-1].usrCoords[1]);this.dataY.push(t)}}else{s=n.createFunction(o[0]);if(!n.exists(s)){throw new Error("JSXGraph: Can't create area with the given parents.\nPossible parent types: [line], [function]")}}l.addParents(o[0]);return l};e.registerElement("arrowparallel",e.createArrowParallel);e.registerElement("bisector",e.createBisector);e.registerElement("bisectorlines",e.createAngularBisectorsOfTwoLines);e.registerElement("msector",e.createMsector);e.registerElement("circumcircle",e.createCircumcircle);e.registerElement("circumcirclemidpoint",e.createCircumcenter);e.registerElement("circumcenter",e.createCircumcenter);e.registerElement("incenter",e.createIncenter);e.registerElement("incircle",e.createIncircle);e.registerElement("integral",e.createIntegral);e.registerElement("midpoint",e.createMidpoint);e.registerElement("mirrorelement",e.createMirrorElement);e.registerElement("mirrorpoint",e.createMirrorPoint);e.registerElement("normal",e.createNormal);e.registerElement("orthogonalprojection",e.createOrthogonalProjection);e.registerElement("parallel",e.createParallel);e.registerElement("parallelpoint",e.createParallelPoint);e.registerElement("perpendicular",e.createPerpendicular);e.registerElement("perpendicularpoint",e.createPerpendicularPoint);e.registerElement("perpendicularsegment",e.createPerpendicularSegment);e.registerElement("reflection",e.createReflection);e.registerElement("grid",e.createGrid);e.registerElement("inequality",e.createInequality);return{createArrowParallel:e.createArrowParallel,createBisector:e.createBisector,createAngularBisectorOfTwoLines:e.createAngularBisectorsOfTwoLines,createCircumcircle:e.createCircumcircle,createCircumcenter:e.createCircumcenter,createIncenter:e.createIncenter,createIncircle:e.createIncircle,createIntegral:e.createIntegral,createMidpoint:e.createMidpoint,createMirrorElement:e.createMirrorElement,createMirrorPoint:e.createMirrorPoint,createNormal:e.createNormal,createOrthogonalProjection:e.createOrthogonalProjection,createParallel:e.createParallel,createParallelPoint:e.createParallelPoint,createPerpendicular:e.createPerpendicular,createPerpendicularPoint:e.createPerpendicularPoint,createPerpendicularSegmen:e.createPerpendicularSegment,createReflection:e.createReflection,createGrid:e.createGrid,createInequality:e.createInequality}});define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","parser/geonext","utils/color","utils/type","utils/event","utils/env","base/transformation","base/point","base/line","base/text","element/composition","base/composition"],function(t,r,s,n,d,l,p,u,h,m,g,b,C,y,f,P,_,S,E,x,O){'use strict';t.Board=function(e,t,o,i,s,a,d,l,c,p,u){this.BOARD_MODE_NONE=0;this.BOARD_MODE_DRAG=1;this.BOARD_MODE_MOVE_ORIGIN=2;this.BOARD_QUALITY_LOW=1;this.BOARD_QUALITY_HIGH=2;this.BOARD_MODE_ZOOM=17;if(C.exists(u.document)&&!1!==u.document){this.document=u.document}else if(document!==void 0&&C.isObject(document)){this.document=document}this.container=e;this.containerObj=f.isBrowser?this.document.getElementById(this.container):null;if(f.isBrowser&&"no"!==t.type&&null===this.containerObj){throw new Error("\nJSXGraph: HTML container element '"+e+"' not found.")}this.renderer=t;this.grids=[];this.options=C.deepCopy(n);this.attr=u;this.dimension=2;this.jc=new m;this.jc.use(this);this.origin={};this.origin.usrCoords=[1,0,0];this.origin.scrCoords=[1,i[0],i[1]];this.zoomX=s;this.zoomY=a;this.unitX=d*this.zoomX;this.unitY=l*this.zoomY;this.keepaspectratio=!1;this.canvasWidth=c;this.canvasHeight=p;if(C.exists(o)&&""!==o&&f.isBrowser&&!C.exists(this.document.getElementById(o))){this.id=o}else{this.id=this.generateId()}y.eventify(this);this.hooks=[];this.dependentBoards=[];this.inUpdate=!1;this.objects={};this.objectsList=[];this.groups={};this.animationObjects={};this.highlightedObjects={};this.numObjects=0;this.elementsByName={};this.mode=this.BOARD_MODE_NONE;this.updateQuality=this.BOARD_QUALITY_HIGH;this.isSuspendedRedraw=!1;this.calculateSnapSizes();this.drag_dx=0;this.drag_dy=0;this.drag_position=[0,0];this.mouse={};this.touches=[];this.xmlString="";this.cPos=[];this.positionAccessLast=0;this.downObjects=[];if(this.attr.showcopyright){this.renderer.displayCopyright(r.licenseText,parseInt(this.options.text.fontSize,10))}this.needsFullUpdate=!1;this.reducedUpdate=!1;this.currentCBDef="none";this.geonextCompatibilityMode=!1;if(this.options.text.useASCIIMathML&&translateASCIIMath){init()}else{this.options.text.useASCIIMathML=!1}this.hasMouseHandlers=!1;this.hasTouchHandlers=!1;this.hasPointerHandlers=!1;this.hasMouseUp=!1;this.hasTouchEnd=!1;this.hasPointerUp=!1;this._drag_offset=[0,0];this._board_touches=[];this.selectingMode=!1;this.isSelecting=!1;this.selectingBox=[[0,0],[0,0]];if(this.attr.registerevents){this.addEventHandlers()}this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}};t.extend(t.Board.prototype,{generateName:function generateName(e){var t,o,s=this.attr.maxnamelength,n="",a="",d=[],l="";if(e.type===r.OBJECT_TYPE_TICKS){return""}if(C.isPoint(e)){t=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]}else if(e.type===r.OBJECT_TYPE_ANGLE){t=["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]}else{t=["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]}if(!C.isPoint(e)&&e.elementClass!==r.OBJECT_CLASS_LINE&&e.type!==r.OBJECT_TYPE_ANGLE){if(e.type===r.OBJECT_TYPE_POLYGON){n="P_{"}else if(e.elementClass===r.OBJECT_CLASS_CIRCLE){n="k_{"}else if(e.elementClass===r.OBJECT_CLASS_TEXT){n="t_{"}else{n="s_{"}a="}"}for(o=0;o<s;o++){d[o]=0}while(d[s-1]<t.length){for(d[0]=1;d[0]<t.length;d[0]++){l=n;for(o=s;0<o;o--){l+=t[d[o-1]]}if(!C.exists(this.elementsByName[l+a])){return l+a}}d[0]=t.length;for(o=1;o<s;o++){if(d[o-1]===t.length){d[o-1]=1;d[o]+=1}}}return""},generateId:function generateId(){var e=1;while(C.exists(t.boards["jxgBoard"+e])){e=Math.round(65535*Math.random())}return"jxgBoard"+e},setId:function setId(e,t){var r,o=this.numObjects,i=e.id;this.numObjects+=1;if(""===i||!C.exists(i)){i=this.id+t+o;while(C.exists(this.objects[i])){r=Math.round(65535*Math.random());i=this.id+t+o+"-"+r}}e.id=i;this.objects[i]=e;e._pos=this.objectsList.length;this.objectsList[this.objectsList.length]=e;return i},finalizeAdding:function finalizeAdding(e){if(!1===C.evaluate(e.visProp.visible)){this.renderer.display(e,!1)}},finalizeLabel:function finalizeLabel(e){if(e.hasLabel&&!C.evaluate(e.label.visProp.islabel)&&!1===C.evaluate(e.label.visProp.visible)){this.renderer.display(e.label,!1)}},getCoordsTopLeftCorner:function getCoordsTopLeftCorner(){var e,t,r,i=this.document.documentElement||this.document.body.parentNode,s=this.document.body,n=this.containerObj,a,d;if(0<this.cPos.length&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||1e3>new Date().getTime()-this.positionAccessLast)){return this.cPos}this.positionAccessLast=new Date().getTime();if(n.getBoundingClientRect){r=n.getBoundingClientRect();a=1;d=n;while(d&&C.exists(d.parentNode)){if(C.exists(d.style)&&C.exists(d.style.zoom)&&""!==d.style.zoom){a*=parseFloat(d.style.zoom)}d=d.parentNode}e=[r.left*a,r.top*a];e[0]+=f.getProp(n,"border-left-width");e[1]+=f.getProp(n,"border-top-width");if("vml"!==this.renderer.type){e[0]+=f.getProp(n,"padding-left");e[1]+=f.getProp(n,"padding-top")}this.cPos=e.slice();return this.cPos}e=f.getOffset(n);t=this.document.documentElement.ownerDocument;if(!this.containerObj.currentStyle&&t.defaultView){e[0]+=f.getProp(i,"margin-left");e[1]+=f.getProp(i,"margin-top");e[0]+=f.getProp(i,"border-left-width");e[1]+=f.getProp(i,"border-top-width");e[0]+=f.getProp(i,"padding-left");e[1]+=f.getProp(i,"padding-top")}if(s){e[0]+=f.getProp(s,"left");e[1]+=f.getProp(s,"top")}if("object"===("undefined"==typeof google?"undefined":_typeof(google))&&google.translate){e[0]+=10;e[1]+=25}e[0]+=f.getProp(n,"border-left-width");e[1]+=f.getProp(n,"border-top-width");if("vml"!==this.renderer.type){e[0]+=f.getProp(n,"padding-left");e[1]+=f.getProp(n,"padding-top")}e[0]+=this.attr.offsetx;e[1]+=this.attr.offsety;this.cPos=e.slice();return this.cPos},getMousePosition:function getMousePosition(t,e){var r=this.getCoordsTopLeftCorner(),o,i;o=f.getPosition(t,e,this.document);if(!C.exists(this.cssTransMat)){this.updateCSSTransforms()}i=[1,o[0]-r[0],o[1]-r[1]];i=l.matVecMult(this.cssTransMat,i);i[1]/=i[0];i[2]/=i[0];return[i[1],i[2]]},initMoveOrigin:function initMoveOrigin(e,t){this.drag_dx=e-this.origin.scrCoords[1];this.drag_dy=t-this.origin.scrCoords[2];this.mode=this.BOARD_MODE_MOVE_ORIGIN;this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function initMoveObject(e,t,o,i){var s,n,a=[],d=[],l,c=this.objectsList.length,p={visProp:{layer:-1e4}};for(n=0;n<c;n++){s=this.objectsList[n];l=s.hasPoint&&s.hasPoint(e,t);if(s.visPropCalc.visible&&l){s.triggerEventHandlers([i+"down","down"],[o]);this.downObjects.push(s)}if((this.geonextCompatibilityMode&&(C.isPoint(s)||s.elementClass===r.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&s.isDraggable&&s.visPropCalc.visible&&!C.evaluate(s.visProp.fixed)&&l){if(s.visProp.layer>p.visProp.layer||s.visProp.layer===p.visProp.layer&&s.lastDragTime.getTime()>=p.lastDragTime.getTime()){if(!this.attr.ignorelabels||!C.exists(p.label)||s!==p.label){p=s;a.push(p);if(C.exists(p.coords)){d.push(h.subtract(p.coords.scrCoords.slice(1),[e,t]))}else{d.push([0,0])}}}}}if(0<a.length){this.mode=this.BOARD_MODE_DRAG}if(this.attr.takefirst){a.length=1;this._drag_offset=d[0]}else{a=a.slice(-1);this._drag_offset=d[d.length-1]}if(!this._drag_offset){this._drag_offset=[0,0]}if("svg"===this.renderer.type&&C.exists(a[0])&&C.evaluate(a[0].visProp.dragtotopoflayer)&&1===a.length&&C.exists(a[0].rendNode)){a[0].rendNode.parentNode.appendChild(a[0].rendNode)}return a},moveObject:function moveObject(e,t,i,o,n){var a=new s(r.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(e,t),this),d,l,c;if(!(i&&i.obj)){return}d=i.obj;if(d.coords){l=d.coords.scrCoords.slice()}this.drag_position=[a.scrCoords[1],a.scrCoords[2]];this.drag_position=h.add(this.drag_position,this._drag_offset);if(C.exists(d.coords)){d.setPositionDirectly(r.COORDS_BY_SCREEN,this.drag_position)}else{this.showInfobox(!1);if(!isNaN(i.targets[0].Xprev+i.targets[0].Yprev)){d.setPositionDirectly(r.COORDS_BY_SCREEN,[a.scrCoords[1],a.scrCoords[2]],[i.targets[0].Xprev,i.targets[0].Yprev])}i.targets[0].Xprev=a.scrCoords[1];i.targets[0].Yprev=a.scrCoords[2]}d.prepareUpdate().update(!1).updateRenderer();this.updateInfobox(d);d.prepareUpdate().update(!0).updateRenderer();if(d.coords){c=d.coords.scrCoords}if(!d.coords||l[1]!==c[1]||l[2]!==c[2]){d.triggerEventHandlers([n+"drag","drag"],[o]);this.update()}d.highlight(!0);d.lastDragTime=new Date},twoFingerMove:function twoFingerMove(e,t,i,o){var n,a,d;if(C.exists(i)&&C.exists(i.obj)){d=i.obj}else{return}n=new s(r.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(e[0],e[1]),this);a=new s(r.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(t[0],t[1]),this);if(d.elementClass===r.OBJECT_CLASS_LINE||d.type===r.OBJECT_TYPE_POLYGON){this.twoFingerTouchObject(n,a,i,d)}else if(d.elementClass===r.OBJECT_CLASS_CIRCLE){this.twoFingerTouchCircle(n,a,i,d)}d.triggerEventHandlers(["touchdrag","drag"],[o]);i.targets[0].Xprev=n.scrCoords[1];i.targets[0].Yprev=n.scrCoords[2];i.targets[1].Xprev=a.scrCoords[1];i.targets[1].Yprev=a.scrCoords[2]},twoFingerTouchObject:function twoFingerTouchObject(e,t,n,o){var a,c,u,h,m,g,b,y,v,f,P,_,E,x,O,T,A,w,j;if(C.exists(n.targets[0])&&C.exists(n.targets[1])&&!isNaN(n.targets[0].Xprev+n.targets[0].Yprev+n.targets[1].Xprev+n.targets[1].Yprev)){a=e.usrCoords;c=t.usrCoords;u=new s(r.COORDS_BY_SCREEN,[n.targets[0].Xprev,n.targets[0].Yprev],this).usrCoords;h=new s(r.COORDS_BY_SCREEN,[n.targets[1].Xprev,n.targets[1].Yprev],this).usrCoords;g=[1,.5*(u[1]+h[1]),.5*(u[2]+h[2])];m=[1,.5*(a[1]+c[1]),.5*(a[2]+c[2])];y=l.crossProduct(u,h);b=l.crossProduct(a,c);f=l.crossProduct(y,b);if(Math.abs(f[0])<l.eps){return}f[1]/=f[0];f[2]/=f[0];P=p.rad(g.slice(1),f.slice(1),m.slice(1));_=this.create("transform",[P,f[1],f[2]],{type:"rotate"});_.update();g=l.matVecMult(_.matrix,g);g[1]/=g[0];g[2]/=g[0];E=this.create("transform",[m[1]-g[1],m[2]-g[2]],{type:"translate"});E.update();_.melt(E);if(C.evaluate(o.visProp.scalable)){v=p.distance(a,c)/p.distance(u,h);x=this.create("transform",[-m[1],-m[2]],{type:"translate"});O=this.create("transform",[v,v],{type:"scale"});T=this.create("transform",[m[1],m[2]],{type:"translate"});_.melt(x).melt(O).melt(T)}if(o.elementClass===r.OBJECT_CLASS_LINE){A=[];if(o.point1.draggable()){A.push(o.point1)}if(o.point2.draggable()){A.push(o.point2)}_.applyOnce(A)}else if(o.type===r.OBJECT_TYPE_POLYGON){A=[];j=o.vertices.length-1;for(w=0;w<j;++w){if(o.vertices[w].draggable()){A.push(o.vertices[w])}}_.applyOnce(A)}this.update();o.highlight(!0)}},twoFingerTouchCircle:function twoFingerTouchCircle(e,t,i,o){var n,a,l,c,u,h,m,g,b,y,v;if("pointCircle"===o.method||"pointLine"===o.method){return}if(C.exists(i.targets[0])&&C.exists(i.targets[1])&&!isNaN(i.targets[0].Xprev+i.targets[0].Yprev+i.targets[1].Xprev+i.targets[1].Yprev)){n=e.usrCoords;a=t.usrCoords;l=new s(r.COORDS_BY_SCREEN,[i.targets[0].Xprev,i.targets[0].Yprev],this).usrCoords;c=new s(r.COORDS_BY_SCREEN,[i.targets[1].Xprev,i.targets[1].Yprev],this).usrCoords;m=this.create("transform",[n[1]-l[1],n[2]-l[2]],{type:"translate"});h=p.rad(c.slice(1),n.slice(1),a.slice(1));g=this.create("transform",[-n[1],-n[2]],{type:"translate"});b=this.create("transform",[h],{type:"rotate"});m.melt(g).melt(b);if(C.evaluate(o.visProp.scalable)){u=p.distance(n,a)/p.distance(l,c);y=this.create("transform",[u,u],{type:"scale"});m.melt(y)}v=this.create("transform",[n[1],n[2]],{type:"translate"});m.melt(v);if(o.center.draggable()){m.applyOnce([o.center])}if("twoPoints"===o.method){if(o.point2.draggable()){m.applyOnce([o.point2])}}else if("pointRadius"===o.method){if(C.isNumber(o.updateRadius.origin)){o.setRadius(o.radius*u)}}this.update(o.center);o.highlight(!0)}},highlightElements:function highlightElements(e,t,r,o){var i,s,n,a={},d=this.objectsList.length;for(i=0;i<d;i++){s=this.objectsList[i];n=s.id;if(C.exists(s.hasPoint)&&s.visPropCalc.visible&&s.hasPoint(e,t)){this.updateInfobox(s);if(!C.exists(this.highlightedObjects[n])){a[n]=s;s.highlight();s.triggerEventHandlers(["mousehit","hit"],[r,s,o])}if(s.mouseover){s.triggerEventHandlers(["mousemove","move"],[r])}else{s.triggerEventHandlers(["mouseover","over"],[r]);s.mouseover=!0}}}for(i=0;i<d;i++){s=this.objectsList[i];n=s.id;if(s.mouseover){if(!a[n]){s.triggerEventHandlers(["mouseout","out"],[r]);s.mouseover=!1}}}},saveStartPos:function saveStartPos(e,o){var s=[],n,a;if(e.type===r.OBJECT_TYPE_TICKS){s.push([1,NaN,NaN])}else if(e.elementClass===r.OBJECT_CLASS_LINE){s.push(e.point1.coords.usrCoords);s.push(e.point2.coords.usrCoords)}else if(e.elementClass===r.OBJECT_CLASS_CIRCLE){s.push(e.center.coords.usrCoords);if("twoPoints"===e.method){s.push(e.point2.coords.usrCoords)}}else if(e.type===r.OBJECT_TYPE_POLYGON){a=e.vertices.length-1;for(n=0;n<a;n++){s.push(e.vertices[n].coords.usrCoords)}}else if(e.type===r.OBJECT_TYPE_SECTOR){s.push(e.point1.coords.usrCoords);s.push(e.point2.coords.usrCoords);s.push(e.point3.coords.usrCoords)}else if(C.isPoint(e)||e.type===r.OBJECT_TYPE_GLIDER){s.push(e.coords.usrCoords)}else if(e.elementClass===r.OBJECT_CLASS_CURVE){if(0<e.points.length){s.push(e.points[0].usrCoords)}}else{try{s.push(e.coords.usrCoords)}catch(r){t.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+r)}}a=s.length;for(n=0;n<a;n++){o.Zstart.push(s[n][0]);o.Xstart.push(s[n][1]);o.Ystart.push(s[n][2])}},mouseOriginMoveStart:function mouseOriginMoveStart(e){var t,o;t=this._isRequiredKeyPressed(e,"pan");if(t){o=this.getMousePosition(e);this.initMoveOrigin(o[0],o[1])}return t},mouseOriginMove:function mouseOriginMove(e){var t=this.mode===this.BOARD_MODE_MOVE_ORIGIN,r;if(t){r=this.getMousePosition(e);this.moveOrigin(r[0],r[1],!0)}return t},touchOriginMoveStart:function touchOriginMoveStart(e){var o=e[t.touchProperty],i,s;i=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&1==o.length;if(i){s=this.getMousePosition(e,0);this.initMoveOrigin(s[0],s[1])}return i},touchOriginMove:function touchOriginMove(e){var t=this.mode===this.BOARD_MODE_MOVE_ORIGIN,r;if(t){r=this.getMousePosition(e,0);this.moveOrigin(r[0],r[1],!0)}return t},originMoveEnd:function originMoveEnd(){this.updateQuality=this.BOARD_QUALITY_HIGH;this.mode=this.BOARD_MODE_NONE},addEventHandlers:function addEventHandlers(){if(f.supportsPointerEvents()){this.addPointerEventHandlers()}else{this.addMouseEventHandlers();this.addTouchEventHandlers()}if(null!==this.containerObj){this.containerObj.oncontextmenu=function(t){if(C.exists(t)){t.preventDefault()}return!1}}},addPointerEventHandlers:function addPointerEventHandlers(){if(!this.hasPointerHandlers&&f.isBrowser){if(window.navigator.msPointerEnabled){f.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this);f.addEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)}else{f.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this);f.addEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)}f.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this);f.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this);if(null!==this.containerObj){this.containerObj.style.touchAction="none"}this.hasPointerHandlers=!0}},addMouseEventHandlers:function addMouseEventHandlers(){if(!this.hasMouseHandlers&&f.isBrowser){f.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this);f.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this);f.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this);f.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this);this.hasMouseHandlers=!0}},addTouchEventHandlers:function addTouchEventHandlers(){if(!this.hasTouchHandlers&&f.isBrowser){f.addEvent(this.containerObj,"touchstart",this.touchStartListener,this);f.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this);this.hasTouchHandlers=!0}},removePointerEventHandlers:function removePointerEventHandlers(){if(this.hasPointerHandlers&&f.isBrowser){if(window.navigator.msPointerEnabled){f.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this);f.removeEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)}else{f.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this);f.removeEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)}f.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this);f.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this);if(this.hasPointerUp){if(window.navigator.msPointerEnabled){f.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this)}else{f.removeEvent(this.document,"pointerup",this.pointerUpListener,this)}this.hasPointerUp=!1}this.hasPointerHandlers=!1}},removeMouseEventHandlers:function removeMouseEventHandlers(){if(this.hasMouseHandlers&&f.isBrowser){f.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this);f.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this);if(this.hasMouseUp){f.removeEvent(this.document,"mouseup",this.mouseUpListener,this);this.hasMouseUp=!1}f.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this);f.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this);this.hasMouseHandlers=!1}},removeTouchEventHandlers:function removeTouchEventHandlers(){if(this.hasTouchHandlers&&f.isBrowser){f.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this);f.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this);if(this.hasTouchEnd){f.removeEvent(this.document,"touchend",this.touchEndListener,this);this.hasTouchEnd=!1}this.hasTouchHandlers=!1}},removeEventHandlers:function removeEventHandlers(){this.removeMouseEventHandlers();this.removeTouchEventHandlers();this.removePointerEventHandlers()},clickLeftArrow:function clickLeftArrow(){this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]);return this},clickRightArrow:function clickRightArrow(){this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]);return this},clickUpArrow:function clickUpArrow(){this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight);return this},clickDownArrow:function clickDownArrow(){this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight);return this},gestureChangeListener:function gestureChangeListener(e){var t,o=this.attr.zoom.factorx,i=this.attr.zoom.factory,n,a,d,l,u,h,m,g;if(this.mode!==this.BOARD_MODE_ZOOM){return!0}e.preventDefault();t=new s(r.COORDS_BY_SCREEN,this.getMousePosition(e,0),this);a=p.distance([e.touches[0].clientX,e.touches[0].clientY],[e.touches[1].clientX,e.touches[1].clientY],2);if(e.scale===void 0){e.scale=a/this.prevDist}n=e.scale/this.prevScale;this.prevScale=e.scale;if(this.attr.pan.enabled&&this.attr.pan.needtwofingers&&.4>Math.abs(e.scale-1)&&this._num_pan>=.8*this._num_zoom){this._num_pan++;this.moveOrigin(t.scrCoords[1],t.scrCoords[2],!0)}else if(this.attr.zoom.enabled&&.5>Math.abs(n-1)){this._num_zoom++;if(this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical){d=Math.abs(e.touches[0].clientX-e.touches[1].clientX);l=Math.abs(e.touches[0].clientY-e.touches[1].clientY);u=Math.abs(Math.atan2(l,d));g=Math.PI*this.attr.zoom.pinchsensitivity/90}if(this.attr.zoom.pinchhorizontal&&u<g){this.attr.zoom.factorx=n;this.attr.zoom.factory=1;h=0;m=0}else if(this.attr.zoom.pinchvertical&&Math.abs(u-.5*Math.PI)<g){this.attr.zoom.factorx=1;this.attr.zoom.factory=n;h=0;m=0}else{this.attr.zoom.factorx=n;this.attr.zoom.factory=n;h=t.usrCoords[1];m=t.usrCoords[2]}this.zoomIn(h,m);this.attr.zoom.factorx=o;this.attr.zoom.factory=i}return!1},gestureStartListener:function gestureStartListener(e){var t;e.preventDefault();this.prevScale=1;this.prevDist=p.distance([e.touches[0].clientX,e.touches[0].clientY],[e.touches[1].clientX,e.touches[1].clientY],2);t=this.getMousePosition(e,0);this.initMoveOrigin(t[0],t[1]);this._num_zoom=this._num_pan=0;this.mode=this.BOARD_MODE_ZOOM;return!1},_isRequiredKeyPressed:function _isRequiredKeyPressed(e,t){var r=this.attr[t];if(!r.enabled){return!1}if((r.needshift&&e.shiftKey||!r.needshift&&!e.shiftKey)&&(r.needctrl&&e.ctrlKey||!r.needctrl&&!e.ctrlKey)){return!0}return!1},_pointerAddBoardTouches:function _pointerAddBoardTouches(e){var t,r;for(t=0,r=!1;t<this._board_touches.length;t++){if(this._board_touches[t].pointerId===e.pointerId){this._board_touches[t].clientX=e.clientX;this._board_touches[t].clientY=e.clientY;r=!0;break}}if(!r){this._board_touches.push({pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY})}return this},_pointerRemoveBoardTouches:function _pointerRemoveBoardTouches(e){var t;for(t=0;t<this._board_touches.length;t++){if(this._board_touches[t].pointerId===e.pointerId){this._board_touches.splice(t,1);break}}return this},pointerDownListener:function pointerDownListener(e,t){var r,o,s,n,a,d,l=this.options.precision.touch,c,p;if(!this.hasPointerUp){if(window.navigator.msPointerEnabled){f.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this)}else{f.addEvent(this.document,"pointerup",this.pointerUpListener,this)}this.hasPointerUp=!0}if(this.hasMouseHandlers){this.removeMouseEventHandlers()}if(this.hasTouchHandlers){this.removeTouchEventHandlers()}if(this.document.selection&&C.isFunction(this.document.selection.empty)){this.document.selection.empty()}else if(window.getSelection){d=window.getSelection();if(d.removeAllRanges){try{d.removeAllRanges()}catch(t){}}}if(f.isBrowser&&("touch"===e.pointerType||window.navigator.msMaxTouchPoints&&1<window.navigator.msMaxTouchPoints)){this.options.precision.hasPoint=l}n=this.getMousePosition(e);this._testForSelection(e);if(this.selectingMode){this._startSelecting(n);this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[e]);return}if(t){a=[t];this.mode=this.BOARD_MODE_DRAG}else{a=this.initMoveObject(n[0],n[1],e,"mouse")}if(0<a.length){p=a[a.length-1];c=!1;for(r=0;r<this.touches.length;r++){if(this.touches[r].obj===p){o=r;s=this.touches[r].targets.push({num:e.pointerId,X:n[0],Y:n[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]})-1;c=!0;break}}if(!c){s=0;o=this.touches.push({obj:p,targets:[{num:e.pointerId,X:n[0],Y:n[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}]})-1}this.dehighlightAll();p.highlight(!0);this.saveStartPos(p,this.touches[o].targets[s]);if(e&&e.preventDefault){e.preventDefault()}else if(window.event){window.event.returnValue=!1}}if(0<this.touches.length){e.preventDefault();e.stopPropagation()}this.options.precision.hasPoint=this.options.precision.mouse;if(f.isBrowser&&"touch"!==e.pointerType){if(this.mode===this.BOARD_MODE_NONE){this.mouseOriginMoveStart(e)}}else{this._pointerAddBoardTouches(e);e.touches=this._board_touches;if(this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(e)){}else if((this.mode===this.BOARD_MODE_NONE||this.mode===this.BOARD_MODE_MOVE_ORIGIN)&&2==e.touches.length){if(this.mode===this.BOARD_MODE_MOVE_ORIGIN){this.originMoveEnd()}this.gestureStartListener(e)}}this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[e]);return!1},pointerMoveListener:function pointerMoveListener(e){var t,r,o;if(this.mode!==this.BOARD_MODE_DRAG){this.dehighlightAll();this.showInfobox(!1)}if(this.mode!==this.BOARD_MODE_NONE){e.preventDefault();e.stopPropagation()}if(f.isBrowser&&("touch"===e.pointerType||window.navigator.msMaxTouchPoints&&1<window.navigator.msMaxTouchPoints)){this.options.precision.hasPoint=this.options.precision.touch}this.updateQuality=this.BOARD_QUALITY_LOW;if(this.selectingMode){o=this.getMousePosition(e);this._moveSelecting(o);this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[e,this.mode])}else if(!this.mouseOriginMove(e)){if(this.mode===this.BOARD_MODE_DRAG){for(t=0;t<this.touches.length;t++){for(r=0;r<this.touches[t].targets.length;r++){if(this.touches[t].targets[r].num===e.pointerId){if(1===this.touches[t].targets.length){this.touches[t].targets[r].X=e.pageX;this.touches[t].targets[r].Y=e.pageY;o=this.getMousePosition(e);this.moveObject(o[0],o[1],this.touches[t],e,"touch")}else if(2===this.touches[t].targets.length&&-1<this.touches[t].targets[0].num&&-1<this.touches[t].targets[1].num){this.touches[t].targets[r].X=e.pageX;this.touches[t].targets[r].Y=e.pageY;this.twoFingerMove(this.getMousePosition({clientX:this.touches[t].targets[0].X,clientY:this.touches[t].targets[0].Y}),this.getMousePosition({clientX:this.touches[t].targets[1].X,clientY:this.touches[t].targets[1].Y}),this.touches[t],e)}break}}}}else{if("touch"==e.pointerType){this._pointerAddBoardTouches(e);if(2==this._board_touches.length){e.touches=this._board_touches;this.gestureChangeListener(e)}}else{o=this.getMousePosition(e);this.highlightElements(o[0],o[1],e,-1)}}}this.options.precision.hasPoint=this.options.precision.mouse;this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[e,this.mode]);return this.mode===this.BOARD_MODE_NONE},pointerUpListener:function pointerUpListener(e){var t,r,o;this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[e]);this.showInfobox(!1);if(e){for(t=0;t<this.touches.length;t++){for(r=0;r<this.touches[t].targets.length;r++){if(this.touches[t].targets[r].num===e.pointerId){this.touches[t].targets.splice(r,1);if(0===this.touches[t].targets.length){this.touches.splice(t,1)}break}}}}if(this.selectingMode){this._stopSelecting(e);this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[e])}else{for(t=this.downObjects.length-1;-1<t;t--){o=!1;for(r=0;r<this.touches.length;r++){if(this.touches[r].obj.id===this.downObjects[t].id){o=!0}}if(!o){this.downObjects[t].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[e]);this.downObjects[t].snapToGrid();this.downObjects[t].snapToPoints();this.downObjects.splice(t,1)}}}this._pointerRemoveBoardTouches(e);if(0===this._board_touches.length){if(this.hasPointerUp){if(window.navigator.msPointerEnabled){f.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this)}else{f.removeEvent(this.document,"pointerup",this.pointerUpListener,this)}this.hasPointerUp=!1}this.dehighlightAll();this.updateQuality=this.BOARD_QUALITY_HIGH;this.mode=this.BOARD_MODE_NONE;this.originMoveEnd();this.update()}return!0},touchStartListener:function touchStartListener(e){var o,s,a,d,l,c=this.options.precision.touch,p,u,h,m=e[t.touchProperty],g;if(!this.hasTouchEnd){f.addEvent(this.document,"touchend",this.touchEndListener,this);this.hasTouchEnd=!0}if(this.document.selection&&C.isFunction(this.document.selection.empty)){this.document.selection.empty()}else if(window.getSelection){window.getSelection().removeAllRanges()}this.options.precision.hasPoint=this.options.precision.touch;for(o=0;o<m.length;o++){m[o].jxg_isused=!1}for(o=0;o<this.touches.length;o++){for(d=0;d<this.touches[o].targets.length;d++){this.touches[o].targets[d].num=-1;c=this.options.precision.touch;do{for(l=0;l<m.length;l++){if(Math.abs(Math.pow(m[l].screenX-this.touches[o].targets[d].X,2)+Math.pow(m[l].screenY-this.touches[o].targets[d].Y,2))<c*c){this.touches[o].targets[d].num=l;this.touches[o].targets[d].X=m[l].screenX;this.touches[o].targets[d].Y=m[l].screenY;m[l].jxg_isused=!0;break}}c*=2}while(-1===this.touches[o].targets[d].num&&c<this.options.precision.touchMax);if(-1===this.touches[o].targets[d].num){t.debug("i couldn't find a targettouches for target no "+d+" on "+this.touches[o].obj.name+" ("+this.touches[o].obj.id+"). Removed the target.");t.debug("eps = "+c+", touchMax = "+n.precision.touchMax);this.touches[o].targets.splice(o,1)}}}for(o=0;o<m.length;o++){if(!m[o].jxg_isused){s=this.getMousePosition(e,o);if(this.selectingMode){this._startSelecting(s);this.triggerEventHandlers(["touchstartselecting","startselecting"],[e]);e.preventDefault();e.stopPropagation();this.options.precision.hasPoint=this.options.precision.mouse;return 0<this.touches.length}a=this.initMoveObject(s[0],s[1],e,"touch");if(0!==a.length){p=a[a.length-1];if(C.isPoint(p)||p.elementClass===r.OBJECT_CLASS_TEXT||p.type===r.OBJECT_TYPE_TICKS||p.type===r.OBJECT_TYPE_IMAGE){h=[{num:o,X:m[o].screenX,Y:m[o].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}];this.saveStartPos(p,h[0]);this.touches.push({obj:p,targets:h});p.highlight(!0)}else if(p.elementClass===r.OBJECT_CLASS_LINE||p.elementClass===r.OBJECT_CLASS_CIRCLE||p.elementClass===r.OBJECT_CLASS_CURVE||p.type===r.OBJECT_TYPE_POLYGON){u=!1;for(d=0;d<this.touches.length;d++){if(p.id===this.touches[d].obj.id){u=!0;if(1===this.touches[d].targets.length){g={num:o,X:m[o].screenX,Y:m[o].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]};this.saveStartPos(p,g);this.touches[d].targets.push(g)}m[o].jxg_isused=!0}}if(!u){h=[{num:o,X:m[o].screenX,Y:m[o].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}];this.saveStartPos(p,h[0]);this.touches.push({obj:p,targets:h});p.highlight(!0)}}}m[o].jxg_isused=!0}}if(0<this.touches.length){e.preventDefault();e.stopPropagation()}if(this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(e)){}else if(2==m.length&&(this.mode===this.BOARD_MODE_NONE||this.mode===this.BOARD_MODE_MOVE_ORIGIN)){if(this.mode===this.BOARD_MODE_MOVE_ORIGIN){this.originMoveEnd()}this.gestureStartListener(e)}this.options.precision.hasPoint=this.options.precision.mouse;this.triggerEventHandlers(["touchstart","down"],[e]);return!1},touchMoveListener:function touchMoveListener(e){var r,o,s,n=e[t.touchProperty];if(this.mode!==this.BOARD_MODE_NONE){e.preventDefault();e.stopPropagation()}if(this.mode!==this.BOARD_MODE_DRAG){this.showInfobox(!1)}this.options.precision.hasPoint=this.options.precision.touch;this.updateQuality=this.BOARD_QUALITY_LOW;if(this.selectingMode){for(r=0;r<n.length;r++){if(!n[r].jxg_isused){o=this.getMousePosition(e,r);this._moveSelecting(o);this.triggerEventHandlers(["touchmoves","moveselecting"],[e,this.mode]);break}}}else{if(!this.touchOriginMove(e)){if(this.mode===this.BOARD_MODE_DRAG){for(r=0;r<this.touches.length;r++){if(1===this.touches[r].targets.length){if(n[this.touches[r].targets[0].num]){o=this.getMousePosition(e,this.touches[r].targets[0].num);if(0>o[0]||o[0]>this.canvasWidth||0>o[1]||o[1]>this.canvasHeight){return}this.touches[r].targets[0].X=n[this.touches[r].targets[0].num].screenX;this.touches[r].targets[0].Y=n[this.touches[r].targets[0].num].screenY;this.moveObject(o[0],o[1],this.touches[r],e,"touch")}}else if(2===this.touches[r].targets.length&&-1<this.touches[r].targets[0].num&&-1<this.touches[r].targets[1].num){if(n[this.touches[r].targets[0].num]&&n[this.touches[r].targets[1].num]){o=this.getMousePosition(e,this.touches[r].targets[0].num);s=this.getMousePosition(e,this.touches[r].targets[1].num);if(0>o[0]||o[0]>this.canvasWidth||0>o[1]||o[1]>this.canvasHeight||0>s[0]||s[0]>this.canvasWidth||0>s[1]||s[1]>this.canvasHeight){return}this.touches[r].targets[0].X=n[this.touches[r].targets[0].num].screenX;this.touches[r].targets[0].Y=n[this.touches[r].targets[0].num].screenY;this.touches[r].targets[1].X=n[this.touches[r].targets[1].num].screenX;this.touches[r].targets[1].Y=n[this.touches[r].targets[1].num].screenY;this.twoFingerMove(o,s,this.touches[r],e)}}}}else{if(2==n.length){this.gestureChangeListener(e)}}}}if(this.mode!==this.BOARD_MODE_DRAG){this.showInfobox(!1)}this.options.precision.hasPoint=this.options.precision.mouse;this.triggerEventHandlers(["touchmove","move"],[e,this.mode]);return this.mode===this.BOARD_MODE_NONE},touchEndListener:function touchEndListener(e){var o,s,n,a=this.options.precision.touch,d=[],l,c,p=e&&e[t.touchProperty];this.triggerEventHandlers(["touchend","up"],[e]);this.showInfobox(!1);if(this.selectingMode){this._stopSelecting(e);this.triggerEventHandlers(["touchstopselecting","stopselecting"],[e])}else if(p&&0<p.length){for(o=0;o<this.touches.length;o++){d[o]=this.touches[o]}this.touches.length=0;for(o=0;o<p.length;o++){p[o].jxg_isused=!1}for(o=0;o<d.length;o++){l=!1;c=0;for(s=0;s<d[o].targets.length;s++){d[o].targets[s].found=!1;for(n=0;n<p.length;n++){if(Math.abs(Math.pow(p[n].screenX-d[o].targets[s].X,2)+Math.pow(p[n].screenY-d[o].targets[s].Y,2))<a*a){d[o].targets[s].found=!0;d[o].targets[s].num=n;d[o].targets[s].X=p[n].screenX;d[o].targets[s].Y=p[n].screenY;c+=1;break}}}if(C.isPoint(d[o].obj)){l=d[o].targets[0]&&d[o].targets[0].found}else if(d[o].obj.elementClass===r.OBJECT_CLASS_LINE){l=d[o].targets[0]&&d[o].targets[0].found||d[o].targets[1]&&d[o].targets[1].found}else if(d[o].obj.elementClass===r.OBJECT_CLASS_CIRCLE){l=1===c||3===c}if(l){this.touches.push({obj:d[o].obj,targets:[]});for(s=0;s<d[o].targets.length;s++){if(d[o].targets[s].found){this.touches[this.touches.length-1].targets.push({num:d[o].targets[s].num,X:d[o].targets[s].screenX,Y:d[o].targets[s].screenY,Xprev:NaN,Yprev:NaN,Xstart:d[o].targets[s].Xstart,Ystart:d[o].targets[s].Ystart,Zstart:d[o].targets[s].Zstart})}}}else{d[o].obj.noHighlight()}}}else{this.touches.length=0}for(o=this.downObjects.length-1;-1<o;o--){l=!1;for(s=0;s<this.touches.length;s++){if(this.touches[s].obj.id===this.downObjects[o].id){l=!0}}if(!l){this.downObjects[o].triggerEventHandlers(["touchup","up"],[e]);this.downObjects[o].snapToGrid();this.downObjects[o].snapToPoints();this.downObjects.splice(o,1)}}if(!p||0===p.length){if(this.hasTouchEnd){f.removeEvent(this.document,"touchend",this.touchEndListener,this);this.hasTouchEnd=!1}this.dehighlightAll();this.updateQuality=this.BOARD_QUALITY_HIGH;this.originMoveEnd();this.update()}return!0},mouseDownListener:function mouseDownListener(e){var t,r,o;if(this.document.selection&&C.isFunction(this.document.selection.empty)){this.document.selection.empty()}else if(window.getSelection){window.getSelection().removeAllRanges()}if(!this.hasMouseUp){f.addEvent(this.document,"mouseup",this.mouseUpListener,this);this.hasMouseUp=!0}else{return}t=this.getMousePosition(e);this._testForSelection(e);if(this.selectingMode){this._startSelecting(t);this.triggerEventHandlers(["mousestartselecting","startselecting"],[e]);return}r=this.initMoveObject(t[0],t[1],e,"mouse");if(0===r.length){this.mode=this.BOARD_MODE_NONE;o=!0}else{this.mouse={obj:null,targets:[{X:t[0],Y:t[1],Xprev:NaN,Yprev:NaN}]};this.mouse.obj=r[r.length-1];this.dehighlightAll();this.mouse.obj.highlight(!0);this.mouse.targets[0].Xstart=[];this.mouse.targets[0].Ystart=[];this.mouse.targets[0].Zstart=[];this.saveStartPos(this.mouse.obj,this.mouse.targets[0]);if(e&&e.preventDefault){e.preventDefault()}else if(window.event){window.event.returnValue=!1}}if(this.mode===this.BOARD_MODE_NONE){o=this.mouseOriginMoveStart(e)}this.triggerEventHandlers(["mousedown","down"],[e]);return o},mouseMoveListener:function mouseMoveListener(e){var t=this.getMousePosition(e);this.updateQuality=this.BOARD_QUALITY_LOW;if(this.mode!==this.BOARD_MODE_DRAG){this.dehighlightAll();this.showInfobox(!1)}if(this.selectingMode){this._moveSelecting(t);this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[e,this.mode])}else if(!this.mouseOriginMove(e)){if(this.mode===this.BOARD_MODE_DRAG){this.moveObject(t[0],t[1],this.mouse,e,"mouse")}else{this.highlightElements(t[0],t[1],e,-1)}this.triggerEventHandlers(["mousemove","move"],[e,this.mode])}this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function mouseUpListener(e){var t;if(!1===this.selectingMode){this.triggerEventHandlers(["mouseup","up"],[e])}this.updateQuality=this.BOARD_QUALITY_HIGH;if(this.mouse&&this.mouse.obj){this.mouse.obj.snapToGrid(this.mouse.targets[0]);this.mouse.obj.snapToPoints()}this.originMoveEnd();this.dehighlightAll();this.update();if(this.selectingMode){this._stopSelecting(e);this.triggerEventHandlers(["mousestopselecting","stopselecting"],[e])}else{for(t=0;t<this.downObjects.length;t++){this.downObjects[t].triggerEventHandlers(["mouseup","up"],[e])}}this.downObjects.length=0;if(this.hasMouseUp){f.removeEvent(this.document,"mouseup",this.mouseUpListener,this);this.hasMouseUp=!1}this.mouse=null},mouseWheelListener:function mouseWheelListener(e){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(e,"zoom")){return!0}e=e||window.event;var t=e.detail?-e.detail:e.wheelDelta/40,o=new s(r.COORDS_BY_SCREEN,this.getMousePosition(e),this);if(0<t){this.zoomIn(o.usrCoords[1],o.usrCoords[2])}else{this.zoomOut(o.usrCoords[1],o.usrCoords[2])}this.triggerEventHandlers(["mousewheel"],[e]);e.preventDefault();return!1},initInfobox:function initInfobox(){var e=C.copyAttributes({},this.options,"infobox");e.id=this.id+"_infobox";this.infobox=this.create("text",[0,0,"0,0"],e);this.infobox.distanceX=-20;this.infobox.distanceY=25;this.infobox.dump=!1;this.showInfobox(!1);return this},updateInfobox:function updateInfobox(e){var t,r,o,i,s;if(!C.evaluate(e.visProp.showinfobox)){return this}if(C.isPoint(e)){o=e.coords.usrCoords[1];i=e.coords.usrCoords[2];s=C.evaluate(e.visProp.infoboxdigits);this.infobox.setCoords(o+this.infobox.distanceX/this.unitX,i+this.infobox.distanceY/this.unitY);if("string"!=typeof e.infoboxText){if("auto"===s){t=C.autoDigits(o);r=C.autoDigits(i)}else if(C.isNumber(s)){t=C.toFixed(o,s);r=C.toFixed(i,s)}else{t=o;r=i}this.highlightInfobox(t,r,e)}else{this.highlightCustomInfobox(e.infoboxText,e)}this.showInfobox(!0)}return this},showInfobox:function showInfobox(e){if(this.infobox.hiddenByParent==e){this.infobox.hiddenByParent=!e;this.infobox.prepareUpdate().updateVisibility(e).updateRenderer()}return this},highlightInfobox:function highlightInfobox(e,t,r){this.highlightCustomInfobox("("+e+", "+t+")",r);return this},highlightCustomInfobox:function highlightCustomInfobox(e){this.infobox.setText(e);return this},dehighlightAll:function dehighlightAll(){var e,t,r=!1;for(e in this.highlightedObjects){if(this.highlightedObjects.hasOwnProperty(e)){t=this.highlightedObjects[e];if(this.hasMouseHandlers||this.hasPointerHandlers){t.noHighlight()}r=!0}}this.highlightedObjects={};if("canvas"===this.renderer.type&&r){this.prepareUpdate();this.renderer.suspendRedraw(this);this.updateRenderer();this.renderer.unsuspendRedraw()}return this},getScrCoordsOfMouse:function getScrCoordsOfMouse(e,t){return[e,t]},getUsrCoordsOfMouse:function getUsrCoordsOfMouse(e){var t=this.getCoordsTopLeftCorner(),o=f.getPosition(e,null,this.document),i=o[0]-t[0],n=o[1]-t[1],a=new s(r.COORDS_BY_SCREEN,[i,n],this);return a.usrCoords.slice(1)},getAllUnderMouse:function getAllUnderMouse(e){var t=this.getAllObjectsUnderMouse(e);t.push(this.getUsrCoordsOfMouse(e));return t},getAllObjectsUnderMouse:function getAllObjectsUnderMouse(e){var t=this.getCoordsTopLeftCorner(),r=f.getPosition(e,null,this.document),o=r[0]-t[0],i=r[1]-t[1],s=[],n,a,d=this.objectsList.length;for(n=0;n<d;n++){a=this.objectsList[n];if(a.visPropCalc.visible&&a.hasPoint&&a.hasPoint(o,i)){s[s.length]=a}}return s},updateCoords:function updateCoords(){var e,t,r=this.objectsList.length;for(t=0;t<r;t++){e=this.objectsList[t];if(C.exists(e.coords)){if(C.evaluate(e.visProp.frozen)){e.coords.screen2usr()}else{e.coords.usr2screen()}}}return this},moveOrigin:function moveOrigin(e,t,r){if(C.exists(e)&&C.exists(t)){this.origin.scrCoords[1]=e;this.origin.scrCoords[2]=t;if(r){this.origin.scrCoords[1]-=this.drag_dx;this.origin.scrCoords[2]-=this.drag_dy}}this.updateCoords().clearTraces().fullUpdate();this.triggerEventHandlers(["boundingbox"]);return this},addConditions:function addConditions(e){var o,s,n,a,d,l,c,p=[],u=e.indexOf("<data>"),h=e.indexOf("</data>"),g=function(o,i,s,n){return function(){var a,d;a=o.select(i.id);d=a.coords.usrCoords[n];if(2===n){a.setPositionDirectly(r.COORDS_BY_USER,[s(),d])}else{a.setPositionDirectly(r.COORDS_BY_USER,[d,s()])}a.prepareUpdate().update()}},y=function(t,r,o){return function(){var i,s;i=t.select(r.id);s=o();i.setAttribute({visible:s})}},v=function(t,r,o,i){return function(){var s,n;s=t.select(r.id);n=o();if("strokewidth"===i){s.visProp.strokewidth=n}else{n=b.rgba2rgbo(n);s.visProp[i+"color"]=n[0];s.visProp[i+"opacity"]=n[1]}}},f=function(t,r,o){return function(){var i=t.select(r.id);i.position=o()}},P=function(t,r,o){return function(){var i=t.select(r.id);i.setStyle(o())}};if(0>u){return}while(0<=u){o=e.slice(u+6,h);s=o.indexOf("=");n=o.slice(0,s);a=o.slice(s+1);s=n.indexOf(".");d=n.slice(0,s);l=this.elementsByName[C.unescapeHTML(d)];c=n.slice(s+1).replace(/\s+/g,"").toLowerCase();a=C.createFunction(a,this,"",!0);if(!C.exists(this.elementsByName[d])){t.debug("debug conditions: |"+d+"| undefined")}else{"el = this.objects[\""+l.id+"\"];\n";switch(c){case"x":p.push(g(this,l,a,2));break;case"y":p.push(g(this,l,a,1));break;case"visible":p.push(y(this,l,a));break;case"position":p.push(f(this,l,a));break;case"stroke":p.push(v(this,l,a,"stroke"));break;case"style":p.push(P(this,l,a));break;case"strokewidth":p.push(v(this,l,a,"strokewidth"));break;case"fill":p.push(v(this,l,a,"fill"));break;case"label":break;default:t.debug("property '"+c+"' in conditions not yet implemented:"+a);break;}}e=e.slice(h+7);u=e.indexOf("<data>");h=e.indexOf("</data>")}this.updateConditions=function(){var e;for(e=0;e<p.length;e++){p[e]()}this.prepareUpdate().updateElements();return!0};this.updateConditions()},updateConditions:function updateConditions(){return!1},calculateSnapSizes:function calculateSnapSizes(){var e=new s(r.COORDS_BY_USER,[0,0],this),t=new s(r.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),o=e.scrCoords[1]-t.scrCoords[1],i=e.scrCoords[2]-t.scrCoords[2];this.options.grid.snapSizeX=this.options.grid.gridX;while(25<Math.abs(o)){this.options.grid.snapSizeX*=2;o/=2}this.options.grid.snapSizeY=this.options.grid.gridY;while(25<Math.abs(i)){this.options.grid.snapSizeY*=2;i/=2}return this},applyZoom:function applyZoom(){this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate();return this},zoomIn:function zoomIn(e,t){var r=this.getBoundingBox(),o=this.attr.zoom.factorx,i=this.attr.zoom.factory,s=(r[2]-r[0])*(1-1/o),n=(r[1]-r[3])*(1-1/i),a=.5,d=.5,l=this.attr.zoom.eps||this.attr.zoom.min||.001;if(this.zoomX>this.attr.zoom.max&&1<o||this.zoomY>this.attr.zoom.max&&1<i||this.zoomX<l&&1>o||this.zoomY<l&&1>i){return this}if(C.isNumber(e)&&C.isNumber(t)){a=(e-r[0])/(r[2]-r[0]);d=(r[1]-t)/(r[1]-r[3])}this.setBoundingBox([r[0]+s*a,r[1]-n*d,r[2]-s*(1-a),r[3]+n*(1-d)],!1);this.zoomX*=o;this.zoomY*=i;return this.applyZoom()},zoomOut:function zoomOut(e,t){var r=this.getBoundingBox(),o=this.attr.zoom.factorx,i=this.attr.zoom.factory,s=(r[2]-r[0])*(1-o),n=(r[1]-r[3])*(1-i),a=.5,d=.5,l=this.attr.zoom.eps||this.attr.zoom.min||.001;if(this.zoomX<l||this.zoomY<l){return this}if(C.isNumber(e)&&C.isNumber(t)){a=(e-r[0])/(r[2]-r[0]);d=(r[1]-t)/(r[1]-r[3])}this.setBoundingBox([r[0]+s*a,r[1]-n*d,r[2]-s*(1-a),r[3]+n*(1-d)],!1);this.zoomX/=o;this.zoomY/=i;return this.applyZoom()},zoom100:function zoom100(){var e=this.getBoundingBox(),t=.5*((e[2]-e[0])*(1-this.zoomX)),r=.5*((e[1]-e[3])*(1-this.zoomY));this.setBoundingBox([e[0]+t,e[1]-r,e[2]-t,e[3]+r],!1);this.zoomX=1;this.zoomY=1;return this.applyZoom()},zoomAllPoints:function zoomAllPoints(){var e,t,r,o,i,s=0,n=0,a=0,d=0,l=this.objectsList.length;for(e=0;e<l;e++){i=this.objectsList[e];if(C.isPoint(i)&&i.visPropCalc.visible){if(i.coords.usrCoords[1]<s){s=i.coords.usrCoords[1]}else if(i.coords.usrCoords[1]>n){n=i.coords.usrCoords[1]}if(i.coords.usrCoords[2]>d){d=i.coords.usrCoords[2]}else if(i.coords.usrCoords[2]<a){a=i.coords.usrCoords[2]}}}t=50;r=t/this.unitX;o=t/this.unitY;this.zoomX=1;this.zoomY=1;this.setBoundingBox([s-r,d+o,n+r,a-o],!0);return this.applyZoom()},zoomElements:function zoomElements(t){var r,o,s,n,a=[0,0,0,0],d=[1,-1,-1,1];if(!C.isArray(t)||0===t.length){return this}for(r=0;r<t.length;r++){s=this.select(t[r]);n=s.bounds();if(C.isArray(n)){if(C.isArray(a)){for(o=0;4>o;o++){if(d[o]*n[o]<d[o]*a[o]){a[o]=n[o]}}}else{a=n}}}if(C.isArray(a)){for(o=0;4>o;o++){a[o]-=d[o]}this.zoomX=1;this.zoomY=1;this.setBoundingBox(a,!0)}return this},setZoom:function setZoom(e,t){var r=this.attr.zoom.factorx,o=this.attr.zoom.factory;this.attr.zoom.factorx=e/this.zoomX;this.attr.zoom.factory=t/this.zoomY;this.zoomIn();this.attr.zoom.factorx=r;this.attr.zoom.factory=o;return this},removeObject:function removeObject(o){var s,e;if(C.isArray(o)){for(e=0;e<o.length;e++){this.removeObject(o[e])}return this}o=this.select(o);if(!C.exists(o)||C.isString(o)){return this}try{for(s in o.childElements){if(o.childElements.hasOwnProperty(s)){o.childElements[s].board.removeObject(o.childElements[s])}}for(s in o.objects){if(o.objects.hasOwnProperty(s)){o.objects[s].board.removeObject(o.objects[s])}}for(s in this.objects){if(this.objects.hasOwnProperty(s)&&C.exists(this.objects[s].childElements)){delete this.objects[s].childElements[o.id];delete this.objects[s].descendants[o.id]}}if(-1<o._pos){this.objectsList.splice(o._pos,1);for(s=o._pos;s<this.objectsList.length;s++){this.objectsList[s]._pos--}}else if(o.type!==r.OBJECT_TYPE_TURTLE){t.debug("Board.removeObject: object "+o.id+" not found in list.")}delete this.objects[o.id];delete this.elementsByName[o.name];if(o.visProp&&C.evaluate(o.visProp.trace)){o.clearTrace()}if(C.exists(o.remove)){o.remove()}}catch(r){t.debug(o.id+": Could not be removed: "+r)}this.update();return this},removeAncestors:function removeAncestors(e){for(var t in e.ancestors){if(e.ancestors.hasOwnProperty(t)){this.removeAncestors(e.ancestors[t])}}this.removeObject(e);return this},initGeonextBoard:function initGeonextBoard(){var e,t,r;e=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0});t=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0});r=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0});this.create("line",[e,t],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1});this.create("line",[e,r],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1});return this},resizeContainer:function resizeContainer(e,t,r,o){var i;if(!o){i=this.getBoundingBox()}this.canvasWidth=parseInt(e,10);this.canvasHeight=parseInt(t,10);if(!r){this.containerObj.style.width=this.canvasWidth+"px";this.containerObj.style.height=this.canvasHeight+"px"}this.renderer.resize(this.canvasWidth,this.canvasHeight);if(!o){this.setBoundingBox(i,this.keepaspectratio)}return this},showDependencies:function showDependencies(){var e,r,o,s,n;r="<p>\n";for(e in this.objects){if(this.objects.hasOwnProperty(e)){n=0;for(o in this.objects[e].childElements){if(this.objects[e].childElements.hasOwnProperty(o)){n+=1}}if(0<=n){r+="<strong>"+this.objects[e].id+":</strong> "}for(o in this.objects[e].childElements){if(this.objects[e].childElements.hasOwnProperty(o)){r+=this.objects[e].childElements[o].id+"("+this.objects[e].childElements[o].name+"), "}}r+="<p>\n"}}r+="</p>\n";s=window.open();s.document.open();s.document.write(r);s.document.close();return this},showXML:function showXML(){var e=window.open("");e.document.open();e.document.write("<pre>"+C.escapeHTML(this.xmlString)+"</pre>");e.document.close();return this},prepareUpdate:function prepareUpdate(){var e,t,r=this.objectsList.length;for(e=0;e<r;e++){t=this.objectsList[e];t.needsUpdate=t.needsRegularUpdate||this.needsFullUpdate}for(e in this.groups){if(this.groups.hasOwnProperty(e)){t=this.groups[e];t.needsUpdate=t.needsRegularUpdate||this.needsFullUpdate}}return this},updateElements:function updateElements(e){var t,r;e=this.select(e);for(t=0;t<this.objectsList.length;t++){r=this.objectsList[t];r.update(!C.exists(e)||r.id!==e.id).updateVisibility()}for(t in this.groups){if(this.groups.hasOwnProperty(t)){this.groups[t].update(e)}}return this},updateRenderer:function updateRenderer(){var e,t=this.objectsList.length;if("canvas"===this.renderer.type){this.updateRendererCanvas()}else{for(e=0;e<t;e++){this.objectsList[e].updateRenderer()}}return this},updateRendererCanvas:function updateRendererCanvas(){var e,t,r,o,s,n=this.objectsList.length,a=this.options.layer,d=this.options.layer.numlayers,l=Number.NEGATIVE_INFINITY;for(r=0;r<d;r++){o=Number.POSITIVE_INFINITY;for(s in a){if(a.hasOwnProperty(s)){if(a[s]>l&&a[s]<o){o=a[s]}}}l=o;for(e=0;e<n;e++){t=this.objectsList[e];if(t.visProp.layer===o){t.prepareUpdate().updateRenderer()}}}return this},addHook:function addHook(e,r,o){t.deprecated("Board.addHook()","Board.on()");r=C.def(r,"update");o=C.def(o,this);this.hooks.push([r,e]);this.on(r,e,o);return this.hooks.length-1},addEvent:t.shortcut(t.Board.prototype,"on"),removeHook:function removeHook(e){t.deprecated("Board.removeHook()","Board.off()");if(this.hooks[e]){this.off(this.hooks[e][0],this.hooks[e][1]);this.hooks[e]=null}return this},removeEvent:t.shortcut(t.Board.prototype,"off"),updateHooks:function updateHooks(){var e=Array.prototype.slice.call(arguments,0);t.deprecated("Board.updateHooks()","Board.triggerEventHandlers()");e[0]=C.def(e[0],"update");this.triggerEventHandlers([e[0]],arguments);return this},addChild:function addChild(e){if(C.exists(e)&&C.exists(e.containerObj)){this.dependentBoards.push(e);this.update()}return this},removeChild:function removeChild(e){var t;for(t=this.dependentBoards.length-1;0<=t;t--){if(this.dependentBoards[t]===e){this.dependentBoards.splice(t,1)}}return this},update:function update(e){var t,r,o,s;if(this.inUpdate||this.isSuspendedUpdate){return this}this.inUpdate=!0;if("all"===this.attr.minimizereflow&&this.containerObj&&"vml"!==this.renderer.type){s=this.renderer.removeToInsertLater(this.containerObj)}if("svg"===this.attr.minimizereflow&&"svg"===this.renderer.type){s=this.renderer.removeToInsertLater(this.renderer.svgRoot)}this.prepareUpdate().updateElements(e).updateConditions();this.renderer.suspendRedraw(this);this.updateRenderer();this.renderer.unsuspendRedraw();this.triggerEventHandlers(["update"],[]);if(s){s()}r=this.dependentBoards.length;for(t=0;t<r;t++){o=this.dependentBoards[t];if(C.exists(o)&&o!==this){o.updateQuality=this.updateQuality;o.prepareUpdate().updateElements().updateConditions();o.renderer.suspendRedraw();o.updateRenderer();o.renderer.unsuspendRedraw();o.triggerEventHandlers(["update"],[])}}this.inUpdate=!1;return this},fullUpdate:function fullUpdate(){this.needsFullUpdate=!0;this.update();this.needsFullUpdate=!1;return this},addGrid:function addGrid(){this.create("grid",[]);return this},removeGrids:function removeGrids(){var e;for(e=0;e<this.grids.length;e++){this.removeObject(this.grids[e])}this.grids.length=0;this.update();return this},create:function create(e,r,o){var s,n;e=e.toLowerCase();if(!C.exists(r)){r=[]}if(!C.exists(o)){o={}}for(n=0;n<r.length;n++){if(C.isString(r[n])&&!("text"===e&&2===n)&&!(("input"===e||"checkbox"===e||"button"===e)&&(2===n||3===n))){r[n]=this.select(r[n])}}if(C.isFunction(t.elements[e])){s=t.elements[e](this,r,o)}else{throw new Error("JSXGraph: create: Unknown element type given: "+e)}if(!C.exists(s)){t.debug("JSXGraph: create: failure creating "+e);return s}if(s.prepareUpdate&&s.update&&s.updateRenderer){s.fullUpdate()}return s},createElement:function createElement(){t.deprecated("Board.createElement()","Board.create()");return this.create.apply(this,arguments)},clearTraces:function clearTraces(){var e;for(e=0;e<this.objectsList.length;e++){this.objectsList[e].clearTrace()}this.numTraces=0;return this},suspendUpdate:function suspendUpdate(){if(!this.inUpdate){this.isSuspendedUpdate=!0}return this},unsuspendUpdate:function unsuspendUpdate(){if(this.isSuspendedUpdate){this.isSuspendedUpdate=!1;this.fullUpdate()}return this},setBoundingBox:function setBoundingBox(e,t){var r,o,i=f.getDimensions(this.container,this.document);if(!C.isArray(e)){return this}this.plainBB=e;this.canvasWidth=parseInt(i.width,10);this.canvasHeight=parseInt(i.height,10);o=this.canvasWidth;r=this.canvasHeight;if(t){this.unitX=o/(e[2]-e[0]);this.unitY=r/(e[1]-e[3]);if(Math.abs(this.unitX)<Math.abs(this.unitY)){this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY)}else{this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX)}this.keepaspectratio=!0}else{this.unitX=o/(e[2]-e[0]);this.unitY=r/(e[1]-e[3]);this.keepaspectratio=!1}this.moveOrigin(-this.unitX*e[0],this.unitY*e[1]);return this},getBoundingBox:function getBoundingBox(){var e=new s(r.COORDS_BY_SCREEN,[0,0],this),t=new s(r.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[e.usrCoords[1],e.usrCoords[2],t.usrCoords[1],t.usrCoords[2]]},addAnimation:function addAnimation(e){var t=this;this.animationObjects[e.id]=e;if(!this.animationIntervalCode){this.animationIntervalCode=window.setInterval(function(){t.animate()},e.board.attr.animationdelay)}return this},stopAllAnimation:function stopAllAnimation(){for(var e in this.animationObjects){if(this.animationObjects.hasOwnProperty(e)&&C.exists(this.animationObjects[e])){this.animationObjects[e]=null;delete this.animationObjects[e]}}window.clearInterval(this.animationIntervalCode);delete this.animationIntervalCode;return this},animate:function animate(){var e,t,i,s,n,a,d,l,u=0,h=null;for(t in this.animationObjects){if(this.animationObjects.hasOwnProperty(t)&&C.exists(this.animationObjects[t])){u+=1;i=this.animationObjects[t];if(i.animationPath){if(C.isFunction(i.animationPath)){s=i.animationPath(new Date().getTime()-i.animationStart)}else{s=i.animationPath.pop()}if(!C.exists(s)||!C.isArray(s)&&isNaN(s)){delete i.animationPath}else{i.setPositionDirectly(r.COORDS_BY_USER,s);i.fullUpdate();h=i}}if(i.animationData){d=0;for(n in i.animationData){if(i.animationData.hasOwnProperty(n)){a=i.animationData[n].pop();if(!C.exists(a)){delete i.animationData[a]}else{d+=1;e={};e[n]=a;i.setAttribute(e)}}}if(0===d){delete i.animationData}}if(!C.exists(i.animationData)&&!C.exists(i.animationPath)){this.animationObjects[t]=null;delete this.animationObjects[t];if(C.exists(i.animationCallback)){l=i.animationCallback;i.animationCallback=null;l()}}}}if(0==u){window.clearInterval(this.animationIntervalCode);delete this.animationIntervalCode}else{this.update(h)}return this},migratePoint:function migratePoint(e,t,r){var o,s,n,a,d,l,c=!1;e=this.select(e);t=this.select(t);if(C.exists(e.label)){l=e.label.id;c=!0;this.removeObject(e.label)}for(s in e.childElements){if(e.childElements.hasOwnProperty(s)){o=e.childElements[s];a=!1;for(n in o){if(o.hasOwnProperty(n)){if(o[n]===e){o[n]=t;a=!0}}}if(a){delete e.childElements[s]}for(d=0;d<o.parents.length;d++){if(o.parents[d]===e.id){o.parents[d]=t.id}}t.addChild(o)}}if(r){if(c){delete t.childElements[l];delete t.descendants[l]}if(t.label){this.removeObject(t.label)}delete this.elementsByName[t.name];t.name=e.name;if(c){t.createLabel()}}this.removeObject(e);if(C.exists(t.name)&&""!==t.name){this.elementsByName[t.name]=t}this.fullUpdate();return this},emulateColorblindness:function emulateColorblindness(r){var i,s;if(!C.exists(r)){r="none"}if(this.currentCBDef===r){return this}for(i in this.objects){if(this.objects.hasOwnProperty(i)){s=this.objects[i];if("none"!==r){if("none"===this.currentCBDef){s.visPropOriginal={strokecolor:s.visProp.strokecolor,fillcolor:s.visProp.fillcolor,highlightstrokecolor:s.visProp.highlightstrokecolor,highlightfillcolor:s.visProp.highlightfillcolor}}s.setAttribute({strokecolor:b.rgb2cb(C.evaluate(s.visPropOriginal.strokecolor),r),fillcolor:b.rgb2cb(C.evaluate(s.visPropOriginal.fillcolor),r),highlightstrokecolor:b.rgb2cb(C.evaluate(s.visPropOriginal.highlightstrokecolor),r),highlightfillcolor:b.rgb2cb(C.evaluate(s.visPropOriginal.highlightfillcolor),r)})}else if(C.exists(s.visPropOriginal)){t.extend(s.visProp,s.visPropOriginal)}}}this.currentCBDef=r;this.update();return this},select:function select(e){var t,r,o,n,a=e;if(null===a){return a}if(C.isString(a)&&""!==a){if(C.exists(this.objects[a])){a=this.objects[a]}else if(C.exists(this.elementsByName[a])){a=this.elementsByName[a]}else if(C.exists(this.groups[a])){a=this.groups[a]}}else if(C.isFunction(a)||C.isObject(a)&&!C.isFunction(a.setAttribute)){t=C.filterElements(this.objectsList,a);r={};n=t.length;for(o=0;o<n;o++){r[t[o].id]=t[o]}a=new O(r)}else if(C.isObject(a)&&C.exists(a.id)&&!C.exists(this.objects[a.id])){a=null}return a},hasPoint:function hasPoint(e,t){var r=e,o=t,i=this.getBoundingBox();if(C.exists(e)&&C.isArray(e.usrCoords)){r=e.usrCoords[1];o=e.usrCoords[2]}return!!(C.isNumber(r)&&C.isNumber(o)&&i[0]<r&&r<i[2]&&i[1]>o&&o>i[3])},updateCSSTransforms:function updateCSSTransforms(){var e=this.containerObj,t=e,r=e;this.cssTransMat=f.getCSSTransformMatrix(t);t=t.offsetParent;while(t){this.cssTransMat=l.matMatMult(f.getCSSTransformMatrix(t),this.cssTransMat);r=r.parentNode;while(r!==t){this.cssTransMat=l.matMatMult(f.getCSSTransformMatrix(t),this.cssTransMat);r=r.parentNode}t=t.offsetParent}this.cssTransMat=l.inverse(this.cssTransMat);return this},startSelectionMode:function startSelectionMode(){this.selectingMode=!0;this.selectionPolygon.setAttribute({visible:!0});this.selectingBox=[[0,0],[0,0]];this._setSelectionPolygonFromBox();this.selectionPolygon.fullUpdate()},stopSelectionMode:function stopSelectionMode(){this.selectingMode=!1;this.selectionPolygon.setAttribute({visible:!1});return[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function _startSelecting(e){this.isSelecting=!0;this.selectingBox=[[e[0],e[1]],[e[0],e[1]]];this._setSelectionPolygonFromBox()},_moveSelecting:function _moveSelecting(e){if(this.isSelecting){this.selectingBox[1]=[e[0],e[1]];this._setSelectionPolygonFromBox();this.selectionPolygon.fullUpdate()}},_stopSelecting:function _stopSelecting(e){var t=this.getMousePosition(e);this.isSelecting=!1;this.selectingBox[1]=[t[0],t[1]];this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function _setSelectionPolygonFromBox(){var e=this.selectingBox[0],r=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(t.COORDS_BY_SCREEN,[e[0],e[1]]);this.selectionPolygon.vertices[1].setPositionDirectly(t.COORDS_BY_SCREEN,[e[0],r[1]]);this.selectionPolygon.vertices[2].setPositionDirectly(t.COORDS_BY_SCREEN,[r[0],r[1]]);this.selectionPolygon.vertices[3].setPositionDirectly(t.COORDS_BY_SCREEN,[r[0],e[1]])},_testForSelection:function _testForSelection(e){if(this._isRequiredKeyPressed(e,"selection")){if(!C.exists(this.selectionPolygon)){this._createSelectionPolygon(this.attr)}this.startSelectionMode()}},_createSelectionPolygon:function _createSelectionPolygon(e){var t;if(!C.exists(this.selectionPolygon)){t=C.copyAttributes(e,n,"board","selection");if(!0===t.enabled){this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],t)}}return this},__evt__down:function __evt__down(){},__evt__mousedown:function __evt__mousedown(){},__evt__pointerdown:function __evt__pointerdown(){},__evt__touchstart:function __evt__touchstart(){},__evt__up:function __evt__up(){},__evt__mouseup:function __evt__mouseup(){},__evt__pointerup:function __evt__pointerup(){},__evt__touchend:function __evt__touchend(){},__evt__move:function __evt__move(){},__evt__mousemove:function __evt__mousemove(){},__evt__pointermove:function __evt__pointermove(){},__evt__touchmove:function __evt__touchmove(){},__evt__hit:function __evt__hit(){},__evt__mousehit:function __evt__mousehit(){},__evt__update:function __evt__update(){},__evt__boundingbox:function __evt__boundingbox(){},__evt__startselecting:function __evt__startselecting(){},__evt__mousestartselecting:function __evt__mousestartselecting(){},__evt__pointerstartselecting:function __evt__pointerstartselecting(){},__evt__touchstartselecting:function __evt__touchstartselecting(){},__evt__stopselecting:function __evt__stopselecting(){},__evt__mousestopselecting:function __evt__mousestopselecting(){},__evt__pointerstopselecting:function __evt__pointerstopselecting(){},__evt__touchstopselecting:function __evt__touchstopselecting(){},__evt__moveselecting:function __evt__moveselecting(){},__evt__mousemoveselecting:function __evt__mousemoveselecting(){},__evt__pointermoveselecting:function __evt__pointermoveselecting(){},__evt__touchmoveselecting:function __evt__touchmoveselecting(){},__evt:function __evt(){},createRoulette:function createRoulette(e,r,t,o,i,s,n){var a=this;return new function Roulette(){var l=0,c=0,p=0,m=t,b=d.root(function(o){var t=e.X(m),i=e.Y(m),s=r.X(o),n=r.Y(o);return(t-s)*(t-s)+(i-n)*(i-n)},[0,2*Math.PI]),C=0,y=0,v,f=a.create("transform",[function(){return l}],{type:"rotate"}),P=a.create("transform",[function(){return l},function(){return e.X(m)},function(){return e.Y(m)}],{type:"rotate"}),_=a.create("transform",[function(){return c},function(){return p}],{type:"translate"}),S=function(e,t,r){var o=d.D(e.X)(t),i=d.D(e.Y)(t),s=d.D(e.X)(r),n=d.D(e.Y)(r),a=d.D(e.X)(.5*(t+r)),l=d.D(e.Y)(.5*(t+r)),c=Math.sqrt(o*o+i*i),p=Math.sqrt(s*s+n*n),u=Math.sqrt(a*a+l*l);return(c+4*u+p)*(r-t)/6},E=function(e){return v-S(r,b,e)},x=Math.PI/18,O=9*x,T=null;this.rolling=function(){var t,s,T,A,w;C=m+i*o;v=S(e,m,C);y=d.root(E,b);t=new u(e.X(C),e.Y(C));s=new u(r.X(y),r.Y(y));T=new u(d.D(e.X)(C),d.D(e.Y)(C));A=new u(d.D(r.X)(y),d.D(r.Y)(y));w=u.C.div(T,A);l=Math.atan2(w.imaginary,w.real);w.div(u.C.abs(w));w.mult(s);c=t.real-w.real;p=t.imaginary-w.imaginary;if(l<-x&&l>-O){l=-x;P.applyOnce(n)}else if(l>x&&l<O){l=x;P.applyOnce(n)}else{f.applyOnce(n);_.applyOnce(n);m=C;b=y}a.update()};this.start=function(){if(0<s){T=window.setInterval(this.rolling,s)}return this};this.stop=function(){window.clearInterval(T);return this};return this}}});return t.Board});define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/env","utils/color","utils/base64","math/numerics"],function(e,t,r,s,n,a,d,l,c){"use strict";e.SVGRenderer=function(e,r){var o;this.type="svg";this.isIE=-1!==navigator.appVersion.indexOf("MSIE")||navigator.userAgent.match(/Trident\//);this.svgRoot=null;this.svgNamespace="http://www.w3.org/2000/svg";this.xlinkNamespace="http://www.w3.org/1999/xlink";this.container=e;this.container.style.MozUserSelect="none";this.container.style.userSelect="none";this.container.style.overflow="hidden";if(""===this.container.style.position){this.container.style.position="relative"}this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg");this.svgRoot.style.overflow="hidden";this.resize(r.width,r.height);this.container.appendChild(this.svgRoot);this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs");this.svgRoot.appendChild(this.defs);this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter");this.filter.setAttributeNS(null,"id",this.container.id+"_f1");this.filter.setAttributeNS(null,"width","300%");this.filter.setAttributeNS(null,"height","300%");this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse");this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset");this.feOffset.setAttributeNS(null,"result","offOut");this.feOffset.setAttributeNS(null,"in","SourceAlpha");this.feOffset.setAttributeNS(null,"dx","5");this.feOffset.setAttributeNS(null,"dy","5");this.filter.appendChild(this.feOffset);this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur");this.feGaussianBlur.setAttributeNS(null,"result","blurOut");this.feGaussianBlur.setAttributeNS(null,"in","offOut");this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3");this.filter.appendChild(this.feGaussianBlur);this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend");this.feBlend.setAttributeNS(null,"in","SourceGraphic");this.feBlend.setAttributeNS(null,"in2","blurOut");this.feBlend.setAttributeNS(null,"mode","normal");this.filter.appendChild(this.feBlend);this.defs.appendChild(this.filter);this.layer=[];for(o=0;o<t.layer.numlayers;o++){this.layer[o]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.layer[o])}this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1");if(this.supportsForeignObject){this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject");this.foreignObjLayer.setAttribute("x",0);this.foreignObjLayer.setAttribute("y",0);this.foreignObjLayer.setAttribute("width","100%");this.foreignObjLayer.setAttribute("height","100%");this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj");this.svgRoot.appendChild(this.foreignObjLayer)}this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]};e.SVGRenderer.prototype=new r;e.extend(e.SVGRenderer.prototype,{_createArrowHead:function _createArrowHead(t,r){var o,i,s=t.id+"Triangle",a=null,d=n.evaluate(t.visProp.firstarrow),l=n.evaluate(t.visProp.lastarrow);if(n.exists(r)){s+=r}o=this.createPrim("marker",s);o.setAttributeNS(null,"stroke",n.evaluate(t.visProp.strokecolor));o.setAttributeNS(null,"stroke-opacity",n.evaluate(t.visProp.strokeopacity));o.setAttributeNS(null,"fill",n.evaluate(t.visProp.strokecolor));o.setAttributeNS(null,"fill-opacity",n.evaluate(t.visProp.strokeopacity));o.setAttributeNS(null,"stroke-width",0);o.setAttributeNS(null,"orient","auto");o.setAttributeNS(null,"markerUnits","strokeWidth");i=this.container.ownerDocument.createElementNS(this.svgNamespace,"path");if("End"===r){if(e.exists(d.type)){a=n.evaluate(d.type)}o.setAttributeNS(null,"refY",5);if(2===a){o.setAttributeNS(null,"refX",4.9);i.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z")}else if(3===a){o.setAttributeNS(null,"refX",3.33);i.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")}else{o.setAttributeNS(null,"refX",9.9);i.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z")}}else{if(e.exists(l.type)){a=n.evaluate(l.type)}o.setAttributeNS(null,"refY",5);if(2===a){o.setAttributeNS(null,"refX",5.1);i.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z")}else if(3===a){o.setAttributeNS(null,"refX",.1);i.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")}else{o.setAttributeNS(null,"refX",.1);i.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z")}}o.appendChild(i);return o},_setArrowColor:function _setArrowColor(e,t,r,o){if(e){if(n.isString(t)){this._setAttribute(function(){e.setAttributeNS(null,"stroke",t);e.setAttributeNS(null,"fill",t);e.setAttributeNS(null,"stroke-opacity",r);e.setAttributeNS(null,"fill-opacity",r)},o.visPropOld.fillcolor)}if(this.isIE){o.rendNode.parentNode.insertBefore(o.rendNode,o.rendNode)}}},_setArrowWidth:function _setArrowWidth(e,t,r,o){var i,n;if(e){if(0===t){e.setAttributeNS(null,"display","none")}else{i=t;n=i*o;e.setAttributeNS(null,"viewBox","0 0 "+10*i+" "+10*i);e.setAttributeNS(null,"markerHeight",n);e.setAttributeNS(null,"markerWidth",n);e.setAttributeNS(null,"display","inherit")}if(this.isIE){r.parentNode.insertBefore(r,r)}}},updateTicks:function updateTicks(e){var t,r,o,s,a,d="",l=e.ticks.length;for(t=0;t<l;t++){r=e.ticks[t];s=r[0];a=r[1];if(n.isNumber(s[0])&&n.isNumber(s[1])){d+="M "+s[0]+" "+a[0]+" L "+s[1]+" "+a[1]+" "}}o=e.rendNode;if(!n.exists(o)){o=this.createPrim("path",e.id);this.appendChildPrim(o,n.evaluate(e.visProp.layer));e.rendNode=o}o.setAttributeNS(null,"stroke",n.evaluate(e.visProp.strokecolor));o.setAttributeNS(null,"stroke-opacity",n.evaluate(e.visProp.strokeopacity));o.setAttributeNS(null,"stroke-width",n.evaluate(e.visProp.strokewidth));this.updatePathPrim(o,d,e.board)},displayCopyright:function displayCopyright(e,r){var o=this.createPrim("text","licenseText"),i;o.setAttributeNS(null,"x","20px");o.setAttributeNS(null,"y",2+r+"px");o.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+r+"px; fill:#356AA0;  opacity:0.3;");i=this.container.ownerDocument.createTextNode(e);o.appendChild(i);this.appendChildPrim(o,0)},drawInternalText:function drawInternalText(e){var t=this.createPrim("text",e.id);t.style.whiteSpace="nowrap";e.rendNodeText=this.container.ownerDocument.createTextNode("");t.appendChild(e.rendNodeText);this.appendChildPrim(t,n.evaluate(e.visProp.layer));return t},updateInternalText:function updateInternalText(e){var t=e.plaintext,r,o=e.getAnchorX(),i=e.getAnchorY();if(e.rendNode.getAttributeNS(null,"class")!==e.visProp.cssclass){e.rendNode.setAttributeNS(null,"class",n.evaluate(e.visProp.cssclass));e.needsSizeUpdate=!0}if(!isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])){r=e.coords.scrCoords[1];if(e.visPropOld.left!==o+r){e.rendNode.setAttributeNS(null,"x",r+"px");if("left"===o){e.rendNode.setAttributeNS(null,"text-anchor","start")}else if("right"===o){e.rendNode.setAttributeNS(null,"text-anchor","end")}else if("middle"===o){e.rendNode.setAttributeNS(null,"text-anchor","middle")}e.visPropOld.left=o+r}r=e.coords.scrCoords[2];if(e.visPropOld.top!==i+r){e.rendNode.setAttributeNS(null,"y",r+.5*this.vOffsetText+"px");if("bottom"===i){e.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge")}else if("top"===i){e.rendNode.setAttributeNS(null,"dy","1.6ex")}else if("middle"===i){e.rendNode.setAttributeNS(null,"dy","0.6ex")}e.visPropOld.top=i+r}}if(e.htmlStr!==t){e.rendNodeText.data=t;e.htmlStr=t}this.transformImage(e,e.transformations)},updateInternalTextStyle:function updateInternalTextStyle(e,t,r){this.setObjectFillColor(e,t,r)},drawImage:function drawImage(e){var t=this.createPrim("image",e.id);t.setAttributeNS(null,"preserveAspectRatio","none");this.appendChildPrim(t,n.evaluate(e.visProp.layer));e.rendNode=t;this.updateImage(e)},transformImage:function transformImage(e,r){var t,o,i=e.rendNode,n="",a=r.length;if(0<a){o=this.joinTransforms(e,r);t=[o[1][1],o[2][1],o[1][2],o[2][2],o[1][0],o[2][0]].join(",");n+=" matrix("+t+") ";i.setAttributeNS(null,"transform",n)}},updateImageURL:function updateImageURL(e){var t=n.evaluate(e.url);e.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",t)},updateImageStyle:function updateImageStyle(e,t){var r=n.evaluate(t?e.visProp.highlightcssclass:e.visProp.cssclass);e.rendNode.setAttributeNS(null,"class",r)},appendChildPrim:function appendChildPrim(e,r){if(!n.exists(r)){r=0}else if(r>=t.layer.numlayers){r=t.layer.numlayers-1}this.layer[r].appendChild(e);return e},createPrim:function createPrim(e,t){var r=this.container.ownerDocument.createElementNS(this.svgNamespace,e);r.setAttributeNS(null,"id",this.container.id+"_"+t);r.style.position="absolute";if("path"===e){r.setAttributeNS(null,"stroke-linecap","round");r.setAttributeNS(null,"stroke-linejoin","round")}return r},remove:function remove(e){if(n.exists(e)&&n.exists(e.parentNode)){e.parentNode.removeChild(e)}},makeArrows:function makeArrows(e){var t,r=n.evaluate(e.visProp.firstarrow),o=n.evaluate(e.visProp.lastarrow);if(e.visPropOld.firstarrow===r&&e.visPropOld.lastarrow===o){if(this.isIE&&e.visPropCalc.visible&&(r||o)){e.rendNode.parentNode.insertBefore(e.rendNode,e.rendNode)}return}if(r){t=e.rendNodeTriangleStart;if(!n.exists(t)){t=this._createArrowHead(e,"End");this.defs.appendChild(t);e.rendNodeTriangleStart=t;e.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+e.id+"TriangleEnd)")}else{this.defs.appendChild(t)}}else{t=e.rendNodeTriangleStart;if(n.exists(t)){this.remove(t)}}if(o){t=e.rendNodeTriangleEnd;if(!n.exists(t)){t=this._createArrowHead(e,"Start");this.defs.appendChild(t);e.rendNodeTriangleEnd=t;e.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+e.id+"TriangleStart)")}else{this.defs.appendChild(t)}}else{t=e.rendNodeTriangleEnd;if(n.exists(t)){this.remove(t)}}e.visPropOld.firstarrow=r;e.visPropOld.lastarrow=o},updateEllipsePrim:function updateEllipsePrim(e,t,r,o,i){var s=1e6;s=2e5;t=Math.abs(t)<s?t:s*t/Math.abs(t);r=Math.abs(r)<s?r:s*r/Math.abs(r);o=Math.abs(o)<s?o:s*o/Math.abs(o);i=Math.abs(i)<s?i:s*i/Math.abs(i);e.setAttributeNS(null,"cx",t);e.setAttributeNS(null,"cy",r);e.setAttributeNS(null,"rx",Math.abs(o));e.setAttributeNS(null,"ry",Math.abs(i))},updateLinePrim:function updateLinePrim(e,t,r,o,i){var s=1e6;s=2e5;if(!isNaN(t+r+o+i)){t=Math.abs(t)<s?t:s*t/Math.abs(t);r=Math.abs(r)<s?r:s*r/Math.abs(r);o=Math.abs(o)<s?o:s*o/Math.abs(o);i=Math.abs(i)<s?i:s*i/Math.abs(i);e.setAttributeNS(null,"x1",t);e.setAttributeNS(null,"y1",r);e.setAttributeNS(null,"x2",o);e.setAttributeNS(null,"y2",i)}},updatePathPrim:function updatePathPrim(e,t){if(""===t){t="M 0 0"}e.setAttributeNS(null,"d",t)},updatePathStringPoint:function updatePathStringPoint(e,t,r){var o="",i=e.coords.scrCoords,n=.5*(t*Math.sqrt(3)),a=.5*t;if("x"===r){o=" M "+(i[1]-t)+" "+(i[2]-t)+" L "+(i[1]+t)+" "+(i[2]+t)+" M "+(i[1]+t)+" "+(i[2]-t)+" L "+(i[1]-t)+" "+(i[2]+t)}else if("+"===r){o=" M "+(i[1]-t)+" "+i[2]+" L "+(i[1]+t)+" "+i[2]+" M "+i[1]+" "+(i[2]-t)+" L "+i[1]+" "+(i[2]+t)}else if("<>"===r){o=" M "+(i[1]-t)+" "+i[2]+" L "+i[1]+" "+(i[2]+t)+" L "+(i[1]+t)+" "+i[2]+" L "+i[1]+" "+(i[2]-t)+" Z "}else if("^"===r){o=" M "+i[1]+" "+(i[2]-t)+" L "+(i[1]-n)+" "+(i[2]+a)+" L "+(i[1]+n)+" "+(i[2]+a)+" Z "}else if("v"===r){o=" M "+i[1]+" "+(i[2]+t)+" L "+(i[1]-n)+" "+(i[2]-a)+" L "+(i[1]+n)+" "+(i[2]-a)+" Z "}else if(">"===r){o=" M "+(i[1]+t)+" "+i[2]+" L "+(i[1]-a)+" "+(i[2]-n)+" L "+(i[1]-a)+" "+(i[2]+n)+" Z "}else if("<"===r){o=" M "+(i[1]-t)+" "+i[2]+" L "+(i[1]+a)+" "+(i[2]-n)+" L "+(i[1]+a)+" "+(i[2]+n)+" Z "}return o},updatePathStringPrim:function updatePathStringPrim(e){var t,r,o,s=" M ",n="";if(0>=e.numberPoints){return""}o=Math.min(e.points.length,e.numberPoints);if(1===e.bezierDegree){for(t=0;t<o;t++){r=e.points[t].scrCoords;if(isNaN(r[1])||isNaN(r[2])){s=" M "}else{r[1]=Math.max(Math.min(r[1],5000),-5000);r[2]=Math.max(Math.min(r[2],5000),-5000);n+=s+r[1]+" "+r[2];s=" L "}}}else if(3===e.bezierDegree){t=0;while(t<o){r=e.points[t].scrCoords;if(isNaN(r[1])||isNaN(r[2])){s=" M "}else{n+=s+r[1]+" "+r[2];if(s==" C "){t+=1;r=e.points[t].scrCoords;n+=" "+r[1]+" "+r[2];t+=1;r=e.points[t].scrCoords;n+=" "+r[1]+" "+r[2]}s=" C "}t+=1}}return n},updatePathStringBezierPrim:function updatePathStringBezierPrim(e){var t,r,o,s,a,d,l,p=" M ",u="",h=n.evaluate(e.visProp.strokewidth),m="plot"!==n.evaluate(e.visProp.curvetype);if(0>=e.numberPoints){return""}if(m&&e.board.options.curve.RDPsmoothing){e.points=c.RamerDouglasPeucker(e.points,.5)}l=Math.min(e.points.length,e.numberPoints);for(r=1;3>r;r++){p=" M ";for(t=0;t<l;t++){s=e.points[t].scrCoords;if(isNaN(s[1])||isNaN(s[2])){p=" M "}else{s[1]=Math.max(Math.min(s[1],5000),-5000);s[2]=Math.max(Math.min(s[2],5000),-5000);if(p==" M "){u+=p+s[1]+" "+s[2]}else{o=2*r;u+=[p,a+.333*(s[1]-a)+h*(o*Math.random()-r)," ",d+.333*(s[2]-d)+h*(o*Math.random()-r)," ",a+.666*(s[1]-a)+h*(o*Math.random()-r)," ",d+.666*(s[2]-d)+h*(o*Math.random()-r)," ",s[1]," ",s[2]].join("")}p=" C ";a=s[1];d=s[2]}}}return u},updatePolygonPrim:function updatePolygonPrim(e,t){var r,o="",s,n=t.vertices.length;e.setAttributeNS(null,"stroke","none");for(r=0;r<n-1;r++){if(t.vertices[r].isReal){s=t.vertices[r].coords.scrCoords;o=o+s[1]+","+s[2]}else{e.setAttributeNS(null,"points","");return}if(r<n-2){o+=" "}}if(-1===o.indexOf("NaN")){e.setAttributeNS(null,"points",o)}},updateRectPrim:function updateRectPrim(e,t,r,o,i){e.setAttributeNS(null,"x",t);e.setAttributeNS(null,"y",r);e.setAttributeNS(null,"width",o);e.setAttributeNS(null,"height",i)},setPropertyPrim:function setPropertyPrim(e,t,r){if("stroked"===t){return}e.setAttributeNS(null,t,r)},display:function display(e,t){var r;if(e&&e.rendNode){e.visPropOld.visible=t;r=e.rendNode;if(t){r.setAttributeNS(null,"display","inline");r.style.visibility="inherit"}else{r.setAttributeNS(null,"display","none");r.style.visibility="hidden"}}},show:function show(t){e.deprecated("Board.renderer.show()","Board.renderer.display()");this.display(t,!0)},hide:function hide(t){e.deprecated("Board.renderer.hide()","Board.renderer.display()");this.display(t,!1)},setBuffering:function setBuffering(e,t){e.rendNode.setAttribute("buffered-rendering",t)},setDashStyle:function setDashStyle(e){var t=n.evaluate(e.visProp.dash),r=e.rendNode;if(0<t){r.setAttributeNS(null,"stroke-dasharray",this.dashArray[t-1])}else{if(r.hasAttributeNS(null,"stroke-dasharray")){r.removeAttributeNS(null,"stroke-dasharray")}}},setGradient:function setGradient(e){var t=e.rendNode,r,o,i,s,a,d,l,c,p,u=n.evaluate(e.visProp.gradient);o=n.evaluate(e.visProp.fillopacity);o=0<o?o:0;r=n.evaluate(e.visProp.fillcolor);if("linear"===u){i=this.createPrim("linearGradient",e.id+"_gradient");d="0%";l="100%";c="0%";p="0%";i.setAttributeNS(null,"x1",d);i.setAttributeNS(null,"x2",l);i.setAttributeNS(null,"y1",c);i.setAttributeNS(null,"y2",p);s=this.createPrim("stop",e.id+"_gradient1");s.setAttributeNS(null,"offset","0%");s.setAttributeNS(null,"style","stop-color:"+r+";stop-opacity:"+o);a=this.createPrim("stop",e.id+"_gradient2");a.setAttributeNS(null,"offset","100%");a.setAttributeNS(null,"style","stop-color:"+n.evaluate(e.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(e.visProp.gradientsecondopacity));i.appendChild(s);i.appendChild(a);this.defs.appendChild(i);t.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+e.id+"_gradient)");e.gradNode1=s;e.gradNode2=a}else if("radial"===u){i=this.createPrim("radialGradient",e.id+"_gradient");i.setAttributeNS(null,"cx","50%");i.setAttributeNS(null,"cy","50%");i.setAttributeNS(null,"r","50%");i.setAttributeNS(null,"fx",100*n.evaluate(e.visProp.gradientpositionx)+"%");i.setAttributeNS(null,"fy",100*n.evaluate(e.visProp.gradientpositiony)+"%");s=this.createPrim("stop",e.id+"_gradient1");s.setAttributeNS(null,"offset","0%");s.setAttributeNS(null,"style","stop-color:"+n.evaluate(e.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(e.visProp.gradientsecondopacity));a=this.createPrim("stop",e.id+"_gradient2");a.setAttributeNS(null,"offset","100%");a.setAttributeNS(null,"style","stop-color:"+r+";stop-opacity:"+o);i.appendChild(s);i.appendChild(a);this.defs.appendChild(i);t.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+e.id+"_gradient)");e.gradNode1=s;e.gradNode2=a}else{t.removeAttributeNS(null,"style")}},updateGradient:function updateGradient(e){var t,r,o=e.gradNode1,i=e.gradNode2,s=n.evaluate(e.visProp.gradient);if(!n.exists(o)||!n.exists(i)){return}r=n.evaluate(e.visProp.fillopacity);r=0<r?r:0;t=n.evaluate(e.visProp.fillcolor);if("linear"===s){o.setAttributeNS(null,"style","stop-color:"+t+";stop-opacity:"+r);i.setAttributeNS(null,"style","stop-color:"+n.evaluate(e.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(e.visProp.gradientsecondopacity))}else if("radial"===s){o.setAttributeNS(null,"style","stop-color:"+n.evaluate(e.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(e.visProp.gradientsecondopacity));i.setAttributeNS(null,"style","stop-color:"+t+";stop-opacity:"+r)}},setObjectTransition:function setObjectTransition(e,t){var r,o,a,d,l=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(t===void 0){t=n.evaluate(e.visProp.transitionduration)}if(t===e.visPropOld.transitionduration){return}if(e.elementClass===s.OBJECT_CLASS_TEXT&&"html"===n.evaluate(e.visProp.display)){o=" color "+t+"ms, opacity "+t+"ms"}else{o=" fill "+t+"ms, fill-opacity "+t+"ms, stroke "+t+"ms, stroke-opacity "+t+"ms"}d=l.length;for(a=0;a<d;++a){if(e[l[a]]){r=e[l[a]];r.style.transition=o}}e.visPropOld.transitionduration=t},_setAttribute:function _setAttribute(e,t){if(""===t){e()}else{setTimeout(e,1)}},setObjectFillColor:function setObjectFillColor(t,r,i,s){var a,l,p,u,h=n.evaluate(r),m=n.evaluate(i);m=0<m?m:0;if(t.visPropOld.fillcolor===h&&t.visPropOld.fillopacity===m){return}if(n.exists(h)&&!1!==h){if(9!==h.length){l=h;u=m}else{p=d.rgba2rgbo(h);l=p[0];u=m*p[1]}if(s===void 0){a=t.rendNode}else{a=s}if("none"!==l){this._setAttribute(function(){a.setAttributeNS(null,"fill",l)},t.visPropOld.fillcolor)}if(t.type===e.OBJECT_TYPE_IMAGE){this._setAttribute(function(){a.setAttributeNS(null,"opacity",u)},t.visPropOld.fillopacity)}else{if("none"===l){u=0}this._setAttribute(function(){a.setAttributeNS(null,"fill-opacity",u)},t.visPropOld.fillopacity)}if(n.exists(t.visProp.gradient)){this.updateGradient(t)}}t.visPropOld.fillcolor=h;t.visPropOld.fillopacity=m},setObjectStrokeColor:function setObjectStrokeColor(e,t,r){var i=n.evaluate(t),a,l,p=n.evaluate(r),u,h;p=0<p?p:0;if(e.visPropOld.strokecolor===i&&e.visPropOld.strokeopacity===p){return}if(n.exists(i)&&!1!==i){if(9!==i.length){a=i;u=p}else{l=d.rgba2rgbo(i);a=l[0];u=p*l[1]}h=e.rendNode;if(e.elementClass===s.OBJECT_CLASS_TEXT){if("html"===n.evaluate(e.visProp.display)){this._setAttribute(function(){h.style.color=a;h.style.opacity=u},e.visPropOld.strokecolor)}else{this._setAttribute(function(){h.setAttributeNS(null,"style","fill:"+a);h.setAttributeNS(null,"style","fill-opacity:"+u)},e.visPropOld.strokecolor)}}else{this._setAttribute(function(){h.setAttributeNS(null,"stroke",a);h.setAttributeNS(null,"stroke-opacity",u)},e.visPropOld.strokecolor)}if(e.elementClass===s.OBJECT_CLASS_CURVE||e.elementClass===s.OBJECT_CLASS_LINE){if(n.evaluate(e.visProp.firstarrow)){this._setArrowColor(e.rendNodeTriangleStart,a,u,e)}if(n.evaluate(e.visProp.lastarrow)){this._setArrowColor(e.rendNodeTriangleEnd,a,u,e)}}}e.visPropOld.strokecolor=i;e.visPropOld.strokeopacity=p},setObjectStrokeWidth:function setObjectStrokeWidth(e,t){var r,o=n.evaluate(t);if(isNaN(o)||e.visPropOld.strokewidth===o){return}r=e.rendNode;this.setPropertyPrim(r,"stroked","true");if(n.exists(o)){this.setPropertyPrim(r,"stroke-width",o+"px")}e.visPropOld.strokewidth=o},setLineCap:function setLineCap(e){var t=n.evaluate(e.visProp.linecap);if(t===void 0||""===t||e.visPropOld.linecap===t||!n.exists(e.rendNode)){return}this.setPropertyPrim(e.rendNode,"stroke-linecap",t);e.visPropOld.linecap=t},setShadow:function setShadow(e){var t=n.evaluate(e.visProp.shadow);if(e.visPropOld.shadow===t){return}if(n.exists(e.rendNode)){if(t){e.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)")}else{e.rendNode.removeAttributeNS(null,"filter")}}e.visPropOld.shadow=t},suspendRedraw:function suspendRedraw(){},unsuspendRedraw:function unsuspendRedraw(){},resize:function resize(e,t){this.svgRoot.style.width=parseFloat(e)+"px";this.svgRoot.style.height=parseFloat(t)+"px";this.svgRoot.setAttribute("width",parseFloat(e));this.svgRoot.setAttribute("height",parseFloat(t))},createTouchpoints:function createTouchpoints(e){var t,r,o,s;this.touchpoints=[];for(t=0;t<e;t++){r="touchpoint1_"+t;s=this.createPrim("path",r);this.appendChildPrim(s,19);s.setAttributeNS(null,"d","M 0 0");this.touchpoints.push(s);this.setPropertyPrim(s,"stroked","true");this.setPropertyPrim(s,"stroke-width","1px");s.setAttributeNS(null,"stroke","#000000");s.setAttributeNS(null,"stroke-opacity",1);s.setAttributeNS(null,"display","none");o="touchpoint2_"+t;s=this.createPrim("ellipse",o);this.appendChildPrim(s,19);this.updateEllipsePrim(s,0,0,0,0);this.touchpoints.push(s);this.setPropertyPrim(s,"stroked","true");this.setPropertyPrim(s,"stroke-width","1px");s.setAttributeNS(null,"stroke","#000000");s.setAttributeNS(null,"stroke-opacity",1);s.setAttributeNS(null,"fill","#ffffff");s.setAttributeNS(null,"fill-opacity",0);s.setAttributeNS(null,"display","none")}},showTouchpoint:function showTouchpoint(e){if(this.touchpoints&&0<=e&&2*e<this.touchpoints.length){this.touchpoints[2*e].setAttributeNS(null,"display","inline");this.touchpoints[2*e+1].setAttributeNS(null,"display","inline")}},hideTouchpoint:function hideTouchpoint(e){if(this.touchpoints&&0<=e&&2*e<this.touchpoints.length){this.touchpoints[2*e].setAttributeNS(null,"display","none");this.touchpoints[2*e+1].setAttributeNS(null,"display","none")}},updateTouchpoint:function updateTouchpoint(e,t){var r,o;if(this.touchpoints&&0<=e&&2*e<this.touchpoints.length){r=t[0];o=t[1];this.touchpoints[2*e].setAttributeNS(null,"d","M "+(r-37)+" "+o+" L "+(r+37)+" "+o+" M "+r+" "+(o-37)+" L "+r+" "+(o+37));this.updateEllipsePrim(this.touchpoints[2*e+1],t[0],t[1],25,25)}},dumpToCanvas:function dumpToCanvas(e,t,r,o){var i=this.svgRoot,s=window.btoa||l.encode,a,d,c,p,u,h,m,g;if(this.container.hasChildNodes()&&n.exists(this.foreignObjLayer)){while(i.nextSibling){this.foreignObjLayer.appendChild(i.nextSibling)}if(!0===o){g=this.container.ownerDocument;m=g.createElement("div");m.appendChild(this.foreignObjLayer)}}i.setAttribute("xmlns","http://www.w3.org/2000/svg");u=i.getAttribute("width");h=i.getAttribute("height");a=new XMLSerializer().serializeToString(i);if(1<(a.match(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g)||[]).length){a=a.replace(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g,"")}a=a.replace(/&nbsp;/g," ");c=document.getElementById(e);c.width=c.width;p=c.getContext("2d");if(t!==void 0&&r!==void 0){c.style.width=parseFloat(t)+"px";c.style.height=parseFloat(r)+"px";c.setAttribute("width",2*parseFloat(u));c.setAttribute("height",2*parseFloat(h));p.scale(2*u/t,2*h/r)}d=new Image;d.src="data:image/svg+xml;base64,"+s(unescape(encodeURIComponent(a)));d.onload=function(){setTimeout(function(){p.drawImage(d,0,0,t,r)},200)};if(n.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes()){if(!0===o){i.appendChild(this.foreignObjLayer)}while(this.foreignObjLayer.firstChild){this.container.appendChild(this.foreignObjLayer.firstChild)}}return this},screenshot:function screenshot(e,t,r){var o,i=this.container.ownerDocument,s=this.container.parentNode,a,d,l,c,p,u,m,g,b=e.attr.screenshot,C,y,v=!1;if("no"===this.type){return this}m=b.scale*parseFloat(this.container.style.width);g=b.scale*parseFloat(this.container.style.height);if(t===void 0||""===t){v=!0;c=new Image;c.style.width=m+"px";c.style.height=g+"px"}else{v=!1;c=i.getElementById(t)}if(v){o=i.createElement("div");o.style.cssText=b.css;o.style.width=m+"px";o.style.height=g+"px";o.style.zIndex=this.container.style.zIndex+120;a=e.getCoordsTopLeftCorner();o.style.position="absolute";o.style.left=a[0]+"px";o.style.top=a[1]+"px"}d=i.createElement("canvas");l=Math.random().toString(36).substr(2,5);d.setAttribute("id",l);d.setAttribute("width",m);d.setAttribute("height",g);d.style.width=m+"px";d.style.height=m+"px";d.style.display="none";s.append(d);if(v){p=i.createElement("span");u=i.createTextNode("\u2716");p.style.cssText=b.cssButton;p.appendChild(u);p.onclick=function(){o.parentNode.removeChild(o)};o.appendChild(c);o.appendChild(p);s.appendChild(o)}C=document.getElementById(this.container.id+"_navigationbar");if(n.exists(C)){y=C.style.display;C.style.display="none"}this.dumpToCanvas(l,m,g,r);setTimeout(function(){c.src=d.toDataURL("image/png");s.removeChild(d)},400);if(n.exists(C)){C.style.display=y}return this}});return e.SVGRenderer});define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],function(t,r,i,s,n,a,d){"use strict";t.VMLRenderer=function(e){this.type="vml";this.container=e;this.container.style.overflow="hidden";if(""===this.container.style.position){this.container.style.position="relative"}this.container.onselectstart=function(){return!1};this.resolution=10;if(!s.exists(t.vmlStylesheet)){e.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml");t.vmlStylesheet=this.container.ownerDocument.createStyleSheet();t.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)")}try{if(!e.ownerDocument.namespaces.jxgvml){e.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml")}this.createNode=function(t){return e.ownerDocument.createElement("<jxgvml:"+t+" class=\"jxgvml\">")}}catch(t){this.createNode=function(t){return e.ownerDocument.createElement("<"+t+" xmlns=\"urn:schemas-microsoft.com:vml\" class=\"jxgvml\">")}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]};t.VMLRenderer.prototype=new r;t.extend(t.VMLRenderer.prototype,{_setAttr:function _setAttr(e,r,o,i){try{if(8===this.container.ownerDocument.documentMode){e[r]=o}else{e.setAttribute(r,o,i)}}catch(i){t.debug("_setAttr: "+r+" "+o+"<br>\n")}},updateTicks:function updateTicks(e){var t,o,n,a,d,l=this.resolution,r=[];o=e.ticks.length;for(t=0;t<o;t++){n=e.ticks[t];a=n[0];d=n[1];if(s.isNumber(a[0])&&s.isNumber(a[1])){r.push(" m "+Math.round(l*a[0])+", "+Math.round(l*d[0])+" l "+Math.round(l*a[1])+", "+Math.round(l*d[1])+" ")}}if(!s.exists(e.rendNode)){e.rendNode=this.createPrim("path",e.id);this.appendChildPrim(e.rendNode,s.evaluate(e.visProp.layer))}this._setAttr(e.rendNode,"stroked","true");this._setAttr(e.rendNode,"strokecolor",s.evaluate(e.visProp.strokecolor),1);this._setAttr(e.rendNode,"strokeweight",s.evaluate(e.visProp.strokewidth));this._setAttr(e.rendNodeStroke,"opacity",100*s.evaluate(e.visProp.strokeopacity)+"%");this.updatePathPrim(e.rendNode,r,e.board)},displayCopyright:function displayCopyright(e,r){var o,i;o=this.createNode("textbox");o.style.position="absolute";this._setAttr(o,"id",this.container.id+"_licenseText");o.style.left=20;o.style.top=2;o.style.fontSize=r;o.style.color="#356AA0";o.style.fontFamily="Arial,Helvetica,sans-serif";this._setAttr(o,"opacity","30%");o.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)";i=this.container.ownerDocument.createTextNode(e);o.appendChild(i);this.appendChildPrim(o,0)},drawInternalText:function drawInternalText(e){var t=this.createNode("textbox");t.style.position="absolute";e.rendNodeText=this.container.ownerDocument.createTextNode("");t.appendChild(e.rendNodeText);this.appendChildPrim(t,9);t.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)";return t},updateInternalText:function updateInternalText(e){var t,r=e.plaintext,o=this.joinTransforms(e,e.transformations),s=[0,0],n,d,l,c,u,h=e.rendNode,m=[],p=e.getAnchorX(),g=e.getAnchorY();if(!isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])){if("right"===p){s[0]=1}else if("middle"===p){s[0]=.5}if("bottom"===g){s[1]=1}else if("middle"===g){s[1]=.5}m[0]=a.matVecMult(o,[1,e.coords.scrCoords[1]-s[0]*e.size[0],e.coords.scrCoords[2]+(1-s[1])*e.size[1]+this.vOffsetText]);m[0][1]/=m[0][0];m[0][2]/=m[0][0];m[1]=a.matVecMult(o,[1,e.coords.scrCoords[1]+(1-s[0])*e.size[0],e.coords.scrCoords[2]+(1-s[1])*e.size[1]+this.vOffsetText]);m[1][1]/=m[1][0];m[1][2]/=m[1][0];m[2]=a.matVecMult(o,[1,e.coords.scrCoords[1]+(1-s[0])*e.size[0],e.coords.scrCoords[2]-s[1]*e.size[1]+this.vOffsetText]);m[2][1]/=m[2][0];m[2][2]/=m[2][0];m[3]=a.matVecMult(o,[1,e.coords.scrCoords[1]-s[0]*e.size[0],e.coords.scrCoords[2]-s[1]*e.size[1]+this.vOffsetText]);m[3][1]/=m[3][0];m[3][2]/=m[3][0];n=m[0][1];l=m[0][1];d=m[0][2];c=m[0][2];for(u=1;4>u;u++){n=Math.max(n,m[u][1]);l=Math.min(l,m[u][1]);d=Math.max(d,m[u][2]);c=Math.min(c,m[u][2])}t=1===s[0]?Math.floor(e.board.canvasWidth-n):Math.floor(l);if(e.visPropOld.left!==p+t){if(1===s[0]){e.rendNode.style.right=t+"px";e.rendNode.style.left="auto"}else{e.rendNode.style.left=t+"px";e.rendNode.style.right="auto"}e.visPropOld.left=p+t}t=1===s[1]?Math.floor(e.board.canvasHeight-d):Math.floor(c);if(e.visPropOld.top!==g+t){if(1===s[1]){e.rendNode.style.bottom=t+"px";e.rendNode.style.top="auto"}else{e.rendNode.style.top=t+"px";e.rendNode.style.bottom="auto"}e.visPropOld.top=g+t}}if(e.htmlStr!==r){e.rendNodeText.data=r;e.htmlStr=r}h.filters.item(0).M11=o[1][1];h.filters.item(0).M12=o[1][2];h.filters.item(0).M21=o[2][1];h.filters.item(0).M22=o[2][2];h.filters.item(0).enabled=!0},drawImage:function drawImage(e){var t=this.container.ownerDocument.createElement("img");t.style.position="absolute";this._setAttr(t,"id",this.container.id+"_"+e.id);this.container.appendChild(t);this.appendChildPrim(t,s.evaluate(e.visProp.layer));t.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)";e.rendNode=t;this.updateImage(e)},transformImage:function transformImage(e,r){var t,o,s,n,d,l,c=e.rendNode,u=[],p=r.length;if(0<p){t=this.joinTransforms(e,r);u[0]=a.matVecMult(t,e.coords.scrCoords);u[0][1]/=u[0][0];u[0][2]/=u[0][0];u[1]=a.matVecMult(t,[1,e.coords.scrCoords[1]+e.size[0],e.coords.scrCoords[2]]);u[1][1]/=u[1][0];u[1][2]/=u[1][0];u[2]=a.matVecMult(t,[1,e.coords.scrCoords[1]+e.size[0],e.coords.scrCoords[2]-e.size[1]]);u[2][1]/=u[2][0];u[2][2]/=u[2][0];u[3]=a.matVecMult(t,[1,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1]]);u[3][1]/=u[3][0];u[3][2]/=u[3][0];o=u[0][1];n=u[0][1];s=u[0][2];d=u[0][2];for(l=1;4>l;l++){o=Math.max(o,u[l][1]);n=Math.min(n,u[l][1]);s=Math.max(s,u[l][2]);d=Math.min(d,u[l][2])}c.style.left=Math.floor(n)+"px";c.style.top=Math.floor(d)+"px";c.filters.item(0).M11=t[1][1];c.filters.item(0).M12=t[1][2];c.filters.item(0).M21=t[2][1];c.filters.item(0).M22=t[2][2];c.filters.item(0).enabled=!0}},updateImageURL:function updateImageURL(e){var t=s.evaluate(e.url);this._setAttr(e.rendNode,"src",t)},appendChildPrim:function appendChildPrim(e,t){if(!s.exists(t)){t=0}e.style.zIndex=t;this.container.appendChild(e);return e},appendNodesToElement:function appendNodesToElement(e,t){if("shape"===t||"path"===t||"polygon"===t){e.rendNodePath=this.getElementById(e.id+"_path")}e.rendNodeFill=this.getElementById(e.id+"_fill");e.rendNodeStroke=this.getElementById(e.id+"_stroke");e.rendNodeShadow=this.getElementById(e.id+"_shadow");e.rendNode=this.getElementById(e.id)},createPrim:function createPrim(e,t){var r,o,i=this.createNode("fill"),s=this.createNode("stroke"),n=this.createNode("shadow");this._setAttr(i,"id",this.container.id+"_"+t+"_fill");this._setAttr(s,"id",this.container.id+"_"+t+"_stroke");this._setAttr(n,"id",this.container.id+"_"+t+"_shadow");if("circle"===e||"ellipse"===e){r=this.createNode("oval");r.appendChild(i);r.appendChild(s);r.appendChild(n)}else if("polygon"===e||"path"===e||"shape"===e||"line"===e){r=this.createNode("shape");r.appendChild(i);r.appendChild(s);r.appendChild(n);o=this.createNode("path");this._setAttr(o,"id",this.container.id+"_"+t+"_path");r.appendChild(o)}else{r=this.createNode(e);r.appendChild(i);r.appendChild(s);r.appendChild(n)}r.style.position="absolute";r.style.left="0px";r.style.top="0px";this._setAttr(r,"id",this.container.id+"_"+t);return r},remove:function remove(e){if(s.exists(e)){e.removeNode(!0)}},makeArrows:function makeArrows(e){var t,r=s.evaluate(e.visProp.firstarrow),o=s.evaluate(e.visProp.lastarrow);if(e.visPropOld.firstarrow===r&&e.visPropOld.lastarrow===o){return}if(r){t=e.rendNodeStroke;this._setAttr(t,"startarrow","block");this._setAttr(t,"startarrowlength","long")}else{t=e.rendNodeStroke;if(s.exists(t)){this._setAttr(t,"startarrow","none")}}if(o){t=e.rendNodeStroke;this._setAttr(t,"id",this.container.id+"_"+e.id+"stroke");this._setAttr(t,"endarrow","block");this._setAttr(t,"endarrowlength","long")}else{t=e.rendNodeStroke;if(s.exists(t)){this._setAttr(t,"endarrow","none")}}e.visPropOld.firstarrow=r;e.visPropOld.lastarrow=o},updateEllipsePrim:function updateEllipsePrim(e,t,r,o,i){e.style.left=Math.floor(t-o)+"px";e.style.top=Math.floor(r-i)+"px";e.style.width=Math.floor(2*Math.abs(o))+"px";e.style.height=Math.floor(2*Math.abs(i))+"px"},updateLinePrim:function updateLinePrim(e,t,o,i,n,a){var d,l=this.resolution;if(!isNaN(t+o+i+n)){d=["m ",Math.floor(l*t),", ",Math.floor(l*o)," l ",Math.floor(l*i),", ",Math.floor(l*n)];this.updatePathPrim(e,d,a)}},updatePathPrim:function updatePathPrim(e,t,r){var o=r.canvasWidth,i=r.canvasHeight;if(0>=t.length){t=["m 0,0"]}e.style.width=o;e.style.height=i;this._setAttr(e,"coordsize",[Math.floor(this.resolution*o),Math.floor(this.resolution*i)].join(","));this._setAttr(e,"path",t.join(""))},updatePathStringPoint:function updatePathStringPoint(e,t,o){var i=[],s=Math.round,n=e.coords.scrCoords,a=.5*(t*Math.sqrt(3)),d=.5*t,l=this.resolution;if("x"===o){i.push([" m ",s(l*(n[1]-t)),", ",s(l*(n[2]-t))," l ",s(l*(n[1]+t)),", ",s(l*(n[2]+t))," m ",s(l*(n[1]+t)),", ",s(l*(n[2]-t))," l ",s(l*(n[1]-t)),", ",s(l*(n[2]+t))].join(""))}else if("+"===o){i.push([" m ",s(l*(n[1]-t)),", ",s(l*n[2])," l ",s(l*(n[1]+t)),", ",s(l*n[2])," m ",s(l*n[1]),", ",s(l*(n[2]-t))," l ",s(l*n[1]),", ",s(l*(n[2]+t))].join(""))}else if("<>"===o){i.push([" m ",s(l*(n[1]-t)),", ",s(l*n[2])," l ",s(l*n[1]),", ",s(l*(n[2]+t))," l ",s(l*(n[1]+t)),", ",s(l*n[2])," l ",s(l*n[1]),", ",s(l*(n[2]-t))," x e "].join(""))}else if("^"===o){i.push([" m ",s(l*n[1]),", ",s(l*(n[2]-t))," l ",s(l*(n[1]-a)),", ",s(l*(n[2]+d))," l ",s(l*(n[1]+a)),", ",s(l*(n[2]+d))," x e "].join(""))}else if("v"===o){i.push([" m ",s(l*n[1]),", ",s(l*(n[2]+t))," l ",s(l*(n[1]-a)),", ",s(l*(n[2]-d))," l ",s(l*(n[1]+a)),", ",s(l*(n[2]-d))," x e "].join(""))}else if(">"===o){i.push([" m ",s(l*(n[1]+t)),", ",s(l*n[2])," l ",s(l*(n[1]-d)),", ",s(l*(n[2]-a))," l ",s(l*(n[1]-d)),", ",s(l*(n[2]+a))," l ",s(l*(n[1]+t)),", ",s(l*n[2])].join(""))}else if("<"===o){i.push([" m ",s(l*(n[1]-t)),", ",s(l*n[2])," l ",s(l*(n[1]+d)),", ",s(l*(n[2]-a))," l ",s(l*(n[1]+d)),", ",s(l*(n[2]+a))," x e "].join(""))}return i},updatePathStringPrim:function updatePathStringPrim(e){var t,o,s=[],n=this.resolution,r=Math.round,a=" m ",d=Math.min(e.numberPoints,8192);if(0>=e.numberPoints){return""}d=Math.min(d,e.points.length);if(1===e.bezierDegree){for(t=0;t<d;t++){o=e.points[t].scrCoords;if(isNaN(o[1])||isNaN(o[2])){a=" m "}else{if(2e4<o[1]){o[1]=2e4}else if(-2e4>o[1]){o[1]=-2e4}if(2e4<o[2]){o[2]=2e4}else if(-2e4>o[2]){o[2]=-2e4}s.push([a,r(n*o[1]),", ",r(n*o[2])].join(""));a=" l "}}}else if(3===e.bezierDegree){t=0;while(t<d){o=e.points[t].scrCoords;if(isNaN(o[1])||isNaN(o[2])){a=" m "}else{s.push([a,r(n*o[1]),", ",r(n*o[2])].join(""));if(a==" c "){t+=1;o=e.points[t].scrCoords;s.push([" ",r(n*o[1]),", ",r(n*o[2])].join(""));t+=1;o=e.points[t].scrCoords;s.push([" ",r(n*o[1]),", ",r(n*o[2])].join(""))}a=" c "}t+=1}}s.push(" e");return s},updatePathStringBezierPrim:function updatePathStringBezierPrim(e){var t,o,n,a,l,c,p=[],u=s.evaluate(e.visProp.strokewidth),h=this.resolution,r=Math.round,m=" m ",g="plot"!==s.evaluate(e.visProp.curvetype),b=Math.min(e.numberPoints,8192);if(0>=e.numberPoints){return""}if(g&&e.board.options.curve.RDPsmoothing){e.points=d.RamerDouglasPeucker(e.points,1)}b=Math.min(b,e.points.length);for(o=1;3>o;o++){m=" m ";for(t=0;t<b;t++){a=e.points[t].scrCoords;if(isNaN(a[1])||isNaN(a[2])){m=" m "}else{if(2e4<a[1]){a[1]=2e4}else if(-2e4>a[1]){a[1]=-2e4}if(2e4<a[2]){a[2]=2e4}else if(-2e4>a[2]){a[2]=-2e4}if(m==" m "){p.push([m,r(h*a[1])," ",r(h*a[2])].join(""))}else{n=2*o;p.push([m,r(h*(l+.333*(a[1]-l)+u*(n*Math.random()-o)))," ",r(h*(c+.333*(a[2]-c)+u*(n*Math.random()-o)))," ",r(h*(l+.666*(a[1]-l)+u*(n*Math.random()-o)))," ",r(h*(c+.666*(a[2]-c)+u*(n*Math.random()-o)))," ",r(h*a[1])," ",r(h*a[2])].join(""))}m=" c ";l=a[1];c=a[2]}}}p.push(" e");return p},updatePolygonPrim:function updatePolygonPrim(e,t){var o,s=t.vertices.length,n=this.resolution,r,a=[];this._setAttr(e,"stroked","false");r=t.vertices[0].coords.scrCoords;if(isNaN(r[1]+r[2])){return}a.push(["m ",Math.floor(n*r[1]),",",Math.floor(n*r[2])," l "].join(""));for(o=1;o<s-1;o++){if(t.vertices[o].isReal){r=t.vertices[o].coords.scrCoords;if(isNaN(r[1]+r[2])){return}a.push(Math.floor(n*r[1])+","+Math.floor(n*r[2]))}else{this.updatePathPrim(e,"",t.board);return}if(o<s-2){a.push(", ")}}a.push(" x e");this.updatePathPrim(e,a,t.board)},updateRectPrim:function updateRectPrim(e,t,r,o,i){e.style.left=Math.floor(t)+"px";e.style.top=Math.floor(r)+"px";if(0<=o){e.style.width=o+"px"}if(0<=i){e.style.height=i+"px"}},setPropertyPrim:function setPropertyPrim(e,t,r){var o="",i;switch(t){case"stroke":o="strokecolor";break;case"stroke-width":o="strokeweight";break;case"stroke-dasharray":o="dashstyle";break;}if(""!=o){i=s.evaluate(r);this._setAttr(e,o,i)}},display:function display(e,t){if(e&&e.rendNode){e.visPropOld.visible=t;if(t){e.rendNode.style.visibility="inherit"}else{e.rendNode.style.visibility="hidden"}}},show:function show(e){t.deprecated("Board.renderer.show()","Board.renderer.display()");if(e&&e.rendNode){e.rendNode.style.visibility="inherit"}},hide:function hide(e){t.deprecated("Board.renderer.hide()","Board.renderer.display()");if(e&&e.rendNode){e.rendNode.style.visibility="hidden"}},setDashStyle:function setDashStyle(e,t){var r;if(0<=t.dash){r=e.rendNodeStroke;this._setAttr(r,"dashstyle",this.dashArray[t.dash])}},setGradient:function setGradient(e){var t=e.rendNodeFill,r=s.evaluate(e.visProp.gradient);if("linear"===r){this._setAttr(t,"type","gradient");this._setAttr(t,"color2",s.evaluate(e.visProp.gradientsecondcolor));this._setAttr(t,"opacity2",s.evaluate(e.visProp.gradientsecondopacity));this._setAttr(t,"angle",s.evaluate(e.visProp.gradientangle))}else if("radial"===r){this._setAttr(t,"type","gradientradial");this._setAttr(t,"color2",s.evaluate(e.visProp.gradientsecondcolor));this._setAttr(t,"opacity2",s.evaluate(e.visProp.gradientsecondopacity));this._setAttr(t,"focusposition",100*s.evaluate(e.visProp.gradientpositionx)+"%,"+100*s.evaluate(e.visProp.gradientpositiony)+"%");this._setAttr(t,"focussize","0,0")}else{this._setAttr(t,"type","solid")}},setObjectFillColor:function setObjectFillColor(e,t,r){var a=s.evaluate(t),d,l,p=s.evaluate(r),u,h=e.rendNode;p=0<p?p:0;if(e.visPropOld.fillcolor===a&&e.visPropOld.fillopacity===p){return}if(s.exists(a)&&!1!==a){if(9!==a.length){d=a;u=p}else{l=n.rgba2rgbo(a);d=l[0];u=p*l[1]}if("none"===d||!1===d){this._setAttr(e.rendNode,"filled","false")}else{this._setAttr(e.rendNode,"filled","true");this._setAttr(e.rendNode,"fillcolor",d);if(s.exists(u)&&e.rendNodeFill){this._setAttr(e.rendNodeFill,"opacity",100*u+"%")}}if(e.type===i.OBJECT_TYPE_IMAGE){if(1<h.filters.length){h.filters.item(1).opacity=Math.round(100*u);h.filters.item(1).enabled=!0}}}e.visPropOld.fillcolor=a;e.visPropOld.fillopacity=p},setObjectStrokeColor:function setObjectStrokeColor(e,t,r){var n=s.evaluate(t),a,d,l=s.evaluate(r),p,u=e.rendNode,h;l=0<l?l:0;if(e.visPropOld.strokecolor===n&&e.visPropOld.strokeopacity===l){return}if(s.exists(n)&&!1!==n){if(9!==n.length){a=n;p=l}else{d=t.rgba2rgbo(n);a=d[0];p=l*d[1]}if(e.elementClass===i.OBJECT_CLASS_TEXT){if(1<u.filters.length){u.filters.item(1).opacity=Math.round(100*p);u.filters.item(1).enabled=!0}u.style.color=a}else{if(!1!==a){this._setAttr(u,"stroked","true");this._setAttr(u,"strokecolor",a)}h=e.rendNodeStroke;if(s.exists(p)&&e.type!==i.OBJECT_TYPE_IMAGE){this._setAttr(h,"opacity",100*p+"%")}}}e.visPropOld.strokecolor=n;e.visPropOld.strokeopacity=l},setObjectStrokeWidth:function setObjectStrokeWidth(e,t){var r=s.evaluate(t),o;if(isNaN(r)||e.visPropOld.strokewidth===r){return}o=e.rendNode;this.setPropertyPrim(o,"stroked","true");if(s.exists(r)){this.setPropertyPrim(o,"stroke-width",r);if(0===r&&s.exists(e.rendNodeStroke)){this._setAttr(o,"stroked","false")}}e.visPropOld.strokewidth=r},setShadow:function setShadow(e){var t=e.rendNodeShadow,r=s.evaluate(e.visProp.shadow);if(!t||e.visPropOld.shadow===r){return}if(r){this._setAttr(t,"On","True");this._setAttr(t,"Offset","3pt,3pt");this._setAttr(t,"Opacity","60%");this._setAttr(t,"Color","#aaaaaa")}else{this._setAttr(t,"On","False")}e.visPropOld.shadow=r},suspendRedraw:function suspendRedraw(){this.container.style.display="none"},unsuspendRedraw:function unsuspendRedraw(){this.container.style.display=""}});return t.VMLRenderer});define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],function(e,t,r,o,s,n,a,d,l,c,p){"use strict";e.CanvasRenderer=function(e,t){this.type="canvas";this.canvasRoot=null;this.suspendHandle=null;this.canvasId=n.genUUID();this.canvasNamespace=null;if(o.isBrowser){this.container=e;this.container.style.MozUserSelect="none";this.container.style.userSelect="none";this.container.style.overflow="hidden";if(""===this.container.style.position){this.container.style.position="relative"}this.container.innerHTML=["<canvas id=\"",this.canvasId,"\" width=\"",t.width,"px\" height=\"",t.height,"px\"><","/canvas>"].join("");this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId);this.context=this.canvasRoot.getContext("2d")}else if(o.isNode()){this.canvasId="object"===("undefined"==typeof module?"undefined":_typeof(module))?module.require("canvas"):require("canvas");this.canvasRoot=new this.canvasId(500,500);this.context=this.canvasRoot.getContext("2d")}this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]};e.CanvasRenderer.prototype=new t;e.extend(e.CanvasRenderer.prototype,{_drawFilledPolygon:function _drawFilledPolygon(e){var t,r=e.length,o=this.context;if(0<r){o.beginPath();o.moveTo(e[0][0],e[0][1]);for(t=0;t<r;t++){if(0<t){o.lineTo(e[t][0],e[t][1])}}o.lineTo(e[0][0],e[0][1]);o.fill()}},_fill:function _fill(e){var t=this.context;t.save();if(this._setColor(e,"fill")){t.fill()}t.restore()},_rotatePoint:function _rotatePoint(e,t,r){return[t*Math.cos(e)-r*Math.sin(e),t*Math.sin(e)+r*Math.cos(e)]},_rotateShape:function _rotateShape(e,t){var r,o=[],s=e.length;if(0>=s){return e}for(r=0;r<s;r++){o.push(this._rotatePoint(t,e[r][0],e[r][1]))}return o},_setColor:function _setColor(e,t,r){var i=!0,n=!1,d=e.visProp,l,p,u,h,m,g,b;t=t||"stroke";r=r||t;if(!s.exists(e.board)||!s.exists(e.board.highlightedObjects)){n=!0}if(!n&&s.exists(e.board.highlightedObjects[e.id])){l="highlight"}else{l=""}u=s.evaluate(d[l+t+"color"]);if("none"!==u&&!1!==u){g=s.evaluate(d[l+t+"opacity"]);g=0<g?g:0;if(9!==u.length){m=u;b=g}else{h=a.rgba2rgbo(u);m=h[0];b=g*h[1]}this.context.globalAlpha=b;this.context[r+"Style"]=m}else{i=!1}p=parseFloat(s.evaluate(d.strokewidth));if("stroke"===t&&!isNaN(p)){if(0===p){this.context.globalAlpha=0}else{this.context.lineWidth=p}}if("stroke"===t&&d.linecap!==void 0&&""!==d.linecap){this.context.lineCap=d.linecap}return i},_stroke:function _stroke(e){var t=this.context,r=s.evaluate(e.visProp.dash);t.save();if(0<r){if(t.setLineDash){t.setLineDash(this.dashArray[r])}}else{this.context.lineDashArray=[]}if(this._setColor(e,"stroke")){t.stroke()}t.restore()},_translateShape:function _translateShape(e,t,r){var o,s=[],n=e.length;if(0>=n){return e}for(o=0;o<n;o++){s.push([e[o][0]+t,e[o][1]+r])}return s},drawPoint:function drawPoint(e){var t=s.evaluate(e.visProp.face),r=s.evaluate(e.visProp.size),o=e.coords.scrCoords,i=.5*(r*Math.sqrt(3)),n=.5*r,a=parseFloat(s.evaluate(e.visProp.strokewidth))/2,d=this.context;if(!e.visPropCalc.visible){return}switch(t){case"cross":case"x":d.beginPath();d.moveTo(o[1]-r,o[2]-r);d.lineTo(o[1]+r,o[2]+r);d.moveTo(o[1]+r,o[2]-r);d.lineTo(o[1]-r,o[2]+r);d.lineCap="round";d.lineJoin="round";d.closePath();this._stroke(e);break;case"circle":case"o":d.beginPath();d.arc(o[1],o[2],r+1+a,0,2*Math.PI,!1);d.closePath();this._fill(e);this._stroke(e);break;case"square":case"[]":if(0>=r){break}d.save();if(this._setColor(e,"stroke","fill")){d.fillRect(o[1]-r-a,o[2]-r-a,2*r+3*a,2*r+3*a)}d.restore();d.save();this._setColor(e,"fill");d.fillRect(o[1]-r+a,o[2]-r+a,2*r-a,2*r-a);d.restore();break;case"plus":case"+":d.beginPath();d.moveTo(o[1]-r,o[2]);d.lineTo(o[1]+r,o[2]);d.moveTo(o[1],o[2]-r);d.lineTo(o[1],o[2]+r);d.lineCap="round";d.lineJoin="round";d.closePath();this._stroke(e);break;case"diamond":case"<>":d.beginPath();d.moveTo(o[1]-r,o[2]);d.lineTo(o[1],o[2]+r);d.lineTo(o[1]+r,o[2]);d.lineTo(o[1],o[2]-r);d.closePath();this._fill(e);this._stroke(e);break;case"triangleup":case"a":case"^":d.beginPath();d.moveTo(o[1],o[2]-r);d.lineTo(o[1]-i,o[2]+n);d.lineTo(o[1]+i,o[2]+n);d.closePath();this._fill(e);this._stroke(e);break;case"triangledown":case"v":d.beginPath();d.moveTo(o[1],o[2]+r);d.lineTo(o[1]-i,o[2]-n);d.lineTo(o[1]+i,o[2]-n);d.closePath();this._fill(e);this._stroke(e);break;case"triangleleft":case"<":d.beginPath();d.moveTo(o[1]-r,o[2]);d.lineTo(o[1]+n,o[2]-i);d.lineTo(o[1]+n,o[2]+i);d.closePath();this.fill(e);this._stroke(e);break;case"triangleright":case">":d.beginPath();d.moveTo(o[1]+r,o[2]);d.lineTo(o[1]-n,o[2]-i);d.lineTo(o[1]-n,o[2]+i);d.closePath();this._fill(e);this._stroke(e);break;}},updatePoint:function updatePoint(e){this.drawPoint(e)},drawLine:function drawLine(e){var t,o=new d(r.COORDS_BY_USER,e.point1.coords.usrCoords,e.board),i=new d(r.COORDS_BY_USER,e.point2.coords.usrCoords,e.board),n=null,a=s.evaluate(e.visProp.firstarrow),l=s.evaluate(e.visProp.lastarrow);if(!e.visPropCalc.visible){return}if(a||l){n=-4}c.calcStraight(e,o,i,n);t=this.getPositionArrowHead(e,o,i);this.context.beginPath();this.context.moveTo(t.c1.scrCoords[1]+t.d1x,t.c1.scrCoords[2]+t.d1y);this.context.lineTo(t.c2.scrCoords[1]-t.d2x,t.c2.scrCoords[2]-t.d2y);this._stroke(e);if(a&&0<t.sFirst||l&&0<t.sLast){this.makeArrows(e,t.c1,t.c2)}},updateLine:function updateLine(e){this.drawLine(e)},drawTicks:function drawTicks(){},updateTicks:function updateTicks(e){var t,r,o,s,n=e.ticks.length,a=this.context;a.beginPath();for(t=0;t<n;t++){r=e.ticks[t];o=r[0];s=r[1];a.moveTo(o[0],s[0]);a.lineTo(o[1],s[1])}for(t=0;t<n;t++){r=e.ticks[t].scrCoords;if(e.ticks[t].major&&(e.board.needsFullUpdate||e.needsRegularUpdate)&&e.labels[t]&&e.labels[t].visPropCalc.visible){this.updateText(e.labels[t])}}a.lineCap="round";this._stroke(e)},drawCurve:function drawCurve(e){if(s.evaluate(e.visProp.handdrawing)){this.updatePathStringBezierPrim(e)}else{this.updatePathStringPrim(e)}if(1<e.numberPoints){this.makeArrows(e)}},updateCurve:function updateCurve(e){this.drawCurve(e)},drawEllipse:function drawEllipse(e){var t=e.center.coords.scrCoords[1],r=e.center.coords.scrCoords[2],o=e.board.unitX,i=e.board.unitY,s=2*e.Radius(),n=2*e.Radius(),a=s*o,d=n*i,l=t-a/2,c=r-d/2,p=.5522848*(a/2),u=.5522848*(d/2),h=l+a,m=c+d,g=l+a/2,b=c+d/2,C=this.context;if(0<s&&0<n&&!isNaN(t+r)){C.beginPath();C.moveTo(l,b);C.bezierCurveTo(l,b-u,g-p,c,g,c);C.bezierCurveTo(g+p,c,h,b-u,h,b);C.bezierCurveTo(h,b+u,g+p,m,g,m);C.bezierCurveTo(g-p,m,l,b+u,l,b);C.closePath();this._fill(e);this._stroke(e)}},updateEllipse:function updateEllipse(e){return this.drawEllipse(e)},displayCopyright:function displayCopyright(e,t){var r=this.context;r.save();r.font=t+"px Arial";r.fillStyle="#aaa";r.lineWidth=.5;r.fillText(e,10,2+t);r.restore()},drawInternalText:function drawInternalText(e){var t=s.evaluate(e.visProp.fontsize),r=e.getAnchorX(),o=e.getAnchorY(),i=this.context;i.save();if(this._setColor(e,"stroke","fill")&&!isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])){i.font=(0<t?t:0)+"px Arial";this.transformImage(e,e.transformations);if("left"===r){i.textAlign="left"}else if("right"===r){i.textAlign="right"}else if("middle"===r){i.textAlign="center"}if("bottom"===o){i.textBaseline="bottom"}else if("top"===o){i.textBaseline="top"}else if("middle"===o){i.textBaseline="middle"}i.fillText(e.plaintext,e.coords.scrCoords[1],e.coords.scrCoords[2])}i.restore();return null},updateInternalText:function updateInternalText(e){this.drawInternalText(e)},setObjectStrokeColor:function setObjectStrokeColor(e,t,i){var n=s.evaluate(t),d,l,p=s.evaluate(i),u,h;p=0<p?p:0;if(e.visPropOld.strokecolor===n&&e.visPropOld.strokeopacity===p){return}if(s.exists(n)&&!1!==n){if(9!==n.length){d=n;u=p}else{l=a.rgba2rgbo(n);d=l[0];u=p*l[1]}h=e.rendNode;if(e.elementClass===r.OBJECT_CLASS_TEXT&&"html"===s.evaluate(e.visProp.display)){h.style.color=d;h.style.opacity=u}}e.visPropOld.strokecolor=n;e.visPropOld.strokeopacity=p},drawImage:function drawImage(e){e.rendNode=new Image;e._src="";this.updateImage(e)},updateImage:function updateImage(e){var t=this.context,r=s.evaluate(e.visProp.fillopacity),o=s.bind(function(){e.imgIsLoaded=!0;if(0>=e.size[0]||0>=e.size[1]){return}t.save();t.globalAlpha=r;this.transformImage(e,e.transformations);t.drawImage(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1],e.size[0],e.size[1]);t.restore()},this);if(this.updateImageURL(e)){e.rendNode.onload=o}else{if(e.imgIsLoaded){o()}}},transformImage:function transformImage(e,r){var t,o=r.length,i=this.context;if(0<o){t=this.joinTransforms(e,r);if(Math.abs(p.det(t))>=l.eps){i.transform(t[1][1],t[2][1],t[1][2],t[2][2],t[1][0],t[2][0])}}},updateImageURL:function updateImageURL(e){var t=s.evaluate(e.url);if(e._src!==t){e.imgIsLoaded=!1;e.rendNode.src=t;e._src=t;return!0}return!1},remove:function remove(e){if(s.exists(e)&&s.exists(e.parentNode)){e.parentNode.removeChild(e)}},makeArrows:function makeArrows(e,t,o){var i,n,a,d,l,c,p=s.evaluate(e.visProp.strokewidth),u,h,m=this.context,g,b=s.evaluate(e.visProp.firstarrow),C=s.evaluate(e.visProp.lastarrow);if("none"!==s.evaluate(e.visProp.strokecolor)&&(b||C)){if(e.elementClass===r.OBJECT_CLASS_LINE){i=t.scrCoords[1];n=t.scrCoords[2];a=o.scrCoords[1];d=o.scrCoords[2]}else{i=e.points[0].scrCoords[1];n=e.points[0].scrCoords[2];a=e.points[e.points.length-1].scrCoords[1];d=e.points[e.points.length-1].scrCoords[2];return}if(b&&s.exists(b.type)){if(s.exists(b.size)){c=s.evaluate(b.size)}else{c=3}p*=c;g=s.evaluate(b.type);if(2===g){h=[[p,.5*-p],[0,0],[p,.5*p],[.5*p,0]]}else if(3===g){h=[[p/3,.5*-p],[0,.5*-p],[0,.5*p],[p/3,.5*p]]}else{h=[[p,.5*-p],[0,0],[p,.5*p]]}}if(C&&s.exists(C.type)){if(s.exists(C.size)){c=s.evaluate(C.size)}else{c=3}p*=c;g=s.evaluate(C.type);if(2===g){u=[[-p,.5*-p],[0,0],[-p,.5*p],[.5*-p,0]]}else if(3===g){u=[[-p/3,.5*-p],[0,.5*-p],[0,.5*p],[-p/3,.5*p]]}else{u=[[-p,.5*-p],[0,0],[-p,.5*p]]}}m.save();if(this._setColor(e,"stroke","fill")){l=Math.atan2(d-n,a-i);if(C){this._drawFilledPolygon(this._translateShape(this._rotateShape(u,l),a,d))}if(b){this._drawFilledPolygon(this._translateShape(this._rotateShape(h,l),i,n))}}m.restore()}},updatePathStringPrim:function updatePathStringPrim(e){var t,r,o,s,n,a="M",d=this.context;if(0>=e.numberPoints){return}n=Math.min(e.points.length,e.numberPoints);d.beginPath();if(1===e.bezierDegree){for(t=0;t<n;t++){r=e.points[t].scrCoords;if(isNaN(r[1])||isNaN(r[2])){a="M"}else{if(r[1]>5000){r[1]=5000}else if(r[1]<-5000){r[1]=-5000}if(r[2]>5000){r[2]=5000}else if(r[2]<-5000){r[2]=-5000}if(a=="M"){d.moveTo(r[1],r[2])}else{d.lineTo(r[1],r[2])}a="L"}}}else if(3===e.bezierDegree){t=0;while(t<n){r=e.points[t].scrCoords;if(isNaN(r[1])||isNaN(r[2])){a="M"}else{if(a=="M"){d.moveTo(r[1],r[2])}else{t+=1;o=e.points[t].scrCoords;t+=1;s=e.points[t].scrCoords;d.bezierCurveTo(r[1],r[2],o[1],o[2],s[1],s[2])}a="C"}t+=1}}d.lineCap="round";this._fill(e);this._stroke(e)},updatePathStringBezierPrim:function updatePathStringBezierPrim(e){var t,r,o,n,a,d,l,c="M",u=s.evaluate(e.visProp.strokewidth),h="plot"!==s.evaluate(e.visProp.curvetype),m=this.context;if(0>=e.numberPoints){return}if(h&&e.board.options.curve.RDPsmoothing){e.points=p.RamerDouglasPeucker(e.points,.5)}l=Math.min(e.points.length,e.numberPoints);m.beginPath();for(r=1;3>r;r++){c="M";for(t=0;t<l;t++){n=e.points[t].scrCoords;if(isNaN(n[1])||isNaN(n[2])){c="M"}else{if(n[1]>5000){n[1]=5000}else if(n[1]<-5000){n[1]=-5000}if(n[2]>5000){n[2]=5000}else if(n[2]<-5000){n[2]=-5000}if(c=="M"){m.moveTo(n[1],n[2])}else{o=2*r;m.bezierCurveTo(a+.333*(n[1]-a)+u*(o*Math.random()-r),d+.333*(n[2]-d)+u*(o*Math.random()-r),a+.666*(n[1]-a)+u*(o*Math.random()-r),d+.666*(n[2]-d)+u*(o*Math.random()-r),n[1],n[2])}c="C";a=n[1];d=n[2]}}}m.lineCap="round";this._fill(e);this._stroke(e)},updatePolygonPrim:function updatePolygonPrim(e,t){var r,o,s,n=t.vertices.length,a=this.context,d=!0;if(0>=n||!t.visPropCalc.visible){return}a.beginPath();o=0;while(!t.vertices[o].isReal&&o<n-1){o++;d=!1}r=t.vertices[o].coords.scrCoords;a.moveTo(r[1],r[2]);for(s=o;s<n-1;s++){if(!t.vertices[s].isReal){d=!1}r=t.vertices[s].coords.scrCoords;a.lineTo(r[1],r[2])}a.closePath();if(d){this._fill(t)}},display:function display(e,t){if(e&&e.rendNode){e.visPropOld.visible=t;if(t){e.rendNode.style.visibility="inherit"}else{e.rendNode.style.visibility="hidden"}}},show:function show(t){e.deprecated("Board.renderer.show()","Board.renderer.display()");if(s.exists(t.rendNode)){t.rendNode.style.visibility="inherit"}},hide:function hide(t){e.deprecated("Board.renderer.hide()","Board.renderer.display()");if(s.exists(t.rendNode)){t.rendNode.style.visibility="hidden"}},setGradient:function setGradient(e){var t=s.evaluate(e.visProp.fillopacity);t=0<t?t:0;s.evaluate(e.visProp.fillcolor)},setShadow:function setShadow(e){if(e.visPropOld.shadow===e.visProp.shadow){return}e.visPropOld.shadow=e.visProp.shadow},highlight:function highlight(e){if(e.elementClass===r.OBJECT_CLASS_TEXT&&"html"===s.evaluate(e.visProp.display)){this.updateTextStyle(e,!0)}else{e.board.prepareUpdate();e.board.renderer.suspendRedraw(e.board);e.board.updateRenderer();e.board.renderer.unsuspendRedraw()}return this},noHighlight:function noHighlight(e){if(e.elementClass===r.OBJECT_CLASS_TEXT&&"html"===s.evaluate(e.visProp.display)){this.updateTextStyle(e,!1)}else{e.board.prepareUpdate();e.board.renderer.suspendRedraw(e.board);e.board.updateRenderer();e.board.renderer.unsuspendRedraw()}return this},suspendRedraw:function suspendRedraw(t){this.context.save();this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height);if(t&&t.attr.showcopyright){this.displayCopyright(e.licenseText,12)}},unsuspendRedraw:function unsuspendRedraw(){this.context.restore()},resize:function resize(e,t){if(this.container){this.canvasRoot.style.width=parseFloat(e)+"px";this.canvasRoot.style.height=parseFloat(t)+"px";this.canvasRoot.setAttribute("width",2*parseFloat(e)+"px");this.canvasRoot.setAttribute("height",2*parseFloat(t)+"px")}else{this.canvasRoot.width=2*parseFloat(e);this.canvasRoot.height=2*parseFloat(t)}this.context=this.canvasRoot.getContext("2d");this.context.scale(2,2)},removeToInsertLater:function removeToInsertLater(){return function(){}}});return e.CanvasRenderer});define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],function(e,t,r,o,i,s,n,a,d,l){"use strict";e.JSXGraph={rendererType:function(){s.board.renderer="no";if(t.supportsVML()){s.board.renderer="vml";document.onmousemove=function(){var e;if(document.body){e=document.body.scrollLeft;e+=document.body.scrollTop}return e}}if(t.supportsCanvas()){s.board.renderer="canvas"}if(t.supportsSVG()){s.board.renderer="svg"}if(t.isNode()&&t.supportsCanvas()){s.board.renderer="canvas"}if(t.isNode()||"no"===s.renderer){s.text.display="internal";s.infobox.display="internal"}return s.board.renderer}(),initRenderer:function initRenderer(e,t,o,i){var s,c;if((!r.exists(o)||!1===o)&&"object"===("undefined"==typeof document?"undefined":_typeof(document))){o=document}if("object"===_typeof(o)&&null!==e){s=o.getElementById(e);while(s.firstChild){s.removeChild(s.firstChild)}}else{s=e}if(i===void 0||"auto"===i){i=this.rendererType}if("svg"===i){c=new n(s,t)}else if("vml"===i){c=new a(s)}else if("canvas"===i){c=new d(s,t)}else{c=new l}return c},initBoard:function initBoard(i,n){var a,d,l,c,p,u,m,g,b,C,y,v,f,P;n=n||{};C=r.copyAttributes(n,s,"board");C.zoom=r.copyAttributes(C,s,"board","zoom");C.pan=r.copyAttributes(C,s,"board","pan");C.selection=r.copyAttributes(C,s,"board","selection");C.navbar=r.copyAttributes(C.navbar,s,"navbar");g=t.getDimensions(i,C.document);if(C.unitx||C.unity){a=r.def(C.originx,150);d=r.def(C.originy,150);l=r.def(C.unitx,50);c=r.def(C.unity,50)}else{b=C.boundingbox;u=parseInt(g.width,10);m=parseInt(g.height,10);if(r.exists(b)&&C.keepaspectratio){l=u/(b[2]-b[0]);c=m/(b[1]-b[3]);if(Math.abs(l)<Math.abs(c)){c=Math.abs(l)*c/Math.abs(c)}else{l=Math.abs(c)*l/Math.abs(l)}}else{l=u/(b[2]-b[0]);c=m/(b[1]-b[3])}a=-l*b[0];d=c*b[1]}p=this.initRenderer(i,g,C.document,C.renderer);P=new o(i,p,C.id,[a,d],C.zoomfactor*C.zoomx,C.zoomfactor*C.zoomy,l,c,g.width,g.height,C);e.boards[P.id]=P;P.keepaspectratio=C.keepaspectratio;P.resizeContainer(g.width,g.height,!0,!0);P.suspendUpdate();P.initInfobox();if(C.axis){y="object"===_typeof(C.axis)?C.axis:{};v=r.deepCopy(s.board.defaultAxes.x,y);f=r.deepCopy(s.board.defaultAxes.y,y);if(C.defaultaxes.x){v=r.deepCopy(v,C.defaultaxes.x)}if(C.defaultaxes.y){f=r.deepCopy(f,C.defaultaxes.y)}P.defaultAxes={};P.defaultAxes.x=P.create("axis",[[0,0],[1,0]],v);P.defaultAxes.y=P.create("axis",[[0,0],[0,1]],f)}if(C.grid){P.create("grid",[],"object"===_typeof(C.grid)?C.grid:{})}P._createSelectionPolygon(C);P.renderer.drawZoomBar(P,C.navbar);P.unsuspendUpdate();return P},loadBoardFromFile:function loadBoardFromFile(n,a,d,l,c){var p,u,h,m,g;l=l||{};p=r.copyAttributes(l,s,"board");p.zoom=r.copyAttributes(l,s,"board","zoom");p.pan=r.copyAttributes(l,s,"board","pan");p.selection=r.copyAttributes(p,s,"board","selection");p.navbar=r.copyAttributes(p.navbar,s,"navbar");m=t.getDimensions(n,p.document);u=this.initRenderer(n,m,p.document,p.renderer);h=new o(n,u,"",[150,150],1,1,50,50,m.width,m.height,p);h.initInfobox();h.resizeContainer(m.width,m.height,!0,!0);i.parseFileContent(a,h,d,!0,c);g=r.copyAttributes(p,s,"board","selection");h.selectionPolygon=h.create("polygon",[[0,0],[0,0],[0,0],[0,0]],g);h.renderer.drawZoomBar(h,p.navbar);e.boards[h.id]=h;return h},loadBoardFromString:function loadBoardFromString(n,a,d,l,c){var p,u,h,m,g;l=l||{};p=r.copyAttributes(l,s,"board");p.zoom=r.copyAttributes(l,s,"board","zoom");p.pan=r.copyAttributes(l,s,"board","pan");p.selection=r.copyAttributes(p,s,"board","selection");p.navbar=r.copyAttributes(p.navbar,s,"navbar");h=t.getDimensions(n,p.document);u=this.initRenderer(n,h,p.document);m=new o(n,u,"",[150,150],1,1,50,50,h.width,h.height,p);m.initInfobox();m.resizeContainer(h.width,h.height,!0,!0);i.parseString(a,m,d,!0,c);g=r.copyAttributes(p,s,"board","selection");m.selectionPolygon=m.create("polygon",[[0,0],[0,0],[0,0],[0,0]],g);m.renderer.drawZoomBar(m,p.navbar);e.boards[m.id]=m;return m},freeBoard:function freeBoard(t){if("string"==typeof t){t=e.boards[t]}t.removeEventHandlers();t.suspendUpdate();for(var r in t.objects){if(t.objects.hasOwnProperty(r)){t.objects[r].remove()}}while(t.containerObj.firstChild){t.containerObj.removeChild(t.containerObj.firstChild)}for(r in t.objects){if(t.objects.hasOwnProperty(r)){delete t.objects[r]}}delete t.renderer;t.jc.creator.clearCache();delete t.jc;delete e.boards[t.id]},registerElement:function registerElement(t,r){e.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()");e.registerElement(t,r)}};if(t.isBrowser&&"object"===("undefined"==typeof window?"undefined":_typeof(window))&&"object"===("undefined"==typeof document?"undefined":_typeof(document))){t.addEvent(window,"load",function(){var t,o,s,n,a,d,l,c,p,u,h,m,g=document.getElementsByTagName("script"),b=function(t,r,o){var i=e.JSXGraph.initBoard(a,{boundingbox:o,keepaspectratio:!0,grid:h,axis:u,showReload:!0});if(-1<r.toLowerCase().indexOf("script")){i.construct(t)}else{try{i.jc.parse(t)}catch(t){e.debug(t)}}return i},C=function(t,r,o,i){return function(){var s;e.JSXGraph.freeBoard(t);s=b(r,o,i);s.reload=C(s,r,o,i)}};for(o=0;o<g.length;o++){t=g[o].getAttribute("type",!1);if(r.exists(t)&&("text/jessiescript"===t.toLowerCase()||"jessiescript"===t.toLowerCase()||"text/jessiecode"===t.toLowerCase()||"jessiecode"===t.toLowerCase())){l=g[o].getAttribute("width",!1)||"500px";c=g[o].getAttribute("height",!1)||"500px";p=g[o].getAttribute("boundingbox",!1)||"-5, 5, 5, -5";a=g[o].getAttribute("container",!1);p=p.split(",");if(4!==p.length){p=[-5,5,5,-5]}else{for(s=0;s<p.length;s++){p[s]=parseFloat(p[s])}}u=r.str2Bool(g[o].getAttribute("axis",!1)||"false");h=r.str2Bool(g[o].getAttribute("grid",!1)||"false");if(!r.exists(a)){a="jessiescript_autgen_jxg_"+o;n=document.createElement("div");n.setAttribute("id",a);n.setAttribute("style","width:"+l+"; height:"+c+"; float:left");n.setAttribute("class","jxgbox");try{document.body.insertBefore(n,g[o])}catch(t){if("object"===("undefined"==typeof jQuery?"undefined":_typeof(jQuery))){jQuery(n).insertBefore(g[o])}}}else{n=document.getElementById(a)}if(document.getElementById(a)){m=g[o].innerHTML;m=m.replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,"");g[o].innerHTML=m;d=b(m,t,p);d.reload=C(d,m,t,p)}else{e.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}}}},window)}return e.JSXGraph});define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],function(e,r,o,i,n){"use strict";e.Group=function(e,t,o,s,a){var d,l,c,p;this.board=e;this.objects={};d=this.board.numObjects;this.board.numObjects+=1;if(""===t||!n.exists(t)){this.id=this.board.id+"Group"+d}else{this.id=t}this.board.groups[this.id]=this;this.type=r.OBJECT_TYPE_POINT;this.elementClass=r.OBJECT_CLASS_POINT;if(""===o||!n.exists(o)){this.name="group_"+this.board.generateName(this)}else{this.name=o}delete this.type;this.coords={};this.needsRegularUpdate=a.needsregularupdate;this.rotationCenter="centroid";this.scaleCenter=null;this.rotationPoints=[];this.translationPoints=[];this.scalePoints=[];this.scaleDirections={};this.parents=[];if(n.isArray(s)){l=s}else{l=Array.prototype.slice.call(arguments,3)}for(c=0;c<l.length;c++){p=this.board.select(l[c]);if(!n.evaluate(p.visProp.fixed)&&n.exists(p.coords)){this.addPoint(p)}}this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}};e.extend(e.Group.prototype,{ungroup:function ungroup(){var e,t,r;for(e in this.objects){if(this.objects.hasOwnProperty(e)){t=this.objects[e].point;if(n.isArray(t.groups)){r=n.indexOf(t.groups,this.id);if(0<=r){delete t.groups[r]}}}}this.objects={};return this},addParents:function addParents(e){var t,r,o;if(n.isArray(e)){o=e}else{o=arguments}r=o.length;for(t=0;t<r;++t){if(n.isId(this.board,o[t])){this.parents.push(o[t])}else if(n.exists(o[t].id)){this.parents.push(o[t].id)}}this.parents=n.uniqueArray(this.parents)},setParents:function setParents(e){this.parents=[];this.addParents(e)},getParents:function getParents(){return n.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function _updateCoordsCache(e){var t;if(""!==e&&n.exists(this.objects[e])){t=this.objects[e].point;this.coords[t.id]={usrCoords:t.coords.usrCoords.slice(0)}}},update:function update(e){var r,a,d,l,c,p,u,h,m,g=null;if(!this.needsUpdate){return this}e=this._update_find_drag_type();if("nothing"===e.action){this._updateCoordsCache(e.id);return this}g=this.objects[e.id].point;if("translation"===e.action){h=[g.coords.usrCoords[1]-this.coords[e.id].usrCoords[1],g.coords.usrCoords[2]-this.coords[e.id].usrCoords[2]]}else if("rotation"===e.action||"scaling"===e.action){if("rotation"===e.action){a="rotationCenter"}else{a="scaleCenter"}if(n.isPoint(this[a])){m=this[a].coords.usrCoords.slice(1)}else if("centroid"===this[a]){m=this._update_centroid_center()}else if(n.isArray(this[a])){m=this[a]}else if(n.isFunction(this[a])){m=this[a]()}else{return this}if("rotation"===e.action){u=i.rad(this.coords[e.id].usrCoords.slice(1),m,this.objects[e.id].point);h=this.board.create("transform",[u,m[0],m[1]],{type:"rotate"});h.update()}else if("scaling"===e.action){l=i.distance(this.coords[e.id].usrCoords.slice(1),m);if(Math.abs(l)<o.eps){return this}l=i.distance(g.coords.usrCoords.slice(1),m)/l;c=0<=this.scaleDirections[e.id].indexOf("x")?l:1;p=0<=this.scaleDirections[e.id].indexOf("y")?l:1;h=this.board.create("transform",[1,0,0,m[0]*(1-c),c,0,m[1]*(1-p),0,p],{type:"generic"});h.update()}else{return this}}this._update_apply_transformation(e,h);this.needsUpdate=!1;for(r in this.objects){if(this.objects.hasOwnProperty(r)){for(d in this.objects[r].descendants){if(this.objects[r].descendants.hasOwnProperty(d)){this.objects[r].descendants.needsUpdate=this.objects[r].descendants.needsRegularUpdate||this.board.needsFullUpdate}}}}this.board.updateElements(e);for(r in this.objects){if(this.objects.hasOwnProperty(r)){this._updateCoordsCache(r)}}return this},_update_find_drag_type:function _update_find_drag_type(){var e,t,i="nothing",s=[],a;for(e in this.objects){if(this.objects.hasOwnProperty(e)){t=this.objects[e].point;if(t.coords.distance(r.COORDS_BY_USER,this.coords[e])>o.eps){s.push(t.id)}}}if(0===s.length){return{action:i,id:"",changed:s}}a=s[0];t=this.objects[a].point;if(1<s.length){i="translation"}else{if(n.isInArray(this.rotationPoints,t)&&n.exists(this.rotationCenter)){i="rotation"}else if(n.isInArray(this.scalePoints,t)&&n.exists(this.scaleCenter)){i="scaling"}else if(n.isInArray(this.translationPoints,t)){i="translation"}}return{action:i,id:a,changed:s}},_update_centroid_center:function _update_centroid_center(){var e,t,r;e=[0,0];t=0;for(r in this.coords){if(this.coords.hasOwnProperty(r)){e[0]+=this.coords[r].usrCoords[1];e[1]+=this.coords[r].usrCoords[2];++t}}if(0<t){e[0]/=t;e[1]/=t}return e},_update_apply_transformation:function _update_apply_transformation(e,i){var t,s;for(t in this.objects){if(this.objects.hasOwnProperty(t)){if(n.exists(this.board.objects[t])){s=this.objects[t].point;if(s.id!==e.id){if("translation"===e.action){if(!n.isInArray(e.changed,s.id)){s.coords.setCoordinates(r.COORDS_BY_USER,[this.coords[t].usrCoords[1]+i[0],this.coords[t].usrCoords[2]+i[1]])}}else if("rotation"===e.action||"scaling"===e.action){i.applyOnce([s])}}else{if("rotation"===e.action||"scaling"===e.action){s.coords.setCoordinates(r.COORDS_BY_USER,o.matVecMult(i.matrix,this.coords[s.id].usrCoords))}}}else{delete this.objects[t]}}}},addPoint:function addPoint(e){this.objects[e.id]={point:this.board.select(e)};this._updateCoordsCache(e.id);this.translationPoints.push(e);e.groups.push(this.id);e.groups=n.uniqueArray(e.groups);return this},addPoints:function addPoints(e){var t;for(t=0;t<e.length;t++){this.addPoint(e[t])}return this},addGroup:function addGroup(e){for(var t in e.objects){if(e.objects.hasOwnProperty(t)){this.addPoint(e.objects[t].point)}}return this},removePoint:function removePoint(e){delete this.objects[e.id];return this},setRotationCenter:function setRotationCenter(e){this.rotationCenter=e;return this},setRotationPoints:function setRotationPoints(e){return this._setActionPoints("rotation",e)},addRotationPoint:function addRotationPoint(e){return this._addActionPoint("rotation",e)},removeRotationPoint:function removeRotationPoint(e){return this._removeActionPoint("rotation",e)},setTranslationPoints:function setTranslationPoints(e){return this._setActionPoints("translation",e)},addTranslationPoint:function addTranslationPoint(e){return this._addActionPoint("translation",e)},removeTranslationPoint:function removeTranslationPoint(e){return this._removeActionPoint("translation",e)},setScaleCenter:function setScaleCenter(e){this.scaleCenter=e;return this},setScalePoints:function setScalePoints(e,t){var r,o,s;if(n.isArray(e)){r=e}else{r=arguments}s=r.length;for(o=0;o<s;++o){this.scaleDirections[this.board.select(r[o]).id]=t||"xy"}return this._setActionPoints("scale",e)},addScalePoint:function addScalePoint(e,t){this._addActionPoint("scale",e);this.scaleDirections[this.board.select(e).id]=t||"xy";return this},removeScalePoint:function removeScalePoint(e){return this._removeActionPoint("scale",e)},_setActionPoints:function _setActionPoints(e,t){var r,o,s;if(n.isArray(t)){r=t}else{r=arguments}s=r.length;this[e+"Points"]=[];for(o=0;o<s;++o){this._addActionPoint(e,r[o])}return this},_addActionPoint:function _addActionPoint(e,t){this[e+"Points"].push(this.board.select(t));return this},_removeActionPoint:function _removeActionPoint(e,t){var r=this[e+"Points"].indexOf(this.board.select(t));if(-1<r){this[e+"Points"].splice(r,1)}return this},setProperty:function setProperty(){e.deprecated("Group.setProperty","Group.setAttribute()");this.setAttribute.apply(this,arguments)},setAttribute:function setAttribute(){for(var e in this.objects){if(this.objects.hasOwnProperty(e)){this.objects[e].point.setAttribute.apply(this.objects[e].point,arguments)}}return this}});e.createGroup=function(t,r,o){var i=n.copyAttributes(o,t.options,"group"),s=new e.Group(t,i.id,i.name,r,i);s.elType="group";s.setParents(r);return s};e.registerElement("group",e.createGroup);return{Group:e.Group,createGroup:e.createGroup}});define("element/locus",["jxg","math/symbolic","utils/type","base/constants","base/curve"],function(e,t,r){"use strict";e.createLocus=function(e,o,i){var s,n;if(r.isArray(o)&&1===o.length&&r.isPoint(o[0])){n=o[0]}else{throw new Error("JSXGraph: Can't create locus with parent of type other than point.\nPossible parent types: [point]")}s=e.create("curve",[[null],[null]],i);s.dontCallServer=!1;s.elType="locus";s.setParents([n.id]);s.updateDataArray=function(){var r,o,i;if(0<s.board.mode){return}r=t.generatePolynomials(e,n,!0).join("|");if(r===s.spe){return}s.spe=r;o=function(e,r,o,i){s.dataX=e;s.dataY=r;s.eq=o;s.ctime=i;s.generatePolynomial=function(e){return function(t){var r,o="("+t.symbolic.x+")",s="("+t.symbolic.y+")",n=[];for(r=0;r<e.length;r++){n[r]=e[r].replace(/\*\*/g,"^").replace(/x/g,o).replace(/y/g,s)}return n}}(o)};i=t.geometricLocusByGroebnerBase(e,n,o);o(i.datax,i.datay,i.polynomial,i.exectime)};return s};e.registerElement("locus",e.createLocus);return{createLocus:e.createLocus}});define("base/image",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","utils/type","base/coordselement"],function(e,t,o,i,s,n,a,d){"use strict";e.Image=function(r,o,i,s,n){this.constructor(r,i,t.OBJECT_TYPE_IMAGE,t.OBJECT_CLASS_OTHER);this.element=this.board.select(i.anchor);this.coordsConstructor(o);this.W=a.createFunction(n[0],this.board,"");this.H=a.createFunction(n[1],this.board,"");this.usrSize=[this.W(),this.H()];this.size=[Math.abs(this.usrSize[0]*r.unitX),Math.abs(this.usrSize[1]*r.unitY)];this.url=s;this.elType="image";this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]];this.id=this.board.setId(this,"Im");this.board.renderer.drawImage(this);this.board.finalizeAdding(this);this.methodMap=e.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})};e.Image.prototype=new i;a.copyPrototypeMethods(e.Image,d,"coordsConstructor");e.extend(e.Image.prototype,{hasPoint:function hasPoint(e,i){var n,a,d,l,u,h,m,g=this.transformations.length;if(0===g){n=e-this.coords.scrCoords[1];a=this.coords.scrCoords[2]-i;d=this.board.options.precision.hasPoint;return n>=-d&&n-this.size[0]<=d&&a>=-d&&a-this.size[1]<=d}l=new o(t.COORDS_BY_SCREEN,[e,i],this.board);l=l.usrCoords;u=[l[0]-this.span[0][0],l[1]-this.span[0][1],l[2]-this.span[0][2]];m=s.innerProduct;h=m(u,this.span[1]);if(0<=h&&h<=m(this.span[1],this.span[1])){h=m(u,this.span[2]);if(0<=h&&h<=m(this.span[2],this.span[2])){return!0}}return!1},update:function update(e){if(!this.needsUpdate){return this}this.updateCoords(e);this.updateSize();this.updateSpan();return this},updateRenderer:function updateRenderer(){return this.updateRendererGeneric("updateImage")},updateSize:function updateSize(){this.usrSize=[this.W(),this.H()];this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)];return this},updateSpan:function updateSpan(){var e,t,r=this.transformations.length,o=[];if(0===r){this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]]}else{o[0]=[this.Z(),this.X(),this.Y()];o[1]=[this.Z(),this.X()+this.W(),this.Y()];o[2]=[this.Z(),this.X(),this.Y()+this.H()];for(e=0;e<r;e++){for(t=0;3>t;t++){o[t]=s.matVecMult(this.transformations[e].matrix,o[t])}}for(t=0;3>t;t++){o[t][1]/=o[t][0];o[t][2]/=o[t][0];o[t][0]/=o[t][0]}for(t=1;3>t;t++){o[t][0]-=o[0][0];o[t][1]-=o[0][1];o[t][2]-=o[0][2]}this.span=o}return this},addTransform:function addTransform(e){var t;if(a.isArray(e)){for(t=0;t<e.length;t++){this.transformations.push(e[t])}}else{this.transformations.push(e)}return this},getParents:function getParents(){var e=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];if(0!==this.parents.length){e=this.parents}return e},setSize:function setSize(e,t){this.W=a.createFunction(e,this.board,"");this.H=a.createFunction(t,this.board,"");return this},W:function W(){},H:function H(){}});e.createImage=function(t,r,o){var i,s,n=r[0],l=r[1],c=r[2];i=a.copyAttributes(o,t.options,"image");s=d.create(e.Image,t,l,i,n,c);if(!s){throw new Error("JSXGraph: Can't create image with parent types '"+_typeof(r[0])+"' and '"+_typeof(r[1])+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]")}if(0!==a.evaluate(i.rotate)){s.addRotation(a.evaluate(i.rotate))}return s};e.registerElement("image",e.createImage);return{Image:e.Image,createImage:e.createImage}});define("base/ticks",["jxg","math/math","math/geometry","base/constants","base/element","base/coords","utils/type","base/text"],function(e,o,i,s,n,a,l,c){"use strict";e.Ticks=function(e,t,r){this.constructor(e.board,r,s.OBJECT_TYPE_TICKS,s.OBJECT_CLASS_OTHER);this.line=e;this.board=this.line.board;this.ticksFunction=null;this.fixedTicks=null;this.equidistant=!1;this.labelsData=[];if(l.isFunction(t)){this.ticksFunction=t;throw new Error("Function arguments are no longer supported.")}if(l.isArray(t)){this.fixedTicks=t}else{if(Math.abs(t)<o.eps||0>t){t=r.defaultdistance}this.ticksFunction=this.makeTicksFunction(t);this.equidistant=!0}this.minTicksDistance=r.minticksdistance;this.ticks=[];this.ticksDelta=1;this.labels=[];this.labelData=[];this.labelCounter=0;this.id=this.line.addTicks(this);this.elType="ticks";this.inherits.push(this.labels);this.board.setId(this,"Ti")};e.Ticks.prototype=new n;e.extend(e.Ticks.prototype,{makeTicksFunction:function makeTicksFunction(e){return function(){var t,r,o;if(l.evaluate(this.visProp.insertticks)){r=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance");o=r.upper-r.lower;t=Math.pow(10,Math.floor(Math.log(.6*o)/Math.LN10));if(o<=6*t){t*=.5}return t}return e}},hasPoint:function hasPoint(e,n){var a,d,c=this.ticks&&this.ticks.length||0,p=this.board.options.precision.hasPoint+.5*l.evaluate(this.visProp.strokewidth);if(!l.evaluate(this.line.visProp.scalable)){return!1}if(0!==this.line.stdform[1]&&0!==this.line.stdform[2]&&this.line.type!==s.OBJECT_TYPE_AXIS){return!1}for(a=0;a<c;a++){d=this.ticks[a];if(d[2]){if(!(0===this.line.stdform[1]&&Math.abs(d[0][0]-this.line.point1.coords.scrCoords[1])<o.eps||0===this.line.stdform[2]&&Math.abs(d[1][0]-this.line.point1.coords.scrCoords[2])<o.eps)){if(1<=Math.abs(d[0][0]-d[0][1])||1<=Math.abs(d[1][0]-d[1][1])){if(0===this.line.stdform[1]){if(Math.abs(n-.5*(d[1][0]+d[1][1]))<2*p&&d[0][0]-p<e&&e<d[0][1]+p){return!0}}else if(0===this.line.stdform[2]){if(Math.abs(e-.5*(d[0][0]+d[0][1]))<2*p&&d[1][0]-p<n&&n<d[1][1]+p){return!0}}}}}}return!1},setPositionDirectly:function setPositionDirectly(e,t,r){var i,s,n=new a(e,t,this.board),d=new a(e,r,this.board),c=this.board.getBoundingBox();if(!l.evaluate(this.line.visProp.scalable)){return this}if(Math.abs(this.line.stdform[1])<o.eps&&Math.abs(n.usrCoords[1]*d.usrCoords[1])>o.eps){i=d.usrCoords[1]/n.usrCoords[1];c[0]*=i;c[2]*=i;this.board.setBoundingBox(c,!1)}else if(Math.abs(this.line.stdform[2])<o.eps&&Math.abs(n.usrCoords[2]*d.usrCoords[2])>o.eps){s=d.usrCoords[2]/n.usrCoords[2];c[3]*=s;c[1]*=s;this.board.setBoundingBox(c,!1)}return this},calculateTicksCoordinates:function calculateTicksCoordinates(){var e,t;this.setTicksSizeVariables();if(Math.abs(this.dx)<o.eps&&Math.abs(this.dy)<o.eps){return}e=this.getZeroCoordinates();t=this.getLowerAndUpperBounds(e);this.ticks=[];this.labelsData=[];if(this.equidistant){this.generateEquidistantTicks(e,t)}else{this.generateFixedTicks(e,t)}return this},setTicksSizeVariables:function setTicksSizeVariables(){var e,t=.5*l.evaluate(this.visProp.majorheight),r=.5*l.evaluate(this.visProp.minorheight);this.dxMaj=this.line.stdform[1];this.dyMaj=this.line.stdform[2];this.dxMin=this.dxMaj;this.dyMin=this.dyMaj;this.dx=this.dxMaj;this.dy=this.dyMaj;e=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY);this.dxMaj*=t/e*this.board.unitX;this.dyMaj*=t/e*this.board.unitY;this.dxMin*=r/e*this.board.unitX;this.dyMin*=r/e*this.board.unitY;this.minStyle=0>l.evaluate(this.visProp.minorheight)?"infinite":"finite";this.majStyle=0>l.evaluate(this.visProp.majorheight)?"infinite":"finite"},getZeroCoordinates:function getZeroCoordinates(){var e,t,r,o,n,d,c=l.evaluate(this.visProp.anchor);if(this.line.type===s.OBJECT_TYPE_AXIS){return i.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board)}r=this.line.point1.coords.usrCoords[0];e=this.line.point1.coords.usrCoords[1];t=this.line.point1.coords.usrCoords[2];d=this.line.point2.coords.usrCoords[0];o=this.line.point2.coords.usrCoords[1];n=this.line.point2.coords.usrCoords[2];if("right"===c){return this.line.point2.coords}else if("middle"===c){return new a(s.COORDS_BY_USER,[.5*(r+d),.5*(e+o),.5*(t+n)],this.board)}else if(l.isNumber(c)){return new a(s.COORDS_BY_USER,[r+(d-r)*c,e+(o-e)*c,t+(n-t)*c],this.board)}return this.line.point1.coords},getLowerAndUpperBounds:function getLowerAndUpperBounds(e,t){var r,n,d=new a(s.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),c=new a(s.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),p=Math.abs(d.usrCoords[0])>=o.eps&&0<=d.scrCoords[1]&&d.scrCoords[1]<=this.board.canvasWidth&&0<=d.scrCoords[2]&&d.scrCoords[2]<=this.board.canvasHeight,u=Math.abs(c.usrCoords[0])>=o.eps&&0<=c.scrCoords[1]&&c.scrCoords[1]<=this.board.canvasWidth&&0<=c.scrCoords[2]&&c.scrCoords[2]<=this.board.canvasHeight,h,m,g=l.evaluate(this.line.visProp.straightfirst),b=l.evaluate(this.line.visProp.straightlast),C=l.evaluate(this.visProp.includeboundaries),y;if(l.exists(t)||"tickdistance"===t){i.calcStraight(this.line,d,c,l.evaluate(this.line.visProp.margin))}else{i.calcLineDelimitingPoints(this.line,d,c)}y=this.board.renderer.getPositionArrowHead(this.line,d,c,l.evaluate(this.line.visProp.strokewidth));d.setCoordinates(s.COORDS_BY_SCREEN,[d.scrCoords[1]-y.d1x,d.scrCoords[2]-y.d1y]);c.setCoordinates(s.COORDS_BY_SCREEN,[c.scrCoords[1]-y.d2x,c.scrCoords[2]-y.d2y]);h=this.getDistanceFromZero(e,d);m=this.getDistanceFromZero(e,c);if(h<m){r=h;if(!g&&p&&!C){r+=o.eps}n=m;if(!b&&u&&!C){n-=o.eps}}else if(m<h){r=m;if(!b&&u&&!C){r+=o.eps}n=h;if(!g&&p&&!C){n-=o.eps}}else{r=0;n=0}return{lower:r,upper:n}},getDistanceFromZero:function getDistanceFromZero(e,t){var r=o.eps,n=e.distance(s.COORDS_BY_USER,t);if(this.line.type===s.OBJECT_TYPE_AXIS){if(o.relDif(e.usrCoords[1],t.usrCoords[1])>r&&e.usrCoords[1]-t.usrCoords[1]>r||o.relDif(e.usrCoords[2],t.usrCoords[2])>r&&e.usrCoords[2]-t.usrCoords[2]>r){n*=-1}}else if("right"===l.evaluate(this.visProp.anchor)){if(i.isSameDirection(e,this.line.point1.coords,t)){n*=-1}}else{if(!i.isSameDirection(e,this.line.point2.coords,t)){n*=-1}}return n},generateEquidistantTicks:function generateEquidistantTicks(e,t){var r,i=this.getXandYdeltas(),s=this.equidistant?this.ticksFunction(1):this.ticksDelta,n=l.evaluate(this.visProp.insertticks),a=l.evaluate(this.visProp.minorticks);s*=l.evaluate(this.visProp.scale);if(n&&this.minTicksDistance>o.eps){s=this.adjustTickDistance(s,e,i);s/=a+1}else if(!n){s/=a+1}this.ticksDelta=s;if(s<o.eps){return}r=0;if(!l.evaluate(this.visProp.drawzero)){r=s}while(r<=t.upper){if(r>=t.lower){this.processTickPosition(e,r,s,i)}r+=s}r=-s;while(r>=t.lower){if(r<=t.upper){this.processTickPosition(e,r,s,i)}r-=s}},adjustTickDistance:function adjustTickDistance(e,t,r){var o,i,n,d=1,c=l.evaluate(this.visProp.minorticks);this.getLowerAndUpperBounds(t,"ticksdistance");o=t.usrCoords[1]+r.x*e;i=t.usrCoords[2]+r.y*e;n=t.distance(s.COORDS_BY_SCREEN,new a(s.COORDS_BY_USER,[o,i],this.board));while(n/(c+1)<this.minTicksDistance){if(1==d){e*=2}else{e*=5}d*=-1;o=t.usrCoords[1]+r.x*e;i=t.usrCoords[2]+r.y*e;n=t.distance(s.COORDS_BY_SCREEN,new a(s.COORDS_BY_USER,[o,i],this.board))}return e},processTickPosition:function processTickPosition(e,t,r,o){var i,n,d,c;i=e.usrCoords[1]+t*o.x;n=e.usrCoords[2]+t*o.y;d=new a(s.COORDS_BY_USER,[i,n],this.board);d.major=0==Math.round(t/r)%(l.evaluate(this.visProp.minorticks)+1);c=this.tickEndings(d,d.major);if(3===c.length){this.ticks.push(c);if(d.major&&l.evaluate(this.visProp.drawlabels)){this.labelsData.push(this.generateLabelData(this.generateLabelText(d,e),d,this.ticks.length))}else{this.labelsData.push(null)}}},generateFixedTicks:function generateFixedTicks(e,t){var r,o,n,d,c,p,u=l.isArray(this.visProp.labels),h=this.getXandYdeltas(),m=l.evaluate(this.visProp.drawlabels);for(n=0;n<this.fixedTicks.length;n++){c=e.usrCoords[1]+this.fixedTicks[n]*h.x;p=e.usrCoords[2]+this.fixedTicks[n]*h.y;r=new a(s.COORDS_BY_USER,[c,p],this.board);d=this.tickEndings(r,!0);if(3===d.length&&this.fixedTicks[n]>=t.lower&&this.fixedTicks[n]<=t.upper){this.ticks.push(d);if(m&&(u||l.exists(this.visProp.labels[n]))){o=u?l.evaluate(this.visProp.labels[n]):this.fixedTicks[n];this.labelsData.push(this.generateLabelData(this.generateLabelText(r,e,o),r,n))}else{this.labelsData.push(null)}}}},getXandYdeltas:function getXandYdeltas(){var e,t,r=this.line.point1.Dist(this.line.point2);if(this.line.type===s.OBJECT_TYPE_AXIS){e=this.line.point1.coords.usrCoords;t=this.line.point2.coords.usrCoords;if(e[1]>t[1]||Math.abs(e[1]-t[1])<o.eps&&e[2]>t[2]){e=this.line.point2.coords.usrCoords;t=this.line.point1.coords.usrCoords}}else{e=this.line.point1.coords.usrCoords;t=this.line.point2.coords.usrCoords}return{x:(t[1]-e[1])/r,y:(t[2]-e[2])/r}},_isInsideCanvas:function _isInsideCanvas(e,t,r){var o=this.board.canvasWidth,i=this.board.canvasHeight;if(r===void 0){r=0}return e[0]>=r&&e[0]<=o-r&&t[0]>=r&&t[0]<=i-r||e[1]>=r&&e[1]<=o-r&&t[1]>=r&&t[1]<=i-r},tickEndings:function tickEndings(e,t){var r,o,s,n,a,d,p=[-2e6,-2e6],u=[-2e6,-2e6];r=e.scrCoords;if(t){n=this.dxMaj;a=this.dyMaj;d=this.majStyle}else{n=this.dxMin;a=this.dyMin;d=this.minStyle}o=[-a*r[1]-n*r[2],a,n];if("infinite"===d){s=i.meetLineBoard(o,this.board);p[0]=s[0].scrCoords[1];p[1]=s[1].scrCoords[1];u[0]=s[0].scrCoords[2];u[1]=s[1].scrCoords[2]}else{p[0]=r[1]+n*l.evaluate(this.visProp.tickendings[0]);u[0]=r[2]-a*l.evaluate(this.visProp.tickendings[0]);p[1]=r[1]-n*l.evaluate(this.visProp.tickendings[1]);u[1]=r[2]+a*l.evaluate(this.visProp.tickendings[1])}if(this._isInsideCanvas(p,u)){return[p,u,t]}return[]},formatLabelText:function formatLabelText(e){var t=e.toString(),r=l.evaluate(this.visProp.scalesymbol);if(l.isNumber(e)){if(t.length>l.evaluate(this.visProp.maxlabellength)||-1!==t.indexOf("e")){t=e.toPrecision(l.evaluate(this.visProp.precision)).toString()}if(-1<t.indexOf(".")&&-1===t.indexOf("e")){t=t.replace(/0+$/,"");t=t.replace(/\.$/,"")}}if(0<r.length){if("1"===t){t=r}else if("-1"===t){t="-"+r}else if("0"!==t){t=t+r}}if(l.evaluate(this.visProp.useunicodeminus)){t=t.replace(/-/g,"\u2212")}return t},generateLabelText:function generateLabelText(e,t,r){var i,s=this.getDistanceFromZero(t,e);if(Math.abs(s)<o.eps){i="0"}else{if(!l.exists(r)){r=s/l.evaluate(this.visProp.scale)}i=this.formatLabelText(r)}return i},generateLabelData:function generateLabelData(e,t,r){var o,i,s,n;n=l.evaluate(this.visProp.label.fontsize);o=[t.scrCoords[1],t.scrCoords[1]];i=[t.scrCoords[2],t.scrCoords[2]];s=n===void 0?12:n;s*=1.5;if(!this._isInsideCanvas(o,i,s)){return null}o=l.evaluate(this.visProp.label.offset[0]);i=l.evaluate(this.visProp.label.offset[1]);return{x:t.usrCoords[1]+o/this.board.unitX,y:t.usrCoords[2]+i/this.board.unitY,t:e,i:r}},update:function update(){if(this.needsUpdate){if(0!==this.board.canvasWidth&&0!==this.board.canvasHeight){this.calculateTicksCoordinates()}}return this},updateRenderer:function updateRenderer(){if(!this.needsUpdate){return this}if(this.visPropCalc.visible){this.board.renderer.updateTicks(this)}this.updateRendererLabels();this.setDisplayRendNode();this.needsUpdate=!1;return this},updateRendererLabels:function updateRendererLabels(){var e,t,r,o,s,n,a,d;r=this.labelsData.length;o=this.labels.length;for(e=0,t=0;e<r;e++){if(null===this.labelsData[e]){continue}a=this.labelsData[e];if(t<o){n=this.labels[t];n.setText(a.t);n.setCoords(a.x,a.y);t++}else{this.labelCounter+=1;s={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv};s=l.deepCopy(s,this.visProp.label);s.id=this.id+a.i+"Label"+this.labelCounter;n=c.createText(this.board,[a.x,a.y,a.t],s);n.isDraggable=!1;n.dump=!1;this.labels.push(n)}d=l.evaluate(this.visProp.label.visible);if("inherit"===d){d=this.visPropCalc.visible}n.prepareUpdate().updateVisibility(d).updateRenderer();n.distanceX=l.evaluate(this.visProp.label.offset[0]);n.distanceY=l.evaluate(this.visProp.label.offset[1])}r=t;for(t=r;t<o;t++){this.board.renderer.display(this.labels[t],!1);this.labels[t].visProp.visible=!1}return this},hideElement:function hideElement(){var t;e.deprecated("Element.hideElement()","Element.setDisplayRendNode()");this.visPropCalc.visible=!1;this.board.renderer.display(this,!1);for(t=0;t<this.labels.length;t++){if(l.exists(this.labels[t])){this.labels[t].hideElement()}}return this},showElement:function showElement(){var t;e.deprecated("Element.showElement()","Element.setDisplayRendNode()");this.visPropCalc.visible=!0;this.board.renderer.display(this,!1);for(t=0;t<this.labels.length;t++){if(l.exists(this.labels[t])){this.labels[t].showElement()}}return this}});e.createTicks=function(t,r,o){var i,n,a=l.copyAttributes(o,t.options,"ticks");if(2>r.length){n=a.ticksdistance}else{n=r[1]}if(r[0].elementClass===s.OBJECT_CLASS_LINE){i=new e.Ticks(r[0],n,a)}else{throw new Error("JSXGraph: Can't create Ticks with parent types '"+_typeof(r[0])+"'.")}if(l.isFunction(a.generatelabelvalue)){i.generateLabelText=a.generatelabelvalue}if(l.isFunction(a.generatelabeltext)){i.generateLabelText=a.generatelabeltext}i.setParents(r[0]);i.isDraggable=!0;i.fullUpdate(r[0].visPropCalc.visible);return i};e.createHatchmark=function(e,t,r){var o,n,a,d,c,p,u=[],h=l.copyAttributes(r,e.options,"hatch");if(t[0].elementClass!==s.OBJECT_CLASS_LINE||"number"!=typeof t[1]){throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+" and ''"+_typeof(t[2])+"'.")}o=t[1];d=h.ticksdistance;c=(o-1)*d;a=.5*-c;for(n=0;n<o;n++){u[n]=a+n*d}p=e.create("ticks",[t[0],u],h);p.elType="hatch";return p};e.registerElement("ticks",e.createTicks);e.registerElement("hash",e.createHatchmark);e.registerElement("hatch",e.createHatchmark);return{Ticks:e.Ticks,createTicks:e.createTicks,createHashmark:e.createHatchmark,createHatchmark:e.createHatchmark}});define("element/slider",["jxg","math/math","base/constants","utils/type","base/point","base/group","base/element","base/line","base/ticks","base/text"],function(e,t,r,o,i){"use strict";e.createSlider=function(e,s,n){var a,d,l,c,p,u,h,m,g,b,C,y,v,f,P,_,S,E,x,O,T;O=o.copyAttributes(n,e.options,"slider");E=O.withticks;S=O.withlabel;x=O.snapwidth;T=O.precision;O=o.copyAttributes(n,e.options,"slider","point1");h=e.create("point",s[0],O);O=o.copyAttributes(n,e.options,"slider","point2");m=e.create("point",s[1],O);O=o.copyAttributes(n,e.options,"slider","baseline");g=e.create("segment",[h,m],O);g.updateStdform();a=h.coords.usrCoords.slice(1);d=m.coords.usrCoords.slice(1);l=s[2][0];c=s[2][1];p=s[2][2];u=p-l;y=a[0]+(d[0]-a[0])*(c-l)/(p-l);v=a[1]+(d[1]-a[1])*(c-l)/(p-l);O=o.copyAttributes(n,e.options,"slider");O.withLabel=!1;f=e.create("glider",[y,v,g],O);f.setAttribute({snapwidth:x});O=o.copyAttributes(n,e.options,"slider","highline");P=e.create("segment",[h,f],O);f.Value=function(){var e=this._smax-this._smin,t=o.evaluate(this.visProp.snapwidth);return-1===t?this.position*e+this._smin:Math.round((this.position*e+this._smin)/t)*t};f.methodMap=o.deepCopy(f.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"});f._smax=p;f._smin=l;f.setMax=function(e){this._smax=e;return this};f.setValue=function(e){var r=this._smax-this._smin;if(Math.abs(r)>t.eps){this.position=(e-this._smin)/r}else{this.position=0}this.position=Math.max(0,Math.min(1,this.position));return this};f.setMin=function(e){this._smin=e;return this};if(S){O=o.copyAttributes(n,e.options,"slider","label");_=e.create("text",[function(){return .05*(m.X()-h.X())+m.X()},function(){return .05*(m.Y()-h.Y())+m.Y()},function(){var e,t=o.evaluate(f.visProp.suffixlabel),r=o.evaluate(f.visProp.unitlabel),i=o.evaluate(f.visProp.postlabel);if(null!==t){e=t}else if(f.name&&""!==f.name){e=f.name+" = "}else{e=""}e+=o.toFixed(f.Value(),T);if(null!==r){e+=r}if(null!==i){e+=i}return e}],O);f.label=_;f.visProp.withlabel=!0;f.hasLabel=!0}f.point1=h;f.point2=m;f.baseline=g;f.highline=P;if(E){O=o.copyAttributes(n,e.options,"slider","ticks");if(!o.exists(O.generatelabeltext)){O.generateLabelText=function(e,r){var o,i=f.point1.Dist(f.point2),s=f._smin,n=f._smax,a=this.getDistanceFromZero(r,e)*(n-s)/i+s;if(i<t.eps||Math.abs(a)<t.eps){o="0"}else{o=this.formatLabelText(a)}return o}}b=2;C=e.create("ticks",[f.baseline,f.point1.Dist(h)/b,function(e){var o=f.point1.Dist(f.point2),i=f.point1.coords.distance(r.COORDS_BY_USER,e);if(o<t.eps){return 0}return i/o*u+l}],O);f.ticks=C}f.remove=function(){if(S){e.removeObject(_)}e.removeObject(P);e.removeObject(g);e.removeObject(m);e.removeObject(h);i.Point.prototype.remove.call(f)};h.dump=!1;m.dump=!1;g.dump=!1;P.dump=!1;f.elType="slider";f.parents=s;f.subs={point1:h,point2:m,baseLine:g,highLine:P};f.inherits.push(h,m,g,P);if(E){C.dump=!1;f.subs.ticks=C;f.inherits.push(C)}return f};e.registerElement("slider",e.createSlider);return{createSlider:e.createSlider}});define("element/measure",["jxg","utils/type","base/element","base/point","base/line","base/ticks"],function(e,t,r){"use strict";e.createTapemeasure=function(o,i,s){var a,d,l,c,p,u,h,m,g,b,C;a=i[0];d=i[1];l=t.copyAttributes(s,o.options,"tapemeasure","point1");m=o.create("point",a,l);l=t.copyAttributes(s,o.options,"tapemeasure","point2");g=o.create("point",d,l);m.setAttribute({ignoredSnapToPoints:[g]});g.setAttribute({ignoredSnapToPoints:[m]});l=t.copyAttributes(s,o.options,"tapemeasure");c=l.withticks;p=l.withlabel;u=l.precision;if(p){l.withlabel=!0}h=o.create("segment",[m,g],l);if(p){if(s.name&&""!==s.name){b=s.name+" = "}else{b=""}h.label.setText(function(){return b+t.toFixed(m.Dist(g),u)})}if(c){l=t.copyAttributes(s,o.options,"tapemeasure","ticks");C=o.create("ticks",[h,.1],l);h.inherits.push(C)}h.remove=function(){if(c){h.removeTicks(C)}o.removeObject(g);o.removeObject(m);r.prototype.remove.call(this)};h.Value=function(){return m.Dist(g)};m.dump=!1;g.dump=!1;h.elType="tapemeasure";h.getParents=function(){return[[m.X(),m.Y()],[g.X(),g.Y()]]};h.subs={point1:m,point2:g};if(c){C.dump=!1}h.methodMap=e.deepCopy(h.methodMap,{Value:"Value"});h.prepareUpdate().update();if(!o.isSuspendedUpdate){h.updateVisibility().updateRenderer();h.point1.updateVisibility().updateRenderer();h.point2.updateVisibility().updateRenderer()}return h};e.registerElement("tapemeasure",e.createTapemeasure);return{createTapemeasure:e.createTapemeasure}});define("parser/datasource",["jxg","utils/type"],function(e,t){"use strict";e.DataSource=function(){this.data=[];this.columnHeaders=[];this.rowHeaders=[];return this};e.extend(e.DataSource.prototype,{loadFromArray:function loadFromArray(e,r,o){var s,n,a;if(t.isArray(r)){this.columnHeaders=r;r=!1}if(t.isArray(o)){this.rowHeaders=o;o=!1}this.data=[];if(r){this.columnHeaders=[]}if(o){this.rowHeaders=[]}if(t.exists(e)){this.data=[];for(s=0;s<e.length;s++){this.data[s]=[];for(n=0;n<e[s].length;n++){a=e[s][n];if(parseFloat(a).toString()===a){this.data[s][n]=parseFloat(a)}else if("-"!==a){this.data[s][n]=a}else{this.data[s][n]=NaN}}}if(r){this.columnHeaders=this.data[0].slice(1);this.data=this.data.slice(1)}if(o){this.rowHeaders=[];for(s=0;s<this.data.length;s++){this.rowHeaders.push(this.data[s][0]);this.data[s]=this.data[s].slice(1)}}}return this},loadFromTable:function loadFromTable(e,r,o){var s,n,a,d,l;if(t.isArray(r)){this.columnHeaders=r;r=!1}if(t.isArray(o)){this.rowHeaders=o;o=!1}this.data=[];if(r){this.columnHeaders=[]}if(o){this.rowHeaders=[]}e=document.getElementById(e);if(t.exists(e)){s=e.getElementsByTagName("tr");this.data=[];for(n=0;n<s.length;n++){d=s[n].getElementsByTagName("td");this.data[n]=[];for(a=0;a<d.length;a++){l=d[a].innerHTML;if(parseFloat(l).toString()===l){this.data[n][a]=parseFloat(l)}else if("-"!==l){this.data[n][a]=l}else{this.data[n][a]=NaN}}}if(r){this.columnHeaders=this.data[0].slice(1);this.data=this.data.slice(1)}if(o){this.rowHeaders=[];for(n=0;n<this.data.length;n++){this.rowHeaders.push(this.data[n][0]);this.data[n]=this.data[n].slice(1)}}}return this},addColumn:function addColumn(){throw new Error("not implemented")},addRow:function addRow(){throw new Error("not implemented")},getColumn:function getColumn(e){var r,o=[];if(t.isString(e)){for(r=0;r<this.columnHeaders.length;r++){if(e===this.columnHeaders[r]){e=r;break}}}for(r=0;r<this.data.length;r++){if(this.data[r].length>e){o[r]=parseFloat(this.data[r][e])}}return o},getRow:function getRow(e){var r,o;if(t.isString(e)){for(o=0;o<this.rowHeaders.length;o++){if(e===this.rowHeaders[o]){e=o;break}}}r=[];for(o=0;o<this.data[e].length;o++){r[o]=this.data[e][o]}return r}});return e.DataSource});define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],function(e,t,o,i,n,a,d,l,u,h){"use strict";e.Chart=function(e,t,r){this.constructor(e,r);var o,s,n,a,d,l;if(!u.isArray(t)||0===t.length){throw new Error("JSXGraph: Can't create a chart without data")}this.elements=[];if(u.isNumber(t[0])){s=t;o=[];for(n=0;n<s.length;n++){o[n]=n+1}}else if(1===t.length&&u.isArray(t[0])){s=t[0];o=[];l=u.evaluate(s).length;for(n=0;n<l;n++){o[n]=n+1}}else if(2===t.length){l=Math.min(t[0].length,t[1].length);o=t[0].slice(0,l);s=t[1].slice(0,l)}if(u.isArray(s)&&0===s.length){throw new Error("JSXGraph: Can't create charts without data.")}d=r.chartstyle.replace(/ /g,"").split(",");for(n=0;n<d.length;n++){switch(d[n]){case"bar":a=this.drawBar(e,o,s,r);break;case"line":a=this.drawLine(e,o,s,r);break;case"fit":a=this.drawFit(e,o,s,r);break;case"spline":a=this.drawSpline(e,o,s,r);break;case"pie":a=this.drawPie(e,s,r);break;case"point":a=this.drawPoints(e,o,s,r);break;case"radar":a=this.drawRadar(e,t,r);break;}this.elements.push(a)}this.id=this.board.setId(this,"Chart");return this.elements};e.Chart.prototype=new a;e.extend(e.Chart.prototype,{drawLine:function drawLine(e,t,r,o){o.fillcolor="none";o.highlightfillcolor="none";return e.create("curve",[t,r],o)},drawSpline:function drawSpline(e,t,r,o){o.fillColor="none";o.highlightfillcolor="none";return e.create("spline",[t,r],o)},drawFit:function drawFit(e,r,o,i){var s=i.degree;s=Math.max(parseInt(s,10),1)||1;i.fillcolor="none";i.highlightfillcolor="none";return e.create("functiongraph",[t.regressionPolynomial(s,r,o)],i)},drawBar:function drawBar(e,t,r,o){var s,n,a,d,l,c,h,m,g=[],b=[],p,C,y=function(e,r){return function(){return t[e]()-r*a}},v={fixed:!0,withLabel:!1,visible:!1,name:""};p=u.copyAttributes(o,e.options,"chart");if(p&&p.width){a=p.width}else{if(1>=t.length){a=1}else{a=t[1]-t[0];for(s=1;s<t.length-1;s++){a=t[s+1]-t[s]<a?t[s+1]-t[s]:a}}a*=.8}C=u.copyAttributes(o,e.options,"chart","label");for(s=0;s<t.length;s++){if(u.isFunction(t[s])){d=y(s,-.5);l=y(s,0);c=y(s,.5)}else{d=t[s]-.5*a;l=t[s];c=t[s]+.5*a}if(u.isFunction(r[s])){h=r[s]()}else{h=r[s]}h=r[s];if("horizontal"===p.dir){b[0]=e.create("point",[0,d],v);b[1]=e.create("point",[h,d],v);b[2]=e.create("point",[h,c],v);b[3]=e.create("point",[0,c],v);if(u.exists(p.labels)&&u.exists(p.labels[s])){C.anchorY="middle";n=e.create("text",[h,l,p.labels[s]],C);n.visProp.anchorx=function(e){return function(){return 0<=e.X()?"left":"right"}}(n)}}else{b[0]=e.create("point",[d,0],v);b[1]=e.create("point",[d,h],v);b[2]=e.create("point",[c,h],v);b[3]=e.create("point",[c,0],v);if(u.exists(p.labels)&&u.exists(p.labels[s])){C.anchorX="middle";n=e.create("text",[l,h,p.labels[s]],C);n.visProp.anchory=function(e){return function(){return 0<=e.Y()?"bottom":"top"}}(n)}}if(u.isArray(p.colors)){m=p.colors;p.fillcolor=m[s%m.length]}g[s]=e.create("polygon",b,p);if(u.exists(p.labels)&&u.exists(p.labels[s])){g[s].text=n}}return g},drawPoints:function drawPoints(e,t,r,o){var s,n=[],a=o.infoboxarray;o.fixed=!0;o.name="";for(s=0;s<t.length;s++){o.infoboxtext=a?a[s%a.length]:!1;n[s]=e.create("point",[t[s],r[s]],o)}return n},drawPie:function drawPie(e,t,a){var d,l,c=[],p=[],h=o.sum(t),s=a.colors,m=a.highlightcolors,g=a.labels,b=a.radius||4,r=b,C=a.center||[0,0],y=C[0],v=C[1],f=function(e,o,n){return function(){var a,d,l,c=0;for(d=0;d<=e;d++){c+=parseFloat(u.evaluate(t[d]))}a=c;for(d=e+1;d<t.length;d++){a+=parseFloat(u.evaluate(t[d]))}l=0!==a?2*Math.PI*c/a:0;return r()*Math[o](l)+n}},P=function(e,t){var r=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],o=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];if(u.exists(this.label)){this.label.rendNode.style.fontSize=t*u.evaluate(this.label.visProp.fontsize)+"px";this.label.fullUpdate()}this.point2.coords=new n(i.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+r*e,this.point1.coords.usrCoords[2]+o*e],this.board);this.fullUpdate()},_=function(){if(!this.highlighted){this.highlighted=!0;this.board.highlightedObjects[this.id]=this;this.board.renderer.highlight(this);P.call(this,1.1,2)}},S=function(){if(this.highlighted){this.highlighted=!1;this.board.renderer.noHighlight(this);P.call(this,.9090909,1)}},E={fixed:!0,withLabel:!1,visible:!1,name:""};if(!u.isArray(g)){g=[];for(d=0;d<t.length;d++){g[d]=""}}if(!u.isFunction(b)){r=function(){return b}}a.highlightonsector=a.highlightonsector||!1;a.straightfirst=!1;a.straightlast=!1;l=e.create("point",[y,v],E);c[0]=e.create("point",[function(){return r()+y},function(){return v}],E);for(d=0;d<t.length;d++){c[d+1]=e.create("point",[f(d,"cos",y),f(d,"sin",v)],E);a.name=g[d];a.withlabel=""!==a.name;a.fillcolor=s&&s[d%s.length];a.labelcolor=s&&s[d%s.length];a.highlightfillcolor=m&&m[d%m.length];p[d]=e.create("sector",[l,c[d],c[d+1]],a);if(a.highlightonsector){p[d].hasPoint=p[d].hasPointSector}if(a.highlightbysize){p[d].highlight=_;p[d].noHighlight=S}}return{sectors:p,points:c,midpoint:l}},drawRadar:function drawRadar(r,o,s){var a,d,l,c,h,m,g,b,C,y,v,f,P,_,S,E,x,O,T,A,w,N,R,L,B,k,Y,D,I,X,M,U,G,J,z,F,H,$,V,q,W,Z,Q,K,ee=o.length,te=function(){var e,t,r,o,s=u.evaluate(this.visProp.label.offset).slice(0);e=this.point1.X();t=this.point2.X();r=this.point1.Y();o=this.point2.Y();if(t<e){s[0]=-s[0]}if(o<r){s[1]=-s[1]}this.setLabelRelativeCoords(s);return new n(i.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},re=function(e,o){var i,s,n;i=r.create("transform",[-(S[o]-P[o]),0],{type:"translate"});s=r.create("transform",[T/(E[o]+_[o]-(S[o]-P[o])),1],{type:"scale"});i.melt(s);n=r.create("transform",[e],{type:"rotate"});i.melt(n);return i};if(0>=ee){e.debug("No data");return}l=s.paramarray;if(!u.exists(l)){e.debug("Need paramArray attribute");return}c=l.length;if(1>=c){e.debug("Need more than 1 param");return}for(a=0;a<ee;a++){if(c!==o[a].length){e.debug("Use data length equal to number of params ("+o[a].length+" != "+c+")");return}}h=[];m=[];for(d=0;d<c;d++){h[d]=o[0][d];m[d]=h[d]}for(a=1;a<ee;a++){for(d=0;d<c;d++){if(o[a][d]>h[d]){h[d]=o[a][d]}if(o[a][d]<m[d]){m[d]=o[a][d]}}}g=[];b=[];for(a=0;a<ee;a++){g[a]="";b[a]=[]}C=[];y=[];v=s.startshiftratio||0;f=s.endshiftratio||0;for(a=0;a<c;a++){C[a]=(h[a]-m[a])*v;y[a]=(h[a]-m[a])*f}P=s.startshiftarray||C;_=s.endshiftarray||y;S=s.startarray||m;if(u.exists(s.start)){for(a=0;a<c;a++){S[a]=s.start}}E=s.endarray||h;if(u.exists(s.end)){for(a=0;a<c;a++){E[a]=s.end}}if(P.length!==c){e.debug("Start shifts length is not equal to number of parameters");return}if(_.length!==c){e.debug("End shifts length is not equal to number of parameters");return}if(S.length!==c){e.debug("Starts length is not equal to number of parameters");return}if(E.length!==c){e.debug("Ends length is not equal to number of parameters");return}x=s.labelarray||g;O=s.colors;s.highlightcolors;T=s.radius||10;Q=s.strokewidth||1;if(!u.exists(s.highlightonsector)){s.highlightonsector=!1}A={name:s.name,id:s.id,strokewidth:Q,polystrokewidth:s.polystrokewidth||Q,strokecolor:s.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:s.fillColor||"#FFFF88",fillopacity:s.fillOpacity||.4,highlightfillcolor:s.highlightFillColor||"#FF7400",highlightstrokecolor:s.highlightStrokeColor||"black",gradient:s.gradient||"none"};w=s.center||[0,0];N=w[0];R=w[1];L=r.create("point",[N,R],{name:"",fixed:!0,withlabel:!1,visible:!1});B=Math.PI/2-Math.PI/c;B=s.startangle||0;k=B;Y=[];D=[];for(a=0;a<c;a++){k+=2*Math.PI/c;X=T*Math.cos(k)+N;M=T*Math.sin(k)+R;Y[a]=r.create("point",[X,M],{name:"",fixed:!0,withlabel:!1,visible:!1});D[a]=r.create("line",[L,Y[a]],{name:l[a],strokeColor:A.strokecolor,strokeWidth:A.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:A.highlightstrokecolor});D[a].getLabelAnchor=te;I=re(k,a);for(d=0;d<o.length;d++){K=o[d][a];b[d][a]=r.create("point",[K,0],{name:"",fixed:!0,withlabel:!1,visible:!1});b[d][a].addTransform(b[d][a],I)}}U=[];for(a=0;a<ee;a++){A.labelcolor=O&&O[a%O.length];A.strokecolor=O&&O[a%O.length];A.fillcolor=O&&O[a%O.length];U[a]=r.create("polygon",b[a],{withLines:!0,withLabel:!1,fillColor:A.fillcolor,fillOpacity:A.fillopacity,highlightFillColor:A.highlightfillcolor});for(d=0;d<c;d++){U[a].borders[d].setAttribute("strokecolor:"+O[a%O.length]);U[a].borders[d].setAttribute("strokewidth:"+A.polystrokewidth)}}G=s.legendposition||"none";switch(G){case"right":z=s.legendleftoffset||2;F=s.legendtopoffset||1;this.legend=r.create("legend",[N+T+z,R+T-F],{labels:x,colors:O});break;case"none":break;default:e.debug("Unknown legend position");}J=[];if(s.showcircles){H=[];for(a=0;6>a;a++){H[a]=20*a}H[0]="0";$=s.circlelabelarray||H;V=$.length;if(2>V){e.debug("Too less circles");return}q=[];W=B+Math.PI/c;I=re(W,0);A.fillcolor="none";A.highlightfillcolor="none";A.strokecolor=s.strokecolor||"black";A.strokewidth=s.circlestrokewidth||.5;A.layer=0;Z=(E[0]-S[0])/(V-1);for(a=0;a<V;a++){q[a]=r.create("point",[S[0]+a*Z,0],{name:$[a],size:0,fixed:!0,withLabel:!0,visible:!0});q[a].addTransform(q[a],I);J[a]=r.create("circle",[L,q[a]],A)}}this.rendNode=U[0].rendNode;return{circles:J,lines:D,points:b,midpoint:L,polygons:U}},updateRenderer:function updateRenderer(){return this},update:function update(){if(this.needsUpdate){this.updateDataArray()}return this},updateDataArray:function updateDataArray(){}});e.createChart=function(t,r,o){var s,n,a,c,p,m=[],g,b,C,y,v,f,P,_,S,E,O,T=h.isBrowser?t.document.getElementById(r[0]):null;if(1===r.length&&u.isString(r[0])){if(u.exists(T)){y=u.copyAttributes(o,t.options,"chart");T=new d().loadFromTable(r[0],y.withheaders,y.withheaders);s=T.data;p=T.columnHeaders;n=T.rowHeaders;v=y.width;f=y.name;P=y.strokecolor;_=y.fillcolor;S=y.highlightstrokecolor;E=y.highlightfillcolor;t.suspendUpdate();O=s.length;C=[];if(y.rows&&u.isArray(y.rows)){for(a=0;a<O;a++){for(c=0;c<y.rows.length;c++){if(y.rows[c]===a||y.withheaders&&y.rows[c]===n[a]){C.push(s[a]);break}}}}else{C=s}O=C.length;for(a=0;a<O;a++){b=[];if(y.chartstyle&&-1!==y.chartstyle.indexOf("bar")){if(v){g=v}else{g=.8}b.push(1-g/2+(a+.5)*g/O);for(c=1;c<C[a].length;c++){b.push(b[c-1]+1)}y.width=g/O}if(f&&f.length===O){y.name=f[a]}else if(y.withheaders){y.name=p[a]}if(P&&P.length===O){y.strokecolor=P[a]}else{y.strokecolor=l.hsv2rgb(360*((a+1)/O),.9,.6)}if(_&&_.length===O){y.fillcolor=_[a]}else{y.fillcolor=l.hsv2rgb(360*((a+1)/O),.9,1)}if(S&&S.length===O){y.highlightstrokecolor=S[a]}else{y.highlightstrokecolor=l.hsv2rgb(360*((a+1)/O),.9,1)}if(E&&E.length===O){y.highlightfillcolor=E[a]}else{y.highlightfillcolor=l.hsv2rgb(360*((a+1)/O),.9,.6)}if(y.chartstyle&&-1!==y.chartstyle.indexOf("bar")){m.push(new e.Chart(t,[b,C[a]],y))}else{m.push(new e.Chart(t,[C[a]],y))}}t.unsuspendUpdate()}return m}y=u.copyAttributes(o,t.options,"chart");return new e.Chart(t,r,y)};e.registerElement("chart",e.createChart);e.Legend=function(e,t,r){var o;this.constructor();o=u.copyAttributes(r,e.options,"legend");this.board=e;this.coords=new n(i.COORDS_BY_USER,t,this.board);this.myAtts={};this.label_array=o.labelarray||o.labels;this.color_array=o.colorarray||o.colors;this.lines=[];this.myAtts.strokewidth=o.strokewidth||5;this.myAtts.straightfirst=!1;this.myAtts.straightlast=!1;this.myAtts.withlabel=!0;this.myAtts.fixed=!0;this.style=o.legendstyle||o.style;if("vertical"===this.style){this.drawVerticalLegend(e,o)}else{throw new Error("JSXGraph: Unknown legend style: "+this.style)}};e.Legend.prototype=new a;e.Legend.prototype.drawVerticalLegend=function(e,t){var r,o=t.linelength||1,s=(t.rowheight||20)/this.board.unitY,a=function(){this.setLabelRelativeCoords(this.visProp.label.offset);return new n(i.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(r=0;r<this.label_array.length;r++){this.myAtts.strokecolor=this.color_array[r];this.myAtts.highlightstrokecolor=this.color_array[r];this.myAtts.name=this.label_array[r];this.myAtts.label={offset:[10,0],strokeColor:this.color_array[r],strokeWidth:this.myAtts.strokewidth};this.lines[r]=e.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-r*s],[this.coords.usrCoords[1]+o,this.coords.usrCoords[2]-r*s]],this.myAtts);this.lines[r].getLabelAnchor=a}};e.createLegend=function(t,r,o){var i=[0,0];if(u.exists(r)){if(2===r.length){i=r}}return new e.Legend(t,i,o)};e.registerElement("legend",e.createLegend);return{Chart:e.Chart,Legend:e.Legend,createChart:e.createChart,createLegend:e.createLegend}});define("base/turtle",["jxg","base/constants","base/element","utils/type","base/curve","base/point","base/line","base/transformation"],function(e,r,o,s){"use strict";e.Turtle=function(e,t,o){var i,n,a;this.constructor(e,o,r.OBJECT_TYPE_TURTLE,r.OBJECT_CLASS_OTHER);this.turtleIsHidden=!1;this.board=e;this.visProp.curveType="plot";this._attributes=s.copyAttributes(this.visProp,e.options,"turtle");delete this._attributes.id;i=0;n=0;a=90;if(0!==t.length){if(3===t.length){i=t[0];n=t[1];a=t[2]}else if(2===t.length){if(s.isArray(t[0])){i=t[0][0];n=t[0][1];a=t[1]}else{i=t[0];n=t[1]}}else{i=t[0][0];n=t[0][1]}}this.init(i,n,a);this.methodMap=s.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"});return this};e.Turtle.prototype=new o;e.extend(e.Turtle.prototype,{init:function init(e,t,r){var o={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY);this.pos=[e,t];this.isPenDown=!0;this.dir=90;this.stack=[];this.objects=[];this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes);this.objects.push(this.curve);this.turtle=this.board.create("point",this.pos,o);this.objects.push(this.turtle);this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],o);this.objects.push(this.turtle2);this.visProp.arrow.lastArrow=!0;this.visProp.arrow.straightFirst=!1;this.visProp.arrow.straightLast=!1;this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow);this.objects.push(this.arrow);this.subs={arrow:this.arrow};this.inherits.push(this.arrow);this.right(90-r);this.board.update()},forward:function forward(e){if(0===e){return this}var r,o=e*Math.cos(this.dir*Math.PI/180),i=e*Math.sin(this.dir*Math.PI/180);if(!this.turtleIsHidden){r=this.board.create("transform",[o,i],{type:"translate"});r.applyOnce(this.turtle);r.applyOnce(this.turtle2)}if(this.isPenDown){if(8192<=this.curve.dataX.length){this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes);this.objects.push(this.curve)}}this.pos[0]+=o;this.pos[1]+=i;if(this.isPenDown){this.curve.dataX.push(this.pos[0]);this.curve.dataY.push(this.pos[1])}this.board.update();return this},back:function back(e){return this.forward(-e)},right:function right(e){this.dir-=e;this.dir%=360;if(!this.turtleIsHidden){var r=this.board.create("transform",[-e*Math.PI/180,this.turtle],{type:"rotate"});r.applyOnce(this.turtle2)}this.board.update();return this},left:function left(e){return this.right(-e)},penUp:function penUp(){this.isPenDown=!1;return this},penDown:function penDown(){this.isPenDown=!0;this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes);this.objects.push(this.curve);return this},clean:function clean(){var e,t;for(e=0;e<this.objects.length;e++){t=this.objects[e];if(t.type===r.OBJECT_TYPE_CURVE){this.board.removeObject(t);this.objects.splice(e,1)}}this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes);this.objects.push(this.curve);this.board.update();return this},clearScreen:function clearScreen(){var e,t,r=this.objects.length;for(e=0;e<r;e++){t=this.objects[e];this.board.removeObject(t)}this.init(0,0,90);return this},setPos:function setPos(e,o){var i;if(s.isArray(e)){this.pos=e}else{this.pos=[e,o]}if(!this.turtleIsHidden){this.turtle.setPositionDirectly(r.COORDS_BY_USER,[e,o]);this.turtle2.setPositionDirectly(r.COORDS_BY_USER,[e,o+this.arrowLen]);i=this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"});i.applyOnce(this.turtle2)}this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes);this.objects.push(this.curve);this.board.update();return this},setPenSize:function setPenSize(e){this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",e));this.objects.push(this.curve);return this},setPenColor:function setPenColor(e){this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",e));this.objects.push(this.curve);return this},setHighlightPenColor:function setHighlightPenColor(e){this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",e));this.objects.push(this.curve);return this},setAttribute:function setAttribute(e){var t,o,n,a=this.objects.length;for(t=0;t<a;t++){o=this.objects[t];if(o.type===r.OBJECT_TYPE_CURVE){o.setAttribute(e)}}n=this.visProp.id;this.visProp=s.deepCopy(this.curve.visProp);this.visProp.id=n;this._attributes=s.deepCopy(this.visProp);delete this._attributes.id;return this},copyAttr:function copyAttr(e,t){this._attributes[e.toLowerCase()]=t;return this._attributes},showTurtle:function showTurtle(){this.turtleIsHidden=!1;this.arrow.setAttribute({visible:!0});this.visProp.arrow.visible=!1;this.setPos(this.pos[0],this.pos[1]);this.board.update();return this},hideTurtle:function hideTurtle(){this.turtleIsHidden=!0;this.arrow.setAttribute({visible:!1});this.visProp.arrow.visible=!1;this.board.update();return this},home:function home(){this.pos=[0,0];this.setPos(this.pos[0],this.pos[1]);return this},pushTurtle:function pushTurtle(){this.stack.push([this.pos[0],this.pos[1],this.dir]);return this},popTurtle:function popTurtle(){var e=this.stack.pop();this.pos[0]=e[0];this.pos[1]=e[1];this.dir=e[2];this.setPos(this.pos[0],this.pos[1]);return this},lookTo:function lookTo(e){var t,r,o,i,n;if(s.isArray(e)){t=this.pos[0];r=this.pos[1];o=e[0];i=e[1];n=Math.atan2(i-r,o-t);this.right(this.dir-180*n/Math.PI)}else if(s.isNumber(e)){this.right(this.dir-e)}return this},moveTo:function moveTo(e){var r,o,i;if(s.isArray(e)){r=e[0]-this.pos[0];o=e[1]-this.pos[1];if(!this.turtleIsHidden){i=this.board.create("transform",[r,o],{type:"translate"});i.applyOnce(this.turtle);i.applyOnce(this.turtle2)}if(this.isPenDown){if(8192<=this.curve.dataX.length){this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes);this.objects.push(this.curve)}}this.pos[0]=e[0];this.pos[1]=e[1];if(this.isPenDown){this.curve.dataX.push(this.pos[0]);this.curve.dataY.push(this.pos[1])}this.board.update()}return this},fd:function fd(e){return this.forward(e)},bk:function bk(e){return this.back(e)},lt:function lt(e){return this.left(e)},rt:function rt(e){return this.right(e)},pu:function pu(){return this.penUp()},pd:function pd(){return this.penDown()},ht:function ht(){return this.hideTurtle()},st:function st(){return this.showTurtle()},cs:function cs(){return this.clearScreen()},push:function push(){return this.pushTurtle()},pop:function pop(){return this.popTurtle()},evalAt:function evalAt(e,t){var o,s,n,a,d=this.objects.length;for(o=0,s=0;o<d;o++){n=this.objects[o];if(n.elementClass===r.OBJECT_CLASS_CURVE){if(s<=e&&e<s+n.numberPoints){a=e-s;return n[t](a)}s+=n.numberPoints}}return this[t]()},X:function X(e){if(!s.exists(e)){return this.pos[0]}return this.evalAt(e,"X")},Y:function Y(e){if(!s.exists(e)){return this.pos[1]}return this.evalAt(e,"Y")},Z:function Z(){return 1},minX:function minX(){return 0},maxX:function maxX(){var e,t,o=this.objects.length,s=0;for(e=0;e<o;e++){t=this.objects[e];if(t.elementClass===r.OBJECT_CLASS_CURVE){s+=this.objects[e].numberPoints}}return s},hasPoint:function hasPoint(e,t){var o,s;for(o=0;o<this.objects.length;o++){s=this.objects[o];if(s.type===r.OBJECT_TYPE_CURVE){if(s.hasPoint(e,t)){return!0}}}return!1}});e.createTurtle=function(t,r,o){var i;r=r||[];i=s.copyAttributes(o,t.options,"turtle");return new e.Turtle(t,r,i)};e.registerElement("turtle",e.createTurtle);return{Turtle:e.Turtle,createTurtle:e.createTurtle}});define("utils/dump",["jxg","utils/type"],function(e,t){"use strict";e.Dump={addMarkers:function addMarkers(r,o,s){var n,a,d;if(!t.isArray(o)){o=[o]}if(!t.isArray(s)){s=[s]}a=Math.min(o.length,s.length);o.length=a;s.length=a;for(n in r.objects){if(r.objects.hasOwnProperty(n)){for(d=0;d<a;d++){r.objects[n][o[d]]=s[d]}}}},deleteMarkers:function deleteMarkers(r,o){var s,n,a;if(!t.isArray(o)){o=[o]}n=o.length;o.length=n;for(s in r.objects){if(r.objects.hasOwnProperty(s)){for(a=0;a<n;a++){delete r.objects[s][o[a]]}}}},str:function str(e){if("string"==typeof e&&"function"!==e.substr(0,7)){e="\""+e+"\""}return e},minimizeObject:function minimizeObject(r){var o,s,n,a={},d=t.deepCopy(r),l=[];for(n=1;n<arguments.length;n++){l.push(arguments[n])}a=t.deepCopy(a,e.Options.elements,!0);for(n=l.length;0<n;n--){a=t.deepCopy(a,l[n-1],!0)}for(o in a){if(a.hasOwnProperty(o)){s=o.toLowerCase();if("object"!==_typeof(a[o])&&a[o]===d[s]){console.log("delete",o);delete d[s]}}}return d},prepareAttributes:function prepareAttributes(t,r){var o,i;o=this.minimizeObject(r.getAttributes(),e.Options[r.elType]);for(i in r.subs){if(r.subs.hasOwnProperty(i)){o[i]=this.minimizeObject(r.subs[i].getAttributes(),e.Options[r.elType][i],e.Options[r.subs[i].elType]);o[i].id=r.subs[i].id;o[i].name=r.subs[i].name}}o.id=r.id;o.name=r.name;return o},setBoundingBox:function setBoundingBox(e,t,r){e.push({obj:r,method:"setBoundingBox",params:[t.getBoundingBox(),!0]});return e},dump:function dump(r){var o,i,n,a,d=[],l=[],c=r.objectsList.length;this.addMarkers(r,"dumped",!1);for(o=0;o<c;o++){i=r.objectsList[o];n={};if(!i.dumped&&i.dump){n.type=i.getType();n.parents=i.getParents().slice();if("point"===n.type&&1===n.parents[0]){n.parents=n.parents.slice(1)}for(a=0;a<n.parents.length;a++){if(t.isString(n.parents[a])&&"'"!==n.parents[a][0]&&"\""!==n.parents[a][0]){n.parents[a]="\""+n.parents[a]+"\""}else if(t.isArray(n.parents[a])){n.parents[a]="["+n.parents[a].toString()+"]"}}n.attributes=this.prepareAttributes(r,i);if("glider"===n.type&&i.onPolygon){d.push({obj:i.id,prop:"onPolygon",val:!0})}l.push(n)}}this.deleteMarkers(r,"dumped");return{elements:l,props:d,methods:[]}},arrayToParamStr:function arrayToParamStr(e,t){var r,o=[];for(r=0;r<e.length;r++){o.push(t.call(this,e[r]))}return o.join(", ")},toJCAN:function toJCAN(e){var r,o,s;switch(_typeof(e)){case"object":if(e){o=[];if(t.isArray(e)){for(r=0;r<e.length;r++){o.push(this.toJCAN(e[r]))}return"["+o.join(",")+"]"}for(s in e){if(e.hasOwnProperty(s)){o.push(s+": "+this.toJCAN(e[s]))}}return"<<"+o.join(", ")+">> "}return"null";case"string":return"'"+e.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return e.toString();case"null":return"null";}},toJessie:function toJessie(e){var t,r,o=this.dump(e),s=[];o.methods=this.setBoundingBox(o.methods,e,"$board");r=o.elements;for(t=0;t<r.length;t++){if(0<r[t].attributes.name.length){s.push("// "+r[t].attributes.name)}s.push("s"+t+" = "+r[t].type+"("+r[t].parents.join(", ")+") "+this.toJCAN(r[t].attributes).replace(/\n/,"\\n")+";");s.push("")}for(t=0;t<o.methods.length;t++){s.push(o.methods[t].obj+"."+o.methods[t].method+"("+this.arrayToParamStr(o.methods[t].params,this.toJCAN)+");");s.push("")}for(t=0;t<o.props.length;t++){s.push(o.props[t].obj+"."+o.props[t].prop+" = "+this.toJCAN(o.props[t].val)+";");s.push("")}return s.join("\n")},toJavaScript:function toJavaScript(e){var r,o,s=this.dump(e),n=[];s.methods=this.setBoundingBox(s.methods,e,"board");o=s.elements;for(r=0;r<o.length;r++){n.push("board.create(\""+o[r].type+"\", ["+o[r].parents.join(", ")+"], "+t.toJSON(o[r].attributes)+");")}for(r=0;r<s.methods.length;r++){n.push(s.methods[r].obj+"."+s.methods[r].method+"("+this.arrayToParamStr(s.methods[r].params,t.toJSON)+");");n.push("")}for(r=0;r<s.props.length;r++){n.push(s.props[r].obj+"."+s.props[r].prop+" = "+t.toJSON(s.props[r].val)+";");n.push("")}return n.join("\n")}};return e.Dump});define("element/comb",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point"],function(e,t,r,o,i,s,n){"use strict";e.createComb=function(e,t,o){var i,a,s,d,l,u,h,m,g;if(2===t.length){if(r.isArray(t[0])&&1<t[0].length){d=r.copyAttributes(o,e.options,"comb","point1");i=e.create("point",t[0],d)}else if(r.isString(t[0])||r.isPoint(t[0])){i=e.select(t[0])}else if(r.isFunction(t[0])&&r.isPoint(t[0]())){i=t[0]()}else if(r.isFunction(t[0])&&t[0]().length&&2<=t[0]().length){d=r.copyAttributes(o,e.options,"comb","point1");i=n.createPoint(e,t[0](),d)}else{throw new Error("JSXGraph: Can't create comb with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]")}if(r.isArray(t[1])&&1<t[1].length){d=r.copyAttributes(o,e.options,"comb","point2");a=e.create("point",t[1],d)}else if(r.isString(t[1])||r.isPoint(t[1])){a=e.select(t[1])}else if(r.isFunction(t[1])&&r.isPoint(t[1]())){a=t[1]()}else if(r.isFunction(t[1])&&t[1]().length&&2<=t[1]().length){d=r.copyAttributes(o,e.options,"comb","point2");a=n.createPoint(e,t[1](),d)}else{throw new Error("JSXGraph: Can't create comb with parent types '"+_typeof(t[0])+"' and '"+_typeof(t[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]")}}else{l=t.map(function(e){return"'"+_typeof(e)+"'"});throw new Error("JSXGraph: Can't create comb with parent types "+l.join(", ")+".\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]")}d=r.copyAttributes(o,e.options,"comb","curve");s=e.create("curve",[[0],[0]],d);d=r.copyAttributes(o,e.options,"comb");u=d.frequency;h=-d.angle;m=d.width;if(d.reverse){g=i;i=a;a=g;h=-h}s.updateDataArray=function(){var e=0,t=i.Dist(a),r=Math.cos(h),o=Math.sin(h),n=(a.X()-i.X())/t,d=(a.Y()-i.Y())/t,l,c,p;r*=m/Math.abs(o);o*=m/Math.abs(o);this.dataX=[];this.dataY=[];while(e<t){l=i.X()+n*e;c=i.Y()+d*e;p=Math.min(r,t-e)/Math.abs(r);o*=p;r*=p;this.dataX.push(l);this.dataY.push(c);this.dataX.push(l+n*r+d*o);this.dataY.push(c-n*o+d*r);this.dataX.push(NaN);this.dataY.push(NaN);e+=u}};return s};e.registerElement("comb",e.createComb);return{createComb:e.createComb}});define("element/slopetriangle",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point","base/element"],function(e,t,r,o,i,s){"use strict";var n={removeSlopeTriangle:function removeSlopeTriangle(){s.Polygon.prototype.remove.call(this);this.board.removeObject(this.toppoint);this.board.removeObject(this.glider);this.board.removeObject(this.baseline);this.board.removeObject(this.basepoint);this.board.removeObject(this.label);if(this._isPrivateTangent){this.board.removeObject(this.tangent)}},Value:function Value(){return this.tangent.getSlope()}};e.createSlopeTriangle=function(t,i,s){var a,d,l,c,p,u,h,m,g,b=!1;if(1===i.length&&i[0].type===o.OBJECT_TYPE_TANGENT){d=i[0];l=d.glider}else if(1===i.length&&i[0].type===o.OBJECT_TYPE_GLIDER){l=i[0];g=r.copyAttributes(s,t.options,"slopetriangle","tangent");d=t.create("tangent",[l],g);b=!0}else if(2===i.length&&i[0].elementClass===o.OBJECT_CLASS_LINE&&r.isPoint(i[1])){d=i[0];l=i[1]}else{throw new Error("JSXGraph: Can't create slope triangle with parent types '"+_typeof(i[0])+"'.")}g=r.copyAttributes(s,t.options,"slopetriangle","basepoint");h=t.create("point",[function(){return[l.X()+1,l.Y()]}],g);g=r.copyAttributes(s,t.options,"slopetriangle","baseline");u=t.create("line",[l,h],g);g=r.copyAttributes(s,t.options,"slopetriangle","glider");c=t.create("glider",[l.X()+1,l.Y(),u],g);g=r.copyAttributes(s,t.options,"slopetriangle","toppoint");p=t.create("point",[function(){return[c.X(),c.Y()+(c.X()-l.X())*d.getSlope()]}],g);g=r.copyAttributes(s,t.options,"slopetriangle");g.borders=r.copyAttributes(g.borders,t.options,"slopetriangle","borders");a=t.create("polygon",[l,c,p],g);a.Value=n.Value;a.tangent=d;a._isPrivateTangent=b;a.borders[2].setArrow(!1,!1);g=r.copyAttributes(s,t.options,"slopetriangle","label");m=t.create("text",[function(){return c.X()+.1},function(){return .5*(c.Y()+p.Y())},function(){return""}],g);m._setText(function(){return r.toFixed(a.Value(),r.evaluate(m.visProp.digits))});m.fullUpdate();a.glider=c;a.basepoint=h;a.baseline=u;a.toppoint=p;a.label=m;a.subs={glider:c,basePoint:h,baseLine:u,topPoint:p,label:m};a.inherits.push(c,h,u,p,m);a.methodMap=e.deepCopy(a.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"});a.remove=n.removeSlopeTriangle;return a};e.registerElement("slopetriangle",e.createSlopeTriangle);return{createSlopeTriangle:e.createSlopeTriangle}});define("element/checkbox",["jxg","utils/env","utils/type"],function(e,r,o){"use strict";var i={CheckboxChangeEventHandler:function CheckboxChangeEventHandler(){this._value=this.rendNodeCheckbox.checked;this.board.update()}};e.createCheckbox=function(s,n,a){var d,l,c=o.copyAttributes(a,s.options,"checkbox");l=[n[0],n[1],"<span style=\"display:inline\"><input type=\"checkbox\" /><label for=\"\"></label></span>"];d=s.create("text",l,c);d.type=o.OBJECT_TYPE_CHECKBOX;d.rendNodeCheckbox=d.rendNode.childNodes[0].childNodes[0];d.rendNodeLabel=d.rendNode.childNodes[0].childNodes[1];d.rendNodeTag=d.rendNodeCheckbox;d.rendNodeTag.disabled=!!c.disabled;d.rendNodeLabel.innerHTML=n[2];d.rendNodeCheckbox.id=d.rendNode.id+"_checkbox";d.rendNodeLabel.id=d.rendNode.id+"_label";d.rendNodeLabel.setAttribute("for",d.rendNodeCheckbox.id);d.visPropOld.fontsize="0px";s.renderer.updateTextStyle(d,!1);d.rendNodeCheckbox.checked=c.checked;d._value=c.checked;d.Value=function(){return this._value};d.update=function(){if(this.needsUpdate){e.Text.prototype.update.call(this);this._value=this.rendNodeCheckbox.checked}return this};r.addEvent(d.rendNodeCheckbox,"change",i.CheckboxChangeEventHandler,d);return d};e.registerElement("checkbox",e.createCheckbox);return{createCheckbox:e.createCheckbox}});define("element/input",["jxg","utils/env","utils/type"],function(e,r,o){"use strict";var i={InputInputEventHandler:function InputInputEventHandler(){this._value=this.rendNodeInput.value;this.board.update()}};e.createInput=function(s,n,a){var d,l,c=o.copyAttributes(a,s.options,"input");l=[n[0],n[1],"<span style=\"display:inline; white-space:nowrap; padding:0px;\"><span></span><input type=\"text\" maxlength=\""+c.maxlength+"\" style=\"width:100%\"/></span>"];d=s.create("text",l,c);d.type=o.OBJECT_TYPE_INPUT;d.rendNodeLabel=d.rendNode.childNodes[0].childNodes[0];d.rendNodeInput=d.rendNode.childNodes[0].childNodes[1];d.rendNodeLabel.innerHTML=n[3];d.rendNodeInput.value=n[2];d.rendNodeTag=d.rendNodeInput;d.rendNodeTag.disabled=!!c.disabled;d.rendNodeLabel.id=d.rendNode.id+"_label";d.rendNodeInput.id=d.rendNode.id+"_input";d._value=n[2];d.update=function(){if(this.needsUpdate){e.Text.prototype.update.call(this);this._value=this.rendNodeInput.value}return this};d.Value=function(){return this._value};r.addEvent(d.rendNodeInput,"input",i.InputInputEventHandler,d);r.addEvent(d.rendNodeInput,"mousedown",function(e){if(o.exists(e.stopPropagation))e.stopPropagation()},d);r.addEvent(d.rendNodeInput,"touchstart",function(e){if(o.exists(e.stopPropagation))e.stopPropagation()},d);r.addEvent(d.rendNodeInput,"pointerdown",function(e){if(o.exists(e.stopPropagation))e.stopPropagation()},d);d.visPropOld.fontsize="0px";s.renderer.updateTextStyle(d,!1);return d};e.registerElement("input",e.createInput);return{createInput:e.createInput}});define("element/button",["jxg","utils/env","utils/type"],function(e,r,o){"use strict";var i={ButtonClickEventHandler:function ButtonClickEventHandler(){if(this._handler){this._handler()}this.board.update()}};e.createButton=function(s,n,a){var d,l,c=o.copyAttributes(a,s.options,"button");l=[n[0],n[1],"<button type=\"button\" style=\"width:100%;\"></button>"];d=s.create("text",l,c);d.type=o.OBJECT_TYPE_BUTTON;d.rendNodeButton=d.rendNode.childNodes[0];d.rendNodeButton.id=d.rendNode.id+"_button";d.rendNodeButton.innerHTML=n[2];d.rendNodeTag=d.rendNodeButton;d.rendNodeTag.disabled=!!c.disabled;d.visPropOld.fontsize="0px";s.renderer.updateTextStyle(d,!1);if(n[3]){if(o.isString(n[3])){d._jc=new e.JessieCode;d._jc.use(s);d._handler=function(){d._jc.parse(n[3])}}else{d._handler=n[3]}}r.addEvent(d.rendNodeButton,"click",i.ButtonClickEventHandler,d);r.addEvent(d.rendNodeButton,"mousedown",function(e){if(o.exists(e.stopPropagation))e.stopPropagation()},d);r.addEvent(d.rendNodeButton,"touchstart",function(e){if(o.exists(e.stopPropagation))e.stopPropagation()},d);r.addEvent(d.rendNodeButton,"pointerdown",function(e){if(o.exists(e.stopPropagation))e.stopPropagation()},d);return d};e.registerElement("button",e.createButton);return{createButton:e.createButton}});define("../build/core-amd.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/qdt","math/numerics","math/statistics","math/symbolic","math/geometry","math/poly","math/complex","renderer/abstract","renderer/no","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","element/locus","parser/datasource","parser/jessiecode","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button"],function(e){"use strict";return e});return require("../build/core-amd.deps.js")}());
//# sourceMappingURL=jsxgraphcore-lazy.min.js.map
